<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/page/81/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-oj/uva/uva-10089" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/05/oj/uva/uva-10089/" class="article-date">
  <time datetime="2014-05-05T00:20:01.000Z" itemprop="datePublished">2014-05-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/1399189276434.jpg" rel="gallery_ckpaivcb400ezn8vn618v41en">
        <img src="/img/1399189276434.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/05/oj/uva/uva-10089/">UVa 10089 - Repackaging</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/05/oj/uva/uva-10089/" data-id="ckpaivcb400ezn8vn618v41en" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/05/oj/uva/uva-10089/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/方程轉換/">方程轉換</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/極角排序/">極角排序</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <div class="video-container"><iframe src="https://www.youtube.com/embed/2k39aeS7qhg" frameborder="0" loading="lazy" allowfullscreen></iframe></div>

<p>儘管如此世界依舊美麗 (Still world is beautiful それでもせかいはうつくしい 插曲) ，比預期中的還要好看，可能是人物屬性的關係讓我欲罷不能啊！順帶附了劇中歌曲，詳細請等待 OST，</p>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Coffee cups of three different sizes (identified as size 1, size 2 and size 3 cups) are produced in factories under ACM (Association of Cup Makers) and are sold in various packages. Each type of package is identified by three positive integers (S1, S2, S3) where Si (1 &lt;= i &lt;= 3) denotes the number of size i cups included in the package. There is no package with S1 = S2 = S3.</p>
<p>But recently it has been discovered that there is a great demand for packages containing equal number cups of all three sizes. So, as an emergency step to meet the demand ACM has decided to unpack the cups from some of the packages stored in its (unlimited) stock of unsold products and repack them in packages having equal number of cups of all three sizes. For example, suppose ACM has the following four types of packages in its stock: (1, 2, 3), (1, 11, 5), (9, 4, 3) and (2, 3, 2). So, one can unpack three (1, 2, 3) packages, one (9, 4, 3) package and two (2, 3, 2) packages and repack the cups to produce sixteen (1, 1, 1) packages. One can even produce eight (2, 2, 2) packages or four (4, 4, 4) packages or two (8, 8, 8) packages or one (16, 16, 16) package or even different combination of packages each containing equal number of size 1, size 2 and size 3 cups. Note that all the unpacked cups are used to produce the new packages, i.e., no unpacked cup is wasted.</p>
<p>ACM has hired you to write a program that will decide whether it is possible to produce packages containing equal number of all three types of cups using all the cups that can be found by unpacking any combination of existing packages in the stock.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input may contain multiple test cases. Each test case begins with a line containing an integer N (3 &lt;= N &lt;= 1000) indicating the number of different types of packages that can be found in the stock. Each of the next N lines contains three positive integers denoting respectively the number of size 1, size 2 and size 3 cups in a package. No two packages in a test case will have the same specification.</p>
<p>A test case containing a zero for N in the first line terminates the input.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case in the input print a line containing “Yes” if packages can be produced as desired, print “No” otherwise.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">1 2 3</span><br><span class="line">1 11 5</span><br><span class="line">9 4 3</span><br><span class="line">2 3 2</span><br><span class="line">4</span><br><span class="line">1 3 3</span><br><span class="line">1 11 5</span><br><span class="line">9 4 3</span><br><span class="line">2 3 2</span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Yes</span><br><span class="line">No</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<p>咖啡杯有三種不同大小，出售的時候每一包三者都有不同個數，表示成 (S1, S2, S3) = (小, 中, 大)。</p>
<p>現在要將其重新包裝，每一種包假設有無限個數，問有沒有拆包的方式，滿足</p>
<p><code>x1 * (a1, b1, c1) + ... + xn * (an, bn, cn) = (k, k, k)</code></p>
<p>其中 <code>x[i] &gt;= 0 的非負整數, k 為非負整數</code>，也就是重新包裝後要產生 k 個 (1, 1, 1)，以方便出售。</p>
<p>** 題目解法：**</p>
<p>整數線性規劃就別來了，畢竟連 <code>k</code> 都沒有確定，解方程也不曉得解集合是否符合條件。</p>
<p>最後，重新考量 (S1, S2, S3)，如果以 S1 為基準，則產生 (S2 - S1, S3 - S1) 的向量。(因為最後還是要跟 S1 的總個數去計算，利用相對數量方式去降維。)，轉換原本的滿足方程 </p>
<p><code>x1 * (y1, z1) + ... + xn * (yn, zn) = (0, 0)</code></p>
<ul>
<li>如果兩個二維向量 <code>(a, b)</code> 和 <code>(c, d)</code>，對於任意 <code>p (a, b) + q (c, d)</code> 的結果可以產生兩個向量間任意角度(&lt;= 180 deg)的向量 (不考慮向量長度，p, q 是非負整數)。</li>
</ul>
<p>明白了上述條件後，將所有包分配至以原點拉出的向量，只要能產生兩個反向向量就可以相消找到 <code>(0, 0)</code> 向量。相消的條件很簡單，使用極角排序，相鄰兩個角度差全小於 <code>pi</code> 即有存在相消情況。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int n, S1, S2, S3;</span><br><span class="line">    const double pi = acos(-1);</span><br><span class="line">    while(scanf(&quot;%d&quot;, &amp;n) == 1 &amp;&amp; n) &#123;</span><br><span class="line">        double A[1024];</span><br><span class="line">        for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            scanf(&quot;%d %d %d&quot;, &amp;S1, &amp;S2, &amp;S3);</span><br><span class="line">            A[i] = atan2(S2 - S1, S3 - S1);</span><br><span class="line">        &#125;</span><br><span class="line">        sort(A, A + n);</span><br><span class="line">        double gap = 0;</span><br><span class="line">        for(int i = 1; i &lt; n; i++) &#123;</span><br><span class="line">            gap = max(gap, A[i] - A[i-1]);</span><br><span class="line">        &#125;</span><br><span class="line">        gap = max(gap, 2 * pi - (A[n-1] - A[0]));</span><br><span class="line">        puts(gap &gt; pi ? &quot;No&quot; : &quot;Yes&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12544" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/05/oj/uva/uva-12544/" class="article-date">
  <time datetime="2014-05-05T00:03:30.000Z" itemprop="datePublished">2014-05-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/05/oj/uva/uva-12544/">UVa 12544 - Beehives</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/05/oj/uva/uva-12544/" data-id="ckpaivcc800jfn8vnd8635rzh" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/05/oj/uva/uva-12544/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bfs/">bfs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/floyd/">floyd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最小成本環/">最小成本環</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Bees are one of the most industrious insects. Since they collect nectarand pollen from owers, they have to rely on the trees in the forest. For simplicity they numbered the n trees from 0 to n - 1. Instead of roaming around all over the forest, they use a particular list of paths. A path is based on two trees, and they can move either way i.e. from one tree to another in straight line. They don’t use paths thatare not in their list.</p>
<p>As technology has been improved a lot, they also changed their working strategy. Instead of hovering over all the trees in the forest, they are targeting particular trees, mainly trees with lots of owers. So, they planned that they will build some new hives in some targeted trees. After that they will only collect their foods from these trees. They will also remove some paths from their list so that they don’t have to go to a tree with no hive in it.</p>
<p>Now, they want to build the hives such that if one of the paths in their new list go down (some<br>birds or animals disturbs them in that path) it’s still possible to go from any hive to another using the existing paths. </p>
<p>They don’t want to choose less than two trees and as hive-building requires a lot of work, they need to keep the number of hives as low as possible. Now you are given the trees with the paths they use, your task is to propose a new bee hive colony for them.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input starts with an integer T( T &lt; 50), denoting the number of test cases.</p>
<p>Each case starts with a blank line. Next line contains two integers n (2 &lt;= n &lt;= 500) and m (0 &lt; m&lt; 20000), where n denotes the number of trees and m denotes the number of paths. Each of the next m lines contains two integers uv (0 &lt; u , v &lt; n), u = v) meaning that there is a path between tree u and v. Assume that there can be at most one path between tree u to v, and needless to say that a path will not be given more than once in the input. </p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each case, print the case number and the number of beehives in the proposed colony or <code>impossible</code> if its impossible to find such a colony.<br>NOTE:<br>Dataset is huge. Use faster I/O methods.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">3 3</span><br><span class="line">0 1</span><br><span class="line">1 2</span><br><span class="line">2 0</span><br><span class="line">2 1</span><br><span class="line">0 1</span><br><span class="line">5 6</span><br><span class="line">0 1</span><br><span class="line">1 2</span><br><span class="line">1 3</span><br><span class="line">2 3</span><br><span class="line">0 4</span><br><span class="line">3 4</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Case 1: 3</span><br><span class="line">Case 2: impossible</span><br><span class="line">Case 3: 3</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<p>在一個無向圖中，找到一個成本最小環。</p>
<p>** 題目解法：**</p>
<p>Floyd 解法：<br>先來附一個錯誤版本，可以在 <code>O(n^3)</code> 解決，核心思路在於討論路徑上經過編號小於等於 k 時，同時探討最小環上經過編號 k 個所有環。但由於 <code>n = 500</code> 在此題中效率不好，但也不知道為什麼拿了 <code>Runtime Error</code> </p>
<figure class="highlight cpp"><figcaption><span>TLE version</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> g[<span class="number">512</span>][<span class="number">512</span>], w[<span class="number">512</span>][<span class="number">512</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> n, m, x, y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                g[i][j] = w[i][j] = <span class="number">0xf3f3f3f</span>;</span><br><span class="line">        <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">            w[x][y] = w[y][x] = g[x][y] = g[y][x] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0xf3f3f3f</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(i != j)</span><br><span class="line">                        ret = <span class="built_in">min</span>(ret, w[k][i] + g[i][j] + w[j][k]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                    g[i][j] = <span class="built_in">min</span>(g[i][j], g[i][k] + g[k][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d: &quot;</span>, ++cases);</span><br><span class="line">        <span class="keyword">if</span>(ret == <span class="number">0xf3f3f3f</span>)</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;impossible&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BFS 作法：<br>Floyd 用在成本不同的路徑上是有效的，但是在成本都是 1 的時候就有點太過了，使用 BFS 對於每一個點進行最短路徑，查看路徑樹上是否有 <code>back edge</code>。整體可以在 <code>O(n^2)</code> 完成，這個 <code>back edge</code> 可能會造成有重複走過點的環，但是不影響我們去找到最小成本。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">#include &lt;algorithm&gt; </span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">vector&lt;int&gt; g[512];</span><br><span class="line">int dist[512], parent[512];</span><br><span class="line">int bfs(int st, int &amp;ret) &#123;</span><br><span class="line">    memset(dist, 0, sizeof(dist));</span><br><span class="line">    dist[st] = 1, parent[st] = -1;</span><br><span class="line">    queue&lt;int&gt; Q;</span><br><span class="line">    Q.push(st);</span><br><span class="line">    while(!Q.empty()) &#123;</span><br><span class="line">        int u = Q.front();</span><br><span class="line">        Q.pop();</span><br><span class="line">        for(int i = 0; i &lt; g[u].size(); i++) &#123;</span><br><span class="line">            int v = g[u][i];</span><br><span class="line">            if(v == parent[u])	continue;</span><br><span class="line">            if(dist[v] == 0) &#123;</span><br><span class="line">                dist[v] = dist[u] + 1;</span><br><span class="line">                parent[v] = u;</span><br><span class="line">                Q.push(v);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                ret = min(ret, dist[u] + dist[v] - 1);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int testcase, cases = 0;</span><br><span class="line">    int n, m, x, y;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;testcase);</span><br><span class="line">    while(testcase--) &#123;</span><br><span class="line">        scanf(&quot;%d %d&quot;, &amp;n, &amp;m);</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            g[i].clear();</span><br><span class="line">        while(m--) &#123;</span><br><span class="line">            scanf(&quot;%d %d&quot;, &amp;x, &amp;y);</span><br><span class="line">            g[x].push_back(y);</span><br><span class="line">            g[y].push_back(x);</span><br><span class="line">        &#125;</span><br><span class="line">        int ret = n + 1;</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            bfs(i, ret);</span><br><span class="line">        printf(&quot;Case %d: &quot;, ++cases);</span><br><span class="line">        if(ret == n + 1)</span><br><span class="line">            puts(&quot;impossible&quot;);</span><br><span class="line">        else</span><br><span class="line">            printf(&quot;%d\n&quot;, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-10603" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/05/oj/uva/uva-10603/" class="article-date">
  <time datetime="2014-05-04T23:49:50.000Z" itemprop="datePublished">2014-05-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/05/oj/uva/uva-10603/">UVa 10603 - Fill</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/05/oj/uva/uva-10603/" data-id="ckpaivcb800fjn8vnc162ednc" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/05/oj/uva/uva-10603/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bfs/">bfs</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>There are three jugs with a volume of a, b and c liters. (a, b, and c are positive integers not greater than 200). The first and the second jug are initially empty, while the third</p>
<p>is completely filled with water. It is allowed to pour water from one jug into another until either the first one is empty or the second one is full. This operation can be performed zero, one or more times.</p>
<p>You are to write a program that computes the least total amount of water that needs to be poured; so that at least one of the jugs contains exactly d liters of water (d is a positive integer not greater than 200). If it is not possible to measure d liters this way your program should find a smaller amount of water d’ &lt; d which is closest to d and for which d’ liters could be produced. When d’ is found, your program should compute the least total amount of poured water needed to produce d’ liters in at least one of the jugs.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of input contains the number of test cases. In the next T lines, T test cases follow. Each test case is given in one line of input containing four space separated integers - a, b, c and d.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>The output consists of two integers separated by a single space. The first integer equals the least total amount (the sum of all waters you pour from one jug to another) of poured water. The second integer equals d, if d liters of water could be produced by such transformations, or equals the closest smaller value d’ that your program has found.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">2 3 4 2</span><br><span class="line">96 97 199 62	</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">9859 62</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<blockquote><p>有三個桶子，它們各能裝 a ， b ， 和 c 公升。（a , b , c 都為正整數而且不超過200。）第一，第二個桶子最剛開始是空的，但是第三個桶子卻是裝滿水的。你可以從 X 桶子把水倒入 Y 桶子裡並且把 Y 桶子裝滿，要不然就是把 X 桶子倒乾。倒水的步驟可以執行很多次。</p>
<p>你要寫一個程式去計算整個過程中至少要倒多少水才能達成目標，即這三個桶子中有一個桶子剩 d 公升的水。（d 為正整數而且不超過200。）但是如果你沒有辦法達成目標，也就是沒有辦法讓任何一個桶子剩下 d 公升的水，那麼請達成 d’ 公升，d’ 比 d小但是最接近 d。當 d’ 找到了，請你輸出整個過程至少要倒多少水才能達成 d’ 公升。</p>
<footer><strong>luckycat</strong><cite><a href="http://luckycat.kshs.kh.edu.tw/homework/q10603.htm">luckycat.kshs.kh.edu.tw/homework/q10603.htm</a></cite></footer></blockquote>

<p>** 題目解法： **</p>
<p>這題重新測試，導致之前寫的 DFS 方式直接 TLE 炸掉，只要改寫成 BFS 即可通關。<br>原理仍一樣，模擬六種互倒入的方式，每一種倒入又牽扯到溢滿的問題。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define min(x, y) ((x) &lt; (y) ? (x) : (y))</span><br><span class="line">#define oo 0xfffffff</span><br><span class="line">int A, B, C, D, JUG[3];</span><br><span class="line">int dp[201][201][201], res[201];</span><br><span class="line">queue&lt;int&gt; QA, QB, QC, QTOT;</span><br><span class="line">void pushNode(int a, int b, int c, int tot) &#123;</span><br><span class="line">    QA.push(a), QB.push(b), QC.push(c), QTOT.push(tot);</span><br><span class="line">&#125;</span><br><span class="line">void update(int a, int b, int c, int tot) &#123;</span><br><span class="line">    if(tot &gt;= res[D])   return;</span><br><span class="line">    if(tot &gt;= dp[a][b][c])  return;</span><br><span class="line">    dp[a][b][c] = tot;</span><br><span class="line">    res[a] = min(res[a], tot);</span><br><span class="line">    res[b] = min(res[b], tot);</span><br><span class="line">    res[c] = min(res[c], tot);</span><br><span class="line">    if(a &lt; B-b) pushNode(0, b+a, c, tot+a);</span><br><span class="line">    else        pushNode(a-(B-b), B, c, tot+(B-b));</span><br><span class="line">    if(a &lt; C-c) pushNode(0, b, c+a, tot+a);</span><br><span class="line">    else        pushNode(a-(C-c), b, C, tot+(C-c));</span><br><span class="line">    if(b &lt; A-a) pushNode(a+b, 0, c, tot+b);</span><br><span class="line">    else        pushNode(A, b-(A-a), c, tot+(A-a));</span><br><span class="line">    if(b &lt; C-c) pushNode(a, 0, c+b, tot+b);</span><br><span class="line">    else        pushNode(a, b-(C-c), C, tot+(C-c));</span><br><span class="line">    if(c &lt; A-a) pushNode(a+c, b, 0, tot+c);</span><br><span class="line">    else        pushNode(A, b, c-(A-a), tot+(A-a));</span><br><span class="line">    if(c &lt; B-b) pushNode(a, b+c, 0, tot+c);</span><br><span class="line">    else        pushNode(a, B, c-(B-b), tot+(B-b));</span><br><span class="line">&#125;</span><br><span class="line">void bfs(int a, int b, int c, int tot) &#123;</span><br><span class="line">    QA.push(a), QB.push(b), QC.push(c), QTOT.push(tot);</span><br><span class="line">    while (!QA.empty()) &#123;</span><br><span class="line">        a = QA.front(), QA.pop();</span><br><span class="line">        b = QB.front(), QB.pop();</span><br><span class="line">        c = QC.front(), QC.pop();</span><br><span class="line">        tot = QTOT.front(), QTOT.pop();</span><br><span class="line">        update(a, b, c, tot);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int t;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;t);</span><br><span class="line">    while(t--) &#123;</span><br><span class="line">        int i, j, k;</span><br><span class="line">        scanf(&quot;%d %d %d %d&quot;, &amp;A, &amp;B, &amp;C, &amp;D);</span><br><span class="line">        for(i = 0; i &lt;= A; i++)</span><br><span class="line">            for(j = 0; j &lt;= B; j++)</span><br><span class="line">                for(k = 0; k &lt;= C; k++)</span><br><span class="line">                    dp[i][j][k] = oo;</span><br><span class="line">        JUG[0] = A, JUG[1] = B, JUG[2] = C;</span><br><span class="line">        for(i = 0; i &lt;= D; i++)</span><br><span class="line">            res[i] = oo;</span><br><span class="line">        bfs(0, 0, C, 0);</span><br><span class="line">        while(res[D] == oo) D--;</span><br><span class="line">        printf(&quot;%d %d\n&quot;, res[D], D);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12670" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/03/oj/uva/uva-12670/" class="article-date">
  <time datetime="2014-05-02T22:51:24.000Z" itemprop="datePublished">2014-05-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/03/oj/uva/uva-12670/">UVa 12670 - Counting ones</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/03/oj/uva/uva-12670/" data-id="ckpaivccb00jsn8vnf2p1109t" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/03/oj/uva/uva-12670/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/排列組合/">排列組合</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Carl is right now the happiest child in the world: he has just learned this morning what the binary system is. He learned, for instance, that the binary representation of a positive integer k is a string a[n], a[n-1], …, a[0] where each a[i] is a binary digit 0 or 1, starting with a[n] = 1, and such that k = \sum{i = 0, n} a[i] * 2^ i. It is really nice to see him turning decimal numbers into binary numbers, and then adding and even multiplying them. </p>
<p>Caesar is Carl’s older brother, and he just can’t stand to see his little brother so happy. So he has prepared a challenge: \Look Carl, I have an easy question for you: I will give you two integers A and B, and you have to tell me how many 1’s there are in the binary representation of all the integers from A to B, inclusive. Get ready”. Carl agreed to the challenge. After a few minutes, he came back with a list of the binary representation of all the integers from 1 to 100. \Caesar, I’m ready”. Caesar smiled and said: \Well, let me see, I choose A = 10^15 and B = 10^16. Your list will not be useful”. </p>
<p>Carl hates loosing to his brother so he needs a better solution fast. Can you help him ?</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input file contains several test cases, each of them as described below.<br>A single line that contains two integers A and B (1 &lt;= A &lt;= B &lt;= 10^16).</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case, output a line with an integer representing the total number of digits 1 in the binary representation of all the integers from A to B, inclusive.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1000000000000000 10000000000000000</span><br><span class="line">2 12</span><br><span class="line">9007199254740992 9007199254740992</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">239502115812196372</span><br><span class="line">21</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**<br>計算 A 到 B 之間的二進制數出現了幾次 1。</p>
<p>** 題目解法：**<br>將問題轉換成計算 0 到 A 出現了幾次 1，接著討論在相同長度下 1 出現的次數，之後再遞歸求解。</p>
<p>討論的時候，考慮長度為 n 時，每一位的填法，計算要看切割位置的前半和後半數字，詳細查閱代碼。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">mpow</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        ret *= n;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ito2</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">char</span> buf[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>) &#123;</span><br><span class="line">        buf[<span class="number">0</span>] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        buf[<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> i, j, f;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">63</span>, j = f = <span class="number">0</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="keyword">if</span>((n&gt;&gt;i)&amp;<span class="number">1</span>)	f = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(f) &#123;</span><br><span class="line">            buf[j++] = ((n&gt;&gt;i)&amp;<span class="number">1</span>) + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buf[j] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">a2toi</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> &amp;r, <span class="keyword">char</span> buf[])</span> </span>&#123;</span><br><span class="line">    r = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; buf[i]; i++)</span><br><span class="line">        r = r&lt;&lt;<span class="number">1</span> | (buf[i] - <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">long</span> <span class="keyword">long</span> cnt[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//printf(&quot;%d\n&quot;, n);</span></span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">105</span>];</span><br><span class="line">    <span class="built_in">ito2</span>(n, buf);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> prev = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> suffix;</span><br><span class="line">    <span class="built_in">calc</span>(<span class="built_in">mpow</span>(<span class="number">2</span>, len<span class="number">-1</span>)<span class="number">-1</span>, cnt);</span><br><span class="line">    <span class="comment">//for(int i = 0; i &lt; 10; i++)</span></span><br><span class="line">    <span class="comment">//	cnt[i] = 0;</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> prev10 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> d = buf[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="built_in">a2toi</span>(suffix, buf + i + <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(i != len<span class="number">-1</span>)</span><br><span class="line">            cnt[d] += suffix + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cnt[d]++;</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">0</span>)</span><br><span class="line">            cnt[d] += (prev - prev10/<span class="number">2</span>) * <span class="built_in">mpow</span>(<span class="number">2</span>, len-i<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i == <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(j == d)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(j &lt; d) &#123;</span><br><span class="line">                <span class="keyword">if</span>(prev &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    cnt[j] += (prev - prev10/<span class="number">2</span> + <span class="number">1</span>) * <span class="built_in">mpow</span>(<span class="number">2</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cnt[j] += <span class="built_in">mpow</span>(<span class="number">2</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(prev &gt; <span class="number">0</span> &amp;&amp; prev - prev10/<span class="number">2</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    cnt[j] += (prev - prev10/<span class="number">2</span>) * <span class="built_in">mpow</span>(<span class="number">2</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        prev10 *= <span class="number">2</span>;</span><br><span class="line">        prev = prev * <span class="number">2</span> + d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> A, B;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld&quot;</span>, &amp;A, &amp;B) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> cntA[<span class="number">2</span>] = &#123;&#125;, cntB[<span class="number">2</span>] = &#123;&#125;;</span><br><span class="line">        <span class="built_in">calc</span>(A - <span class="number">1</span>, cntA);</span><br><span class="line">        <span class="built_in">calc</span>(B, cntB);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, cntB[<span class="number">1</span>] - cntA[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1449" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/02/oj/uva/uva-1449/" class="article-date">
  <time datetime="2014-05-02T13:07:27.000Z" itemprop="datePublished">2014-05-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/02/oj/uva/uva-1449/">UVa 1449 - Dominating Patterns</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/02/oj/uva/uva-1449/" data-id="ckpaivccp00lcn8vngbl40u1a" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/02/oj/uva/uva-1449/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AC自動機/">AC自動機</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p> The archaeologists are going to decipher a very mysterious ``language”. Now, they know many language patterns; each pattern can be treated as a string on English letters (only lower case). As a sub string, these patterns may appear more than one times in a large text string (also only lower case English letters).</p>
<p>What matters most is that which patterns are the dominating patterns. Dominating pattern is the pattern whose appearing times is not less than other patterns.</p>
<p>It is your job to find the dominating pattern(s) and their appearing times.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The entire input contains multi cases. The first line of each case is an integer, which is the number of patterns N, 1<span>$\le$</span><!-- Has MathJax -->N<span>$\le$</span><!-- Has MathJax -->150. Each of the following N lines contains one pattern, whose length is in range [1, 70]. The rest of the case is one line contains a large string as the text to lookup, whose length is up to 106.</p>
<p>At the end of the input file, number `0’ indicates the end of input file.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each of the input cases, output the appearing times of the dominating pattern(s). If there are more than one dominating pattern, output them in separate lines; and keep their input order to the output.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">2 </span><br><span class="line">aba </span><br><span class="line">bab </span><br><span class="line">ababababac </span><br><span class="line">6 </span><br><span class="line">beta </span><br><span class="line">alpha </span><br><span class="line">haha </span><br><span class="line">delta </span><br><span class="line">dede </span><br><span class="line">tata </span><br><span class="line">dedeltalphahahahototatalpha </span><br><span class="line">0</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">4 </span><br><span class="line">aba </span><br><span class="line">2 </span><br><span class="line">alpha </span><br><span class="line">haha</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<p>給 N 個字串，問在 S 字串中哪些字串出現最多次。</p>
<p>** 題目解法：**</p>
<p>對 N 個字串建造 AC 自動機，將 S 丟入自動機去計算給一個單詞出現次數。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> maxKind 26</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    Node *fail;</span><br><span class="line">    Node *next[maxKind];</span><br><span class="line">    <span class="keyword">int</span> cnt;</span><br><span class="line">    <span class="keyword">int</span> who;</span><br><span class="line">    <span class="built_in">Node</span>() &#123;</span><br><span class="line">        fail = <span class="literal">NULL</span>;</span><br><span class="line">        cnt = <span class="number">0</span>;</span><br><span class="line">        who = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(next, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(next));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_Trie</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* str, Node *root, <span class="keyword">int</span> who)</span> </span>&#123;</span><br><span class="line">    Node *p = root;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, idx;</span><br><span class="line">    <span class="keyword">while</span>(str[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span>(str[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">            idx = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;next[idx] == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            p-&gt;next[idx] = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        p = p-&gt;next[idx];</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;cnt++;</span><br><span class="line">    p-&gt;who = who;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build_AC_automation</span><span class="params">(Node *root)</span> </span>&#123;</span><br><span class="line">    root-&gt;fail = <span class="literal">NULL</span>;</span><br><span class="line">    queue&lt;Node*&gt; Q;</span><br><span class="line">    Q.<span class="built_in">push</span>(root);</span><br><span class="line">    Node *tn, *p;</span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        tn = Q.<span class="built_in">front</span>();</span><br><span class="line">        Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxKind; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(tn-&gt;next[i] == <span class="literal">NULL</span>)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            Q.<span class="built_in">push</span>(tn-&gt;next[i]);</span><br><span class="line">            p = tn-&gt;fail;</span><br><span class="line">            <span class="keyword">while</span>(p != <span class="literal">NULL</span> &amp;&amp; p-&gt;next[i] == <span class="literal">NULL</span>)</span><br><span class="line">                p = p-&gt;fail;</span><br><span class="line">            <span class="keyword">if</span>(p == <span class="literal">NULL</span>)</span><br><span class="line">                tn-&gt;next[i]-&gt;fail = root;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                tn-&gt;next[i]-&gt;fail = p-&gt;next[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">free_AC_automation</span><span class="params">(Node *root)</span> </span>&#123;</span><br><span class="line">    queue&lt;Node*&gt; Q;</span><br><span class="line">    Q.<span class="built_in">push</span>(root);</span><br><span class="line">    Node *tn, *p;</span><br><span class="line">    <span class="keyword">while</span>(!Q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        tn = Q.<span class="built_in">front</span>();</span><br><span class="line">        Q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; maxKind; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(tn-&gt;next[i] != <span class="literal">NULL</span>) &#123;</span><br><span class="line">                Q.<span class="built_in">push</span>(tn-&gt;next[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(tn);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* str, Node *root, <span class="keyword">int</span> cnt[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, idx;</span><br><span class="line">    Node *tn, *p;</span><br><span class="line">    tn = root;</span><br><span class="line">    <span class="keyword">while</span>(str[i]) &#123;</span><br><span class="line">        <span class="keyword">if</span>(str[i] &gt;= <span class="string">&#x27;a&#x27;</span> &amp;&amp; str[i] &lt;= <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">            idx = str[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">while</span>(tn-&gt;next[idx] == <span class="literal">NULL</span> &amp;&amp; tn != root)</span><br><span class="line">            tn = tn-&gt;fail;</span><br><span class="line">        tn = tn-&gt;next[idx];</span><br><span class="line">        tn = (tn == <span class="literal">NULL</span>) ? root : tn;</span><br><span class="line">        p = tn;</span><br><span class="line">        <span class="keyword">while</span>(p != root) &#123;</span><br><span class="line">        	<span class="keyword">if</span>(p-&gt;cnt &gt; <span class="number">0</span>)</span><br><span class="line">            	cnt[p-&gt;who]++;</span><br><span class="line">            p = p-&gt;fail;</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> buf[<span class="number">1048576</span>], pattern[<span class="number">256</span>][<span class="number">256</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</span><br><span class="line">        Node *root = <span class="keyword">new</span> <span class="built_in">Node</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, pattern[i]);</span><br><span class="line">            <span class="built_in">build_Trie</span>(pattern[i], root, i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">build_AC_automation</span>(root);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        <span class="keyword">int</span> cnt[<span class="number">256</span>] = &#123;&#125;;</span><br><span class="line">        <span class="built_in">query</span>(buf, root, cnt);</span><br><span class="line">        <span class="built_in">free_AC_automation</span>(root);</span><br><span class="line">        <span class="keyword">int</span> maxMatch = cnt[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	maxMatch = <span class="built_in">max</span>(maxMatch, cnt[i+<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, maxMatch);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="keyword">if</span>(cnt[i+<span class="number">1</span>] == maxMatch)</span><br><span class="line">        		<span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, pattern[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1494" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/02/oj/uva/uva-1494/" class="article-date">
  <time datetime="2014-05-01T23:37:27.000Z" itemprop="datePublished">2014-05-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/02/oj/uva/uva-1494/">UVa 1494 - Qin Shi Huang&#39;s National Road System</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/02/oj/uva/uva-1494/" data-id="ckpaivccq00lgn8vnekw8a8pj" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/02/oj/uva/uva-1494/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p> During the Warring States Period of ancient China(476 BC to 221 BC), there were seven kingdoms in China – they were Qi, Chu, Yan, Han, Zhao, Wei and Qin. Ying Zheng was the king of the kingdom Qin. Through 9 years of wars, he finally conquered all six other kingdoms and became the first emperor of a unified China in 221 BC. That was Qin dynasty – the first imperial dynasty of China(not to be confused with the Qing Dynasty, the last dynasty of China). So Ying Zheng named himself “Qin Shi Huang” because “Shi Huang” means “the first emperor “ in Chinese.</p>
<p>\epsfbox{p5713.eps}</p>
<p>Qin Shi Huang undertook gigantic projects, including the first version of the Great Wall of China, the now famous city-sized mausoleum guarded by a life-sized Terracotta Army, and a massive national road system. There is a story about the road system:</p>
<p>There were n cities in China and Qin Shi Huang wanted them all be connected by n - 1 roads, in order that he could go to every city from the capital city Xianyang. Although Qin Shi Huang was a tyrant, he wanted the total length of all roads to be minimum,so that the road system may not cost too many people’s life. A daoshi (some kind of monk) named Xu Fu told Qin Shi Huang that he could build a road by magic and that magic road would cost no money and no labor. But Xu Fu could only build ONE magic road for Qin Shi Huang. So Qin Shi Huang had to decide where to build the magic road. Qin Shi Huang wanted the total length of all none magic roads to be as small as possible, but Xu Fu wanted the magic road to benefit as many people as possible – So Qin Shi Huang decided that the value of A/B (the ratio of A to B) must be the maximum, which A is the total population of the two cites connected by the magic road, and B is the total length of none magic roads.</p>
<p>Would you help Qin Shi Huang?</p>
<p>A city can be considered as a point, and a road can be considered as a line segment connecting two points.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line contains an integer t meaning that there are t test cases (t &lt; 10).</p>
<p>For each test case:</p>
<p>The first line is an integer n meaning that there are n cities (2 &lt; n &lt;= 1000).</p>
<p>Then n lines follow. Each line contains three integers X, Y and P (0 &lt; X, Y &lt;= 1000, 0 &lt; P &lt; 100000). (X, Y) is the coordinate of a city and P is the population of that city.</p>
<p>It is guaranteed that each city has a distinct location.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each test case, print a line indicating the above mentioned maximum ratio A/B. The result should be rounded to 2 digits after decimal point.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">4</span><br><span class="line">1 1 20</span><br><span class="line">1 2 30</span><br><span class="line">200 2 80</span><br><span class="line">200 1 100</span><br><span class="line">3</span><br><span class="line">1 1 20</span><br><span class="line">1 2 30</span><br><span class="line">2 2 40</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">65.00</span><br><span class="line">70.00</span><br></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<p>有 n 個城市，在中國秦始皇希望他們都用連接 n - 1 道路，以便他可以去到每一個城市從首都咸陽。儘管秦始皇是個暴君，他希望所有的道路是最低的總長度，從而使道路系統可能不會花費太多勞力。倒是一個（一些和尚）命名徐福告訴秦始皇，他可以通過魔法修路和魔法的道路將花費沒用錢，沒用勞動力。但徐福只能建一個神奇的道路秦始皇。所以，秦始皇不得不決定在哪裡建造魔法的道路。秦始皇想所有無魔法的道路是盡可能小的總長度，但徐福希望魔法道路可以效益為盡可能多的人。所以秦始皇決定 A / B 必須是最大的，其中 A 是魔法路兩端的總人口，而 B 是沒有魔法的道路的總長度。</p>
<p>** 題目解法：**</p>
<p>找出 MST，窮舉所有所有魔法路的可能。</p>
<p>對於一個 MST 修改一條邊，可在 <code>O(n)</code> 時間內找到環，之後將環上最重的邊去除即可。<br>但是這題中，MST 會保留住，因此對 MST 任兩點路徑上的最重邊進行在 <code>O(n^2)</code> 內完成計算。</p>
<ul>
<li>MST 加入新點，可以在 O(n) 時間內完成 ?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">struct E &#123;</span><br><span class="line">    int x, y, v;</span><br><span class="line">    E(int a=0, int b=0, int c=0):</span><br><span class="line">        x(a), y(b), v(c) &#123;&#125;</span><br><span class="line">    bool operator&lt;(const E &amp;a) const &#123;</span><br><span class="line">        return  v &lt; a.v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">E D[1000005];</span><br><span class="line">vector&lt;E&gt; tree[1005];</span><br><span class="line">int p[1005], rank[1005];</span><br><span class="line">int findp(int x) &#123;</span><br><span class="line">    return p[x] == x ? x : (p[x] = findp(p[x]));</span><br><span class="line">&#125;</span><br><span class="line">int joint(int x, int y) &#123;</span><br><span class="line">    x = findp(x), y = findp(y);</span><br><span class="line">    if(x == y)</span><br><span class="line">        return 0;</span><br><span class="line">    if(rank[x] &gt; rank[y])</span><br><span class="line">        rank[x] += rank[y], p[y] = x;</span><br><span class="line">    else</span><br><span class="line">        rank[y] += rank[x], p[x] = y;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line">double kruscal(int n, int m) &#123;</span><br><span class="line">    double sum = 0;</span><br><span class="line">    </span><br><span class="line">    sort(D, D+m);</span><br><span class="line">    for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        p[i] = i, rank[i] = 1;</span><br><span class="line">        tree[i].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    for(int i = 0; i &lt; m; i++) &#123;</span><br><span class="line">        if(joint(D[i].x, D[i].y)) &#123;</span><br><span class="line">        	sum += sqrt(D[i].v);</span><br><span class="line">        	tree[D[i].x].push_back(E(D[i].x, D[i].y, D[i].v));</span><br><span class="line">        	tree[D[i].y].push_back(E(D[i].y, D[i].x, D[i].v));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return sum;</span><br><span class="line">&#125;</span><br><span class="line">int visited[1005];</span><br><span class="line">double maxEdge[1005][1005];</span><br><span class="line">void dfs(int u, int n) &#123;</span><br><span class="line">    visited[u] = 1;</span><br><span class="line">    for(int i = 0; i &lt; tree[u].size(); i++) &#123;</span><br><span class="line">        int v = tree[u][i].y;</span><br><span class="line">        if(visited[v])	continue;</span><br><span class="line">        double cost = sqrt(tree[u][i].v);</span><br><span class="line">        maxEdge[u][v] = maxEdge[v][u] = cost;</span><br><span class="line">        for(int j = 0; j &lt; n; j++) &#123;</span><br><span class="line">            if(visited[j]) &#123;</span><br><span class="line">                maxEdge[j][v] = maxEdge[v][j] = max(maxEdge[j][u], cost);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        dfs(v, n);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int testcase;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;testcase);</span><br><span class="line">    while(testcase--) &#123;</span><br><span class="line">        int n, e;</span><br><span class="line">        int X[1005], Y[1005], P[1005];</span><br><span class="line">        scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">        	scanf(&quot;%d %d %d&quot;, &amp;X[i], &amp;Y[i], &amp;P[i]);</span><br><span class="line">        e = 0;</span><br><span class="line">        for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            for(int j = i + 1; j &lt; n; j++) &#123;</span><br><span class="line">                D[e++] = E(i, j, (X[i] - X[j])*(X[i] - X[j]) </span><br><span class="line">                                    + (Y[i] - Y[j])*(Y[i] - Y[j]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        double mstcost = kruscal(n, e);</span><br><span class="line">        double ret = 0;</span><br><span class="line">        </span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            visited[i] = 0;</span><br><span class="line">        dfs(0, n);</span><br><span class="line">        </span><br><span class="line">        for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">            for(int j = i + 1; j &lt; n; j++) &#123;</span><br><span class="line">                ret = max(ret, (P[i] + P[j])/(mstcost - maxEdge[i][j]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        printf(&quot;%.2lf\n&quot;, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1417" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/01/oj/uva/uva-1417/" class="article-date">
  <time datetime="2014-05-01T11:24:09.000Z" itemprop="datePublished">2014-05-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/01/oj/uva/uva-1417/">UVa 1417 - Traffic Jam</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/01/oj/uva/uva-1417/" data-id="ckpaivccp00lbn8vnbtpjfwht" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/01/oj/uva/uva-1417/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/線段樹/">線段樹</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>The kingdom of Tripbansai has an unusual traffic system. The city locations in the kingdom can be described as a grid and all the roads connect neighboring cities. This rectangular grid has 2 rows and C columns where every point represents a city. So there are 2 * C cities and 3 * C - 2 roads in this system.</p>
<p>Sometimes two adjacent cities become disconnected because of traffic jam, and sometimes the traffic problem has been solved so that a road can be usedd again. We can assume that every road is closed at first.</p>
<p>Ministry of Communications will give some instructions to you. Your task is to implement a program as a traffic response information system.</p>
<p>Each instruction appears as a single line in one ofthe formats below:</p>
<p><code>Close r1 c1 r2 c2</code>     Close the road connecting the adjacent cities located on (r1, c1) and (r2, c2) .<br><code>Open r1 c1 r2 c2</code>     Open the road connecting the adjacent cities located on (r1, c1) and (r2, c2) .<br><code>Ask r1 c1 r2 c2</code>     Reply with Y if there exists a way from the city on (r1, c1) to the city on (r2, c2) ;<br>    reply with N if there doesn’t.<br><code>Exit</code>     No more requests are forthcoming. The problem should exit.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line ofthe input contains a single integer T (1<span>$\le$</span><!-- Has MathJax -->T<span>$\le$</span><!-- Has MathJax -->11) , representing the number of test cases that follow.</p>
<p>The first line of each test case consists of a single integer C (1<span>$\le$</span><!-- Has MathJax -->C<span>$\le$</span><!-- Has MathJax -->100000) , which is the number of columns.</p>
<p>There are some lines following, each for an instruction. Each test case ends with an instruction ``Exit”. There are no more than 100000 instructions in each test case. All the roads are closed initially, and each case is an independent problem.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each instruction <code>Ask r1 c1 r2 c2</code>, display a line containing <code>Y</code> or <code>N</code>.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">Open 1 1 1 2</span><br><span class="line">Open 1 2 2 2</span><br><span class="line">Ask 1 1 2 2</span><br><span class="line">Ask 2 1 2 2</span><br><span class="line">Exit</span><br><span class="line">3</span><br><span class="line">Open 1 1 1 2</span><br><span class="line">Ask 1 1 1 2</span><br><span class="line">Close 1 1 1 2</span><br><span class="line">Ask 1 1 1 2</span><br><span class="line">Exit</span><br><span class="line">2</span><br><span class="line">Open 1 1 1 2</span><br><span class="line">Open 1 2 2 2</span><br><span class="line">Open 2 1 2 2</span><br><span class="line">Ask 1 1 2 1</span><br><span class="line">Exit</span><br></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Y</span><br><span class="line">N</span><br><span class="line">Y</span><br><span class="line">N</span><br><span class="line">Y</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>對於一個 2 x C 的方格點來說，將會有 <code>3 * C - 2</code> 條邊。</p>
<p>** 題目解法： **</p>
<p>維護一個區間角落四個點之間的連接資訊，也就是總共六種。</p>
<ul>
<li>c[0] 左上右上</li>
<li>c[1] 左上右下</li>
<li>c[2] 左下右上</li>
<li>c[3] 左下右下</li>
<li>c[4] 左上左下</li>
<li>c[5] 右上右下</li>
</ul>
<p>上方 <code>r = 1</code> 下方 <code>r = 2</code> 左方 <code>c = left</code> 右方 <code>c = right</code></p>
<p>對於區間 <code>[l, r]</code> 我們只維護這個區間的資訊，不考慮繞此外的結果。<br>而對於區間的編號，由左而右，構成 0, 1, 2, 3, …, C，每一個可以看作是一個方格。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> c[<span class="number">6</span>];</span><br><span class="line">&#125;; <span class="comment">// - \ / _ | |</span></span><br><span class="line">Node ST[<span class="number">262144</span> + <span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(&amp;ST[k], <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(ST[k]));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r)/<span class="number">2</span>;</span><br><span class="line">    <span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Node <span class="title">combine</span><span class="params">(Node s1, Node s2)</span> </span>&#123;</span><br><span class="line">    Node s;</span><br><span class="line">    s.c[<span class="number">0</span>] = (s1.c[<span class="number">0</span>] &amp;&amp; s2.c[<span class="number">0</span>]) || (s1.c[<span class="number">1</span>] &amp;&amp; s2.c[<span class="number">2</span>]);</span><br><span class="line">    s.c[<span class="number">1</span>] = (s1.c[<span class="number">0</span>] &amp;&amp; s2.c[<span class="number">1</span>]) || (s1.c[<span class="number">1</span>] &amp;&amp; s2.c[<span class="number">3</span>]);</span><br><span class="line">    s.c[<span class="number">2</span>] = (s1.c[<span class="number">2</span>] &amp;&amp; s2.c[<span class="number">0</span>]) || (s1.c[<span class="number">3</span>] &amp;&amp; s2.c[<span class="number">2</span>]);</span><br><span class="line">    s.c[<span class="number">3</span>] = (s1.c[<span class="number">2</span>] &amp;&amp; s2.c[<span class="number">1</span>]) || (s1.c[<span class="number">3</span>] &amp;&amp; s2.c[<span class="number">3</span>]);</span><br><span class="line">    s.c[<span class="number">4</span>] = (s1.c[<span class="number">4</span>]) || (s1.c[<span class="number">0</span>] &amp;&amp; s2.c[<span class="number">4</span>] &amp;&amp; s1.c[<span class="number">3</span>]);</span><br><span class="line">    s.c[<span class="number">5</span>] = (s2.c[<span class="number">5</span>]) || (s2.c[<span class="number">0</span>] &amp;&amp; s1.c[<span class="number">5</span>] &amp;&amp; s2.c[<span class="number">3</span>]);</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> qidx, <span class="keyword">int</span> qfield, <span class="keyword">int</span> qval)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(l == r) &#123;</span><br><span class="line">        ST[k].c[qfield] = qval;</span><br><span class="line">        ST[k].c[<span class="number">1</span>] = (ST[k].c[<span class="number">0</span>] &amp;&amp; ST[k].c[<span class="number">5</span>]) || (ST[k].c[<span class="number">3</span>] &amp;&amp; ST[k].c[<span class="number">4</span>]);</span><br><span class="line">        ST[k].c[<span class="number">2</span>] = (ST[k].c[<span class="number">0</span>] &amp;&amp; ST[k].c[<span class="number">4</span>]) || (ST[k].c[<span class="number">3</span>] &amp;&amp; ST[k].c[<span class="number">5</span>]);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(qidx &gt; mid)</span><br><span class="line">        <span class="built_in">modify</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, qidx, qfield, qval);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">modify</span>(k&lt;&lt;<span class="number">1</span>, l, mid, qidx, qfield, qval);</span><br><span class="line">    ST[k] = <span class="built_in">combine</span>(ST[k&lt;&lt;<span class="number">1</span>], ST[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Node <span class="title">query</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> ql, <span class="keyword">int</span> qr)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ql &lt;= l &amp;&amp; r &lt;= qr)</span><br><span class="line">        <span class="keyword">return</span> ST[k];</span><br><span class="line">    <span class="keyword">int</span> mid = (l + r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(ql &gt; mid)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, ql, qr);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(qr &lt;= mid)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>, l, mid, ql, qr);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">combine</span>(<span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>, l, mid, ql, qr), </span><br><span class="line">                        <span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, mid+<span class="number">1</span>, r, ql, qr));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, C;</span><br><span class="line">    <span class="keyword">int</span> r1, r2, c1, c2;</span><br><span class="line">    <span class="keyword">int</span> lines = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> cmd[<span class="number">10</span>];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;C);</span><br><span class="line">        <span class="built_in">memset</span>(ST, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(ST));</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">0</span>, C);</span><br><span class="line">        <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, cmd) == <span class="number">1</span> &amp;&amp; cmd[<span class="number">0</span>] != <span class="string">&#x27;E&#x27;</span>) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;r1, &amp;c1, &amp;r2, &amp;c2);</span><br><span class="line">            <span class="keyword">if</span>(cmd[<span class="number">0</span>] == <span class="string">&#x27;O&#x27;</span> || cmd[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span>) &#123; <span class="comment">// open</span></span><br><span class="line">                <span class="keyword">int</span> qval = cmd[<span class="number">0</span>] == <span class="string">&#x27;O&#x27;</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(c1 != c2) &#123;</span><br><span class="line">                    <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">0</span>, C, <span class="built_in">min</span>(c1, c2), r1 == <span class="number">1</span> ? <span class="number">0</span> : <span class="number">3</span>, qval);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">0</span>, C, <span class="built_in">min</span>(c1, c2) - <span class="number">1</span>, <span class="number">5</span>, qval);</span><br><span class="line">                    <span class="built_in">modify</span>(<span class="number">1</span>, <span class="number">0</span>, C, <span class="built_in">min</span>(c1, c2), <span class="number">4</span>, qval);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(c1 &gt; c2) &#123;</span><br><span class="line">                    <span class="built_in">swap</span>(c1, c2);</span><br><span class="line">                    <span class="built_in">swap</span>(r1, r2);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(r1 == r2 &amp;&amp; c1 == c2) &#123;</span><br><span class="line">                    <span class="built_in">puts</span>(<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span>(r1 != r2 &amp;&amp; c1 == c2) &#123;</span><br><span class="line">                    Node l = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, C, <span class="number">0</span>, c1 - <span class="number">1</span>);</span><br><span class="line">                    Node r = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, C, c1, C);</span><br><span class="line">                    <span class="keyword">if</span>(l.c[<span class="number">5</span>] || r.c[<span class="number">4</span>])</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;N&quot;</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Node l = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, C, <span class="number">0</span>, c1 - <span class="number">1</span>);</span><br><span class="line">                    Node r = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, C, c2, C);</span><br><span class="line">                    Node m = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">0</span>, C, c1, c2 - <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">int</span> kc[<span class="number">2</span>][<span class="number">2</span>] = &#123; &#123;<span class="number">0</span>, <span class="number">1</span>&#125;, &#123;<span class="number">2</span>, <span class="number">3</span>&#125; &#125;;</span><br><span class="line">                    <span class="keyword">if</span>(m.c[kc[r1 - <span class="number">1</span>][r2 - <span class="number">1</span>]] || </span><br><span class="line">                        (l.c[<span class="number">5</span>] &amp;&amp; m.c[kc[(<span class="number">3</span> - r1) - <span class="number">1</span>][r2 - <span class="number">1</span>]]) ||</span><br><span class="line">                        (r.c[<span class="number">4</span>] &amp;&amp; m.c[kc[r1 - <span class="number">1</span>][(<span class="number">3</span> - r2) - <span class="number">1</span>]]) ||</span><br><span class="line">                        (l.c[<span class="number">5</span>] &amp;&amp; r.c[<span class="number">4</span>] &amp;&amp; m.c[kc[(<span class="number">3</span> - r1) - <span class="number">1</span>][(<span class="number">3</span> - r2) - <span class="number">1</span>]]))</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;Y&quot;</span>);</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;N&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1608" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/01/oj/uva/uva-1608/" class="article-date">
  <time datetime="2014-05-01T11:04:03.000Z" itemprop="datePublished">2014-05-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/01/oj/uva/uva-1608/">UVa 1608 - Non-boring sequences</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/01/oj/uva/uva-1608/" data-id="ckpaivccs00lpn8vnc5gg5hx6" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/01/oj/uva/uva-1608/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞歸/">遞歸</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>We were afraid of making this problem statement too boring, so we decided to keep it short. A sequence is called non-boring if its every connected subsequence contains a unique element, i.e. an element such that no other element of that subsequence has the same value.<br>Given a sequence of integers, decide whether it is non-boring.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of the input contains the number of test cases T. The descriptions of the test cases follow:<br>Each test case starts with an integer n (1 &lt;= n &lt;= 200000) denoting the length of the sequence. In the next line the n elements of the sequence follow, separated with single spaces. The elements are non-negative integers less than 10^9.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Print the answers to the test cases in the order in which they appear in the input. For each test case print a single line containing the word <code>non-boring</code> or <code>boring</code>.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">4</span><br><span class="line">5</span><br><span class="line">1 2 3 4 5</span><br><span class="line">5</span><br><span class="line">1 1 1 1 1</span><br><span class="line">5</span><br><span class="line">1 2 3 2 1</span><br><span class="line">5</span><br><span class="line">1 1 2 1 1</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">non-boring</span><br><span class="line">boring</span><br><span class="line">non-boring</span><br><span class="line">boring</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>對於所有連續區間，都符合至少有一個獨特的數字。即每個區間中都會有一個數字不重複。</p>
<p>** 題目解法： **</p>
<p>對於一個區間 <code>[l, r]</code> 來說，符合條件時，會存在一個獨特的數字位於 <code>m</code>，則對於 <code>i in [l, m-1] and j in [m+1, r]</code>，所有 <code>[i, j]</code> 產生的區間必然會符合，則遞歸下去查找 <code>[l, m-1]</code> 和 <code>[m+1, r]</code> 有沒有符合。</p>
<p>這題有趣的地方在於－如何快速得到這個獨特數字，不過也不難想地，建出數字的前一個相同和下一個相同。判斷該數字在區間是獨特時，則前一個和下一個皆不會在區間中。</p>
<p>這樣仍不會通過測資，如果是想要接近中間的方式去切割，則會接受 TLE 的殘酷事實，當初在想是不是遞迴太深還怎麼的，這裡留下困惑，根據快速排序的經驗，如果切割點在中間是比較好的，複雜度為 <code>O(n log n)</code>。</p>
<figure class="highlight plaintext"><figcaption><span>cpp</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">int A[262144];</span><br><span class="line">int NEXT[262144], PREV[262144];</span><br><span class="line">map&lt;int, int&gt; R;</span><br><span class="line">int dfs(int l, int r) &#123;</span><br><span class="line">    if(l &gt;= r)	return 1;</span><br><span class="line">    for(int i = 0; i &lt;= (r-l+1)/2; i++) &#123;</span><br><span class="line">        if(NEXT[l+i] &gt; r &amp;&amp; PREV[l+i] &lt; l)</span><br><span class="line">            return dfs(l, l+i-1) &amp;&amp; dfs(l+i+1, r);</span><br><span class="line">        if(NEXT[r-i] &gt; r &amp;&amp; PREV[r-i] &lt; l)</span><br><span class="line">            return dfs(l, r-i-1) &amp;&amp; dfs(r-i+1, r);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int testcase, n;</span><br><span class="line">    scanf(&quot;%d&quot;, &amp;testcase);</span><br><span class="line">    while(testcase--) &#123;</span><br><span class="line">        scanf(&quot;%d&quot;, &amp;n);</span><br><span class="line">        for(int i = 1; i &lt;= n; i++) &#123;</span><br><span class="line">            scanf(&quot;%d&quot;, &amp;A[i]);</span><br><span class="line">            NEXT[i] = n+1;</span><br><span class="line">            PREV[i] = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        R.clear();</span><br><span class="line">        for(int i = 1; i &lt;= n; i++) &#123;</span><br><span class="line">            PREV[i] = R[A[i]], NEXT[PREV[i]] = i;</span><br><span class="line">            R[A[i]] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        puts(dfs(1, n) ? &quot;non-boring&quot; : &quot;boring&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">20</span><br><span class="line">6</span><br><span class="line">1 2 3 1 2 3</span><br><span class="line">5</span><br><span class="line">1 2 3 4 5</span><br><span class="line">5</span><br><span class="line">1 1 1 1 1</span><br><span class="line">5</span><br><span class="line">1 2 3 2 1</span><br><span class="line">5</span><br><span class="line">1 1 2 1 1</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12345" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/05/01/oj/uva/uva-12345/" class="article-date">
  <time datetime="2014-05-01T08:54:48.000Z" itemprop="datePublished">2014-05-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/01/oj/uva/uva-12345/">UVa 12345 - Dynamic len(set(a[L:R]))</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/05/01/oj/uva/uva-12345/" data-id="ckpaivcc500izn8vn2fyi764d" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/05/01/oj/uva/uva-12345/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/塊狀表/">塊狀表</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>In python, we can use len(start(a[L:R])) to calculate the number of distinct values of elements a[L], a[L+1], …, a[R-1]. </p>
<p>Here are some interactive examples that may help you understand how it is done. Remember that the indices of python lists start from 0. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; a=[1,2,1,3,2,1,4]</span><br><span class="line">&gt;&gt;&gt; print a[1:6]</span><br><span class="line">[2, 1, 3, 2, 1]</span><br><span class="line">&gt;&gt;&gt; print set(a[1:6])</span><br><span class="line">set([1, 2, 3])</span><br><span class="line">&gt;&gt;&gt; print len(set(a[1:6]))</span><br><span class="line">3</span><br><span class="line">&gt;&gt;&gt; a[3]=2</span><br><span class="line">&gt;&gt;&gt; print len(set(a[1:6]))</span><br><span class="line">2</span><br><span class="line">&gt;&gt;&gt; print len(set(a[3:5]))</span><br><span class="line">1 </span><br></pre></td></tr></table></figure>

<p>Your task is to simulate this process.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>There will be only one test case. The first line contains two integers n and m (1 ≤ n,m ≤ 50,000). The next line contains the original list.</p>
<p>All the integers are between 1 and 1,000,000 (inclusive). The next m lines contain the statements that you need to execute.</p>
<p>A line formatted as “M x y” (1 ≤ y ≤ 1,000,000) means “a[x] = y”, and a line formatted as “Q x y” means “print len(set(a[x:y]))”.</p>
<p>It is guaranteed that the statements will not cause “index out of range” error.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Print the simulated result, one line for each query.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">7 4</span><br><span class="line">1 2 1 3 2 1 4</span><br><span class="line">Q 1 6</span><br><span class="line">M 3 2</span><br><span class="line">Q 1 6</span><br><span class="line">Q 3 5</span><br></pre></td></tr></table></figure>

<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">2</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<ol>
<li>支持查找區間內有多少不同數字。</li>
<li>支持單點值修改</li>
</ol>
<p>** 題目解法：**</p>
<p>維護每一個數字的前面相同數字的位置，如果前面沒有一樣的就是 <code>-1</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  i   0  1  2  3  4  5  6</span><br><span class="line">A[]   1  2  1  3  2  1  4</span><br><span class="line">P[]  -1 -1  0 -1  1  2 -1</span><br></pre></td></tr></table></figure>
<p>對於詢問 [l, r]，返回 P[l, r] 內小於 l 的個數。</p>
<p>這裡使用塊狀表維護資訊，也可以使用 線段樹 + 平衡樹。</p>
<ul>
<li><p>塊狀表 作法</p>
<ul>
<li><p>對於詢問<br>  對於完整的塊進行二分搜尋。如果所在是不完整的塊，則窮舉搜尋。</p>
</li>
<li><p>對於修改</p>
<ul>
<li>向後搜索舊值<br>  將指向自己的修改成原本指向的。</li>
<li>向前搜索新值<br>  將指向連到前方的相同數字。</li>
<li>向後搜索新值<br>  將後面最靠近的相同數字連向自己。</li>
</ul>
</li>
<li><p>維護資訊</p>
<ul>
<li>堆的 prev 排序後的資訊<br>  用在詢問 query 區間內小於 l 的二分搜</li>
<li>堆的 value 排序後的資訊<br>  維護 prev 時，查找前一個和後一個的時候使用。</li>
</ul>
</li>
<li><p>堆更新時，最簡單是直接排序，複雜度 <code>O(sqrt(n) * log(sqrt(n)))</code> 看起來是不會很多，如果不使用這種方式，則必須對 prev 和 value 數組增加映射來找到相對應的原位置，然後用插入排序的方式，達到 <code>O(sqrt(n))</code>。但是在 UVa 運行前者在 1.200 s 左右，基本上可以不用再優化，紀錄的資訊增加一倍 又或者 代碼要長一點。</p>
</li>
</ul>
</li>
</ul>
<p>每一個操作約在 <code>O(sqrt(n))</code> 時間內完整，塊狀表不用做合併操作。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">int</span> pSIZE, pCOUNT;</span><br><span class="line"><span class="keyword">int</span> Pval[<span class="number">256</span>][<span class="number">256</span>], Ppre[<span class="number">256</span>][<span class="number">256</span>], Plen[<span class="number">256</span>];</span><br><span class="line"><span class="keyword">int</span> A[<span class="number">65536</span>], P[<span class="number">65536</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> pxIdx = <span class="number">-1</span>, pyIdx = pSIZE;</span><br><span class="line">    map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; PREV;</span><br><span class="line">    map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;::iterator it;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">memset</span>(Plen, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(Plen));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(pyIdx == pSIZE)</span><br><span class="line">            pxIdx++, pyIdx = <span class="number">0</span>;</span><br><span class="line">        Pval[pxIdx][pyIdx] = A[i];</span><br><span class="line">        it = PREV.<span class="built_in">find</span>(A[i]);</span><br><span class="line">        <span class="keyword">if</span>(it == PREV.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            Ppre[pxIdx][pyIdx] = <span class="number">-1</span>;</span><br><span class="line">            PREV[A[i]] = i;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            Ppre[pxIdx][pyIdx] = it-&gt;second;</span><br><span class="line">            it-&gt;second = i;</span><br><span class="line">        &#125;</span><br><span class="line">        P[i] = Ppre[pxIdx][pyIdx];</span><br><span class="line">        pyIdx++;</span><br><span class="line">        Plen[pxIdx] = pyIdx;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    pCOUNT = pxIdx + <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pCOUNT; i++) &#123;</span><br><span class="line">        <span class="built_in">sort</span>(Pval[i], Pval[i] + Plen[i]);</span><br><span class="line">        <span class="built_in">sort</span>(Ppre[i], Ppre[i] + Plen[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> L, <span class="keyword">int</span> R)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> B = L;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(L%pSIZE &amp;&amp; L &lt;= R) &#123;</span><br><span class="line">        <span class="keyword">if</span>(P[L] &lt; B)	ret++;</span><br><span class="line">        L++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>((R+<span class="number">1</span>)%pSIZE &amp;&amp; L &lt;= R) &#123;</span><br><span class="line">        <span class="keyword">if</span>(P[R] &lt; B)	ret++;</span><br><span class="line">        R--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(L &gt; R)	<span class="keyword">return</span> ret;</span><br><span class="line">    L /= pSIZE, R /= pSIZE;</span><br><span class="line">    <span class="keyword">while</span>(L &lt;= R) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="built_in">upper_bound</span>(Ppre[L], Ppre[L] + pSIZE, B - <span class="number">1</span>) - Ppre[L];</span><br><span class="line">        ret += cnt;</span><br><span class="line">        L++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updatePrev</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = x * pSIZE, j = <span class="number">0</span>; j &lt; Plen[x]; i++, j++)</span><br><span class="line">        Ppre[x][j] = P[i];</span><br><span class="line">    <span class="built_in">sort</span>(Ppre[x], Ppre[x] + Plen[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = x * pSIZE, j = <span class="number">0</span>; j &lt; Plen[x]; i++, j++)</span><br><span class="line">        Pval[x][j] = A[i], Ppre[x][j] = P[i];</span><br><span class="line">    <span class="built_in">sort</span>(Pval[x], Pval[x] + Plen[x]);</span><br><span class="line">    <span class="built_in">sort</span>(Ppre[x], Ppre[x] + Plen[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getNext</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val, <span class="keyword">int</span> &amp;NEXT, <span class="keyword">int</span> &amp;nx)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = x/pSIZE * pSIZE + Plen[x / pSIZE] - <span class="number">1</span>;</span><br><span class="line">    NEXT = <span class="number">0x3f3f3f3f</span>, nx = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(x%pSIZE &amp;&amp; x &lt;= y) &#123;</span><br><span class="line">        <span class="keyword">if</span>(A[x] == val) &#123;</span><br><span class="line">            NEXT = x, nx = x / pSIZE;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        x++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> L = x / pSIZE, R = pCOUNT - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(L * pSIZE &lt; x)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">binary_search</span>(Pval[i], Pval[i] + Plen[i], val);</span><br><span class="line">        <span class="keyword">if</span>(pos == <span class="literal">true</span>) &#123;</span><br><span class="line">            NEXT = i * pSIZE;</span><br><span class="line">            <span class="keyword">while</span>(A[NEXT] != val)	NEXT++;</span><br><span class="line">            nx = i;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getPrev</span><span class="params">(<span class="keyword">int</span> y, <span class="keyword">int</span> val, <span class="keyword">int</span> &amp;PREV, <span class="keyword">int</span> &amp;px)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">0</span>;</span><br><span class="line">    PREV = <span class="number">-1</span>, px = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>((y+<span class="number">1</span>)%pSIZE &amp;&amp; x &lt;= y) &#123;</span><br><span class="line">        <span class="keyword">if</span>(A[y] == val) &#123;</span><br><span class="line">            PREV = y, px = y / pSIZE;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        y--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> L = <span class="number">0</span>, R = y / pSIZE;</span><br><span class="line">    <span class="keyword">if</span>(R * pSIZE &gt; y)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = R; i &gt;= L; i--) &#123;</span><br><span class="line">        <span class="keyword">int</span> pos = <span class="built_in">binary_search</span>(Pval[i], Pval[i] + Plen[i], val);</span><br><span class="line">        <span class="keyword">if</span>(pos == <span class="literal">true</span>) &#123;</span><br><span class="line">            PREV = i * pSIZE + Plen[i] - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(A[PREV] != val)	PREV--;</span><br><span class="line">            px = i;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> X, <span class="keyword">int</span> nval)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(A[X] == nval)	<span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> oval = A[X];</span><br><span class="line">    <span class="keyword">int</span> NEXT, PREV, nx, px;</span><br><span class="line">    PREV = P[X], px = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(PREV &gt;= <span class="number">0</span>)	px = PREV / pSIZE;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">getNext</span>(X + <span class="number">1</span>, oval, NEXT, nx);</span><br><span class="line">    <span class="keyword">if</span>(nx != <span class="number">-1</span>) &#123;</span><br><span class="line">        P[NEXT] = PREV;</span><br><span class="line">        <span class="built_in">updatePrev</span>(nx);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">getNext</span>(X + <span class="number">1</span>, nval, NEXT, nx);</span><br><span class="line">    <span class="keyword">if</span>(nx != <span class="number">-1</span>) &#123;</span><br><span class="line">        P[NEXT] = X;</span><br><span class="line">        <span class="built_in">updatePrev</span>(nx);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">getPrev</span>(X - <span class="number">1</span>, nval, PREV, px);</span><br><span class="line">    A[X] = nval, P[X] = PREV;</span><br><span class="line">    <span class="built_in">update</span>(X / pSIZE);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//	freopen(&quot;in.txt&quot;, &quot;r+t&quot;, stdin);</span></span><br><span class="line">    <span class="comment">//	freopen(&quot;out2.txt&quot;, &quot;w+t&quot;, stdout);</span></span><br><span class="line">    <span class="keyword">int</span> n, m, L, R;</span><br><span class="line">    <span class="keyword">char</span> cmd[<span class="number">4</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(pSIZE = <span class="number">1</span>; pSIZE * pSIZE &lt; n; pSIZE++);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;A[i]);</span><br><span class="line">        <span class="built_in">build</span>(n);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(m--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s %d %d&quot;</span>, cmd, &amp;L, &amp;R);</span><br><span class="line">            <span class="keyword">if</span>(cmd[<span class="number">0</span>] == <span class="string">&#x27;Q&#x27;</span>) &#123;</span><br><span class="line">                R--;</span><br><span class="line">                <span class="keyword">int</span> r = <span class="built_in">query</span>(L, R);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, r);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">modify</span>(L, R);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 30 50</span></span><br><span class="line"><span class="comment"> 4 19 18 17 16 7 16 9 18 14 4 11 4 2 8 8 1 3 1 5 5 8 3 8 11 17 10 0 2 16</span></span><br><span class="line"><span class="comment"> M 20 12 </span></span><br><span class="line"><span class="comment"> Q 2 29</span></span><br><span class="line"><span class="comment"> M 8 9</span></span><br><span class="line"><span class="comment"> Q 7 7</span></span><br><span class="line"><span class="comment"> M 25 12</span></span><br><span class="line"><span class="comment"> M 19 13</span></span><br><span class="line"><span class="comment"> Q 12 22</span></span><br><span class="line"><span class="comment"> Q 8 11</span></span><br><span class="line"><span class="comment"> M 5 5</span></span><br><span class="line"><span class="comment"> M 15 8</span></span><br><span class="line"><span class="comment"> Q 9 26</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-note/ccpc-2014" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/04/28/note/ccpc-2014/" class="article-date">
  <time datetime="2014-04-28T11:18:14.000Z" itemprop="datePublished">2014-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/雜言筆記/">雜言筆記</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="/img/MG_7452.jpg" rel="gallery_ckpaivcan00d4n8vn8zjv66b2">
        <img src="/img/MG_7452.jpg" itemprop="image">
      </a>
    
      <a class="article-gallery-img fancybox" href="/img/DSCF6339.jpg" rel="gallery_ckpaivcan00d4n8vn8zjv66b2">
        <img src="/img/DSCF6339.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/04/28/note/ccpc-2014/">CCPC 2014 中程杯紀錄</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/04/28/note/ccpc-2014/" data-id="ckpaivcan00d4n8vn8zjv66b2" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/04/28/note/ccpc-2014/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CCPC/">CCPC</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/中程杯/">中程杯</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><p>在此先感謝 inker 帶我出門！當然也感謝 ** 彰師大 ** 這次辦的程式競賽。這是一場久違的比賽，同時也是這學期最後一場，原因是因為太久沒參賽，導致往後的桂冠賽也無法參加。</p>
<p>至於討厭比賽的問題，這一篇就不多說了。記得下次繼續支持彰師大資工辦的活動，免得像靜宜大學被玩壞了。 <a href="http://ccpc.csie.ncue.edu.tw/#rule-pn">CCPC 官網</a></p>
<h1 id="賽前"><a href="#賽前" class="headerlink" title="賽前"></a>賽前</h1><p>比賽前日進發 inker 豪宅，中間歷經坐錯區間車，到比賽會場前，徒步走了三十分鐘到火車站搭車 … 各種經歷深感出門是件難事。跟我肯定是不幸的，應該多少有點關聯。</p>
<p>上次比賽是很久之前的事情，想到這次還會遭遇國手，還有清華交大的選手，深感害怕。在這情況下，要出門見人什麼的，讓我窩回宿舍吧！</p>
<h1 id="題目"><a href="#題目" class="headerlink" title="題目"></a>題目</h1><h2 id="Problem-A-Non-boring-sequences"><a href="#Problem-A-Non-boring-sequences" class="headerlink" title="Problem A Non-boring sequences"></a>Problem A Non-boring sequences</h2><p><a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=4483">UVa 1608 - Non-boring sequences</a></p>
<p>結果題目還是讀錯了，對於任意連續區間，都存在一個獨特的數字。</p>
<p>很容易誤解 <code>connected subsequence</code> 簡單的說就是相鄰兩個元素。<br>這題由於讀題錯誤，在全場第一個送出的同時拿下的 <code>Wrong Answer</code>。<br>在假解的情況下，居然通過了測試。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">int</span> t, n, h1,h2;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t --)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        map&lt;<span class="keyword">int</span>, <span class="keyword">bool</span>&gt; mp;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">bool</span> yes = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">int</span> pre = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span> ; i &lt; n ; i ++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;h2);</span><br><span class="line">            <span class="keyword">if</span>(pre == h2)&#123;</span><br><span class="line">            </span><br><span class="line">                yes = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            pre = h2;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(yes?<span class="string">&quot;non-boring\n&quot;</span>:<span class="string">&quot;boring\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-B-Traffic-Jam"><a href="#Problem-B-Traffic-Jam" class="headerlink" title="Problem B Traffic Jam"></a>Problem B Traffic Jam</h2><p><a href="http://uva.onlinejudge.org/index.php?option=com_onlinejudge&Itemid=8&category=24&page=show_problem&problem=4163">UVa 1417 - Traffic Jam</a></p>
<p>這題是全場最噁心的題目，但是沒想到有人用 BFS 還是 DFS 在每個詢問就過了。</p>
<p>賽完看到記分板表示非常火。</p>
<p>猜測解法如下，採用線段樹的方式。</p>
<h3 id="觀察"><a href="#觀察" class="headerlink" title="觀察"></a>觀察</h3><p><img src="/img/CCPC201402.PNG" alt="2014 CCPC B01"><br><img src="/img/CCPC201403.PNG" alt="2014 CCPC B02"></p>
<p>對於任兩點詢問假設這個區間是 <code>[l, r]</code>，不管同側還是異測，當然你也可以假設兩旁還有可以連的。發現對於區間 <code>[l, r]</code> 的點來說，會有左上無法到右下的情況或者左下無法到右上，兩者只有符合一個條件就可以說出 <code>NO</code>。</p>
<h3 id="推倒"><a href="#推倒" class="headerlink" title="推倒"></a>推倒</h3><p><img src="/img/CCPC201401.PNG" alt="2014 CCPC B03"></p>
<p>因此我們維護區間 <code>[l, r]</code> 的左上到右下、左下到右上的連通性。</p>
<p>對於區間 S 來說，可以切成 S1 和 S2，維護四條資訊，連通性有無 0/1。</p>
<ul>
<li>A(左上, 右下) = <ul>
<li>S1.A &amp; S2.A &amp; (wx || yz)</li>
<li>S1.A &amp; S2.D &amp; (z || wxy)</li>
<li>S1.C &amp; S2.A &amp; (x || wyz)</li>
<li>S1.C &amp; S2.D &amp; (wz || xy)</li>
</ul>
</li>
<li>B(左下, 右上)</li>
<li>C(左上, 右上)</li>
<li>D(左下, 右下)</li>
</ul>
<p>剩餘 BCD 三條類推，有空的時候再來填滿它，也就是說，之後的開邊跟閉邊都屬於單點更新，因此可以在 <code>O(log n)</code> 時間內完成。對於詢問兩點時，找到 <code>[l, r]</code> 查找 <code>A || B</code> 的結果，由於線段樹會切成數個區間，這個時候要由左而右依序組合即可。</p>
<h2 id="Problem-C-Finding-the-Prime-Implicants-of-a-Boolean-Function"><a href="#Problem-C-Finding-the-Prime-Implicants-of-a-Boolean-Function" class="headerlink" title="Problem C Finding the Prime Implicants of a Boolean Function"></a>Problem C Finding the Prime Implicants of a Boolean Function</h2><p>這題就是單純複雜，但是輸入卻不明確。主辦單位有說會忽略空白比對，但是對於 <code>Invaild input format</code> 來說，題目也沒有說清楚輸入格式。</p>
<p>好吧，硬著頭皮做，至少把範例輸入輸出弄了一樣，但是卻砸了。</p>
<p>對了，關於 subset 有個快速地找法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for(int j = (i-1)&amp;i; j &gt; 0; j--, j &amp;= i) &#123;</span><br><span class="line">    // j 是 i 的 subset</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>這個寫法會在幾題的 UVa 中見到，速度快了 X 倍，不過這題測資沒有強成這樣，也許只是我寫太瘋狂了，想不到更好的解法來完成。最後掛了 <code>Wrong Answer</code>，直接默哀數分鐘。在我心中－她過了。</p>
<p>這題就是窮舉，將每一種組合拆成兩個去合併，而每一種組合(16 bits)如果能合併成一個 <code>product item</code> 則用一個 <code>exist(4 bits)</code> 和 <code>mark(4 bits)</code> 表示，</p>
<p>因此，對於每一個組合拆成 a, b，其中 a.exist == b.exist，同時變數差異只會有一個。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;sstream&gt;</span><br><span class="line">#include &lt;set&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">//int A[105] = &#123;0, 2, 3, 5,7 ,8, 9, 10, 11, 13, 15&#125;, n = 11;</span><br><span class="line">//int A[105] = &#123;0, 1, 2, 5, 6, 7, 8, 9, 10, 14&#125;, n = 10;</span><br><span class="line">int A[1024], n;</span><br><span class="line">unsigned int result[1&lt;&lt;16] = &#123;&#125;;</span><br><span class="line">unsigned int mergeV[1&lt;&lt;16] = &#123;&#125;;</span><br><span class="line">struct cmp &#123;</span><br><span class="line">    bool operator()(const int a, const int b) const &#123;</span><br><span class="line">        for(int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            int ia, ib;</span><br><span class="line">            ia = (a&gt;&gt;i)&amp;1;</span><br><span class="line">            ib = (b&gt;&gt;i)&amp;1;</span><br><span class="line">            if(ia != ib)</span><br><span class="line">                return ia &gt; ib;</span><br><span class="line">        &#125;</span><br><span class="line">        return a &lt; b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">void solv() &#123;</span><br><span class="line">    map&lt;unsigned int, int&gt; combine;</span><br><span class="line">    map&lt;unsigned int, int&gt; combineN;</span><br><span class="line">    for(int i = 0; i &lt; (1&lt;&lt;16); i++) &#123;</span><br><span class="line">        result[i] = mergeV[i] = 0;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">        unsigned int mark = 15; // exits</span><br><span class="line">        unsigned int ssss = A[i];</span><br><span class="line">        combine[(ssss&lt;&lt;16)|mark]++;</span><br><span class="line">        combineN[(ssss&lt;&lt;16)|mark] = 1&lt;&lt;A[i];</span><br><span class="line">        result[1&lt;&lt;A[i]] = (ssss&lt;&lt;16)|mark;</span><br><span class="line">        mergeV[1&lt;&lt;A[i]] = 1;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i = 1; i &lt; (1&lt;&lt;16); i++) &#123;</span><br><span class="line">        if((i&amp;(-i)) == i)</span><br><span class="line">            continue;</span><br><span class="line">        int ok = 0;</span><br><span class="line">        unsigned int V;</span><br><span class="line">        for(int j = 1; j &lt; i; j++) &#123;</span><br><span class="line">            if((i&amp;j) == j) &#123;</span><br><span class="line">                int a, b;</span><br><span class="line">                a = j, b = i^j;</span><br><span class="line">                if(mergeV[a] &amp;&amp; mergeV[b]) &#123;</span><br><span class="line">                    unsigned int markA, markB;</span><br><span class="line">                    unsigned int ssssA, ssssB;</span><br><span class="line">                    markA = result[a]&amp;((1&lt;&lt;16)-1);</span><br><span class="line">                    markB = result[b]&amp;((1&lt;&lt;16)-1);</span><br><span class="line">                    ssssA = result[a]&gt;&gt;16;</span><br><span class="line">                    ssssB = result[b]&gt;&gt;16;</span><br><span class="line">                    if(markA == markB) &#123;</span><br><span class="line">                        unsigned int diff = ssssA ^ ssssB;</span><br><span class="line">                        if((diff&amp;(-diff)) == diff) &#123;</span><br><span class="line">                            unsigned int markC = (markA) ^ diff;</span><br><span class="line">                            unsigned int ssssC = min(ssssA, ssssB);</span><br><span class="line">                            ok = 1;</span><br><span class="line">                            combine[result[a]]++;</span><br><span class="line">                            combine[result[b]]++;</span><br><span class="line">                            V = (ssssC&lt;&lt;16)|markC;</span><br><span class="line">                            combineN[(ssssC&lt;&lt;16)|markC] = i;</span><br><span class="line">                            result[i] = (ssssC&lt;&lt;16)|markC;</span><br><span class="line">                            mergeV[i] = 1;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(ok)</span><br><span class="line">            combine[V]++;</span><br><span class="line">    &#125;</span><br><span class="line">    set&lt; int, cmp &gt; output[20];</span><br><span class="line">    for(map&lt;unsigned int, int&gt;::iterator it = combine.begin();</span><br><span class="line">        it != combine.end(); it++) &#123;</span><br><span class="line">        if(it-&gt;second &gt; 1)</span><br><span class="line">            continue;</span><br><span class="line">        /*printf(&quot;merge %d: count %d \n&quot;, it-&gt;first, it-&gt;second);*/</span><br><span class="line">        </span><br><span class="line">        unsigned int markA;</span><br><span class="line">        unsigned int ssssA;</span><br><span class="line">        markA = it-&gt;first&amp;((1&lt;&lt;16)-1);</span><br><span class="line">        ssssA = it-&gt;first&gt;&gt;16;</span><br><span class="line">        int cc = combineN[it-&gt;first];</span><br><span class="line">        /*for(int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            printf(&quot;%d &quot;, (markA&gt;&gt;i)&amp;1);</span><br><span class="line">        &#125;</span><br><span class="line">        puts(&quot;  e &quot;);</span><br><span class="line">        for(int i = 0; i &lt; 4; i++) &#123;</span><br><span class="line">            printf(&quot;%d &quot;, (ssssA&gt;&gt;i)&amp;1);</span><br><span class="line">        &#125;</span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">        for(int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            if((cc&gt;&gt;i)&amp;1)</span><br><span class="line">                printf(&quot;%d &quot;, i);</span><br><span class="line">        &#125;</span><br><span class="line">        puts(&quot;&quot;);*/</span><br><span class="line">        int osize = 0;</span><br><span class="line">        for(int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">            if((cc&gt;&gt;i)&amp;1)</span><br><span class="line">                osize++;</span><br><span class="line">        &#125;</span><br><span class="line">        output[osize].insert(cc);</span><br><span class="line">    &#125;</span><br><span class="line">    int f = 0;</span><br><span class="line">    for(int k = 16; k &gt;= 0; k--)</span><br><span class="line">        for(set&lt; int &gt;::iterator it = output[k].begin();</span><br><span class="line">            it != output[k].end(); it++) &#123;</span><br><span class="line">            int cc = (*it);</span><br><span class="line">            if(f)	printf(&quot;,&quot;);</span><br><span class="line">            f = 1;</span><br><span class="line">            putchar(&#x27;(&#x27;);</span><br><span class="line">            int f2 = 0;</span><br><span class="line">            for(int i = 0; i &lt; 16; i++) &#123;</span><br><span class="line">                if((cc&gt;&gt;i)&amp;1) &#123;</span><br><span class="line">                    if(f2)	printf(&quot;, &quot;);</span><br><span class="line">                    f2 = 1;</span><br><span class="line">                    printf(&quot;%d&quot;, i);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            putchar(&#x27;)&#x27;);</span><br><span class="line">        &#125;</span><br><span class="line">    puts(&quot;&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    char in[1024];</span><br><span class="line">    while(gets(in)) &#123;</span><br><span class="line">        int error = 0;</span><br><span class="line">        for(int i = 0; in[i]; i++) &#123;</span><br><span class="line">            if(in[i] == &#x27;)&#x27;)</span><br><span class="line">                in[i] = &#x27; &#x27;;</span><br><span class="line">            else if(in[i] == &#x27;(&#x27;)</span><br><span class="line">                in[i] = &#x27; &#x27;;</span><br><span class="line">            else if(in[i] == &#x27;,&#x27;)</span><br><span class="line">                in[i] = &#x27; &#x27;;</span><br><span class="line">            else if(in[i] &lt;= &#x27;9&#x27; &amp;&amp; in[i] &gt;= &#x27;0&#x27;)</span><br><span class="line">                continue;</span><br><span class="line">            else</span><br><span class="line">                error = 1;</span><br><span class="line">        &#125;</span><br><span class="line">        stringstream sin(in);</span><br><span class="line">        int number;</span><br><span class="line">        n = 0;</span><br><span class="line">        while(sin &gt;&gt; number) &#123;</span><br><span class="line">            A[n++] = number;</span><br><span class="line">        &#125;</span><br><span class="line">        if(n &gt;= 1024)</span><br><span class="line">            while(1);</span><br><span class="line">        sort(A, A+n);</span><br><span class="line">        int ok = 1;</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            if(A[i] &lt; 0 || A[i] &gt; 15)</span><br><span class="line">                ok = 0;</span><br><span class="line">        if(ok == 0 || error) &#123;</span><br><span class="line">            printf(&quot;Invalid input format&quot;);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;/*</span><br><span class="line">        printf(&quot;%d\n&quot;, n);</span><br><span class="line">        for(int i = 0; i &lt; n; i++)</span><br><span class="line">            printf(&quot;%d\n&quot;, A[i]);*/</span><br><span class="line">        solv();</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line">(0,2,5,8,10)</span><br><span class="line">(0,2,3,5,7,8,9,10,11,13,15)</span><br><span class="line">(0,1,2,5,6,7,8,9,10,14)</span><br><span class="line">(0,1,2,4,5,6,8,9,12,13,14)</span><br><span class="line">(0,1,2,5,6,7,8,9,10,16)</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h2 id="Problem-D-Binary-String"><a href="#Problem-D-Binary-String" class="headerlink" title="Problem D Binary String"></a>Problem D Binary String</h2><p>雖然詢問每個參數最大上限後，發現在 m = 100 的情況下，窮舉有點刺激，但是題目卻是要求輸出每一種組合，所以想必組合也不會太多，所以直接亂來吧！</p>
<p>至於以下代碼的正確性就交給神吧，反正都是亂做過的。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> n, m, s_ones;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> s[<span class="number">105</span>], ret[<span class="number">105</span>];</span><br><span class="line"><span class="keyword">int</span> slen = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> idx, <span class="keyword">int</span> ones, <span class="keyword">int</span> has)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(ones &gt; m)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(has == <span class="number">0</span> &amp;&amp; idx - slen &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> ok = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = idx - slen, j = <span class="number">0</span>; j &lt; slen; j++, i++) &#123;</span><br><span class="line">            ok &amp;= ret[i] == s[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ok)</span><br><span class="line">            has = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(idx == n) &#123;</span><br><span class="line">        <span class="keyword">if</span>(ones != m || !has)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        ret[n] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="built_in">puts</span>(ret);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ret[idx] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(idx+<span class="number">1</span>, ones, has);</span><br><span class="line">    ret[idx] = <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(idx+<span class="number">1</span>, ones+<span class="number">1</span>, has);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %s&quot;</span>, &amp;n, &amp;m, s) == <span class="number">3</span>) &#123;</span><br><span class="line">        s_ones = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">            s_ones += s[i] == <span class="string">&#x27;1&#x27;</span>;</span><br><span class="line">        slen = <span class="built_in">strlen</span>(s);</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-E-Digits-Count"><a href="#Problem-E-Digits-Count" class="headerlink" title="Problem E Digits Count"></a>Problem E Digits Count</h2><p>這題在 UVa 見過，但是要在比賽中打出來，卻卡死兩個很久沒用腦的人，直到鎖版 (最後一個小時) 才湊出來。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mpow</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        ret *= n;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> cnt[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="comment">//printf(&quot;%d\n&quot;, n);</span></span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">105</span>];</span><br><span class="line">    <span class="built_in">sprintf</span>(buf, <span class="string">&quot;%d&quot;</span>, n);</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(buf);</span><br><span class="line">    <span class="keyword">int</span> prev = <span class="number">0</span>, suffix;</span><br><span class="line">    <span class="built_in">calc</span>(<span class="built_in">mpow</span>(<span class="number">10</span>, len<span class="number">-1</span>)<span class="number">-1</span>, cnt);</span><br><span class="line">    <span class="comment">//for(int i = 0; i &lt; 10; i++)</span></span><br><span class="line">    <span class="comment">//	cnt[i] = 0;</span></span><br><span class="line">    <span class="keyword">int</span> prev10 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> d = buf[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="built_in">sscanf</span>(buf+i+<span class="number">1</span>, <span class="string">&quot;%d&quot;</span>, &amp;suffix);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(i != len<span class="number">-1</span>)</span><br><span class="line">            cnt[d] += suffix + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cnt[d]++;</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">0</span>)</span><br><span class="line">            cnt[d] += (prev - prev10/<span class="number">10</span>) * <span class="built_in">mpow</span>(<span class="number">10</span>, len-i<span class="number">-1</span>);</span><br><span class="line">    <span class="comment">//	pritnf(&quot;%d \n&quot;, );</span></span><br><span class="line">    <span class="comment">//	puts(&quot;&quot;);</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = i == <span class="number">0</span>; j &lt; <span class="number">10</span>; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(j == d)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(j &lt; d) &#123;</span><br><span class="line">                <span class="keyword">if</span>(prev &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    cnt[j] += (prev - prev10/<span class="number">10</span> + <span class="number">1</span>) * <span class="built_in">mpow</span>(<span class="number">10</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                    <span class="comment">//printf(&quot;%d %d\n&quot;, j, (prev - prev10/10 + 1) * mpow(10, len-i-2));</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cnt[j] += <span class="built_in">mpow</span>(<span class="number">10</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                    <span class="comment">//printf(&quot;%d %d\n&quot;, j, mpow(10, len-i-1));</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(prev &gt; <span class="number">0</span> &amp;&amp; prev - prev10/<span class="number">10</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    cnt[j] += (prev - prev10/<span class="number">10</span>) * <span class="built_in">mpow</span>(<span class="number">10</span>, len-i<span class="number">-1</span>);</span><br><span class="line">                    <span class="comment">//printf(&quot;%d %d\n&quot;, j, (prev - prev10/10 + 1) * mpow(10, len-i-2));</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        prev10 *= <span class="number">10</span>;</span><br><span class="line">        prev = prev * <span class="number">10</span> + d;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*for(int i = 0; i &lt; 10; i++)</span></span><br><span class="line"><span class="comment">		printf(&quot;%d &quot;, cnt[i]);</span></span><br><span class="line"><span class="comment">	puts(&quot;&quot;);*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">brute</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt[<span class="number">10</span>] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">char</span> buf[<span class="number">105</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(buf, <span class="string">&quot;%d&quot;</span>, i);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; buf[j]; j++)</span><br><span class="line">            cnt[buf[j]-<span class="string">&#x27;0&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>, cnt[i]);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> l, r;</span><br><span class="line">    <span class="comment">/*while(scanf(&quot;%d&quot;, &amp;l) == 1) &#123;</span></span><br><span class="line"><span class="comment">		brute(l);</span></span><br><span class="line"><span class="comment">		int cnt[10] = &#123;&#125;;</span></span><br><span class="line"><span class="comment">		calc(l, cnt);</span></span><br><span class="line"><span class="comment">		for(int i = 0; i &lt; 10; i++)</span></span><br><span class="line"><span class="comment">			printf(&quot;%d &quot;, cnt[i]);</span></span><br><span class="line"><span class="comment">		puts(&quot;&quot;);</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(l == <span class="number">0</span> &amp;&amp; r == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">int</span> A[<span class="number">10</span>] = &#123;&#125;, B[<span class="number">10</span>] = &#123;&#125;;</span><br><span class="line">        <span class="built_in">calc</span>(l<span class="number">-1</span>, A);</span><br><span class="line">        <span class="built_in">calc</span>(r, B);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d%c&quot;</span>, B[i] - A[i], i ==  <span class="number">9</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-F-Math-Problem"><a href="#Problem-F-Math-Problem" class="headerlink" title="Problem F Math Problem"></a>Problem F Math Problem</h2><p>大數二分開 n 方，根據別組的討論，才發現數字其實還挺小的，用 <code>double</code> 型態做 log 運算即可。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> <span class="keyword">throws</span> Exception </span>&#123; <span class="comment">// µ&#123;¦¡¶i¤JÂI</span></span><br><span class="line">        Scanner cin = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">while</span>(cin.hasNext()) &#123;</span><br><span class="line">            <span class="keyword">int</span> n = cin.nextInt();</span><br><span class="line">            String p = cin.next();</span><br><span class="line">            <span class="keyword">if</span>(n == <span class="number">1</span>) &#123;</span><br><span class="line">                System.out.println(p);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            BigInteger bigp = <span class="keyword">new</span> BigInteger(p);</span><br><span class="line">            BigInteger l = BigInteger.ZERO;</span><br><span class="line">            BigInteger r = <span class="keyword">new</span> BigInteger(p);</span><br><span class="line">            BigInteger m = l, mid, mmid;</span><br><span class="line">            <span class="keyword">while</span>(l.compareTo(r) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                mid = l.add(r).shiftRight(<span class="number">1</span>);</span><br><span class="line">                mmid = mid.pow(n);</span><br><span class="line">                <span class="keyword">if</span>(mmid.compareTo(bigp) &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    l = mid.add(BigInteger.ONE);</span><br><span class="line">                    m = mid;</span><br><span class="line">                &#125; <span class="keyword">else</span></span><br><span class="line">                    r = mid.subtract(BigInteger.ONE);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-G-Better-Method"><a href="#Problem-G-Better-Method" class="headerlink" title="Problem G Better Method"></a>Problem G Better Method</h2><p>聽說是曾經的萬年測試題，這次難得變成主角，肯定是想要每組至少都能帶一題回去。跟 ICPC 一樣的設計方式呢。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ret = n;</span><br><span class="line">    <span class="keyword">while</span>(n &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">        ret += n/<span class="number">3</span>;</span><br><span class="line">        n = n%<span class="number">3</span> + n/<span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = <span class="built_in">max</span>(<span class="built_in">f</span>(n), <span class="built_in">f</span>(n+<span class="number">1</span>)<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, v);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Problem-H-K-Anonymous-Sequence"><a href="#Problem-H-K-Anonymous-Sequence" class="headerlink" title="Problem H K-Anonymous Sequence"></a>Problem H K-Anonymous Sequence</h2><p>本次第二難的題目，但比賽時也是用假解過的，實質為單調對列，可以在 <code>O(n)</code> 時間內完成。至於假解的方式就不方便提供。</p>
<h1 id="賽後"><a href="#賽後" class="headerlink" title="賽後"></a>賽後</h1><p>UVa 2000+ 才到這了，腦部硬體的差距就是如此地遙遠，即使捨去其他應用軟體，仍然趕不上嗎？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Rank	Name	Solved	Time	    A    	    B    	    C    	    D    	    E    	    F    	    G    	    H    	Total att/solv</span><br><span class="line">1	team22	6	608	1/11	2/58	0/--	3/141	1/221	1/50	1/67	5/--	14/6</span><br><span class="line">2	team2	6	844	2/32	7/--	14/--	1/108	1/244	1/19	1/11	8/270	35/6</span><br><span class="line">3	team4	5	530	1/7	1/281	26/--	1/217	1/--	1/9	1/16	0/--	32/5</span><br><span class="line">4	team17	5	698	2/13	1/105	1/--	4/296	0/--	1/167	1/37	3/--	13/5</span><br><span class="line">5	team1	5	958	3/286	0/--	4/240	4/--	1/178	1/69	1/85	0/--	14/5</span><br><span class="line">6	team12	4	177	1/11	0/--	3/--	0/--	1/138	1/17	1/11	0/--	7/4</span><br><span class="line">7	team3	4	359	1/108	0/--	5/--	0/--	1/188	1/35	1/28	0/--	9/4</span><br><span class="line">8	team23	4	776	1/12	7/278	0/--	0/--	0/--	1/57	5/229	0/--	14/4</span><br><span class="line">9	team20	4	815	8/131	4/159	0/--	0/--	0/--	1/164	1/161	0/--	14/4</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">名次	學校學系	隊名</span><br><span class="line">第一名	國立成功大學資訊工程學系	ItsNotCode</span><br><span class="line">第二名	國立中央大學資訊工程學系	Morri$</span><br><span class="line">第三名	國立清華大學資訊工程學系	ISeaTeL</span><br><span class="line">佳作	國立成功大學資訊工程學系	Insert</span><br><span class="line">佳作	國立臺北大學資訊工程學系	Forward Thinking</span><br><span class="line">佳作	國立清華大學資訊工程學系	JustInTime</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/80/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/79/">79</a><a class="page-number" href="/page/80/">80</a><span class="page-number current">81</span><a class="page-number" href="/page/82/">82</a><a class="page-number" href="/page/83/">83</a><span class="space">&hellip;</span><a class="page-number" href="/page/85/">85</a><a class="extend next" rel="next" href="/page/82/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">30</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-handover/">
              
                <i class="icon-file-o"></i> 
              
            Handover</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-interview-recursion/">
              
                <i class="icon-file-o"></i> 
              
            Interview &amp; Recursion</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-job-build/">
              
                <i class="icon-file-o"></i> 
              
            Job Build</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-lang/">
              
                <i class="icon-file-o"></i> 
              
            Programming Language Impostors</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-machine-learning-newbie/">
              
                <i class="icon-file-o"></i> 
              
            Machine Learning for Newbie</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-parallel-gc/">
              
                <i class="icon-file-o"></i> 
              
            Parallel &amp; Garbage Collection</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>