<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/page/44/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <!-- <link rel="import" href="/bower_components/app-layout/app-layout.html"> --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-uva-12425" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/05/uva-12425/" class="article-date">
  <time datetime="2014-12-05T00:40:29.000Z" itemprop="datePublished">2014-12-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/05/uva-12425/">UVa 12425 - Best Friend</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/05/uva-12425/" data-id="ckrobwivr00o61cvneo9840us" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/05/uva-12425/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/因數/">因數</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一個整數 N，接著詢問 x，有多少 <code>gcd(i, N) &lt;= x</code>。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">30 3</div><div class="line">1</div><div class="line">2</div><div class="line">10</div><div class="line">11 2</div><div class="line">1</div><div class="line">2</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Case 1</div><div class="line">8</div><div class="line">16</div><div class="line">28</div><div class="line">Case 2</div><div class="line">10</div><div class="line">10</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>先把 N 的因數 f 全部找出，原則上不超過 2000 個，然後建出 <code>phi(N/f[i])</code>。</p>
<p>當要知道 <code>gcd(i, N) = x</code> 時，相當於找到 <code>gcd(i/x, N/x) = 1</code>，任何與 <code>N/x</code> 互質的個數。建造完後，對於每次詢問二分答案即可。</p>
<p>很多地方忘記用 long long，吃了不少 Runtime error。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxL (1000000&gt;&gt;5)+1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> GET(x) (mark[x&gt;&gt;5]&gt;&gt;(x&amp;31)&amp;1)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SET(x) (mark[x&gt;&gt;5] |= 1&lt;&lt;(x&amp;31))</span></div><div class="line"><span class="keyword">int</span> mark[maxL];</div><div class="line"><span class="keyword">int</span> P[<span class="number">100000</span>], Pt = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> phi[<span class="number">1048576</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j, k;</div><div class="line">    SET(<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n = <span class="number">1000000</span>;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">    	phi[i] = i;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">2</span>; i &lt;= n; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(!GET(i)) &#123;</div><div class="line">            <span class="keyword">for</span> (k = n/i, j = i*k; k &gt;= i; k--, j -= i)</div><div class="line">                SET(j);</div><div class="line">            <span class="keyword">for</span> (j = i; j &lt;= n; j += i)</div><div class="line">            	phi[j] = phi[j]/i * (i<span class="number">-1</span>);</div><div class="line">            P[Pt++] = i;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; &gt; factor(<span class="keyword">long</span> <span class="keyword">long</span> n) &#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> on = n;</div><div class="line">    <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; &gt; R;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, j; i &lt; Pt &amp;&amp; (<span class="keyword">long</span> <span class="keyword">long</span>)P[i] * P[i] &lt;= n; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(n%P[i] == <span class="number">0</span>) &#123;		</div><div class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; n%P[i] == <span class="number">0</span>; n /= P[i], j++);</div><div class="line">            R.push_back(make_pair((<span class="keyword">long</span> <span class="keyword">long</span>)P[i], j));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(n != <span class="number">1</span>)	R.push_back(make_pair(n, <span class="number">1</span>));</div><div class="line">    <span class="keyword">return</span> R;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> idx, <span class="keyword">int</span> n, <span class="keyword">long</span> <span class="keyword">long</span> m, <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; &gt; &amp;v, <span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; &amp;ret)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(idx == v.size()) &#123;</div><div class="line">        ret.push_back(m);</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> a = m, b = v[idx].first;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = v[idx].second; i &gt;= <span class="number">0</span>; i--)</div><div class="line">        make(idx + <span class="number">1</span>, n, a, v, ret), a *= b;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">getPhi</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n &lt; <span class="number">1000000</span>)	<span class="keyword">return</span> phi[n];</div><div class="line">    <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; &gt; f = factor(n);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; f.size(); i++)</div><div class="line">        n = n / f[i].first * (f[i].first - <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> n;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    sieve();</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>, Q;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> N, X;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld %d"</span>, &amp;N, &amp;Q);</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; &gt; f = factor(N);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; fa;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; sum;</div><div class="line">        make(<span class="number">0</span>, N, <span class="number">1</span>, f, fa);</div><div class="line">        sum.resize(fa.size(), <span class="number">0</span>);</div><div class="line">        sort(fa.begin(), fa.end());</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fa.size(); i++) &#123;</div><div class="line">            <span class="keyword">if</span> (i)</div><div class="line">                sum[i] = sum[i<span class="number">-1</span>] + getPhi(N / fa[i]);</div><div class="line">            <span class="keyword">else</span></div><div class="line">                sum[i] = getPhi(N / fa[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d\n"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;X);</div><div class="line">            <span class="keyword">if</span> (X &lt;= <span class="number">0</span>) &#123;</div><div class="line">                <span class="built_in">puts</span>(<span class="string">"0"</span>);</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</div><div class="line">            <span class="keyword">int</span> pos = (<span class="keyword">int</span>)(lower_bound(fa.begin(), fa.end(), X) - fa.begin());</div><div class="line">            <span class="keyword">if</span> (pos &gt;= fa.size() || fa[pos] &gt; X)	pos--;</div><div class="line">            ret = sum[pos];</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">30 3</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">10</span></div><div class="line"><span class="comment">11 5</span></div><div class="line"><span class="comment">0</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">11</span></div><div class="line"><span class="comment">15</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-12404" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/05/uva-12404/" class="article-date">
  <time datetime="2014-12-05T00:36:50.000Z" itemprop="datePublished">2014-12-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/05/uva-12404/">UVa 12404 - Trapezium Drawing</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/05/uva-12404/" data-id="ckrobwivl00nq1cvnuzgokyi1" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/05/uva-12404/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給予梯形兩點座標、四個邊長。找到另外兩點座標。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">0 0 20 0 10 14 8</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Case 1:</div><div class="line">14.00000000 8.00000000 0.00000000 8.00000000</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>向量旋轉找解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 131072</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pt</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    Pt(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</div><div class="line">    	x(a), y(b) &#123;&#125;	</div><div class="line">    Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x - a.x, y - a.y);</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>+(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x + a.x, y + a.y);</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x * a, y * a);</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x / a, y / a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - a.x) &gt; eps)</div><div class="line">            <span class="keyword">return</span> x &lt; a.x;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(y - a.y) &gt; eps)</div><div class="line">            <span class="keyword">return</span> y &lt; a.y;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(x - a.x) &lt; eps &amp;&amp; <span class="built_in">fabs</span>(y - a.y) &lt; eps;</div><div class="line">    &#125; </div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> hypot(a.x - b.x, a.y - b.y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.x + a.y * b.y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Pt o, Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y)-(a.y-o.y)*(b.x-o.x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.y - a.y * b.x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">between</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> dot(c - a, b - a) &gt;= -eps &amp;&amp; dot(c - b, a - b) &gt;= -eps;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">onSeg</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> between(a, b, c) &amp;&amp; <span class="built_in">fabs</span>(cross(a, b, c)) &lt; eps;</div><div class="line">&#125;</div><div class="line"><span class="function">Pt <span class="title">rotateRadian</span><span class="params">(Pt a, <span class="keyword">double</span> radian)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    x = a.x * <span class="built_in">cos</span>(radian) - a.y * <span class="built_in">sin</span>(radian);</div><div class="line">    y = a.x * <span class="built_in">sin</span>(radian) + a.y * <span class="built_in">cos</span>(radian);</div><div class="line">    <span class="keyword">return</span> Pt(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c, <span class="keyword">double</span> d)</span> </span>&#123;</div><div class="line">    <span class="comment">// d^2 - x^2 = b^2 - (a - x - c)^2</span></div><div class="line">    <span class="comment">// d^2 - x^2 = b^2 - (a-c - x)^2</span></div><div class="line">    <span class="comment">// d^2 - x^2 = b^2 - ((a-c)^2 - 2(a-c)x + x^2)</span></div><div class="line">    <span class="comment">// d^2 - x^2 = b^2 - (a-c)^2 + 2(a-c)x - x^2</span></div><div class="line">    <span class="comment">// d^2 - b^2 + (a-c)^2 = 2(a-c)x</span></div><div class="line">    <span class="keyword">double</span> x;</div><div class="line">    x = (<span class="built_in">pow</span>(d, <span class="number">2</span>) - <span class="built_in">pow</span>(b, <span class="number">2</span>) + <span class="built_in">pow</span>(a-c, <span class="number">2</span>))/(<span class="number">2</span> * (a-c));</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        Pt A, B, C, D;</div><div class="line">        <span class="keyword">double</span> a, b, c, d;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;x, &amp;y);</div><div class="line">        A = Pt(x, y);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;x, &amp;y);</div><div class="line">        B = Pt(x, y);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf"</span>, &amp;b, &amp;c, &amp;d);</div><div class="line">        a = dist(A, B);</div><div class="line">        x = solve(a, b, c, d);</div><div class="line">        </div><div class="line">        Pt vAB = (B - A) / a;</div><div class="line">        <span class="keyword">double</span> theta = <span class="built_in">atan2</span>(<span class="built_in">sqrt</span>(d*d - x*x), x);</div><div class="line">        D = rotateRadian(vAB, theta) * d + A;</div><div class="line">        C = D + vAB * c;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>, ++cases);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.8lf %.8lf %.8lf %.8lf\n"</span>, C.x, C.y, D.x, D.y);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">0 0 20 0 10 14 8</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">8</span></div><div class="line"><span class="comment">0 0 20 0 10 14 8</span></div><div class="line"><span class="comment">0 0 20 0 8 14 10</span></div><div class="line"><span class="comment">20 0 0 0 10 14 8</span></div><div class="line"><span class="comment">20 0 0 0 8 14 10</span></div><div class="line"><span class="comment">8 0 8 20 10 14 8</span></div><div class="line"><span class="comment">8 0 8 20 8 14 10</span></div><div class="line"><span class="comment">0 20 0 0 10 14 8</span></div><div class="line"><span class="comment">0 20 0 0 8 14 10</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-10397" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/05/uva-10397/" class="article-date">
  <time datetime="2014-12-05T00:06:45.000Z" itemprop="datePublished">2014-12-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/05/uva-10397/">UVa 10397 - Connect the Campus</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/05/uva-10397/" data-id="ckrobwiti00ic1cvnjpp1nh8b" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/05/uva-10397/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Delaunay/">Delaunay</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MST/">MST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/計算幾何/">計算幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>在現有的鋪設下，還有幾處建築物之間沒有連通。</p>
<p>找到花費最小的歐基里德距離生成樹</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">103 104</div><div class="line">104 100</div><div class="line">104 103</div><div class="line">100 100</div><div class="line">1</div><div class="line">4 2</div><div class="line">4</div><div class="line">103 104</div><div class="line">104 100</div><div class="line">104 103</div><div class="line">100 100</div><div class="line">1</div><div class="line">4 2</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">4.41</div><div class="line">4.41</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>直接用 kruskal 就可以完成，但是建造邊最慘將會達到 <code>O(n^2)</code>，因此效率並不好，好幾年之後回過頭來寫這一題。</p>
<p>對於 EMST 可以使用 Delaunay triangulation 完成。Delaunay triangulation 原則上可以在 <code>O(n log n)</code> 時間內完成。由於 EMST 是 Delaunay 的 subgraph，而 Delaunay 保證 edge 數最多為 <code>3n - 6</code>。套用 kruskal 的 <code>O(E log E)</code> 算法就能保證在 <code>O(n log n)</code> 時間內完成。</p>
<p>Delaunay triangulation 目前實作有 D&amp;C 和 random 兩種。</p>
<p>計算幾何資料請參照 <a href="https://github.com/morris821028/Computational-Geometry" target="_blank" rel="external">morris821028/Computational-Geometry</a> 下載。</p>
<p>廣泛的比較下，兩者期望都在 <code>O(n log n)</code> 完成，而實際結果 D&amp;C 普遍速度快很多。random 作法很吃機率期望，原因是要支持動態的 point location 操作，沒有一個好的資料結構來保證每一步的搜索效率，教科書上給予一個類似可持久化結構的 DG structure，深度是期望的 <code>O(log n)</code>，實作起來只會比 <code>O(n)</code> 快個常數倍。但 random increase algorithm 對於演算法的證明的確是比較容易，而且步驟相當好說明。</p>
<p>當效率不好去學 D&amp;C algorithm，一開始要對座標進行排序，也就是不支持動態 (離線操作)，接著針對 x 座標剖半，兩個完成 Delaunay triangulation 的凸包進行合併，接著需要將中間縫隙穿針引線地縫起來。因此要找到兩個凸包的下公切線，然後開始攀爬上去，保證一開始的下公切線一定是 Delaunay edge，然後開始窮舉下一個 Delaunay edge，過程中也不斷地移除不適的邊。</p>
<p>有相當不錯的資料結構可以快速地搜索公切線、圍繞凸包的頂點 … 等，但是根據教科書給予的計算，每一個點的 degree 期望值不超過 9，意即偷偷地窮舉攀爬不影響效率。</p>
<p>關於三點共圓，詢問一點是否在圓內的操作，投影到拋物面上，三點在投影結果上拉出一個平面，若點在圓內，則保證該點在平面的下方。求出外心計算，會造成誤差 (無法儲存除法運算結果)，換成拋物面的思路魯棒性高。</p>
<p>下附 D&amp;C algorithm 的做法，關於 random 就放在 github repo 封存了。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-8</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN (1048576)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXV 1024</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    <span class="keyword">int</span> id;</div><div class="line">    Point(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>, <span class="keyword">int</span> c = <span class="number">-1</span>):</div><div class="line">    	x(a), y(b), id(c) &#123;&#125;	</div><div class="line">    Point <span class="keyword">operator</span>-(<span class="keyword">const</span> Point &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Point(x - a.x, y - a.y);</div><div class="line">    &#125;</div><div class="line">    Point <span class="keyword">operator</span>+(<span class="keyword">const</span> Point &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Point(x + a.x, y + a.y);</div><div class="line">    &#125;</div><div class="line">    Point <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Point(x * a, y * a);</div><div class="line">    &#125;</div><div class="line">    Point <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Point(x / a, y / a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Point &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - a.x) &gt; eps)	<span class="keyword">return</span> x &lt; a.x;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(y - a.y) &gt; eps)	<span class="keyword">return</span> y &lt; a.y;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Point &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="built_in">fabs</span>(x - a.x) &lt; eps &amp;&amp; <span class="built_in">fabs</span>(y - a.y) &lt; eps;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> Point &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> !(<span class="built_in">fabs</span>(x - a.x) &lt; eps &amp;&amp; <span class="built_in">fabs</span>(y - a.y) &lt; eps);</div><div class="line">    &#125; </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">int</span> id = <span class="number">-1</span>)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>-&gt;id = id;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(Point b)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> hypot(x - b.x, y - b.y);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dist2</span><span class="params">(Point b)</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> (x - b.x) * (x - b.x) + (y - b.y) * (y - b.y);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"point (%lf, %lf)\n"</span>, x, y);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point3D</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y, z;</div><div class="line">    Point3D(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>, <span class="keyword">double</span> c = <span class="number">0</span>):</div><div class="line">        x(a), y(b), z(c) &#123;&#125;</div><div class="line">    Point3D(Point p) &#123;</div><div class="line">        x = p.x, y = p.y, z = p.x * p.x + p.y * p.y;</div><div class="line">    &#125;</div><div class="line">    Point3D <span class="keyword">operator</span>-(<span class="keyword">const</span> Point3D &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Point3D(x - a.x, y - a.y, z - a.z);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Point3D a)</span> </span>&#123;</div><div class="line">    	<span class="keyword">return</span> x * a.x + y * a.y + z * a.z;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> id;</div><div class="line">    <span class="built_in">list</span>&lt;Edge&gt;::iterator twin;</div><div class="line">    Edge(<span class="keyword">int</span> id = <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">this</span>-&gt;id = id;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmpZero</span><span class="params">(<span class="keyword">double</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(v) &gt; eps)	<span class="keyword">return</span> v &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Point o, Point a, Point b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y) - (a.y-o.y)*(b.x-o.x);</div><div class="line">&#125;</div><div class="line"><span class="function">Point3D <span class="title">cross</span><span class="params">(Point3D a, Point3D b)</span> </span>&#123; <span class="comment">// normal vector</span></div><div class="line">    <span class="keyword">return</span> Point3D(a.y * b.z - a.z * b.y </div><div class="line">                 , -a.x * b.z + a.z * b.x</div><div class="line">                 , a.x * b.y - a.y * b.x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inCircle</span><span class="params">(Point a, Point b, Point c, Point p)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (cross(a, b, c) &lt; <span class="number">0</span>)</div><div class="line">        swap(b, c);</div><div class="line">    Point3D a3(a), b3(b), c3(c), p3(p);</div><div class="line"><span class="comment">//	printf("%lf %lf %lf\n", a3.x, a3.y, a3.z);</span></div><div class="line"><span class="comment">//	printf("%lf %lf %lf\n", b3.x, b3.y, b3.z);</span></div><div class="line"><span class="comment">//	printf("%lf %lf %lf\n", c3.x, c3.y, c3.z);</span></div><div class="line"><span class="comment">//	printf("%lf %lf %lf\n", p3.x, p3.y, p3.z);</span></div><div class="line">    b3 = b3 - a3, c3 = c3 - a3, p3 = p3 - a3;</div><div class="line">    Point3D f = cross(b3, c3); <span class="comment">// normal vector</span></div><div class="line">    <span class="keyword">return</span> cmpZero(p3.dot(f)); <span class="comment">// check same direction, in: &lt; 0, on: = 0, out: &gt; 0</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">intersection</span><span class="params">(Point a, Point b, Point c, Point d)</span> </span>&#123; <span class="comment">// seg(a, b) and seg(c, d)</span></div><div class="line">    <span class="keyword">return</span> cmpZero(cross(a, c, b)) * cmpZero(cross(a, b, d)) &gt; <span class="number">0</span> </div><div class="line">        &amp;&amp; cmpZero(cross(c, a, d)) * cmpZero(cross(c, d, b)) &gt; <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Delaunay</span> &#123;</span></div><div class="line">    <span class="keyword">public</span>:</div><div class="line">    <span class="built_in">list</span>&lt;Edge&gt; head[MAXV]; <span class="comment">// graph</span></div><div class="line">    Point p[MAXV];</div><div class="line">    <span class="keyword">int</span> n, rename[MAXV];</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, Point p[])</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            head[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="keyword">this</span>-&gt;p[i] = p[i];</div><div class="line">        sort(<span class="keyword">this</span>-&gt;p, <span class="keyword">this</span>-&gt;p + n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            rename[p[i].id] = i;</div><div class="line">        <span class="keyword">this</span>-&gt;n = n;</div><div class="line">        divide(<span class="number">0</span>, n - <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">        head[u].push_front(Edge(v));</div><div class="line">        head[v].push_front(Edge(u));</div><div class="line">        head[u].begin()-&gt;twin = head[v].begin();</div><div class="line">        head[v].begin()-&gt;twin = head[u].begin();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (r - l &lt;= <span class="number">1</span>) &#123; <span class="comment">// #point &lt;= 2</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt;= r; j++)</div><div class="line">                    addEdge(i, j); </div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> mid = (l + r) /<span class="number">2</span>;</div><div class="line">        divide(l, mid);</div><div class="line">        divide(mid + <span class="number">1</span>, r);</div><div class="line">        </div><div class="line">        <span class="built_in">list</span>&lt;Edge&gt;::iterator it;</div><div class="line">        <span class="keyword">int</span> nowl = l, nowr = r;</div><div class="line">        </div><div class="line"><span class="comment">//		printf("divide %d %d\n", l, r);</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> update = <span class="number">1</span>; update; ) &#123; <span class="comment">// find left and right convex, lower common tangent</span></div><div class="line">            update = <span class="number">0</span>;</div><div class="line">            Point ptL = p[nowl], ptR = p[nowr];</div><div class="line">            <span class="keyword">for</span> (it = head[nowl].begin(); it != head[nowl].end(); it++) &#123;</div><div class="line">                Point t = p[it-&gt;id];</div><div class="line">                <span class="keyword">double</span> v = cross(ptR, ptL, t);</div><div class="line">                <span class="keyword">if</span> (cmpZero(v) &gt; <span class="number">0</span> || (cmpZero(v) == <span class="number">0</span> &amp;&amp; ptR.dist2(t) &lt; ptR.dist2(ptL))) &#123;</div><div class="line">                    nowl = it-&gt;id, update = <span class="number">1</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (update)	<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span> (it = head[nowr].begin(); it != head[nowr].end(); it++) &#123;</div><div class="line">                Point t = p[it-&gt;id];</div><div class="line">                <span class="keyword">double</span> v = cross(ptL, ptR, t);</div><div class="line">                <span class="keyword">if</span> (cmpZero(v) &lt; <span class="number">0</span> || (cmpZero(v) == <span class="number">0</span> &amp;&amp; ptL.dist2(t) &lt; ptL.dist2(ptR))) &#123;</div><div class="line">                    nowr = it-&gt;id, update = <span class="number">1</span>;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        addEdge(nowl, nowr); <span class="comment">// add tangent</span></div><div class="line"><span class="comment">//		printf("add base %d %d\n", nowl, nowr);</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> update = <span class="number">1</span>; <span class="literal">true</span>;) &#123;</div><div class="line">            update = <span class="number">0</span>;</div><div class="line">            Point ptL = p[nowl], ptR = p[nowr];</div><div class="line">            <span class="keyword">int</span> ch = <span class="number">-1</span>, side = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (it = head[nowl].begin(); it != head[nowl].end(); it++) &#123;</div><div class="line"><span class="comment">//				ptL.print(), ptR.print(), p[it-&gt;id].print();</span></div><div class="line">                <span class="keyword">if</span> (cmpZero(cross(ptL, ptR, p[it-&gt;id])) &gt; <span class="number">0</span></div><div class="line">                    &amp;&amp; (ch == <span class="number">-1</span> || inCircle(ptL, ptR, p[ch], p[it-&gt;id]) &lt; <span class="number">0</span>))</div><div class="line">                    ch = it-&gt;id, side = <span class="number">-1</span>;</div><div class="line"><span class="comment">//				printf("test L %d %d %d\n", nowl, it-&gt;id, inCircle(ptL, ptR, p[ch], p[it-&gt;id]));</span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (it = head[nowr].begin(); it != head[nowr].end(); it++) &#123;</div><div class="line">                <span class="keyword">if</span> (cmpZero(cross(ptR, p[it-&gt;id], ptL)) &gt; <span class="number">0</span></div><div class="line">                    &amp;&amp; (ch == <span class="number">-1</span> || inCircle(ptL, ptR, p[ch], p[it-&gt;id]) &lt; <span class="number">0</span>))</div><div class="line">                    ch = it-&gt;id, side = <span class="number">1</span>;</div><div class="line"><span class="comment">//				printf("test R %d %d %d\n", nowr, it-&gt;id, inCircle(ptL, ptR, p[ch], p[it-&gt;id])); </span></div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (ch == <span class="number">-1</span>)	<span class="keyword">break</span>; <span class="comment">// upper common tangent</span></div><div class="line"><span class="comment">//			printf("choose %d %d\n", ch, side);</span></div><div class="line">            <span class="keyword">if</span> (side == <span class="number">-1</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (it = head[nowl].begin(); it != head[nowl].end(); ) &#123;</div><div class="line">                    <span class="keyword">if</span> (intersection(ptL, p[it-&gt;id], ptR, p[ch])) &#123;</div><div class="line">                        head[it-&gt;id].erase(it-&gt;twin);</div><div class="line">                        head[nowl].erase(it++);</div><div class="line">                    &#125; <span class="keyword">else</span></div><div class="line">                        it++;</div><div class="line">                &#125;</div><div class="line">                nowl = ch;</div><div class="line">                addEdge(nowl, nowr);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">for</span> (it = head[nowr].begin(); it != head[nowr].end(); ) &#123;</div><div class="line">                    <span class="keyword">if</span> (intersection(ptR, p[it-&gt;id], ptL, p[ch])) &#123;</div><div class="line">                        head[it-&gt;id].erase(it-&gt;twin);</div><div class="line">                        head[nowr].erase(it++);</div><div class="line">                    &#125; <span class="keyword">else</span></div><div class="line">                        it++;</div><div class="line">                &#125;</div><div class="line">                nowr = ch;</div><div class="line">                addEdge(nowl, nowr);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; getEdge() &#123;</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; ret;</div><div class="line">        <span class="built_in">list</span>&lt;Edge&gt;::iterator it;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (it = head[i].begin(); it != head[i].end(); it++) &#123;</div><div class="line">                <span class="keyword">if</span> (it-&gt;id &lt; i)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line"><span class="comment">//				printf("DG %d %d\n", i, it-&gt;id);</span></div><div class="line">                ret.push_back(make_pair(p[i].id, p[it-&gt;id].id));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125; tool;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">edge</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> x, y, v;</div><div class="line">    edge(<span class="keyword">int</span> a = <span class="number">0</span>, <span class="keyword">int</span> b = <span class="number">0</span>, <span class="keyword">int</span> c = <span class="number">0</span>):</div><div class="line">        x(a), y(b), v(c) &#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> edge &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> v &lt; a.v;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">int</span> parent[<span class="number">1024</span>], weight[<span class="number">1024</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i= <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">        parent[i] = i, weight[i] = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findp</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> x == parent[x] ? x : (parent[x]=findp(parent[x]));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">joint</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    x = findp(x), y = findp(y);</div><div class="line">    <span class="keyword">if</span> (x == y)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(weight[x] &gt; weight[y])</div><div class="line">        weight[x] += weight[y], parent[y] = x;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        weight[y] += weight[x], parent[x] = y;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m, cases = <span class="number">0</span>;</div><div class="line">    Point p[MAXV];</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        init(n);</div><div class="line">        <span class="keyword">int</span> x, y;</div><div class="line">        <span class="keyword">int</span> e = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            p[i] = Point(x, y, i);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        tool.init(n, p);</div><div class="line">            </div><div class="line">        <span class="built_in">vector</span>&lt;edge&gt; E;</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; DG = tool.getEdge();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; DG.size(); i++) &#123;</div><div class="line">            x = DG[i].first, y = DG[i].second;</div><div class="line">            <span class="keyword">int</span> v = (p[x].x - p[y].x) * (p[x].x - p[y].x) + </div><div class="line">                        (p[x].y - p[y].y) * (p[x].y - p[y].y);</div><div class="line">            E.push_back(edge(x, y, v));</div><div class="line"><span class="comment">//			printf("DG %d %d %d\n", x, y, v);</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            x--, y--;</div><div class="line">            e += joint(x, y);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        sort(E.begin(), E.end());</div><div class="line">        <span class="keyword">double</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; E.size(); i++) &#123;</div><div class="line">            x = E[i].x, y = E[i].y;</div><div class="line">            <span class="keyword">if</span> (joint(x, y)) &#123;</div><div class="line">                ret += <span class="built_in">sqrt</span>(E[i].v);</div><div class="line">                e++;</div><div class="line">                <span class="keyword">if</span> (e == n - <span class="number">1</span>)</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.2lf\n"</span>, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">1 1</span></div><div class="line"><span class="comment">2 2</span></div><div class="line"><span class="comment">0</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">1 1</span></div><div class="line"><span class="comment">0</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">4</span></div><div class="line"><span class="comment">103 104</span></div><div class="line"><span class="comment">104 100</span></div><div class="line"><span class="comment">104 103</span></div><div class="line"><span class="comment">100 100</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">4 2</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">4</span></div><div class="line"><span class="comment">3 4</span></div><div class="line"><span class="comment">4 0</span></div><div class="line"><span class="comment">4 3</span></div><div class="line"><span class="comment">0 0</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">4 2</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/civilization-note" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/lesson/civilization-note/" class="article-date">
  <time datetime="2014-12-02T06:38:24.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/通識課程/">通識課程</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/lesson/civilization-note/">[通識] 文明的進程 小組報告</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/lesson/civilization-note/" data-id="ckrobwjii02bu1cvnm2ywiwbp" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/lesson/civilization-note/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/通識/">通識</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="主題"><a href="#主題" class="headerlink" title="主題"></a>主題</h1><p><strong> 跨國的文明競逐與衝突－原住民的文化問題 </strong></p>
<p>報告核心－文明的傲慢</p>
<h2 id="「原住民」稱呼為何而來？"><a href="#「原住民」稱呼為何而來？" class="headerlink" title="「原住民」稱呼為何而來？"></a>「原住民」稱呼為何而來？</h2><p><img src="http://i.imgur.com/zIBvmxj.png" alt="誠心臣服在我太陽帝國之下"></p>
<p>正因為我們是侵略者！他們才是 <strong> 真‧台灣人 </strong>。</p>
<p><a href="http://www.acfun.tv/v/ac401707" target="_blank" rel="external">AcFun 線上看－《賽德克巴萊》</a></p>
<p>在評論中大陸人這麼說</p>
<ul>
<li>「為什麼他們不說國語？」</li>
<li>「一隻豬發生的血案？」</li>
<li>「他們才是真台灣人啊。」</li>
</ul>
<p><img src="http://i.imgur.com/hNUx2gO.png" alt="都已經被我們給文明化了"></p>
<p>要求弱勢族群做出相同的行為－那就是一種 <strong> 傲慢 </strong>。</p>
<h2 id="文化差異"><a href="#文化差異" class="headerlink" title="文化差異"></a>文化差異</h2><p>漢人文化需要競爭，做任何事情都需要競爭，而原住民只要在工作上能夠溫飽就能快樂過活，藉由唱歌舞蹈等表現方式來闡述他們的快樂，及時行樂整是他們的天性，說他們懶惰不上進才是我們的傲慢。相較於競爭，他們是互助合作的生命共同體，在那種生存環境下，農耕、狩獵都要互相幫忙，你說競爭下的快樂帶給多少回饋？</p>
<p><img src="http://i.imgur.com/02xA0o6.png" alt="把我的尊嚴還給我！"></p>
<p>如何表現自己的英勇事蹟？奮勇殺敵、狩獵得到的 <strong> 骸骨 </strong> 作為一個能力階層。即使如此，敬老尊賢是重要的文化，年齡階層而非能力階層。做為一個活在漢人社會的人而言，能力若決定一生，而談快樂？雖然能力不如人，難道就培養不出比自己厲害的人？也許虎媽就是這麼來的。</p>
<p><img src="http://i.imgur.com/cBtvS0q.png" alt="還敢帶刀 ... 混蛋！"></p>
<p>佩刀難道錯了嗎？佩刀是因為生活所需，也是我們地位的象徵。憑什麼要求不能帶刀，那你們帶刀又是什麼意思，相比中古世紀騎士可以制裁的對象，低層社會人們只能對自己以下的對象進行攻擊。</p>
<h2 id="融入現代社會"><a href="#融入現代社會" class="headerlink" title="融入現代社會"></a>融入現代社會</h2><ul>
<li>第一階段－原住民成年人<br>從成年人開始步入社會，雖然一開始會接受很殘酷的生活適應，還必須使用 <strong> 漢姓 </strong>，論名字對自尊的重要性，即使謀求到工作，並且逐漸適應生活所需。(有多少人能失去自己的名字？)</li>
<li>第二階段－孩子教育<br>由於長時間活在漢人社會，孩子學習也就必須上小學，然而文化的成長背景不同下，做為父母能教導什麼給孩子？就因為環境不同，知識理解的差異所引來歧視，難道就是錯的嗎？</li>
<li>第三階段－傳統繼承<br>村落沒有新血、沒有傳承，不就是鼓勵他們進入漢人社會的原因嗎？</li>
</ul>
<blockquote>
<p> 什麼樣背景的人用什麼方式學，不是比較好理解嗎？學習成績不好沒什麼好擔心，只是規格面向不同。不懂不是問題，只是要換的方式。</p>
</blockquote>
<h2 id="保有精神"><a href="#保有精神" class="headerlink" title="保有精神"></a>保有精神</h2><p><img src="http://i.imgur.com/1ChXIj5.png" alt="也改變不了這張不被文明認同的臉"></p>
<p>我們的信仰、精神，藉由血緣牽連在一起。</p>
<p><img src="http://i.imgur.com/2F20zJy.png" alt="巴萬，你的獵場在哪裡？"></p>
<h2 id="矛盾所在"><a href="#矛盾所在" class="headerlink" title="矛盾所在"></a>矛盾所在</h2><ul>
<li>用很多補償條款鼓勵原住民進入我們漢人社會，但又希望他們保有他們自己的文化？</li>
</ul>
<blockquote>
<p>鼓勵改變，但卻又希望不變？(你們這群人到底想怎樣！)</p>
</blockquote>
<ul>
<li>武力較強的文明使得我們成功掠奪這塊土地，而這種文明真的是文明嗎？難道不就是個野蠻人？</li>
<li>想想印地安原住民的文化，真的是所謂低於來自被歐洲驅逐的人們所擁有的嗎？</li>
<li>如果你們所說小七是文明的象徵？想要成為你們所說的文明文化有錯嗎？</li>
</ul>
<blockquote><p>反問小朋友：「沒有漢堡和薯條，你們都吃什麼？」小朋友答說，就吃海裡抓的九孔和龍蝦。</p>
<footer><strong>蘭嶼小孩要吃薯條</strong><cite><a href="http://www.chinatimes.com/newspapers/20140721000704-260109" target="_blank" rel="external">www.chinatimes.com/newspapers/20140721000704-260109</a></cite></footer></blockquote>
<ul>
<li>文章中見到蘭嶼小孩吃山珍海味，那豈不是反了？依照生活的飲食水準，到底是誰過得奢侈？</li>
</ul>
<h1 id="世界原住民"><a href="#世界原住民" class="headerlink" title="世界原住民"></a>世界原住民</h1><p>當年英國統治的殖民地眾多，要不是他們可以退回祖國，那群人也是相當龐大的原住民。然而我們仗著人數眾多，無法退出的處境，厚臉皮地活在這片土地。不是中國對待少數民族的方式，他們在同一個文化脈絡下分支成長，即使不能理解，也能知道自己是同一脈人，已經磨得相當長久的時間。</p>
<p>縱使看著別國對待本國原住民的方式，例如：規劃保護區、歸還土地… 等，同時也表明了曾經使用過的暴力，他們的處境與我們台灣不同，他們有原本的家可以回，而我們必須對抗其他國家的勢力，必須與原住民站在同一條船上，也許對待他們的方式相比別國來說殘酷，一旦我們的立場被別國 (如中國，他們又會怎麼對待原住民？) 取代，那到底是誰殘酷？</p>
<h1 id="被消費的文化"><a href="#被消費的文化" class="headerlink" title="被消費的文化"></a>被消費的文化</h1><h2 id="文明化造就觀光行為"><a href="#文明化造就觀光行為" class="headerlink" title="文明化造就觀光行為"></a>文明化造就觀光行為</h2><p>觀光是大多數人的娛樂，也因此造就服務業的產生。談談服務業與文明化的關係</p>
<blockquote><p>這個新的公民身分的尊貴性，首先意味著華人社會本來以長幼輩分及遠近<br>親疏為基礎的傳統人際關係階序必須被鬆動，好讓尊貴的自豪自信得以越過這<br>些差異位置所包含的舉止規範和情感限制，而成為所有主體都可以近用的現代<br>情感特質。在這方面，第一個重要的結構性發展就是台灣產業結構劇變後的服<br>務業人際互動模式，以及隨之在日常生活中不斷重複的互動消費實踐，它們都<br>使得新規訓不再只是外加的強制和要求，而得以徹底融入主體的生活活動與內<br>在自我情感。</p>
<footer><strong>情感嬌貴化：變化中的台灣性佈局</strong><cite><a href="http://sex.ncu.edu.tw/members/Ho/paper/20120620%20%E4%B8%8A%E5%A4%A7%E6%96%87%E5%8C%96%E7%A0%94%E7%A9%B6%EF%BC%8D%E6%83%85%E6%84%9F%E5%AC%8C%E8%B2%B4%E5%8C%96%EF%BC%88%E7%B9%81%EF%BC%89.pdf" target="_blank" rel="external">sex.ncu.edu.tw/members/Ho/paper/20120620%20%E4%B8%8A%E5%A4%A7%E6%96%87%E5%8C%96%E7%A0%94%E7%A9%B6%EF%BC%8D%E6%83%85%E6%84%9F%E5%AC%8C%E8%B2%B4%E5%8C%96%EF%BC%88%E7%B9%81%EF%BC%89.pdf</a></cite></footer></blockquote>
<p>這深入探討可能要問一下何春蕤老師，總之身處服務業的情感，肯定是原住民們所無法理解的，一開始覺得他們好客，不知不覺地商業化他們，直到他們的好心被利用，才逐漸地被厭惡。</p>
<h1 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h1><p>當我們對外說出「我們台灣人」到底是指那些人？是活在這片土地上的所有人？那接下來的話就是共同意識嗎？正因為要對外證明我們是個國，才急切地想要讓所有活在這片土地上的人，至少有一個共同意志？</p>
<p>我們用更殘酷的方式生存，剝奪那些活在幕後的人的生存條件與資源，真的有比原住民文明嗎？追求文明結果，竟是雙面刃？</p>
<h1 id="探討"><a href="#探討" class="headerlink" title="探討"></a>探討</h1><p>在各國文化的核心目標不同時，它們對待原住民的方式也有所不同，到底是給予相同地位？還是給予空間適性發展？我想這牽涉到－到底有沒有必要活在「社會」牢籠，他們明明不用看處在強勢文化人們的臉色，自給自足活得很好，為何他們要踏入我們的文化？</p>
<p>也許以前原住民的人數與文化有關係，為了生存不得不離開原本的文化，背負著必須學習更多文化知識的壓力。這種不對稱的學習，真的造就我們欺壓原住民了嗎？</p>
<h2 id="文化模式與人口承載量"><a href="#文化模式與人口承載量" class="headerlink" title="文化模式與人口承載量"></a>文化模式與人口承載量</h2><p>造成必要的出走的主因。根據人口普查統計，至今原住民已經從日治時代的七萬多人暴增到五十多萬人，它們的生活習性支撐這麼多人嗎？</p>
<h2 id="看待偏見"><a href="#看待偏見" class="headerlink" title="看待偏見"></a>看待偏見</h2><p><strong> 偏見有時也是一種讚美 </strong> 。即使是你所認為不文明的舉動，不就是正因為做了你做不到的事情？</p>
<h2 id="文化分工"><a href="#文化分工" class="headerlink" title="文化分工"></a>文化分工</h2><p>唱歌、表演真的是唯一生存之道？原住民未來若要發展特色，難道唱歌表演就是唯一了嗎？在很多原住民歌手的興起下，就只能朝著同一個方向嗎？</p>
<h2 id="學校教育"><a href="#學校教育" class="headerlink" title="學校教育"></a>學校教育</h2><p>窮鄉僻壤的村落，書上這麼多內容壓根沒見過，為何而學？遵守什麼規矩？</p>
<h2 id="補償條例"><a href="#補償條例" class="headerlink" title="補償條例"></a>補償條例</h2><p>一個跨世代的心態，但要知道強勢文化下也有弱勢成員，而生存的價值是因為他們的需求而存在，有時給予環境正表示處於文明的鑑賞期。</p>
<h2 id="生活教育"><a href="#生活教育" class="headerlink" title="生活教育"></a>生活教育</h2><p>生活就是最好的教育，有人走得出去，也一定會有人走不出去，為了 <strong> 部落 </strong> 而走的民族精神？</p>
<h2 id="器具演進"><a href="#器具演進" class="headerlink" title="器具演進"></a>器具演進</h2><p>從人工到電動－難道有人畫畫一開始就學電繪嗎？沒什麼大驚小怪的，會電腦打字就不會寫字了嗎？</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1674" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/uva-1674/" class="article-date">
  <time datetime="2014-12-02T00:38:31.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/uva-1674/">UVa 1674 - Lightning Energy Report</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/uva-1674/" data-id="ckrobwizn00x71cvn64plwho6" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/uva-1674/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tarjan/">tarjan</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一棵樹，接著有數次操作將路徑 (u, v) 上的所有節點權重加上 k。</p>
<p>請問最後每一個點帶有的權重為何？</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">1 </div><div class="line">9 </div><div class="line">0 1</div><div class="line">1 2</div><div class="line">2 3</div><div class="line">2 4</div><div class="line">2 7</div><div class="line">7 8</div><div class="line">7 6</div><div class="line">6 5</div><div class="line">5 </div><div class="line">1 4 10 </div><div class="line">3 5 3 </div><div class="line">0 8 5 </div><div class="line">1 6 10 </div><div class="line">4 4 100</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Case #1: </div><div class="line">5 </div><div class="line">25 </div><div class="line">28 </div><div class="line">3 </div><div class="line">110 </div><div class="line">3 </div><div class="line">13 </div><div class="line">18 </div><div class="line">5</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>參照 <a href="">zerojudge b322. 樹形鎖頭</a> 的解法。</p>
<blockquote><p><img src="http://i.imgur.com/j1x16qN.png" alt="解說圖"></p>
<p><code>A[]</code> : 子樹總和<br><code>B[]</code> : 節點權重</p>
<p>增加路徑 u 到 v 的權重為 k 時，路徑相當於 u 到某點 x 再到 LCA(u, v) 接著 y 最後 v。</p>
<p>那我們增加節點 u, v 的權重 <code>B[u] += k, B[v] += k</code>，減少其 LCA 的權重 <code>B[LCA(u, v)] -= 2k</code>，然後你會觀察 <code>A[]</code> 的部分，權重增加 k 的只會有 u-v 之間的所有節點。</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXV 65536</span></div><div class="line"><span class="keyword">int</span> visited[MAXV];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; tree[MAXV];</div><div class="line"><span class="keyword">int</span> parent[MAXV], weight[MAXV];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findp</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> parent[x] == x ? x : (parent[x] = findp(parent[x]));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">joint</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    x = findp(x), y = findp(y);</div><div class="line">    <span class="keyword">if</span>(x == y)</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(weight[x] &gt; weight[y])</div><div class="line">        weight[x] += weight[y], parent[y] = x;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        weight[y] += weight[x], parent[x] = y;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// LCA</span></div><div class="line"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; Q[MAXV];<span class="comment">// query pair, input index - node</span></div><div class="line"><span class="keyword">int</span> LCA[<span class="number">131072</span>]; <span class="comment">// [query time] input query answer buffer.</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p)</span> </span>&#123;<span class="comment">// rooted-tree.</span></div><div class="line">    parent[u] = u;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tree[u].size(); i++) &#123;<span class="comment">//son node.</span></div><div class="line">        <span class="keyword">int</span> v = tree[u][i];</div><div class="line">        <span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;</div><div class="line">        tarjan(v, u);</div><div class="line">        parent[findp(v)] = u;</div><div class="line">    &#125;</div><div class="line">    visited[u] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q[u].size(); i++) &#123;</div><div class="line">        <span class="keyword">if</span>(visited[Q[u][i].second]) &#123;</div><div class="line">            LCA[Q[u][i].first] = findp(Q[u][i].second);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> weight[])</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> sum = weight[u];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; tree[u].size(); i++) &#123;<span class="comment">//son node.</span></div><div class="line">        <span class="keyword">int</span> v = tree[u][i];</div><div class="line">        <span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;</div><div class="line">        sum += dfs(v, u, weight);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> weight[u] = sum;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line">    <span class="comment">//	freopen("out2.txt", "w+t", stdout);</span></div><div class="line">    <span class="keyword">int</span> n, m, x, y;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> X[MAXV], Y[MAXV], K[MAXV];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            tree[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            tree[x].push_back(y);</div><div class="line">            tree[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> weight[MAXV] = &#123;&#125;, extra[MAXV] = &#123;&#125;;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            visited[i] = <span class="number">0</span>, Q[i].clear();</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;X[i], &amp;Y[i], &amp;K[i]);</div><div class="line">            Q[X[i]].push_back(make_pair(i, Y[i]));</div><div class="line">            Q[Y[i]].push_back(make_pair(i, X[i]));</div><div class="line">        &#125;</div><div class="line">        tarjan(<span class="number">0</span>, <span class="number">-1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            extra[LCA[i]] += K[i];</div><div class="line">            weight[X[i]] += K[i];</div><div class="line">            weight[Y[i]] += K[i];</div><div class="line">            weight[LCA[i]] -= <span class="number">2</span> * K[i];</div><div class="line">        &#125;</div><div class="line">        dfs(<span class="number">0</span>, <span class="number">-1</span>, weight);</div><div class="line">        </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, weight[i] + extra[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1659" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/uva-1659/" class="article-date">
  <time datetime="2014-12-02T00:17:28.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/uva-1659/">UVa 1659 - Help Little Laura</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/uva-1659/" data-id="ckrobwizk00x01cvncnw6mdsg" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/uva-1659/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最少費用流/">最少費用流</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>平面上有 N 個點，並且給定數條有向邊，在這個遊戲中，必須從某個點出發，沿著邊回到起點。每一條邊最多經過一次，而點可以重複走。</p>
<p>每經過一條邊，可以獲益每單位長 X 的利益，但是使用一條邊的成本為 Y。</p>
<p>請問最大獲益為何？</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">4 5 1 </div><div class="line">0 0 2 3 0 </div><div class="line">1 0 3 4 0 </div><div class="line">1 1 4 0 </div><div class="line">0 1 1 0 </div><div class="line">1 2 1 </div><div class="line">0 0 0 </div><div class="line">10 7 2 </div><div class="line">0 0 2 4 0 </div><div class="line">5 0 3 0 </div><div class="line">5 10 4 10 0 </div><div class="line">2 3 5 0 </div><div class="line">7 5 6 0 </div><div class="line">0 11 1 0 </div><div class="line">8 0 10 5 0 </div><div class="line">18 3 7 0 </div><div class="line">14 5 8 1 0 </div><div class="line">12 9 9 0 </div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Case 1: 16.00 </div><div class="line">Case 2: 0.00 </div><div class="line">Case 3: 522.18</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>目標將每一個點調整 <code>indeg = outdeg</code>，要將多餘的邊捨去，只要滿足 <code>indeg = outdeg</code>，則可以表示平面上有數個尤拉環道。</p>
<p>接著建造最少費用流的模型，來捨去掉多餘的邊。當存有邊 <code>e(i-&gt;j)</code> 時，<code>outdeg[i]++, indeg[j]++</code>，一開始選擇所有 <code>cost(e(i-&gt;j)) &gt; 0</code> 的邊，作為初始盤面，對於 <code>cost(e(i-&gt;j)) &lt; 0</code> 先不選，選擇獲益為負的結果並不好。</p>
<p>如果 <code>cost(e(i-&gt;j)) &gt; 0</code>，建造邊 <code>i-&gt;j, flow: 1, cost: cost(e(i-&gt;j))</code>，假使在最少費用流中選擇這一條邊時，就會將 deg 數量減少。對於 <code>cost(e(i-&gt;j)) &lt; 0</code> 一開始並沒有在盤面上，如果流經這一條邊，則說明將會增加這一條邊。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;deque&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-8</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> x, y, cap;</div><div class="line">    <span class="keyword">double</span> cost;<span class="comment">// x-&gt;y, v</span></div><div class="line">    <span class="keyword">int</span> next;</div><div class="line">&#125; edge[<span class="number">1000005</span>];</div><div class="line"><span class="keyword">int</span> e, head[<span class="number">600</span>], prev[<span class="number">600</span>], record[<span class="number">600</span>], inq[<span class="number">600</span>];</div><div class="line"><span class="keyword">double</span> dis[<span class="number">600</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">addEdge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap, <span class="keyword">double</span> cost)</span> </span>&#123;</div><div class="line">    edge[e].x = x, edge[e].y = y, edge[e].cap = cap, edge[e].cost = cost;</div><div class="line">    edge[e].next = head[x], head[x] = e++;</div><div class="line">    edge[e].x = y, edge[e].y = x, edge[e].cap = <span class="number">0</span>, edge[e].cost = -cost;</div><div class="line">    edge[e].next = head[y], head[y] = e++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">mincost</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> mncost = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> flow, totflow = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> i, x, y;</div><div class="line">    <span class="keyword">double</span> oo = <span class="number">1e+30</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</div><div class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">    		dis[i] = oo;</div><div class="line">        dis[s] = <span class="number">0</span>;</div><div class="line">        <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">        Q.push_front(s);</div><div class="line">        <span class="keyword">while</span>(!Q.empty()) &#123;</div><div class="line">            x = Q.front(), Q.pop_front();</div><div class="line">            inq[x] = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span>(i = head[x]; i != <span class="number">-1</span>; i = edge[i].next) &#123;</div><div class="line">                y = edge[i].y;</div><div class="line">                <span class="keyword">if</span>(edge[i].cap &gt; <span class="number">0</span> &amp;&amp; dis[y] &gt; dis[x] + edge[i].cost) &#123;</div><div class="line">                    dis[y] = dis[x] + edge[i].cost;</div><div class="line">                    prev[y] = x, record[y] = i;</div><div class="line">                    <span class="keyword">if</span>(inq[y] == <span class="number">0</span>) &#123;</div><div class="line">                        inq[y] = <span class="number">1</span>;</div><div class="line">                        <span class="keyword">if</span>(Q.size() &amp;&amp; dis[Q.front()] &gt; dis[y])</div><div class="line">                            Q.push_front(y);</div><div class="line">                        <span class="keyword">else</span></div><div class="line">                            Q.push_back(y);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(dis[t] == oo)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        flow = <span class="number">0x3f3f3f3f</span>;</div><div class="line">        <span class="keyword">for</span>(x = t; x != s; x = prev[x]) &#123;</div><div class="line">            <span class="keyword">int</span> ri = record[x];</div><div class="line">            flow = min(flow, edge[ri].cap);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(x = t; x != s; x = prev[x]) &#123;</div><div class="line">            <span class="keyword">int</span> ri = record[x];</div><div class="line">            edge[ri].cap -= flow;</div><div class="line">            edge[ri^<span class="number">1</span>].cap += flow;</div><div class="line">            edge[ri^<span class="number">1</span>].cost = -edge[ri].cost;</div><div class="line">        &#125;</div><div class="line">        totflow += flow;</div><div class="line">        mncost += dis[t] * flow;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> mncost;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> N, X, Y;</div><div class="line">    <span class="keyword">int</span> x[<span class="number">128</span>], y[<span class="number">128</span>], u;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;X, &amp;Y) == <span class="number">3</span> &amp;&amp; N) &#123;</div><div class="line">    	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[<span class="number">128</span>];</div><div class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">    		<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x[i], &amp;y[i]);</div><div class="line">    		<span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;u) == <span class="number">1</span> &amp;&amp; u)</div><div class="line">    			g[i].push_back(u);</div><div class="line">        &#125; </div><div class="line">        </div><div class="line">    	e = <span class="number">0</span>;</div><div class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span>(head));	</div><div class="line">        <span class="keyword">int</span> deg[<span class="number">128</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">double</span> sumCost = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; g[i].size(); j++) &#123;</div><div class="line">                u = g[i][j];</div><div class="line">                <span class="keyword">double</span> d = hypot(x[i] - x[u], y[i] - y[u]);</div><div class="line">                <span class="keyword">double</span> cost = d * X - Y;</div><div class="line">                <span class="keyword">if</span> (cost &lt; <span class="number">0</span>) &#123;</div><div class="line">                    addEdge(u, i, <span class="number">1</span>, -cost);</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    sumCost += cost;</div><div class="line">                    addEdge(i, u, <span class="number">1</span>, cost);</div><div class="line">                    deg[u]--, deg[i]++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> source = <span class="number">0</span>, sink = N + <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (deg[i] &gt; <span class="number">0</span>)	addEdge(source, i, deg[i], <span class="number">0</span>);</div><div class="line">            <span class="keyword">if</span> (deg[i] &lt; <span class="number">0</span>)	addEdge(i, sink, -deg[i], <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">double</span> mncost = mincost(source, sink, N+<span class="number">1</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: %.2lf\n"</span>, ++cases, sumCost - mncost + eps);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">4 5 1 </span></div><div class="line"><span class="comment">0 0 2 3 0 </span></div><div class="line"><span class="comment">1 0 3 4 0 </span></div><div class="line"><span class="comment">1 1 4 0 </span></div><div class="line"><span class="comment">0 1 1 0 </span></div><div class="line"><span class="comment">1 2 1 </span></div><div class="line"><span class="comment">0 0 0 </span></div><div class="line"><span class="comment">10 7 2 </span></div><div class="line"><span class="comment">0 0 2 4 0 </span></div><div class="line"><span class="comment">5 0 3 0 </span></div><div class="line"><span class="comment">5 10 4 10 0 </span></div><div class="line"><span class="comment">2 3 5 0 </span></div><div class="line"><span class="comment">7 5 6 0 </span></div><div class="line"><span class="comment">0 11 1 0 </span></div><div class="line"><span class="comment">8 0 10 5 0 </span></div><div class="line"><span class="comment">18 3 7 0 </span></div><div class="line"><span class="comment">14 5 8 1 0 </span></div><div class="line"><span class="comment">12 9 9 0 </span></div><div class="line"><span class="comment">0</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1649" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/uva-1649/" class="article-date">
  <time datetime="2014-12-02T00:12:12.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/uva-1649/">UVa 1649 - Binomial coefficients</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/uva-1649/" data-id="ckrobwizj00ww1cvnyw9h80xt" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/uva-1649/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分/">二分</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>組合的反函數，現在給定組合數，輸出是由哪幾種組合可以配出組合數。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">2</div><div class="line">15</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">(2,1)</div><div class="line">4</div><div class="line">(6,2) (6,4) (15,1) (15,14)</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>先預見表，完成前幾項的結果。</p>
<p>看著巴斯卡三角形單純看 i，對於 <code>C(n, i)</code> 是一個嚴格遞增的函數。因此窮舉 i，針對組合數進行二分搜索。</p>
<p>為防止越界，在整數計算上可以利用除法進行比大小。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1024</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MAXVAL = <span class="number">1e+16</span>, MAXVAL2 = <span class="number">1e+15</span>;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> C[MAXN][MAXN] = &#123;&#125;;</div><div class="line"><span class="built_in">map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; &gt; &gt; R;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">testCombination</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> n, <span class="keyword">long</span> <span class="keyword">long</span> m, <span class="keyword">long</span> <span class="keyword">long</span> Cnm)</span> </span>&#123; <span class="comment">// test C(n, m), m &lt; 10</span></div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</div><div class="line">    m = min(m, n-m);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">long</span> <span class="keyword">long</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (Cnm * i / (n + <span class="number">1</span> - i) / ret  &lt; <span class="number">1</span>)</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        ret = ret * (n + <span class="number">1</span> - i) / i;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret == Cnm ? <span class="number">0</span> : <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; &gt; invCombination(<span class="keyword">long</span> <span class="keyword">long</span> n) &#123;</div><div class="line">    <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; &gt; ret;</div><div class="line">    ret = R[n];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> l = <span class="number">1</span>, r = n, mid;</div><div class="line">        <span class="keyword">while</span> (l &lt;= r) &#123;</div><div class="line">            mid = (l + r)/<span class="number">2</span>;</div><div class="line">            <span class="keyword">int</span> f = testCombination(mid, i, n); <span class="comment">// &#123;-1, 0, 1&#125;</span></div><div class="line">            <span class="keyword">if</span> (f == <span class="number">0</span>) &#123;</div><div class="line">                ret.push_back(make_pair(mid, i));</div><div class="line">                ret.push_back(make_pair(mid, mid - i));</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (f &lt; <span class="number">0</span>)</div><div class="line">                l = mid + <span class="number">1</span>;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                r = mid - <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    sort(ret.begin(), ret.end());</div><div class="line">    ret.resize(unique(ret.begin(), ret.end()) - ret.begin());</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">//	printf("%d\n", testCombination(5000, 2, 12497500));</span></div><div class="line">    C[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++) &#123;</div><div class="line">        C[i][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</div><div class="line">            C[i][j] = C[i<span class="number">-1</span>][j<span class="number">-1</span>] + C[i<span class="number">-1</span>][j];</div><div class="line">            C[i][j] = min(C[i][j], MAXVAL);</div><div class="line">            <span class="keyword">if</span> (j != i &amp;&amp; C[i][j] &lt;= MAXVAL2)</div><div class="line">                R[C[i][j]].push_back(make_pair(i, j));</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"><span class="comment">//	for (int i = 0; i &lt; 10; i++)</span></div><div class="line"><span class="comment">//		printf("%lld\n", C[MAXN-1][i]);</span></div><div class="line">    <span class="keyword">int</span> testcase;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; &gt; r = invCombination(n);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (<span class="keyword">int</span>) r.size());</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; r.size(); i++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"(%lld,%lld)%c"</span>, r[i].first, r[i].second, i == r.size()<span class="number">-1</span> ? <span class="string">'\n'</span> : <span class="string">' '</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1614" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/uva-1614/" class="article-date">
  <time datetime="2014-12-01T23:58:38.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/uva-1614/">UVa 1614 - Hell on the Markets</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/uva-1614/" data-id="ckrobwizi00wu1cvnn1a3n2oz" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/uva-1614/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/貪心/">貪心</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>金融交易，它們希望賣出、買進交易結束後的差為零。</p>
<p>意即將數字分兩堆的結果相同。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">1 2 3 3</div><div class="line">4</div><div class="line">1 2 3 4</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">No</div><div class="line">Yes</div><div class="line">1 -1 -1 1</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>由於保證 <code>0 &lt; a[i] &lt;= i</code>，基於這一點，可以發現到只考慮一個數字 <code>a[1]</code> 時，必然可以湊出 <code>1 - a[1]</code>，當考慮第 i 大數字時，保證前 i - 1 個數字可以湊出 <code>1 ~ (i-1)</code>，加上第 i 個數字必然可以湊出 <code>1 ~ (i-1)+a[i]</code> (<code>1, 2, 3, ..., i-1, a[i], 1+a[i], ..., i-1+a[i]</code>)。</p>
<p>而事實上，可以湊出所有的 <code>1 ~ sum[i]</code>，根據遞歸是可以證明的。只要總和是偶數，必然可以劃分成總和相同的兩堆。排序一下，從大的數字開始挑，貪心去完成目標的總和。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">    </div><div class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; A[<span class="number">100000</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> ret[<span class="number">100000</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i].first);</div><div class="line">            A[i].second = i;</div><div class="line">            sum += A[i].first;</div><div class="line">        &#125; </div><div class="line">        <span class="keyword">if</span> (sum%<span class="number">2</span>) &#123;</div><div class="line">            <span class="built_in">puts</span>(<span class="string">"No"</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">puts</span>(<span class="string">"Yes"</span>);</div><div class="line">            sum /= <span class="number">2</span>;</div><div class="line">            sort(A, A+n);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">                <span class="keyword">if</span> (sum &gt;= A[i].first)</div><div class="line">                    sum -= A[i].first, ret[A[i].second] = <span class="number">1</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    ret[A[i].second] = <span class="number">-1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d%c"</span>, ret[i], i == n<span class="number">-1</span> ? <span class="string">'\n'</span> : <span class="string">' '</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1169" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/12/02/uva-1169/" class="article-date">
  <time datetime="2014-12-01T23:48:12.000Z" itemprop="datePublished">2014-12-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/12/02/uva-1169/">UVa 1169 - Robotruck</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/12/02/uva-1169/" data-id="ckrobwiv700mr1cvnfatpwlql" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/12/02/uva-1169/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/單調隊列/">單調隊列</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>在一個二維平面中，灑落 N 個垃圾，機器人從原點 (0, 0) 依序要蒐集垃圾，機器人一次承載 W 重量的垃圾，隨時可以返回原點將垃圾放下。</p>
<p>請問依序收集垃圾的最少花費為何？</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line"></div><div class="line">10</div><div class="line">4</div><div class="line">1 2 3</div><div class="line">1 0 3</div><div class="line">3 1 4</div><div class="line">3 1 4</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">14</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>一開始得到方程式 <code>dp[i] = min(dp[j-1] + cost[j, i] + dist[j] + dist[i])</code> 必須滿足 <code>w[j, i] &lt;= C</code>，其中 j &lt;= i。</p>
<p>其中 <code>dp[i]</code> 表示依序收集前 i 個垃圾的最小花費，<code>cost[j, i]</code> 表示走訪編號 j 到 i 垃圾位置的花費，補上原點到編號 j，並且收集完從 i 回到原點。</p>
<p>這樣的方程式轉換需要 <code>N^2</code> 時間，化簡一下式子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dp[i] = dp[j-1] + cost[j, i] + dist[j] + dist[i]</div><div class="line">dp[i] = dp[j-1] + cost[i] - cost[j] + dist[j] + dist[i]</div><div class="line">dp[i] = (dp[j-1] - cost[j] + dist[j]) + cost[i] + dist[i]</div></pre></td></tr></table></figure>
<p>會發現 i, j 獨立，也滿足垃圾重量累計遞增，因此盡可能保留 <code>dp[j-1] - cost[j] + dist[j]</code> 小的結果，並且重量不超過限制，當重量超過限制時，該組答案在隨後保證再也不會用到，直接捨棄之。</p>
<p>核心就是單調隊列的思路。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 131072</span></div><div class="line"><span class="keyword">int</span> x[MAXN], y[MAXN], w[MAXN];</div><div class="line"><span class="keyword">int</span> cost[MAXN], dist[MAXN];</div><div class="line"><span class="keyword">int</span> dp[MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> j)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> dp[j<span class="number">-1</span>] - cost[j] + dist[j];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, C, N;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;C, &amp;N);</div><div class="line">        w[<span class="number">0</span>] = <span class="number">0</span>, cost[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;x[i], &amp;y[i], &amp;w[i]);</div><div class="line">            cost[i] = cost[i<span class="number">-1</span>] + <span class="built_in">abs</span>(x[i] - x[i<span class="number">-1</span>]) + <span class="built_in">abs</span>(y[i] - y[i<span class="number">-1</span>]);</div><div class="line">            dist[i] = <span class="built_in">abs</span>(x[i]) + <span class="built_in">abs</span>(y[i]);</div><div class="line">            w[i] += w[i<span class="number">-1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// dp[i] = dp[j-1] + cost[j, i] + dist[j] + dist[i]</span></div><div class="line">        <span class="comment">// dp[i] = dp[j-1] + cost[i] - cost[j] + dist[j] + dist[i]</span></div><div class="line">        <span class="comment">// dp[i] = (dp[j-1] - cost[j] + dist[j]) + cost[i] + dist[i]</span></div><div class="line">        <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">        Q.push_back(<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">while</span> (!Q.empty() &amp;&amp; w[i] - w[Q.front()] &gt; C)</div><div class="line">                Q.pop_front();</div><div class="line">            dp[i] = f(Q.front() + <span class="number">1</span>) + cost[i] + dist[i];</div><div class="line">            <span class="keyword">while</span> (!Q.empty() &amp;&amp; f(Q.back() + <span class="number">1</span>) &gt;= f(i + <span class="number">1</span>))</div><div class="line">                Q.pop_back();</div><div class="line">            Q.push_back(i);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[N]);</div><div class="line">        <span class="keyword">if</span> (testcase)	<span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/geometry-hw4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/11/28/lesson/geometry-hw4/" class="article-date">
  <time datetime="2014-11-28T00:39:44.000Z" itemprop="datePublished">2014-11-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/計算幾何/">計算幾何</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/28/lesson/geometry-hw4/">計算幾何 - HW04</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/11/28/lesson/geometry-hw4/" data-id="ckrobwjk402dx1cvn5f96tjmo" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/11/28/lesson/geometry-hw4/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/計算幾何/">計算幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Chapter-7"><a href="#Chapter-7" class="headerlink" title="Chapter 7"></a>Chapter 7</h2><h3 id="7-1"><a href="#7-1" class="headerlink" title="7.1"></a>7.1</h3><p>Prove that for any n &gt; 3 there is a set of n point sites in the plane such that one of the cells of Vor(P) has n−1 vertices</p>
<p>證明一個點個數 n &gt; 3 的 Voronoi diagram，存在一個 cell 具有 n - 1 個頂點。</p>
<p><img src="http://i.imgur.com/86AoEWl.png" alt="7.1"></p>
<p>如圖所示，一個點放置在圓心，剩餘的 n - 1 個放置在圓周上。則中間的 cell 必然有 n - 1 個頂點。</p>
<h3 id="7-3"><a href="#7-3" class="headerlink" title="7.3"></a>7.3</h3><p>Show that<span>$\Omega (nlogn)$</span><!-- Has MathJax --> is a lower bound for computing Voronoi diagrams by reducing the sorting problem to the problem of computing Voronoi diagrams. You can assume that the Voronoi diagram algorithm should be able to compute for every vertex of the Voronoi diagram its incident edges in cyclic order around the vertex.</p>
<p><img src="http://i.imgur.com/Algk5Xi.png" alt="7.3"></p>
<p>證明 Voronoi diagram 的 lower bound<span>$\Omega (nlogn)$</span><!-- Has MathJax -->，藉由 reduce 到 sorting problem。</p>
<blockquote>
<p>關於 reduce 證明，將一個簡單、約束較少的問題 A，藉由一個合適的轉換，變成一個困難問題 B 的 subset，已知 A 的 lower bound，則 B 的 lower bound 至少與 A 相同。</p>
</blockquote>
<ol>
<li>假設排序 n 個整數<span>$x_{1}, x_{2}, ..., x_{n}$</span><!-- Has MathJax --> </li>
<li>轉換成<span>$(x_{1}, 0), (x_{2}, 0), ..., (x_{n}, 0)$</span><!-- Has MathJax --> 將所有點放置在 x 軸上，並且額外增加一點<span>$(\infty, 0)$</span><!-- Has MathJax -->。將 n + 1 個點找到 Voronoi diagram，對於<span>$(\infty, 0)$</span><!-- Has MathJax --> 的 cell 而言，恰好邊都是由另外 n 個點對應的 cell 構成 cell edge (相鄰)。假設儲存邊的順序為順或逆時針，則邊的順序等價排序結果。</li>
</ol>
<p>最後如上圖所示，又已知轉換需要<span>$O(n)$</span><!-- Has MathJax -->，sorting<span>$\Omega (nlogn)$</span><!-- Has MathJax -->，則 Voronoi diagram 的 lower bound<span>$\Omega (nlogn)$</span><!-- Has MathJax -->。</p>
<h3 id="7-5"><a href="#7-5" class="headerlink" title="7.5"></a>7.5</h3><p>Give an example where the parabola defined by some site<span>$p_{i}$</span><!-- Has MathJax --> contributes more than one arc to the beach line. Can you give an example where it contributes a linear number of arcs?</p>
<p><img src="http://i.imgur.com/VEwhdjt.png" alt="7.5"></p>
<p>如上圖所示<span>$p_{i}$</span><!-- Has MathJax --> 拉出的拋物線 (parabola) 有可能提供多個弧 (arc)。(最左側的點提供 2 個弧)</p>
<p>一個點<span>$p_{i}$</span><!-- Has MathJax --> 存有的 arc 數量與 cell<span>$p_{i}$</span><!-- Has MathJax -->) 的頂點數量線性相關。由 exercose 7.1 得到最多<span>$O(n)$</span><!-- Has MathJax --> 的頂點。同理 arc 數量最多<span>$O(n)$</span><!-- Has MathJax -->。</p>
<p>beach line 上的 arc 數最多為 Voronoi diagram 的 edge 數，又 Voronoi diagram 的 edge 最大數為<span>$3n - 6$</span><!-- Has MathJax -->，也因此最多為<span>$O(n)$</span><!-- Has MathJax --></p>
<h3 id="7-10"><a href="#7-10" class="headerlink" title="7.10"></a>7.10</h3><p>Let P be a set of n points in the plane. Give an<span>$O(nlogn)$</span><!-- Has MathJax --> time algorithm to find two points in P that are closest together. Show that your algorithm is correct.</p>
<p>Algorithm:</p>
<ol>
<li>建造 Voronoi Diagram by fortune’s algorithm<span>$O(nlogn)$</span><!-- Has MathJax --></li>
<li>對於每一個 cell<span>$p_{i}$</span><!-- Has MathJax -->) 檢查鄰居 cell<span>$p_{neighbor}$</span><!-- Has MathJax -->)，計算<span>$distance(p_{i}, p_{neighbor})$</span><!-- Has MathJax --> 的結果。Voronoi diagram 的 edge 數<span>$3n - 6$</span><!-- Has MathJax -->，每一條 edge 檢查只需要<span>$O(1)$</span><!-- Has MathJax -->。<span>$O(n)$</span><!-- Has MathJax --></li>
</ol>
<p>證明：每一個點所張開的 cell 只會與相鄰的 cell 最近，否則不符合 Voronoi diagram 的定義。</p>
<h3 id="7-14"><a href="#7-14" class="headerlink" title="7.14"></a>7.14</h3><p>Show that the farthest point Voronoi diagram on n points in the plane has at most 2n−3 (bounded or unbounded) edges. Also give an exact bound on the maximum number of vertices in the farthest point Voronoi diagram.</p>
<ul>
<li>歐拉公式<span>$v - e + f = 2$</span><!-- Has MathJax --></li>
<li>一個頂點至少三條邊。</li>
<li>farthest point Voronoi diagram 的最多有 n - 2 個頂點。<ul>
<li>對於每一個頂點而言，通過其相鄰 cell 對應的點的外接圓，其圓包含所有平面點。</li>
<li>這種圓最多 n - 2 個。</li>
</ul>
</li>
<li>從隨機增量算法中得知，插入一個點時，最多增加一個 vertex (繞行時，會刪除對於 cell 相交兩個線段之間的所有 vertex，這種 vertex 至少一個，並且增加與線段的交點 1 個)。<span>$v(3) = 1, v(n) = v(n-1) + 1 \text{ for } n &gt; 3$</span><!-- Has MathJax --></li>
<li>考慮增加一個虛點，連接所有 unbounded edge  <span>$v - e + f = 2 \Rightarrow (n-2+1) - e + n = 2 \Rightarrow e = 2n - 3$</span><!-- Has MathJax -->。</li>
</ul>
<hr>
<h2 id="Chpater-9"><a href="#Chpater-9" class="headerlink" title="Chpater 9"></a>Chpater 9</h2><h3 id="9-2"><a href="#9-2" class="headerlink" title="9.2"></a>9.2</h3><p>The degree of a point in a triangulation is the number of edges incident to it. Give an example of a set of n points in the plane such that, no matter how the set is triangulated, there is always a point whose degree is n−1.</p>
<p>對於任意三角化的結果，總會有一個點的 degree = n - 1。</p>
<p><img src="http://i.imgur.com/JEnOhDo.png" alt="9.2"></p>
<ul>
<li>此點一定能用一條線區隔所有剩餘點。</li>
<li>剩餘 n - 1 個點，一定能滿足任兩點的連線不遮蔽其他的點。</li>
</ul>
<p>example：n - 1 個點落在<span>$y = e^{x}$</span><!-- Has MathJax --> 上，且<span>$x &lt; p$</span><!-- Has MathJax -->，另外一點在<span>$(p, q)$</span><!-- Has MathJax --></p>
<h3 id="9-4"><a href="#9-4" class="headerlink" title="9.4"></a>9.4</h3><p>Prove that the smallest angle of any triangulation of a convex polygon whose vertices lie on a circle is the same. This implies that any completion of the Delaunay triangulation of a set of points maximizes the minimum angle.</p>
<p>對於所有頂點共圓的凸多邊形，任何的三角化的最小角度都會相同。</p>
<ol>
<li>任何三角形必然是圓上三點。</li>
<li>任何凸邊形的邊都會是一個三角形上的邊</li>
<li>三角形的邊都是圓的弦，並且對應角度正比弦長大小。</li>
<li>凸多邊形的最小弦長是多邊上的邊，又因一定會在三角形上，任何三角化一定包含這個最小角。</li>
</ol>
<h3 id="9-7"><a href="#9-7" class="headerlink" title="9.7"></a>9.7</h3><p>Prove that all edges of DG(Pr) that are not in DG(Pr−1) are incident to pr. In other words, the new edges of DG(Pr) form a star as in Figure 9.8. Give a direct proof, without referring to algorithm DELAUNAYTRIANGULATION.</p>
<p>對於新增加的邊<span>$e$</span><!-- Has MathJax -->，只會與新加入的點<span>$p_{r}$</span><!-- Has MathJax --> 相連。</p>
<ul>
<li><p>從 Voronoi diagram 等價 Delaunay triangulation，加入點的 cell，不會使其他兩個 cell 從沒相鄰變成相鄰。</p>
</li>
<li><p>對於<span>$\Delta(p_{i}, p_{j}, p_{k})$</span><!-- Has MathJax --> 之間加入<span>$p_{r}$</span><!-- Has MathJax -->，由於<span>$C(p_{i}, p_{j}, p_{k})$</span><!-- Has MathJax --> 內部不存在任何點<span>$C&apos;(p_{i}, p_{r})$</span><!-- Has MathJax --> (兩點當直徑)，得到<span>$C&apos; \subseteq C$</span><!-- Has MathJax -->，且<span>$C&apos;$</span><!-- Has MathJax --> 內部不存在任何點，確定<span>$\bar{p_{i} p_{r}}$</span><!-- Has MathJax --> 屬於 Delaunay 上。同理<span>$\bar{p_{j} p_{r}}$</span><!-- Has MathJax --><span>$\bar{p_{k} p_{r}}$</span><!-- Has MathJax -->。  </p>
</li>
<li><p>由於<span>$\Delta(p_{l}, p_{i}, p_{j})$</span><!-- Has MathJax --> 原本是 Delaunay 上，如果 flip<span>$\bar{p_{i} p_{j}}$</span><!-- Has MathJax -->，得到<span>$C(p_{i}, p_{r}, p_{l}) \subseteq C(p_{l}, p_{i}, p_{j})$</span><!-- Has MathJax --><span>$C(p_{j}, p_{r}, p_{l}) \subseteq C(p_{l}, p_{i}, p_{j})$</span><!-- Has MathJax -->，確定<span>$\bar{p_{r} p_{l}}$</span><!-- Has MathJax --> 屬於 Delaunay 上。  </p>
</li>
<li><p>也因此，對於增加的三角形進行檢查時，每次已經保證該三角形其中兩邊一定屬於 Delaunay 上，同時必然有<span>$p_{r}$</span><!-- Has MathJax -->，flip 的邊一定會接到<span>$p_{r}$</span><!-- Has MathJax --> 上。遞迴得證。</p>
</li>
</ul>
<h3 id="9-11"><a href="#9-11" class="headerlink" title="9.11"></a>9.11</h3><p>A Euclidean minimum spanning tree (EMST) of a set P of points in the plane is a tree of minimum total edge length connecting all the points. EMST’s are interesting in applications where we want to connect sites in a planar environment by communication lines (local area networks), roads, railroads, or the like.</p>
<ol>
<li>Prove that the set of edges of a Delaunay triangulation of P contains an EMST for P.</li>
<li>Use this result to give an O(nlogn) algorithm to compute an EMST for P.</li>
</ol>
<p>對於歐幾里得距離的平面最小生成樹。</p>
<ol>
<li><p>證明 EMST 的 edge set 被 Delaunay triangulation 的 edge set 包含。(參考 <a href="http://en.wikipedia.org/wiki/Euclidean_minimum_spanning_tree" target="_blank" rel="external">wiki</a>)<br> 目標： <strong> every edge not in a Delaunay triangulation is also not in any EMST </strong></p>
<ul>
<li>最小生成樹的性質：任何一個 cycle 上的最重邊將不會在最小生成樹中。</li>
<li><p>Delaunay triangulation： If there is a circle with two of the input points on its boundary which contains no other input points, the line between those two points is an edge of every Delaunay triangulation.</p>
<blockquote>
<p>對於鈍角三角形，最大邊必然不在 EMST 中，然而對於 Delaunay triangulation 性質，必須考慮他們兩點的 boundary (shared Voronoi edge) 是否存在。</p>
</blockquote>
<p>假設 p, q 之間沒有邊於 Delaunay，則對於任意通過 p, q 的圓都存在點 r 在圓內，從性質中發現 r 到 p, q 的距離一定小於 p q 之間的距離。同時在 EMST 中，p q r 三點會構成鈍角三角形，其中 p q 是最大邊，p q 之間必然沒有邊。</p>
</li>
</ul>
</li>
<li><p>找到 EMST 的<span>$O(nlogn)$</span><!-- Has MathJax --> 算法<br> Algorithm:</p>
<ol>
<li>利用 Delaunay triangulation 找到所有邊<span>$O(nlogn)$</span><!-- Has MathJax --></li>
<li>最多有 3n - 6 條邊，利用 MST 中的 kruskal’s algorithm<span>$O(ElogE)$</span><!-- Has MathJax --><br>3.<span>$E = O(3n-6) = O(n)$</span><!-- Has MathJax -->，得到<span>$O(nlogn)$</span><!-- Has MathJax --> 的做法。</li>
</ol>
</li>
</ol>
<h3 id="9-13"><a href="#9-13" class="headerlink" title="9.13"></a>9.13</h3><p>The Gabriel graph of a set P of points in the plane is defined as follows:<br>p q Two points p and q are connected by an edge of the Gabriel graph if and only if the disc with diameter pq does not contain any other point of P.</p>
<ol>
<li>Prove that DG(P) contains the Gabriel graph of P.</li>
<li>Prove that p and q are adjacent in the Gabriel graph of P if and only if the Delaunay edge between p and q intersects its dual Voronoi edge.</li>
<li>Give an O(nlogn) time algorithm to compute the Gabriel graph of a set of n points</li>
</ol>
<p>Gabriel graph：任兩點之間為直徑的圓內若沒有其他點，則兩點之間有邊。</p>
<ol>
<li>證明 subgraph 關係。 </li>
</ol>
<ul>
<li>根據 Theorem 9.6 (1) 任三點圓內<span>$C(p_{i}, p_{j}, p_{k})$</span><!-- Has MathJax -->沒有其他點，但是<span>$C(p_{i}, p_{j})$</span><!-- Has MathJax --> 內部可能存有其他點 (如單純的 n = 3 的鈍角三角形)。找到<span>$e_{p_{i}, p_{j}} \notin Gabriel \text{ but } e_{p_{i}, p_{j}} \in Delaunay$</span><!-- Has MathJax --><br>*<span>$C(p_{i}, p_{j})$</span><!-- Has MathJax --> 內部沒有其他點，則兩點之間必然有 shared Voronoi edge，符合 Theorem 9.6 (2)。得到  <span>$\text{ if }e_{p_{i}, p_{j}} \in Gabriel \text{ , then } e_{p_{i}, p_{j}} \in Delaunay$</span><!-- Has MathJax -->，得證<span>$g(P) \subseteq DG(P)$</span><!-- Has MathJax -->。</li>
</ul>
<ol>
<li>如果<span>$\bar{pq}$</span><!-- Has MathJax --> 經過多個 Voronoi edge，則<span>$\bar{pq}$</span><!-- Has MathJax --> 上一點 x 滿足 <span>$$\bar{xr} &lt; \bar{xp}, \bar{xr} &lt; \bar{xq} \\
\Rightarrow \angle rpx &lt; \angle prx, \angle rqx &lt; \angle xrq \text{(triangle)} \\
\text{let } \angle rpx = a, \angle prx = c, \angle rqx = b, \angle xrq = d \\
\Rightarrow a + b + c + d = 180^{\circ} \\ 
\Rightarrow c + d &gt; 90^{\circ}$$</span><!-- Has MathJax -->
</li>
</ol>
<p>符合圓內角性質，點 r 一定在圓內，得證<span>$e_{p_{i}, p_{j}} \notin Gabriel$</span><!-- Has MathJax -->。</p>
<ol>
<li><p>在 O(n logn) 時間內完成。<br> Algorithm： </p>
<ol>
<li>利用 Delaunay triangulation 找到所有邊<span>$O(nlogn)$</span><!-- Has MathJax --></li>
<li><p>將<span>$e_{p{i}, p{j}} \in DG(P)$</span><!-- Has MathJax --> 進行測試是否有點落在<span>$C(p{i}, p{j})$</span><!-- Has MathJax --><span>$O(n)$</span><!-- Has MathJax --></p>
<p>只需要拿鄰居進行檢測，鄰居最多 2 個 (共邊的三角形)。</p>
</li>
</ol>
</li>
</ol>
<h3 id="9-14"><a href="#9-14" class="headerlink" title="9.14"></a>9.14</h3><p>The relative neighborhood graph of a set P of points in the plane is defined as follows: Two points p and q are connected by an edge of the relative neighborhood graph if and only if</p>
<span>$d(p, q) \leq \underset{r \in P, r \neq p, q }{min} max(d(p, r), d(q, r)).$</span><!-- Has MathJax -->
<ol>
<li>Given two points p and q, let lune(p,q) be the moon-shaped region p q lune(p,q) formed as the intersection of the two circles around p and q whose radius is d(p,q). Prove that p and q are connected in the relative neighborhood graph if and only if lune(p,q) does not contain any point of P in its interior.</li>
<li>Prove that DG(P) contains the relative neighborhood graph of P.</li>
<li>Design an algorithm to compute the relative neighborhood graph of a given point set.</li>
</ol>
<p>整體而言類似 9.13。</p>
<ol>
<li>若 p, q 之間沒有邊，則  <span>$$\exists r : d(p, q) &gt; \underset{r \in P, r \neq p, q }{min} max(d(p, r), d(q, r)) \\
\exists r : d(p, q) &gt; d(p, r) \text{ and } d(p, q) &gt; d(q, r)$$</span><!-- Has MathJax -->
AND 就是做交集操作，不知道該怎麼寫才好。</li>
<li>與 9.14 依樣畫葫蘆，只是<span>$lune(p, q) \subseteq C(p, q)$</span><!-- Has MathJax -->，則更暗示<span>$\text{ if }e_{p_{i}, p_{j}} \in G \text{ , then } e_{p_{i}, p_{j}} \in Gabriel$</span><!-- Has MathJax --> </li>
<li>速度是<span>$O(n^{2})$</span><!-- Has MathJax -->，沒辦法單純看鄰居進行檢查。拿每一條邊進行 O(n) 窮舉。不過在分散式計算，整體是 O(n)。</li>
</ol>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/43/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/42/">42</a><a class="page-number" href="/page/43/">43</a><span class="page-number current">44</span><a class="page-number" href="/page/45/">45</a><a class="page-number" href="/page/46/">46</a><span class="space">&hellip;</span><a class="page-number" href="/page/85/">85</a><a class="extend next" rel="next" href="/page/45/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">34</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">11</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">46</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/07/29/java/java-jni-tls-error-2/">
              
                <i class="icon-file-o"></i> 
              
            Java JNI GC Thread Error (EINVAL)</a>
          </li>
        
          <li>
            <a class="text" href="/2021/07/29/work/company-ghost-story-11/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 11</a>
          </li>
        
          <li>
            <a class="text" href="/2021/06/21/diary-202106/">
              
                <i class="icon-file-o"></i> 
              
            疫情下的工作變化</a>
          </li>
        
          <li>
            <a class="text" href="/2021/06/21/work/company-ghost-story-10/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 10</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/diary-202105/">
              
                <i class="icon-file-o"></i> 
              
            前思後想 新居落成</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-2/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 組合篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>