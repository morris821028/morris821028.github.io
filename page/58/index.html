<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/page/58/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-oj/uva/uva-10597" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/05/oj/uva/uva-10597/" class="article-date">
  <time datetime="2014-10-05T14:14:25.000Z" itemprop="datePublished">2014-10-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/05/oj/uva/uva-10597/">UVa 10597 - Right Words</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/05/oj/uva/uva-10597/" data-id="ckpaivcb800fin8vnab33fp4t" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/05/oj/uva/uva-10597/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CFG/">CFG</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>對一個已經是 Chomsky normal form 的 CFG，問一個 string 是否在 CFG 之中。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">S</span><br><span class="line">SABC</span><br><span class="line">ab</span><br><span class="line">S -&gt; AB</span><br><span class="line">S -&gt; BC</span><br><span class="line">A -&gt; BA</span><br><span class="line">A -&gt; a</span><br><span class="line">B -&gt; CC</span><br><span class="line">B -&gt; b</span><br><span class="line">C -&gt; AB</span><br><span class="line">C -&gt; a</span><br><span class="line"># -&gt; #</span><br><span class="line">baaba</span><br><span class="line">ab</span><br><span class="line">abaa</span><br><span class="line">a</span><br><span class="line">aaaaa</span><br><span class="line">bbbbb</span><br><span class="line">#</span><br><span class="line">S</span><br><span class="line">SAB</span><br><span class="line">ab</span><br><span class="line">S -&gt; AB</span><br><span class="line">A -&gt; AA</span><br><span class="line">A -&gt; a</span><br><span class="line">B -&gt; b</span><br><span class="line"># -&gt; #</span><br><span class="line">ab</span><br><span class="line">aaab</span><br><span class="line">aba</span><br><span class="line">baaaaaaaa</span><br><span class="line">abbbbbb</span><br><span class="line">aaaaaba</span><br><span class="line">baaaaaaaab</span><br><span class="line">aaaa</span><br><span class="line">a</span><br><span class="line">ab</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">baaba is in L(G)</span><br><span class="line">ab is in L(G)</span><br><span class="line">abaa is in L(G)</span><br><span class="line">a is not in L(G)</span><br><span class="line">aaaaa is in L(G)</span><br><span class="line">bbbbb is not in L(G)</span><br><span class="line"> </span><br><span class="line">ab is in L(G)</span><br><span class="line">aaab is in L(G)</span><br><span class="line">aba is not in L(G)</span><br><span class="line">baaaaaaaa is not in L(G)</span><br><span class="line">abbbbbb is not in L(G)</span><br><span class="line">aaaaaba is not in L(G)</span><br><span class="line">baaaaaaaab is not in L(G)</span><br><span class="line">aaaa is not in L(G)</span><br><span class="line">a is not in L(G)</span><br><span class="line">ab is in L(G)</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>因為 chomsky normal form 恰好劃分成兩個，定義字串 <code>dp[l][r]</code> 中可以解析出那些 nonterminal，藉由矩陣鍊乘積的方式，將其組合。最後檢查整個字串是否可以推回 start symbol。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> s1[<span class="number">1024</span>], s2[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s1) == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">char</span> start = s1[<span class="number">0</span>];</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%*s %*s&quot;</span>);</span><br><span class="line">        set&lt;<span class="keyword">char</span>&gt; re[<span class="number">128</span>];</span><br><span class="line">        set&lt;<span class="keyword">char</span>&gt; rule[<span class="number">128</span>][<span class="number">128</span>];</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%s -&gt; %s&quot;</span>, s1, s2) == <span class="number">2</span> &amp;&amp; s1[<span class="number">0</span>] != <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s2[<span class="number">1</span>] == <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">                re[s2[<span class="number">0</span>]].<span class="built_in">insert</span>(s1[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                rule[s2[<span class="number">0</span>]][s2[<span class="number">1</span>]].<span class="built_in">insert</span>(s1[<span class="number">0</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s1) == <span class="number">1</span> &amp;&amp; s1[<span class="number">0</span>] != <span class="string">&#x27;#&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s1);</span><br><span class="line">            set&lt;<span class="keyword">char</span>&gt; dp[<span class="number">64</span>][<span class="number">64</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">                dp[i][i].<span class="built_in">insert</span>(re[s1[i]].<span class="built_in">begin</span>(), re[s1[i]].<span class="built_in">end</span>());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; i + j &lt; n; j++) &#123;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; i+j; k++) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (set&lt;<span class="keyword">char</span>&gt;::iterator a = dp[j][k].<span class="built_in">begin</span>();</span><br><span class="line">                            a != dp[j][k].<span class="built_in">end</span>(); a++)</span><br><span class="line">                        <span class="keyword">for</span> (set&lt;<span class="keyword">char</span>&gt;::iterator b = dp[k+<span class="number">1</span>][i+j].<span class="built_in">begin</span>();</span><br><span class="line">                            b != dp[k+<span class="number">1</span>][i+j].<span class="built_in">end</span>(); b++)</span><br><span class="line">                            dp[j][i+j].<span class="built_in">insert</span>(rule[*a][*b].<span class="built_in">begin</span>(), rule[*a][*b].<span class="built_in">end</span>());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s is %sin L(G)\n&quot;</span>, s1, dp[<span class="number">0</span>][n<span class="number">-1</span>].<span class="built_in">find</span>(start) == dp[<span class="number">0</span>][n<span class="number">-1</span>].<span class="built_in">end</span>() </span><br><span class="line">                                        ? <span class="string">&quot;not &quot;</span> : <span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/geometry-hw1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/05/lesson/geometry-hw1/" class="article-date">
  <time datetime="2014-10-05T07:26:10.000Z" itemprop="datePublished">2014-10-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/計算幾何/">計算幾何</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/05/lesson/geometry-hw1/">計算幾何 - HW01</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/05/lesson/geometry-hw1/" data-id="ckpaivcai00cnn8vn7mughsk1" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/05/lesson/geometry-hw1/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/計算幾何/">計算幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h1 id="Chapter-1"><a href="#Chapter-1" class="headerlink" title="Chapter 1"></a>Chapter 1</h1><h2 id="1-1"><a href="#1-1" class="headerlink" title="1.1"></a>1.1</h2><p>The convex hull of a set S is defined to be the intersection of all convex sets that contain S. For the convex hull of a set of points it was indicated that the convex hull is the convex set with smallest perimeter. We want to show that these are equivalent definitions</p>
<p>a. Prove that the intersection of two convex sets is again convex. This implies that the intersection of a finite family of convex sets is convex as well.<br>b. Prove that the smallest perimeter polygon P containing a set of points P is convex.<br>c. Prove that any convex set containing the set of points P contains the smallest perimeter polygon P.</p>
<hr>
<p>a. 證明兩個凸包交集仍然是凸包<br>假設凸包分別為<span>$C1, C2$</span><!-- Has MathJax -->，題目所求<span>$C = C1 \bigcap C2$</span><!-- Has MathJax --><br>已知：A set<span>$K$</span><!-- Has MathJax --> is convex if each<span>$u \neq v$</span><!-- Has MathJax -->, the line-segment<span>$\bar{uv}$</span><!-- Has MathJax --> is contained in<span>$K$</span><!-- Has MathJax -->,<span>$\bar{uv}\subseteq K$</span><!-- Has MathJax --><br>假設<span>$C$</span><!-- Has MathJax --> 不是凸包，則存在<span>$\bar{uv} \nsubseteq C$</span><!-- Has MathJax -->，根據定義<span>$u, v \in C1, C2$</span><!-- Has MathJax -->，得到<span>$\bar{uv} \nsubseteq C1, C2$</span><!-- Has MathJax -->，矛盾得證<span>$C$</span><!-- Has MathJax --> 一定是凸包。</p>
<p>b. 證明最小周長的多邊形 P 包含所有點集 S 一定是凸包<br>假設<span>$P$</span><!-- Has MathJax --> 是最小周長的非凸包多邊形，令<span>$x, y \in P, and \bar{xy} \nsubseteq P$</span><!-- Has MathJax -->，則<span>$\bar{xy}$</span><!-- Has MathJax --> 會交<span>$P$</span><!-- Has MathJax --> 於至少兩點<span>$x&apos;, y&apos;$</span><!-- Has MathJax --><span>$P&apos;$</span><!-- Has MathJax --> 是將<span>$\bar{x^{&apos;}y^{&apos;}}$</span><!-- Has MathJax --> 連起所產生的新多邊形，顯然地<span>$P&apos;$</span><!-- Has MathJax --> 的周長更小。矛盾得證。</p>
<p>c. 證明任何一個凸多邊形 C 包含點集 S 的同時也一定會包含最小周長的多邊形 P。<br>假設有 vertex<span>$v \in P, but v \notin C$</span><!-- Has MathJax -->，同時 v 不會在 S 範圍中，因為 C 已經包含了 S<span>$v1, v2$</span><!-- Has MathJax --> 為<span>$C, P$</span><!-- Has MathJax --> 交點，則<span>$P&apos;$</span><!-- Has MathJax --> 是<span>$v1, v2$</span><!-- Has MathJax --> 相連產生的多邊形，則 P’ 藉由 (b) 一定是多邊形，v1 到 v2 的距離更短，找到一個周長更小的多邊形。矛盾得證。</p>
<h2 id="1-3"><a href="#1-3" class="headerlink" title="1.3"></a>1.3</h2><p>Let E be an unsorted set of n segments that are the edges of a convex polygon. Describe an O(nlogn) algorithm that computes from E a list containing all vertices of the polygon, sorted in clockwise order.</p>
<hr>
<p>Algorithm:</p>
<ol>
<li>得到所有點<span>${(x1, y1), (x2, y2), ..., (xn, yn)}$</span><!-- Has MathJax -->，並且附加是屬於哪兩個邊的端點對點作排序。<code>map&lt; point, vector&lt;seg&gt; &gt; R</code> - <code>O(n log n)</code></li>
<li>挑最左下的角當作<span>$(x1, y1)$</span><!-- Has MathJax --> 的其中一邊<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A[0] = (x0, y0) = R.begin().first;</span><br><span class="line">for (int i = 0; i &lt; E.size(); i++) &#123;</span><br><span class="line">    for (seg s : R[A[0]]) &#123;</span><br><span class="line">        if (s.p0 == A[i] &amp;&amp; (i == 0 || s.p1 != A[i-1]))</span><br><span class="line">            A[i+1] = s.p1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>檢查是否為順時針，否則反轉序列 - <code>O(n)</code></li>
</ol>
<h2 id="1-8"><a href="#1-8" class="headerlink" title="1.8"></a>1.8</h2><p>The O(nlogn) algorithm to compute the convex hull of a set of n points in the plane that was described in this chapter is based on the paradigm of incremental construction: add the points one by one, and update the convex hull after each addition. In this exercise we shall develop an algorithm based on another paradigm, namely divide-and-conquer.</p>
<p>a. Let P1 and P2 be two disjoint convex polygons with n vertices in total. Give an O(n) time algorithm that computes the convex hull of P1 ∪P2.<br>b. Use the algorithm from part a to develop an O(nlogn) time divide-andconquer algorithm to compute the convex hull of a set of n points in the plane.</p>
<hr>
<p>D&amp;C 的 <code>O(n log n)</code> 凸包算法</p>
<p>a. 將兩個沒有相交的凸包，用 <code>O(n)</code> 時間內合併凸包<span>$P1 \cup P2$</span><!-- Has MathJax -->。</p>
<p>假設兩個凸包儲存方式都是逆時針順序，並第一個節點為最左下的節點。<br>Algorithm:</p>
<ol>
<li>將最左側的凸包另為 P1，反之 P2。</li>
<li>代碼如下，找到下凸包 - <code>O(n)</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vector C</span><br><span class="line">C[m = 0] = P1[0]</span><br><span class="line">for (i = 1, j = 0; i &lt; P1.size(); i++) &#123;</span><br><span class="line">    if (m &gt;= 2 &amp;&amp; cross(C[m-1] - C[m-2], P2[j] - C[m-2]) &lt;= 0)</span><br><span class="line">        break;</span><br><span class="line">    C[m++] = P1[i]</span><br><span class="line">&#125;</span><br><span class="line">for (; j &lt; P2.size(); j++)</span><br><span class="line">    while (m &gt;= 2 &amp;&amp; cross(C[m-1] - C[m-2], P2[j] - C[m-2]) &lt;= 0)</span><br><span class="line">        m--;</span><br><span class="line">    C[m++] = P2[j];</span><br></pre></td></tr></table></figure></li>
<li>仿 <strong>2.</strong> 反過來作，找到上凸包 - <code>O(n)</code></li>
<li>上下凸包合併 - <code>O(n)</code></li>
</ol>
<p>b.<br>Algorithm:</p>
<ol>
<li>將所有點按照 x 做升排序 - <code>O(n log n)</code></li>
<li><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">convex DC(int l, int r, point p[]) &#123;</span><br><span class="line">    if (l == r)</span><br><span class="line">        return convex(p[l])</span><br><span class="line">    convex leftconvex = DC(l, (l + r)/2, p);</span><br><span class="line">    convex rightconvex = DC((l+r)/2 + 1, r, p);</span><br><span class="line">    return merge(leftconvex, rightconvex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>Prove<span>$T(n) = 2 T(n/2) + O(n)$</span><!-- Has MathJax -->,<br>by master theorem:<span>$a = 2, b = 2, c = 1, log_{a}b = c, \Rightarrow T(n) = \theta (n^{c} log n) = \theta (n log n)$</span><!-- Has MathJax --></p>
<hr>
<h1 id="Chapter-2"><a href="#Chapter-2" class="headerlink" title="Chapter 2"></a>Chapter 2</h1><h2 id="2-1"><a href="#2-1" class="headerlink" title="2.1"></a>2.1</h2><p>Let S be a set of n disjoint line segments whose upper endpoints lie on the line y=1 and whose lower endpoints lie on the line y=0. These segments partition the horizontal strip [−∞ : ∞]×[0 : 1] into n+1 regions. Give an O(nlogn) time algorithm to build a binary search tree on the segments in S such that the region containing a query point can be determined in O(logn) time. Also describe the query algorithm in detail.</p>
<hr>
<p><a href="http://zerojudge.tw/ShowProblem?problemid=b321">參閱實作 b321: 河道分界</a></p>
<p>Algorithm: (build)</p>
<ol>
<li>sort 線段 (根據上方的 (x, 1) 進行由小排到大 ) - <code>O(n log n)</code></li>
<li>靜態建造，動態建造請參閱可平衡的 BST。因為任切一條 y = k 的線，保證相交的 x 值得順序不會變 (跟排序結果的順序相比)，因此一開始挑 y = 1 來做排序依據。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root = dfs(0, n - 1, segments) - `O(n)`</span><br><span class="line">node dfs(int l, int r, segment segs[]) &#123;</span><br><span class="line">    if (l == r)</span><br><span class="line">        return new node(segs[l]);</span><br><span class="line">    else if (l &lt; r)</span><br><span class="line">        int mid = (l + r)/2;</span><br><span class="line">        node ret = new node(segs[mid]);</span><br><span class="line">        ret.lson = dfs(l, mid - 1, segs);</span><br><span class="line">        ret.rson = dfs(mid + 1, r, segs);</span><br><span class="line">        return ret;</span><br><span class="line">    else</span><br><span class="line">        return NULL;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p>Algorithm: (query)</p>
<ol>
<li>令 lbound = null, rbound = null</li>
<li>走訪 BST<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">void query(node u, point p) &#123;</span><br><span class="line">    if u == NULL</span><br><span class="line">        return;</span><br><span class="line">    if p leftside by u.seg</span><br><span class="line">        rbound = u</span><br><span class="line">        dfs(u.lson, p)</span><br><span class="line">    else</span><br><span class="line">        lbound = u</span><br><span class="line">        dfs(u.rson, p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>output <code>(lbound, rbound)</code></li>
</ol>
<h2 id="2-5"><a href="#2-5" class="headerlink" title="2.5"></a>2.5</h2><p>Which of the following equalities are always true?</p>
<span>$$(1) Twin(Twin(\vec{e})) = \vec{e} \\
(2) Next(Prev(\vec{e})) = \vec{e} \\
(3) Twin(Prev(Twin(\vec{e}))) = Next(\vec{e}) \\
(4) IncidentFace(\vec{e}) = IncidentFace(Next(\vec{e})) \\$$</span><!-- Has MathJax -->

<hr>
<p>(1)(2)(4) are always true. (3) may not be true.</p>
<h2 id="2-6"><a href="#2-6" class="headerlink" title="2.6"></a>2.6</h2><p>Give an example of a doubly-connected edge list where for an edge e the faces<span>$IncidentFace(\vec{e})$</span><!-- Has MathJax --> and<span>$IncidentFace(Twin(\vec{e}))$</span><!-- Has MathJax --> are the same.</p>
<hr>
<p>已知<span>$IncidentFace(\vec{e}) = IncidentFace(Next(\vec{e}))$</span><!-- Has MathJax --> always true，讓<span>$Next(\vec{e}) = Twin(\vec{e})$</span><!-- Has MathJax --> always true。</p>
<table>
<thead>
<tr>
<th>Half-edge</th>
<th>Orign</th>
<th>Twin</th>
<th>IncidentFace</th>
<th>Next</th>
<th>Prev</th>
</tr>
</thead>
<tbody><tr>
<td><span>$\vec{e_{1, 2}}$</span><!-- Has MathJax --></td>
<td><span>$v_{1}$</span><!-- Has MathJax --></td>
<td><span>$\vec{e_{2, 1}}$</span><!-- Has MathJax --></td>
<td>f1</td>
<td><span>$\vec{e_{2, 1}}$</span><!-- Has MathJax --></td>
<td><span>$\vec{e_{2, 1}}$</span><!-- Has MathJax --></td>
</tr>
<tr>
<td><span>$\vec{e_{2, 1}}$</span><!-- Has MathJax --></td>
<td><span>$v_{2}$</span><!-- Has MathJax --></td>
<td><span>$\vec{e_{1, 2}}$</span><!-- Has MathJax --></td>
<td>f1</td>
<td><span>$\vec{e_{1, 2}}$</span><!-- Has MathJax --></td>
<td><span>$\vec{e_{1, 2}}$</span><!-- Has MathJax --></td>
</tr>
</tbody></table>
<h2 id="2-14"><a href="#2-14" class="headerlink" title="2.14"></a>2.14</h2><p>Let S be a set of n disjoint line segments in the plane, and let p be a point not on any of the line segments of S. We wish to determine all line segments of S that p can see, that is, all line segments of S that contain some point q so that the open segment pq doesn’t intersect any p not visible line segment of S. Give an O(nlogn) time algorithm for this problem that uses a rotating half-line with its endpoint at p.</p>
<hr>
<p><a href="http://zerojudge.tw/ShowProblem?problemid=b325">參閱實作 b325: 人格分裂</a></p>
<p>Algorithm:</p>
<ol>
<li>對於所有的端點相對 p 做極角排序，並且知道相對應的角度上會存有那些線段的端點。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">map&lt;double, vector&lt;int, int&gt; &gt; angle;</span><br><span class="line">for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    double v1 = atan2(D[i].s.y - pos.y, D[i].s.x - pos.x);</span><br><span class="line">    double v2 = atan2(D[i].e.y - pos.y, D[i].e.x - pos.x);</span><br><span class="line">    angle[v1].push_back(make_pair(i, 0));</span><br><span class="line">    angle[v2].push_back(make_pair(i, 1));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>藉由出現的角度，使用極角掃描，一開始必須將碰的線段加入。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">double c;</span><br><span class="line">CMP::base = pos;</span><br><span class="line">double ftheta = angle.begin()-&gt;first;</span><br><span class="line">pair&lt;int, int&gt; u = angle.begin()-&gt;second[0];</span><br><span class="line">Pt fpt;</span><br><span class="line">if (u.second == 0)</span><br><span class="line">    fpt = D[u.first].s;</span><br><span class="line">else</span><br><span class="line">    fpt = D[u.first].e;</span><br><span class="line">for (int i = 0; i &lt; n; i++) &#123;</span><br><span class="line">    if (cross(pos, fpt, D[i].s) * cross(pos, fpt, D[i].e) &lt; 0)</span><br><span class="line">        S.insert(D[i]);</span><br><span class="line">&#125;</span><br><span class="line">CMP::sin = sin(ftheta);</span><br><span class="line">CMP::cos = cos(ftheta);</span><br><span class="line">for (map&lt;double, vector&lt; pair&lt;int, int&gt; &gt;, CMP2&gt;::iterator it = angle.begin();</span><br><span class="line">    it != angle.end(); it++) &#123;</span><br><span class="line">    CMP::sin = sin(it-&gt;first);</span><br><span class="line">    CMP::cos = cos(it-&gt;first);</span><br><span class="line">    for (int i = 0; i &lt; it-&gt;second.size(); i++) &#123;</span><br><span class="line">        pair&lt;int, int&gt; u = it-&gt;second[i];</span><br><span class="line">        if (u.second == 0)</span><br><span class="line">            c = cross(pos, D[u.first].s, D[u.first].e);</span><br><span class="line">        else</span><br><span class="line">            c = cross(pos, D[u.first].e, D[u.first].s);</span><br><span class="line">        if (fabs(c) &gt; eps) &#123;</span><br><span class="line">            if (c &gt; 0)</span><br><span class="line">                S.insert(D[u.first]);</span><br><span class="line">            else</span><br><span class="line">                S.erase(D[u.first]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    if (S.size()) &#123;</span><br><span class="line">        visual[S.begin()-&gt;label] = 1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="心得"><a href="#心得" class="headerlink" title="心得"></a>心得</h1><p>出題目，出題目，萌萌哒</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-mproblem-disaster" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/mproblem-disaster/" class="article-date">
  <time datetime="2014-10-03T07:20:35.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/出題解題/">出題解題</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="http://i.imgur.com/5VfY8zp.jpg" rel="gallery_ckpaivc7u0033n8vnghaqdrsg">
        <img src="http://i.imgur.com/5VfY8zp.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/mproblem-disaster/">[ACM 題目] 災難再臨</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/mproblem-disaster/" data-id="ckpaivc7u0033n8vnghaqdrsg" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/mproblem-disaster/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCA/">LCA</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <script type="text/javascript" src="http://scarky.com/widget/get/P28AP0HS/"></script>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>還記得那些年我們已經經歷的災難嗎？PTC201410D！ZJOI 2012 DAY2！如果不記得，接著請聽我捏造個故事。</p>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>危險種這一類的怪物，不斷地在村莊肆虐作亂，並且不斷地靠近帝國首都，艾斯德斯大人受令狩獵帝國周圍的危險種。</p>
<p>根據情報顯示，危險種移動的路徑預估為有向無環圖，牠們的數個巢穴坐落於地圖的末端 (也就是不會在有別的地點抵達這個地方)，而在首都前將有數個要塞，要塞正牠們的目標之地。為了阻止牠們到來，身為艾斯德斯大人的下屬，必須派軍隊前往危險種前往要塞的必經之地，即使抵達的位置無法阻止所有巢穴的危險種，但能對艾斯德斯大人貢獻一份心力便已足夠。</p>
<p>由於必經之地很多，好不容易在地圖上標記起來，卻又不知道哪個地點比較好 (可以阻止最多巢穴前往要塞)。正在困擾的同時，艾斯德斯大人已經將全部危險種給剷除了 …</p>
<p>「還沒一瞬間就將怪物解決，艾斯德斯大人啊！ <code>&lt;(_ _)&gt;</code>」</p>
<p>不過報告書還是得寫 …</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>輸入有多組測資。</p>
<p>每組測資第一行會有一個整數 N (N &lt; 32767)。</p>
<p>接下來會有 N 行，第 i 行上會有數個整數 x，直到 0 表示結束，表示有一條邊從 i 到 x。</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>對於每組測資，輸出可以埋伏地點以及埋伏的最佳收穫情況。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">0</span><br><span class="line">1 0</span><br><span class="line">1 0</span><br><span class="line">2 3 0</span><br><span class="line">2 0</span><br><span class="line"></span><br><span class="line">17</span><br><span class="line">10 13 0</span><br><span class="line">9 12 0</span><br><span class="line">9 14 11 0</span><br><span class="line">10 0</span><br><span class="line">12 0</span><br><span class="line">17 0</span><br><span class="line">0</span><br><span class="line">0</span><br><span class="line">13 14 0</span><br><span class="line">11 0</span><br><span class="line">15 0</span><br><span class="line">15 0</span><br><span class="line">16 0</span><br><span class="line">7 0</span><br><span class="line">16 0</span><br><span class="line">17 0</span><br><span class="line">8 0 </span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 1</span><br><span class="line">6 4</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12747" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-12747/" class="article-date">
  <time datetime="2014-10-03T00:56:27.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-12747/">UVa 12747 - Back to Edit Distance</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-12747/" data-id="ckpaivccf00k5n8vn4tl80dvq" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-12747/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LCS/">LCS</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LIS/">LIS</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>目標從起始序列經過操作變成目標序列。</p>
<ul>
<li>操作 1 : 任意替除掉一個元素。</li>
<li>操作 2 : 將元素插入到任意位置。</li>
</ul>
<p>請問最少次數為何</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">5</span><br><span class="line">1 3 5 4 2</span><br><span class="line">1 5 4 3 2</span><br><span class="line">4</span><br><span class="line">1 2 4 3</span><br><span class="line">3 4 2 1</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Case 1: 2</span><br><span class="line">Case 2: 6</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>很明顯地看出，任意插入就可以直接無視，只要找有最長共同子序列即可，剩餘的元素一次替除一次插入即可。</p>
<p>但是最長子序列在這一題無法使用 <code>O(n * n)</code> 的算法，因此將其轉換成 LIS 做法，由於元素恰好不重複，可以在 <code>O(n log n)</code> 完成 (轉換不造成元素增加)。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// LCS to LIS</span></span><br><span class="line"><span class="keyword">int</span> A[<span class="number">262144</span>], B[<span class="number">262144</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LIS</span><span class="params">(<span class="keyword">int</span> A[], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; r;</span><br><span class="line">    r.<span class="built_in">push_back</span>(A[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> pos = (<span class="keyword">int</span>)(<span class="built_in">upper_bound</span>(r.<span class="built_in">begin</span>(), r.<span class="built_in">end</span>(), A[i]) - r.<span class="built_in">begin</span>());</span><br><span class="line">        <span class="keyword">if</span> (pos == r.<span class="built_in">size</span>())</span><br><span class="line">            r.<span class="built_in">push_back</span>(A[i]);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r[pos] = A[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> r.<span class="built_in">size</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> n, x;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span> (testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            A[x] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            B[i] = A[x];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d: %d\n&quot;</span>, ++cases, (n - <span class="built_in">LIS</span>(B, n)) * <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">1 3 5 4 2</span></span><br><span class="line"><span class="comment">1 5 4 3 2</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">1 2 4 3</span></span><br><span class="line"><span class="comment">3 4 2 1</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12166" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-12166/" class="article-date">
  <time datetime="2014-10-03T00:41:08.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-12166/">UVa 12166 - Equilibrium Mobile</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-12166/" data-id="ckpaivcc000ifn8vn0kxrdidx" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-12166/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/adhoc/">adhoc</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一個天平表達式，請問至少要調整幾個權重才能使之平衡。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">[[3,7],6]</span><br><span class="line">40</span><br><span class="line">[[2,3],[4,5]]</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">0</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>恰好是一棵二元樹，那麼可以得知道假使一個權重不改，最後的天平重量為何。<br>假使 depth 上的權重 w 不改，則最後的天平重量就是 w * pow(2, depth)。</p>
<p>藉此，可以記錄所有最後的天平重量，得知最多有多少不改 = N - 最少改變個樹。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> exp[<span class="number">1048576</span>];</span><br><span class="line">map&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt; R;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> dep)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (exp[l] == <span class="string">&#x27;[&#x27;</span>) &#123;</span><br><span class="line">        <span class="keyword">int</span> p = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = l + <span class="number">1</span>; i &lt;= r - <span class="number">1</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (exp[i] == <span class="string">&#x27;[&#x27;</span>)	p++;</span><br><span class="line">            <span class="keyword">if</span> (exp[i] == <span class="string">&#x27;]&#x27;</span>)	p--;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">0</span> &amp;&amp; exp[i] == <span class="string">&#x27;,&#x27;</span>) &#123;</span><br><span class="line">                <span class="built_in">dfs</span>(l+<span class="number">1</span>, i<span class="number">-1</span>, dep+<span class="number">1</span>);</span><br><span class="line">                <span class="built_in">dfs</span>(i+<span class="number">1</span>, r<span class="number">-1</span>, dep+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> w;</span><br><span class="line">        exp[r+<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">        <span class="built_in">sscanf</span>(exp+l, <span class="string">&quot;%d&quot;</span>, &amp;w);</span><br><span class="line">        R[(<span class="keyword">long</span> <span class="keyword">long</span>)w&lt;&lt;dep]++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span> (testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, exp);</span><br><span class="line">        R.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="built_in">strlen</span>(exp) - <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>, mx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (map&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">int</span>&gt;::iterator it = R.<span class="built_in">begin</span>();</span><br><span class="line">            it != R.<span class="built_in">end</span>(); it++)</span><br><span class="line">            sum += it-&gt;second, mx = <span class="built_in">max</span>(mx, it-&gt;second);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, sum - mx);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">[[3,7],6]</span></span><br><span class="line"><span class="comment">40</span></span><br><span class="line"><span class="comment">[[2,3],[4,5]]</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11724" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-11724/" class="article-date">
  <time datetime="2014-10-03T00:23:46.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-11724/">UVa 11724 - Evaluate the Expression</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-11724/" data-id="ckpaivcbo00h2n8vndprgcli7" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-11724/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spfa/">spfa</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>每個變數皆為正整數，給定一個算術表達式和變數之間的大小關係，請問最少產生出來的答案為何。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">3</span><br><span class="line">a+b*c</span><br><span class="line">2</span><br><span class="line">a&gt;b</span><br><span class="line">c&gt;b</span><br><span class="line">z*(x+y)</span><br><span class="line">3</span><br><span class="line">z&gt;x</span><br><span class="line">x&gt;y</span><br><span class="line">z&gt;y</span><br><span class="line">a+b+c+a</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Case 1: 4</span><br><span class="line">Case 2: 9</span><br><span class="line">Case 3: 4</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>先使用 spfa 找到根據 greedy 策略分配的變數值，如果發生負環情況直接輸出 <code>-1</code>。</p>
<p>然後使用矩陣鏈乘積的 DP 方法進行找到最小答案。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> exp[<span class="number">1024</span>], cond[<span class="number">1024</span>];</span><br><span class="line"><span class="keyword">int</span> val[<span class="number">26</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">spfa</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; g[])</span> </span>&#123;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; Q;</span><br><span class="line">    <span class="keyword">int</span> inq[<span class="number">26</span>] = &#123;&#125;, dist[<span class="number">26</span>] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">int</span> cnt[<span class="number">26</span>] = &#123;&#125;;</span><br><span class="line">    <span class="keyword">int</span> u, v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;</span><br><span class="line">        Q.<span class="built_in">push</span>(i), dist[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (!Q.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        u = Q.<span class="built_in">front</span>(), Q.<span class="built_in">pop</span>();</span><br><span class="line">        inq[u] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            v = g[u][i];</span><br><span class="line">            <span class="keyword">if</span> (dist[v] &lt; dist[u] + <span class="number">1</span>) &#123;</span><br><span class="line">                dist[v] = dist[u] + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span> (!inq[v]) &#123;</span><br><span class="line">                    inq[v] = <span class="number">1</span>, Q.<span class="built_in">push</span>(v);</span><br><span class="line">                    <span class="keyword">if</span> (++cnt[v] &gt; <span class="number">26</span>)</span><br><span class="line">                        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">        val[i] = dist[i];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> used[<span class="number">512</span>][<span class="number">512</span>];</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">512</span>][<span class="number">512</span>];</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (used[l][r])</span><br><span class="line">        <span class="keyword">return</span> dp[l][r];</span><br><span class="line">    <span class="keyword">if</span> (l == r)</span><br><span class="line">        <span class="keyword">return</span> val[exp[l] - <span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    used[l][r] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> &amp;ret = dp[l][r];</span><br><span class="line">    ret = <span class="number">1LL</span>&lt;&lt;<span class="number">60</span>;</span><br><span class="line">    <span class="keyword">int</span> p = <span class="number">0</span>, test = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (exp[i] == <span class="string">&#x27;(&#x27;</span>)	p++;</span><br><span class="line">        <span class="keyword">if</span> (exp[i] == <span class="string">&#x27;)&#x27;</span>)	p--;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="number">0</span> &amp;&amp; exp[i] == <span class="string">&#x27;+&#x27;</span>) &#123;</span><br><span class="line">            ret = <span class="built_in">min</span>(ret, <span class="built_in">dfs</span>(l, i<span class="number">-1</span>) + <span class="built_in">dfs</span>(i+<span class="number">1</span>, r));</span><br><span class="line">            test++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="number">0</span> &amp;&amp; exp[i] == <span class="string">&#x27;*&#x27;</span>) &#123;</span><br><span class="line">            ret = <span class="built_in">min</span>(ret, <span class="built_in">dfs</span>(l, i<span class="number">-1</span>) * <span class="built_in">dfs</span>(i+<span class="number">1</span>, r));</span><br><span class="line">            test++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (test == <span class="number">0</span>)</span><br><span class="line">        ret = <span class="built_in">min</span>(ret, <span class="built_in">dfs</span>(l+<span class="number">1</span>, r<span class="number">-1</span>));</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span> (testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, exp);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; g[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, cond);</span><br><span class="line">            g[cond[<span class="number">2</span>]-<span class="string">&#x27;a&#x27;</span>].<span class="built_in">push_back</span>(cond[<span class="number">0</span>]-<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d: &quot;</span>, ++cases);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">spfa</span>(g)) &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(used));</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="built_in">strlen</span>(exp) - <span class="number">1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">a+b*c</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">a&gt;b</span></span><br><span class="line"><span class="comment">c&gt;b</span></span><br><span class="line"><span class="comment">z*(x+y)</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">z&gt;x</span></span><br><span class="line"><span class="comment">x&gt;y</span></span><br><span class="line"><span class="comment">z&gt;y</span></span><br><span class="line"><span class="comment">a+b+c+a</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-1045" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-1045/" class="article-date">
  <time datetime="2014-10-03T00:16:36.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-1045/">UVa 1045 - The Great Wall Game</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-1045/" data-id="ckpaivcb700ffn8vnflrd08xx" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-1045/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/KM算法/">KM算法</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>將棋子移動到可以形成萬里長城，也就是說移動到同一行、或同一列、或其一對角線上。</p>
<p>求移動得最少步數。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5                                                                </span><br><span class="line">1 2 2 4 3 4 5 1 5 3                                             </span><br><span class="line">2                                                                </span><br><span class="line">1 1 1 2                                                         </span><br><span class="line">3                                                                </span><br><span class="line">3 1 1 2 2 2                                                       </span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Board 1: 6 moves required.</span><br><span class="line">  </span><br><span class="line">Board 2: 0 moves required.</span><br><span class="line">  </span><br><span class="line">Board 3: 1 moves required.</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>窮舉要移動到哪裡，然後找完美匹配的最大權重 - KM 算法。</p>
<p>只要將移動步數弄成負權重套上去 KM 即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">KM</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> W[<span class="number">105</span>][<span class="number">105</span>], N;</span><br><span class="line">    <span class="keyword">int</span> mx[<span class="number">105</span>], my[<span class="number">105</span>]; <span class="comment">// match arr</span></span><br><span class="line">    <span class="keyword">int</span> lx[<span class="number">105</span>], ly[<span class="number">105</span>]; <span class="comment">// label arr</span></span><br><span class="line">    <span class="keyword">int</span> x[<span class="number">105</span>], y[<span class="number">105</span>]; <span class="comment">// used arr</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">hungary</span><span class="params">(<span class="keyword">int</span> nd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i;</span><br><span class="line">        x[nd] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(y[i] == <span class="number">0</span> &amp;&amp; W[nd][i] == lx[nd]+ly[i]) &#123;</span><br><span class="line">                y[i] = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">if</span>(my[i] == <span class="number">-1</span> || <span class="built_in">hungary</span>(my[i])) &#123;</span><br><span class="line">                    my[i] = nd;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, j, k, d;</span><br><span class="line">        <span class="built_in">memset</span>(mx, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(mx));</span><br><span class="line">        <span class="built_in">memset</span>(my, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(my));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">        	lx[i] = <span class="number">-0x3f3f3f3f</span>, ly[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; N; j++)</span><br><span class="line">                lx[i] = lx[i] &gt; W[i][j] ? lx[i] : W[i][j];</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">                <span class="built_in">memset</span>(x, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(x));</span><br><span class="line">                <span class="built_in">memset</span>(y, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(y));</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">hungary</span>(i))  <span class="keyword">break</span>;</span><br><span class="line">                d = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line">                <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(x[j]) &#123;</span><br><span class="line">                        <span class="keyword">for</span>(k = <span class="number">0</span>; k &lt; N; k++)</span><br><span class="line">                            <span class="keyword">if</span>(!y[k])</span><br><span class="line">                            d = d &lt; lx[j]+ly[k]-W[j][k] ?</span><br><span class="line">                                d : lx[j]+ly[k]-W[j][k];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(d == <span class="number">0x3f3f3f3f</span>)  <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; N; j++) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(x[j])    lx[j] -= d;</span><br><span class="line">                    <span class="keyword">if</span>(y[j])    ly[j] += d;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(my[i] != <span class="number">-1</span>)</span><br><span class="line">                res += W[my[i]][i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; km;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dist</span><span class="params">(<span class="keyword">int</span> x1, <span class="keyword">int</span> y1, <span class="keyword">int</span> x2, <span class="keyword">int</span> y2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span>(x1 - x2) + <span class="built_in">abs</span>(y1 - y2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> n, x[<span class="number">105</span>], y[<span class="number">105</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x[i], &amp;y[i]);</span><br><span class="line">        	x[i]--, y[i]--;</span><br><span class="line">        &#125;</span><br><span class="line">        km.N = n;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">-0x3f3f3f3f</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">        			km.W[j][k] = -<span class="built_in">dist</span>(x[j], y[j], i, k);</span><br><span class="line">        	ret = <span class="built_in">max</span>(ret, km.<span class="built_in">run</span>());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; n; k++)</span><br><span class="line">        			km.W[j][k] = -<span class="built_in">dist</span>(x[j], y[j], k, i);</span><br><span class="line">        	ret = <span class="built_in">max</span>(ret, km.<span class="built_in">run</span>());</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        		km.W[j][i] = -<span class="built_in">dist</span>(x[j], y[j], i, i);	</span><br><span class="line">    	&#125;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, km.<span class="built_in">run</span>());</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">        		km.W[j][i] = -<span class="built_in">dist</span>(x[j], y[j], i, n - i - <span class="number">1</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, km.<span class="built_in">run</span>());</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Board %d: %d moves required.\n\n&quot;</span>, ++cases, -ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12801" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-12801/" class="article-date">
  <time datetime="2014-10-03T00:06:32.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-12801/">UVa 12801 - Grandpa Pepe&#39;s Pizza</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-12801/" data-id="ckpaivcci00kkn8vncxh24j6v" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-12801/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/窮舉/">窮舉</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>現在 pizza 上有 m 個橄欖，請問是否能均分 m 塊，使得每一塊皆有一個橄欖。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">12 3</span><br><span class="line">2 8 11</span><br><span class="line">12 4</span><br><span class="line">4 5 7 11</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">S</span><br><span class="line">N</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>窮舉其中兩個相鄰橄欖中的所有分割點，檢查一下即可。</p>
<p>稍微估價一下，點多窮舉次樹就少，點少切割成功的機率就高，所以算法總不會太差。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, A[<span class="number">65536</span>];</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;A[i]);</span><br><span class="line">        A[m] = A[<span class="number">0</span>] + n;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>, div = n/m;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = A[<span class="number">0</span>]; i &lt; A[<span class="number">1</span>]; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> d = i, ok = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123;</span><br><span class="line"><span class="comment">//				printf(&quot;(%d %d] %d\n&quot;, d, d+div, A[j]);</span></span><br><span class="line">                <span class="keyword">if</span> (d &lt; A[j] &amp;&amp; A[j] &lt;= d + div)</span><br><span class="line">                    d += div;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    ok = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="comment">//			puts(&quot;&quot;);</span></span><br><span class="line">            <span class="keyword">if</span> (ok) &#123;</span><br><span class="line">                ret = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(ret ? <span class="string">&quot;S&quot;</span> : <span class="string">&quot;N&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">12 3</span></span><br><span class="line"><span class="comment">2 8 11</span></span><br><span class="line"><span class="comment">12 4</span></span><br><span class="line"><span class="comment">4 5 7 11</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12677" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/03/oj/uva/uva-12677/" class="article-date">
  <time datetime="2014-10-02T23:57:59.000Z" itemprop="datePublished">2014-10-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/03/oj/uva/uva-12677/">UVa 12677 - Join two kingdoms</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/03/oj/uva/uva-12677/" data-id="ckpaivccc00jvn8vn6m78942i" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/03/oj/uva/uva-12677/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/期望值/">期望值</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/樹/">樹</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/樹形dp/">樹形dp</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給兩棵樹，請問將兩個樹用一條邊連起來，則獲得新的一棵樹的最長路徑期望值為何。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">4 5</span><br><span class="line">1 2</span><br><span class="line">2 3</span><br><span class="line">4 2</span><br><span class="line">2 3</span><br><span class="line">3 4</span><br><span class="line">4 1</span><br><span class="line">4 5</span><br><span class="line"></span><br><span class="line">1 5</span><br><span class="line">1 2</span><br><span class="line">2 3</span><br><span class="line">3 4</span><br><span class="line">4 5</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">5.350</span><br><span class="line">4.400</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>利用 dp 方法，找到通過點 v 的 (以 v 為路徑端點)最長路徑為何，以及兩棵樹分別原有的最長路徑為何。</p>
<p>接著考量是否加入新一條會成為最長路徑，也就是說會通過新增加的邊。分別對每個樹的節點構成的最長路徑做排序，接著窮舉連接的點，用二分搜索找到另一個樹的節點，能夠使之成為更長的最長路徑。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> oo 0xfffffff</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; g[<span class="number">65536</span>];</span><br><span class="line"><span class="keyword">int</span> dp_down[<span class="number">65536</span>][<span class="number">2</span>], dp_up[<span class="number">65536</span>];</span><br><span class="line"><span class="keyword">int</span> used[<span class="number">65536</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</span><br><span class="line">    used[u] = <span class="number">1</span>;</span><br><span class="line">    dp_down[u][<span class="number">0</span>] = dp_down[u][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">    	<span class="keyword">int</span> v = g[u][i];</span><br><span class="line">        <span class="keyword">if</span>(used[v] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">dfs</span>(v);</span><br><span class="line">            <span class="keyword">if</span>(dp_down[v][<span class="number">0</span>]+<span class="number">1</span> &gt; dp_down[u][<span class="number">1</span>])</span><br><span class="line">                dp_down[u][<span class="number">1</span>] = dp_down[v][<span class="number">0</span>] + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(dp_down[u][<span class="number">1</span>] &gt; dp_down[u][<span class="number">0</span>])</span><br><span class="line">                <span class="built_in">swap</span>(dp_down[u][<span class="number">0</span>], dp_down[u][<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> dep)</span> </span>&#123;</span><br><span class="line">    dp_up[u] = dep, used[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">    	<span class="keyword">int</span> v = g[u][i];</span><br><span class="line">        <span class="keyword">if</span>(used[v] == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> hv;</span><br><span class="line">            <span class="keyword">if</span>(dp_down[v][<span class="number">0</span>] + <span class="number">1</span> != dp_down[u][<span class="number">0</span>])</span><br><span class="line">                hv = dp_down[u][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                hv = dp_down[u][<span class="number">1</span>];</span><br><span class="line">            hv = <span class="built_in">max</span>(hv, dp_up[u]);</span><br><span class="line">            <span class="built_in">dfs2</span>(v, hv+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">    	<span class="keyword">int</span> mxpath[<span class="number">2</span>][<span class="number">65636</span>];</span><br><span class="line">        <span class="keyword">int</span> a_diameter = <span class="number">0</span>, b_diameter = <span class="number">0</span>;</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</span><br><span class="line">    		g[i].<span class="built_in">clear</span>();</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">    		<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    		g[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">    		g[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(used));</span><br><span class="line">    	<span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    	<span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(used));</span><br><span class="line">    	<span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    		mxpath[<span class="number">0</span>][i] = <span class="built_in">max</span>(<span class="built_in">max</span>(dp_down[i][<span class="number">0</span>], dp_down[i][<span class="number">1</span>]), dp_up[i]);</span><br><span class="line">    		a_diameter = <span class="built_in">max</span>(a_diameter, dp_down[i][<span class="number">0</span>] + dp_down[i][<span class="number">1</span>]);</span><br><span class="line">    		a_diameter = <span class="built_in">max</span>(a_diameter, dp_down[i][<span class="number">0</span>] + dp_up[i]);</span><br><span class="line">    	&#125;</span><br><span class="line">    		</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= m; i++)</span><br><span class="line">    		g[i].<span class="built_in">clear</span>();</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">    		<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;x, &amp;y);</span><br><span class="line">    		g[x].<span class="built_in">push_back</span>(y);</span><br><span class="line">    		g[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(used));</span><br><span class="line">    	<span class="built_in">dfs</span>(<span class="number">1</span>);</span><br><span class="line">    	<span class="built_in">memset</span>(used, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(used));</span><br><span class="line">    	<span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= m; i++) &#123;</span><br><span class="line">    		mxpath[<span class="number">1</span>][i] = <span class="built_in">max</span>(<span class="built_in">max</span>(dp_down[i][<span class="number">0</span>], dp_down[i][<span class="number">1</span>]), dp_up[i]);</span><br><span class="line">    		b_diameter = <span class="built_in">max</span>(b_diameter, dp_down[i][<span class="number">0</span>] + dp_down[i][<span class="number">1</span>]);</span><br><span class="line">    		b_diameter = <span class="built_in">max</span>(b_diameter, dp_down[i][<span class="number">0</span>] + dp_up[i]);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">double</span> ret = <span class="number">0</span>, suffix[<span class="number">65536</span>] = &#123;&#125;;</span><br><span class="line">    	<span class="built_in">sort</span>(mxpath[<span class="number">0</span>]+<span class="number">1</span>, mxpath[<span class="number">0</span>]+<span class="number">1</span>+n);</span><br><span class="line">    	<span class="built_in">sort</span>(mxpath[<span class="number">1</span>]+<span class="number">1</span>, mxpath[<span class="number">1</span>]+<span class="number">1</span>+m);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    		suffix[i] = suffix[i+<span class="number">1</span>] + mxpath[<span class="number">1</span>][i];</span><br><span class="line">    	<span class="keyword">int</span> mx_diameter = <span class="built_in">max</span>(a_diameter, b_diameter);</span><br><span class="line">    	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = m; i &lt;= n; i++) &#123;</span><br><span class="line">    		<span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; mxpath[<span class="number">0</span>][i] + mxpath[<span class="number">1</span>][j] &gt;= mx_diameter)</span><br><span class="line">    			j--;</span><br><span class="line">    		ret += j * mx_diameter + (suffix[j + <span class="number">1</span>] + mxpath[<span class="number">0</span>][i] * (m - j) + m - j);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;%.3lf\n&quot;</span>, ret / n / m);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-mproblem-flere2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/10/02/mproblem-flere2/" class="article-date">
  <time datetime="2014-10-02T09:22:52.000Z" itemprop="datePublished">2014-10-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/出題解題/">出題解題</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/02/mproblem-flere2/">[ACM 題目] 學姊日談</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/10/02/mproblem-flere2/" data-id="ckpaivc7w003an8vnf6wf8xyv" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/10/02/mproblem-flere2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/樹鏈剖分/">樹鏈剖分</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <script type="text/javascript" src="http://scarky.com/widget/get/P8MBBT3Z/"></script>

<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>某 M 正與學姊討論蘿莉控追小海女的故事。</p>
<p>某 M 喃喃自語 …<br>『用了暴力法來完成的話，就能在調整 O(1) - O(E[x]) 完成。』<br>『如果用一個最常見的樹鏈剖分來完成也不過是 O(log n) - O(log^2 n)』<br>『在一般情況下，詢問次數肯定比調整次數來得高，想一想常數還得加上去，完全贏不了啊。』</p>
<p>學姊在一旁說到<br>『那如果是單純的二元樹，有比較好做嗎？說不定有更簡化的算法來完成？』<br>『說不定那個 … bitvertor 還是 bitset 能完成呢。』<br>『這個想法難不成是找到 lowbit 嗎？我沒有暫時想法。』某 M 這麼回答道。<br>『也許吧 … 我也不確定』學姊簇著眉。</p>
<p>某 M 發了瘋似的想了一個算法<br>『如果我們將其轉換成 k-ary search tree，也就是說需要將節點編號重新編成有大小關係，然後維護一個 BST 來查找 lower_bound 的結果，這麼一來就是 O(k log n) - O(log n) 了！』<br>『啊啊啊，這個方法不可行，』<br>學姊將鄙視般的眼神投向某 M。看來這場病還要持續很久。</p>
<p>『將題目弄成找樹前綴和好了，既然暴力法有期望值的剪枝，讓它剪不了不就好了！』<br>『你覺得不會被其他解法坑殺嗎 …』學姊如此擔憂地表示到。<br>『沒關係，吾等 M 可不是說假的』</p>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>給定一棵樹，樹根 root 編號 0，每個點一開始的權重為 0。</p>
<p>操作 x k: 將節點 x 的權重增加 k，請輸出從 x 到 root 的權重和。</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>輸入有多組測資，每組測資第一行會有一個整數 N (N &lt; 32767)，表示這棵樹有多少個節點。</p>
<p>接下來會有 N - 1 行，每一行上會有兩個整數 u, v (0 &lt;= u, v &lt; N) 表示 u, v 之間有一條邊。</p>
<p>接下來會有一行上有一個整數 Q (Q &lt; 32767)，表示接下來有 M 組詢問。</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>對於每個詢問結果輸出一行，請參照範例輸出的說明。</p>
<p>每組測資後空一行。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">0 1</span><br><span class="line">0 2</span><br><span class="line">1 3</span><br><span class="line">0 4</span><br><span class="line">3 5</span><br><span class="line">4 6</span><br><span class="line">5 7</span><br><span class="line">5 8</span><br><span class="line">4 9</span><br><span class="line">5</span><br><span class="line">1 1</span><br><span class="line">5 2</span><br><span class="line">3 0</span><br><span class="line">0 4</span><br><span class="line">4 8</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">3</span><br><span class="line">1</span><br><span class="line">4</span><br><span class="line">12</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p>名為 “學姊”。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/57/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/56/">56</a><a class="page-number" href="/page/57/">57</a><span class="page-number current">58</span><a class="page-number" href="/page/59/">59</a><a class="page-number" href="/page/60/">60</a><span class="space">&hellip;</span><a class="page-number" href="/page/85/">85</a><a class="extend next" rel="next" href="/page/59/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">30</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-handover/">
              
                <i class="icon-file-o"></i> 
              
            Handover</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-interview-recursion/">
              
                <i class="icon-file-o"></i> 
              
            Interview &amp; Recursion</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-job-build/">
              
                <i class="icon-file-o"></i> 
              
            Job Build</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-lang/">
              
                <i class="icon-file-o"></i> 
              
            Programming Language Impostors</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-machine-learning-newbie/">
              
                <i class="icon-file-o"></i> 
              
            Machine Learning for Newbie</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-parallel-gc/">
              
                <i class="icon-file-o"></i> 
              
            Parallel &amp; Garbage Collection</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>