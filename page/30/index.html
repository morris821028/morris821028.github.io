<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/page/30/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-uva-1398" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-1398/" class="article-date">
  <time datetime="2015-04-27T00:32:24.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-1398/">UVa 1398 - Meteor</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-1398/" data-id="ckkj23n1o00u0n0vr23tsxd9g" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-1398/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/掃描線/">掃描線</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>進行天文觀測，天空上有 n 個流星，以及拍攝的區域。</p>
<p>給定每一個流星的起始位置與速度，請問在哪一個時刻可以拍到最多顆流星在拍攝區域內部。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">2 </div><div class="line">4 2 </div><div class="line">2 </div><div class="line">-1 1 1 -1 </div><div class="line">5 2 -1 -1 </div><div class="line">13 6 </div><div class="line">7 </div><div class="line">3 -2 1 3 </div><div class="line">6 9 -2 -1 </div><div class="line">8 0 -1 -1 </div><div class="line">7 6 10 0 </div><div class="line">11 -2 2 1 </div><div class="line">-2 4 6 -1 </div><div class="line">3 2 -5 -1</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">1 </div><div class="line">2</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>將每一個流星進入和離開拍攝區域的時間求出，並且組合成 (enter_time, 1), (leave_time, -1) 的方式，根據時間由小排到大，利用掃描線算法統計累計的最大值即可。</p>
<p>求流星進出區域的時間，可以將 x, y 座標分開考慮，對進入時間取最大值、離開時間取最小值。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// sweep line algorithm</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> LCM = <span class="number">2520</span>; <span class="comment">// gcd(1, 2, 3, ..., 10) = 2520, /vx, /vy, vx, vy &lt;= 10</span></div><div class="line"><span class="keyword">int</span> W, H;</div><div class="line">pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; getTime(<span class="keyword">int</span> sx, <span class="keyword">int</span> sy, <span class="keyword">int</span> vx, <span class="keyword">int</span> vy) &#123;</div><div class="line">    <span class="keyword">int</span> enter = <span class="number">0</span>, leave = INF;</div><div class="line">    <span class="keyword">if</span> (vx == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (sx &lt;= <span class="number">0</span> || sx &gt;= W)</div><div class="line">            leave = <span class="number">0</span>;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vx &lt; <span class="number">0</span>) &#123;</div><div class="line">        enter = max(enter, (sx - W) * LCM / (-vx));</div><div class="line">        leave = min(leave, (sx - <span class="number">0</span>) * LCM / (-vx));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        enter = max(enter, (<span class="number">0</span> - sx) * LCM / (vx));</div><div class="line">        leave = min(leave, (W - sx) * LCM / (vx));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (vy == <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span> (sy &lt;= <span class="number">0</span> || sy &gt;= H)</div><div class="line">            leave = <span class="number">0</span>; </div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vy &lt; <span class="number">0</span>) &#123;</div><div class="line">        enter = max(enter, (sy - H) * LCM / (-vy));</div><div class="line">        leave = min(leave, (sy - <span class="number">0</span>) * LCM / (-vy));</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        enter = max(enter, (<span class="number">0</span> - sy) * LCM / (vy));</div><div class="line">        leave = min(leave, (H - sy) * LCM / (vy));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> make_pair(enter, leave);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, N;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;W, &amp;H);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N);</div><div class="line">        </div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; D;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">int</span> sx, sy, vx, vy;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d %d %d"</span>, &amp;sx, &amp;sy, &amp;vx, &amp;vy);</div><div class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; t = getTime(sx, sy, vx, vy);</div><div class="line">            <span class="keyword">if</span> (t.first &lt; t.second) &#123;</div><div class="line">                D.push_back(make_pair(t.first, <span class="number">1</span>));</div><div class="line">                D.push_back(make_pair(t.second, <span class="number">-1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        sort(D.begin(), D.end());</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, s = <span class="number">0</span>; i &lt; D.size(); i++) &#123;</div><div class="line">            s += D[i].second;</div><div class="line">            ret = max(ret, s);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1342" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-1342/" class="article-date">
  <time datetime="2015-04-27T00:24:36.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-1342/">UVa 1342 - That Nice Euler Circuit</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-1342/" data-id="ckkj23n1700thn0vrg9x5k7ja" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-1342/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/尤拉公式/">尤拉公式</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/線段交/">線段交</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/計算幾何/">計算幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>一筆畫完成一個簡單多邊形，請問有多少個區域。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">5</div><div class="line">0 0 0 1 1 1 1 0 0 0 </div><div class="line">7 </div><div class="line">1 1 1 5 2 1 2 5 5 1 3 5 1 1 </div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Case 1: There are 2 pieces. </div><div class="line">Case 2: There are 5 pieces.</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>利用尤拉公式<span>$V - E + F = 2$</span><!-- Has MathJax --> 來完成，藉由線段交找到所有頂點集合，去除掉重複點後，檢查邊的數量，如此一來就可以找到面的數量。</p>
<p>特別小心共線計算。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Euler characteristic, V - E + F = 2</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-8</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pt</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    Pt(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</div><div class="line">    	x(a), y(b) &#123;&#125;	</div><div class="line">    Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x - a.x, y - a.y);</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>+(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x + a.x, y + a.y);</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> Pt(x * a, y * a);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">    	<span class="keyword">return</span> <span class="built_in">fabs</span>(x - a.x) &lt; eps &amp;&amp; <span class="built_in">fabs</span>(y - a.y) &lt; eps;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">    	<span class="keyword">return</span> !(a == *<span class="keyword">this</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(x - a.x) &gt; eps)</div><div class="line">            <span class="keyword">return</span> x &lt; a.x;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(y - a.y) &gt; eps)</div><div class="line">            <span class="keyword">return</span> y &lt; a.y;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> hypot(x, y);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;x, &amp;y);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmpZero</span><span class="params">(<span class="keyword">double</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(v) &gt; eps) <span class="keyword">return</span> v &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.x + a.y * b.y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Pt o, Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y)-(a.y-o.y)*(b.x-o.x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.y - a.y * b.x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">between</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> dot(c - a, b - a) &gt;= -eps &amp;&amp; dot(c - b, a - b) &gt;= -eps;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">onSeg</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> between(a, b, c) &amp;&amp; <span class="built_in">fabs</span>(cross(a, b, c)) &lt; eps;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Seg</span> &#123;</span></div><div class="line">    Pt s, e;</div><div class="line">    <span class="keyword">int</span> label;</div><div class="line">    Seg(Pt a = Pt(), Pt b = Pt(), <span class="keyword">int</span> l=<span class="number">0</span>): s(a), e(b), label(l) &#123;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> Seg &amp;other) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> !((s == other.s &amp;&amp; e == other.e) || (e == other.s &amp;&amp; s == other.e));</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">intersection</span><span class="params">(Pt as, Pt at, Pt bs, Pt bt)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (cmpZero(cross(as, at, bs) * cross(as, at, bt)) &lt; <span class="number">0</span> &amp;&amp;</div><div class="line">        cmpZero(cross(bs, bt, as) * cross(bs, bt, at)) &lt; <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function">Pt <span class="title">getIntersect</span><span class="params">(Seg a, Seg b)</span> </span>&#123;</div><div class="line">    Pt u = a.s - b.s;</div><div class="line">    <span class="keyword">double</span> t = cross2(b.e - b.s, u)/cross2(a.e - a.s, b.e - b.s);</div><div class="line">    <span class="keyword">return</span> a.s + (a.e - a.s) * t;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">getAngle</span><span class="params">(Pt va, Pt vb)</span> </span>&#123; <span class="comment">// segment, not vector</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">acos</span>(dot(va, vb) / va.length() / vb.length());</div><div class="line">&#125;</div><div class="line"><span class="function">Pt <span class="title">rotateRadian</span><span class="params">(Pt a, <span class="keyword">double</span> radian)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    x = a.x * <span class="built_in">cos</span>(radian) - a.y * <span class="built_in">sin</span>(radian);</div><div class="line">    y = a.x * <span class="built_in">sin</span>(radian) + a.y * <span class="built_in">cos</span>(radian);</div><div class="line">    <span class="keyword">return</span> Pt(x, y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inPolygon</span><span class="params">(<span class="built_in">vector</span>&lt;Pt&gt; &amp;p, Pt q)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> i, j, cnt = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n = p.size();</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, j = n<span class="number">-1</span>; i &lt; n; j = i++) &#123;</div><div class="line">        <span class="keyword">if</span>(onSeg(p[i], p[j], q))</div><div class="line">            <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span>(p[i].y &gt; q.y != p[j].y &gt; q.y &amp;&amp;</div><div class="line">        q.x &lt; (p[j].x-p[i].x)*(q.y-p[i].y)/(p[j].y-p[i].y) + p[i].x)</div><div class="line">        cnt++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> cnt&amp;<span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">polygonArea</span><span class="params">(<span class="built_in">vector</span>&lt;Pt&gt; &amp;p)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> area = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n = p.size();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n;i++)</div><div class="line">        area += p[i].x * p[(i+<span class="number">1</span>)%n].y - p[i].y * p[(i+<span class="number">1</span>)%n].x;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(area) /<span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Pt <span class="title">projectLine</span><span class="params">(Pt as, Pt ae, Pt p)</span> </span>&#123;</div><div class="line">    <span class="keyword">double</span> a, b, c, v;</div><div class="line">    a = as.y - ae.y, b = ae.x - as.x;</div><div class="line">    c = - (a * as.x + b * as.y);</div><div class="line">    v = a * p.x + b * p.y + c;</div><div class="line">    <span class="keyword">return</span> Pt(p.x - v*a / (a*a+b*b), p.y - v*b/ (a*a+b*b));</div><div class="line">&#125;</div><div class="line"><span class="comment">// maybe collinear !!!!!!!!</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">305</span>;</div><div class="line">    <span class="keyword">int</span> n, cases = <span class="number">0</span>;</div><div class="line">    Pt D[MAXN];</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;		</div><div class="line">        <span class="keyword">int</span> V = <span class="number">0</span>, E = <span class="number">0</span>; </div><div class="line">        <span class="built_in">vector</span>&lt;Pt&gt; SV;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            D[i].read(), SV.push_back(D[i]);</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i+<span class="number">1</span> &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j+<span class="number">1</span> &lt; n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (intersection(D[i], D[i+<span class="number">1</span>], D[j], D[j+<span class="number">1</span>])) &#123;</div><div class="line">                    Pt p = getIntersect(Seg(D[i], D[i+<span class="number">1</span>]), Seg(D[j], D[j+<span class="number">1</span>]));</div><div class="line">                    SV.push_back(p);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        sort(SV.begin(), SV.end());</div><div class="line">        SV.resize(unique(SV.begin(), SV.end()) - SV.begin());</div><div class="line">        V = SV.size(), E = n - <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; SV.size(); i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j+<span class="number">1</span> &lt; n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (onSeg(D[j], D[j+<span class="number">1</span>], SV[i]) &amp;&amp; SV[i] != D[j] &amp;&amp; SV[i] != D[j+<span class="number">1</span>])</div><div class="line">                    E++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"><span class="comment">//		printf("%d %d\n", E, V);</span></div><div class="line">        <span class="keyword">int</span> ret = E - V + <span class="number">2</span>; <span class="comment">// V - E + F = 2, F = E - V + 2</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: There are %d pieces.\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">7 </span></div><div class="line"><span class="comment">1 1 1 5 2 1 2 5 5 1 3 5 1 1 </span></div><div class="line"><span class="comment">0</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1326" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-1326/" class="article-date">
  <time datetime="2015-04-27T00:10:38.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-1326/">UVa 1326 - Jurassic Remains</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-1326/" data-id="ckkj23n0x00t2n0vr896uetys" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-1326/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/D-C/">D&C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bitmask/">bitmask</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/中間相遇法/">中間相遇法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分治/">分治</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>博物館對於骨頭化石進行拼湊作業，每一個骨頭上用 A - Z 去標記。兩片骨頭可以連接則表示具有相同的英文字母。</p>
<p>現在有數組骨頭，上面會有數個街口。現在找一組骨頭集合，使得每一個接口都有其連接的對象，盡可能使集合越大越好。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">6</div><div class="line">ABD</div><div class="line">EG</div><div class="line">GE</div><div class="line">ABE</div><div class="line">AC</div><div class="line">BCD</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">5</div><div class="line">1 2 3 5 6</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>題目相當於問找一個集合，使得每一個字母數量出現偶數次。</p>
<p>由於 N = 24，這個數量使用<span>$O(2^{24})$</span><!-- Has MathJax --> 相當消耗時間。使用中間相遇法 (在密碼學中可以見到，有點雙向 Bfs 的味道)，也就是分治算法的概念，將問題對切，從兩個統計結果中找交集。算法降至<span>$O(2^{12} \times 12)$</span><!-- Has MathJax --></p>
<p>考慮前 N/2 個骨頭 A、後 N/2 個骨頭 B，分別找到在字母集出現狀態為 S 的最佳解 A1, B1，若將兩個相同狀態組合<span>$S \text{ XOR } S = 0$</span><!-- Has MathJax --> 符合出現偶數次的條件。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">char</span> s[<span class="number">128</span>];</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> mask[<span class="number">32</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">            <span class="keyword">int</span> x = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; s[j]; j++)</div><div class="line">                x ^= (<span class="number">1</span>&lt;&lt;(s[j] - <span class="string">'A'</span>)); </div><div class="line">            mask[i] = x;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// D&amp;C, dp, bitmask</span></div><div class="line">        <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; dp1, dp2;</div><div class="line">        <span class="keyword">int</span> div1 = n/<span class="number">2</span>, div2 = n - n/<span class="number">2</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span>&lt;&lt;div1); i++) &#123;</div><div class="line">            <span class="keyword">int</span> x = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; div1; j++) &#123;</div><div class="line">                <span class="keyword">if</span> ((i&gt;&gt;j)&amp;<span class="number">1</span>)</div><div class="line">                    x ^= mask[j];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (dp1.count(x) || __builtin_popcount(dp1[x]) &lt; __builtin_popcount(i))</div><div class="line">                dp1[x] = i;			</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span>&lt;&lt;div2); i++) &#123;</div><div class="line">            <span class="keyword">int</span> x = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; div2; j++) &#123;</div><div class="line">                <span class="keyword">if</span> ((i&gt;&gt;j)&amp;<span class="number">1</span>)</div><div class="line">                    x ^= mask[j + div1];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (dp2.count(x) || __builtin_popcount(dp2[x]) &lt; __builtin_popcount(i))</div><div class="line">                dp2[x] = i;			</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> retCnt = <span class="number">0</span>, retMask = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;::iterator it = dp1.begin();</div><div class="line">            it != dp1.end(); it++) &#123;</div><div class="line">            <span class="keyword">if</span> (dp2.count(it-&gt;first)) &#123;</div><div class="line">                <span class="keyword">int</span> x = it-&gt;second | ((dp2[it-&gt;first]) &lt;&lt; div1);</div><div class="line">                <span class="keyword">if</span> (__builtin_popcount(x) &gt; retCnt) &#123;</div><div class="line">                    retCnt = __builtin_popcount(x);</div><div class="line">                    retMask = x;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, retCnt);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, f = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span> ((retMask&gt;&gt;i)&amp;<span class="number">1</span>) &#123;</div><div class="line">                <span class="keyword">if</span> (f)	<span class="built_in">putchar</span>(<span class="string">' '</span>);</div><div class="line">                f = <span class="number">1</span>;</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d"</span>, i+<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-1105" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-1105/" class="article-date">
  <time datetime="2015-04-27T00:02:41.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-1105/">UVa 1105 - Coffee Central</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-1105/" data-id="ckkj23muu00kyn0vrhn1t0tiq" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-1105/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/座標轉換/">座標轉換</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一個網格狀的地圖，每一個地點都有其相對應的人數，現在要建造一個咖啡廳，而咖啡廳所在位置可以引來在曼哈頓距離為 m 以內的所有網格上的人數。</p>
<p>對於每一組詢問，回報咖啡廳應該建在哪裡可以引來最多的人。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">4 4 5 3</div><div class="line">1 1</div><div class="line">1 2</div><div class="line">3 3</div><div class="line">4 4</div><div class="line">2 4</div><div class="line">1</div><div class="line">2 </div><div class="line">4</div><div class="line">0 0 0 0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Case 1:</div><div class="line">3 (3,4)</div><div class="line">4 (2,2)</div><div class="line">5 (3,1)</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>由於單一組詢問數量不到 20，想必可以使用 O(n^2) 去應付每一組詢問。</p>
<p>窮舉每一個可能的位置，並且去計算該位置能引來多少的人。為了加速統計人數，曼哈頓距離內，是一個 45 度的正方形，紀錄上非常不方便。利用旋轉矩陣，將整個平面紀錄轉 45 度，讓每一次的區域統計變成平行於兩軸的區域，如此一來就可以在 O(1) 時間內找到區域總和。</p>
<p>特別小心答案為人數 0 時，答案輸出的座標。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2048</span>;</div><div class="line"><span class="keyword">int</span> sum[MAXN][MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> &amp;tx, <span class="keyword">int</span> &amp;ty, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</div><div class="line">    tx = x - y + dy, ty = x + y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> limit, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>, ret_x = <span class="number">1</span>, ret_y = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> tx, ty;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= dy; j++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dx; i++) &#123;</div><div class="line">            rotate(i, j, tx, ty, dx, dy);</div><div class="line">            <span class="keyword">int</span> lx, rx, ly, ry, cnt;</div><div class="line">            lx = max(tx - limit, <span class="number">1</span>);</div><div class="line">            ly = max(ty - limit, <span class="number">1</span>);</div><div class="line">            rx = min(tx + limit, dx + dy);</div><div class="line">            ry = min(ty + limit, dx + dy);</div><div class="line">            cnt = sum[rx][ry] - sum[rx][ly<span class="number">-1</span>] - sum[lx<span class="number">-1</span>][ry] + sum[lx<span class="number">-1</span>][ly<span class="number">-1</span>];</div><div class="line">            <span class="keyword">if</span> (cnt &gt; ret) &#123;</div><div class="line">                ret = cnt, ret_x = i, ret_y = j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d (%d,%d)\n"</span>, ret, ret_x, ret_y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> dx, dy, n, q;</div><div class="line">    <span class="keyword">int</span> x, y, tx, ty, limit, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d %d %d"</span>, &amp;dx, &amp;dy, &amp;n, &amp;q) == <span class="number">4</span> &amp;&amp; dx) &#123;</div><div class="line">        <span class="comment">// rotate matrix, rotate 45 degree</span></div><div class="line"><span class="comment">//		for (int i = 1; i &lt;= dx; i++) &#123;</span></div><div class="line"><span class="comment">//			for (int j = 1; j &lt;= dy; j++) &#123;</span></div><div class="line"><span class="comment">//				printf("(%d %d) -&gt; (%d %d)\n", i, j, i - j + dy, i + j);</span></div><div class="line"><span class="comment">//			&#125; </span></div><div class="line"><span class="comment">//		&#125;</span></div><div class="line"></div><div class="line">        <span class="built_in">memset</span>(sum, <span class="number">0</span>, <span class="keyword">sizeof</span>(sum));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            rotate(x, y, tx, ty, dx, dy);</div><div class="line">            sum[tx][ty]++;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dx + dy; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>, s = <span class="number">0</span>; j &lt;= dx + dy; j++) &#123;</div><div class="line">                s += sum[i][j];</div><div class="line">                sum[i][j] = sum[i<span class="number">-1</span>][j] + s;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d:\n"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;limit);</div><div class="line">            query(limit, dx, dy);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-10476" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-10476/" class="article-date">
  <time datetime="2015-04-26T23:48:51.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-10476/">UVa 10476 - Spam or Not Spam</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-10476/" data-id="ckkj23mt700imn0vrmk5uz1d6" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-10476/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/NLP/">NLP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/n-gram/">n-gram</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shingle/">shingle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/自然語言/">自然語言</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>判斷訊息是否為垃圾訊息。</p>
<p>給數組垃圾訊息、非垃圾訊息，從中統計語言的出現頻率。例如 <code>ABCDEFG</code> 取 k-shingle 中 k = 3，那麼總共出現 <code>ABC</code>、<code>BCD</code>、<code>CDE</code>、<code>DEF</code> … 等。</p>
<p>接著按照題目給定的公式，計算輸入的訊息離垃圾訊息比較接近、還是非垃圾訊息。</p>
<blockquote>
<p>n-gram 通常指的是以單詞 (word) 為切割單位，而 k-shingle 則是以字符 (char) 為切割單位。在巨量資料的開放課程中，以 shingle 去描述這樣的切割方式。</p>
</blockquote>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">2 1 1</div><div class="line">AAAA</div><div class="line">BBBB CCCC</div><div class="line">ENDMESSAGE</div><div class="line">BBBB</div><div class="line">ENDMESSAGE</div><div class="line">AAAABBBB</div><div class="line">ENDMESSAGE</div><div class="line">AAABB</div><div class="line">ENDMESSAGE</div><div class="line">2 1 2</div><div class="line">AAAA</div><div class="line">BBBB CCCC</div><div class="line">ENDMESSAGE</div><div class="line">BBBB</div><div class="line">ENDMESSAGE</div><div class="line">AAAABBBB</div><div class="line">ENDMESSAGE</div><div class="line">AAABB</div><div class="line">ENDMESSAGE</div><div class="line">AAABB</div><div class="line">ENDMESSAGE</div><div class="line">0 0 0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Set 1:</div><div class="line">0.21822 0.73030</div><div class="line">non-spam</div><div class="line">Set 2:</div><div class="line">0.21822 0.73030</div><div class="line">non-spam</div><div class="line">0.21822 0.73030</div><div class="line">non-spam</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>相當有趣的題目，終於把自然語言學習到的部分拿出來玩。但可惜題目沒有巨量資料那樣瘋狂，用 hash 去失真的操作，由於記憶體不夠，用 1-pass/2-pass 找 frequent items 之類的。</p>
<p>為了加速運算，改成 hash 會比較快，但只要一碰撞輸出機率時就會炸掉，所以還是別貿然嘗試。</p>
<p>特別用了 <code>std::inner_product</code> 來寫中間的數學運算，但仔細想想如果是兩個 <code>std::map</code> 要進行 <code>std::inner_product()</code> 仍然會因為元素不見得都會在兩個的 <code>key set</code> 而無法運作。<code>std::inner_product</code> 內建實作中只有單純的迭代，用在 vector 類型比較合適。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// NLP, n-gram, shingle</span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;numeric&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">map_product</span><span class="params">(pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; l, pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; r)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> l.second * r.second;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Stat</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> kShingle;</div><div class="line">    <span class="keyword">int</span> sqsum;</div><div class="line">    <span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; count;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">        kShingle = k, sqsum = <span class="number">0</span>;</div><div class="line">        count.clear();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="built_in">string</span> <span class="title">toKey</span><span class="params">(<span class="built_in">string</span> &amp;s)</span> </span>&#123; <span class="comment">// retain for hash function</span></div><div class="line">        <span class="keyword">return</span> s;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">char</span> s[])</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'\0'</span> || s[<span class="number">1</span>] == <span class="string">'\0'</span>)	</div><div class="line">            <span class="keyword">return</span>;</div><div class="line">        <span class="keyword">char</span> end = <span class="string">'\0'</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; s[i]; i++) &#123;</div><div class="line">            swap(s[i+<span class="number">1</span>], end);</div><div class="line">            <span class="built_in">string</span> shingle = s+i<span class="number">-2</span>;</div><div class="line">            swap(s[i+<span class="number">1</span>], end);</div><div class="line">            count[toKey(shingle)] ++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> </span>&#123;</div><div class="line">        sqsum = inner_product(count.begin(), count.end(), count.begin(), <span class="number">0</span>,</div><div class="line">           plus&lt;<span class="keyword">int</span>&gt;(), map_product);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">double</span> <span class="title">distance</span><span class="params">(Stat &amp;other)</span> </span>&#123;</div><div class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt;::iterator it = count.begin(), jt;</div><div class="line">            it != count.end(); it++) &#123;</div><div class="line">            jt = other.count.find(it-&gt;first);</div><div class="line">            <span class="keyword">if</span> (jt != other.count.end()) &#123;</div><div class="line">                sum += it-&gt;second * jt-&gt;second;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> (<span class="keyword">double</span>) sum / <span class="built_in">sqrt</span>((<span class="keyword">double</span>) sqsum * other.sqsum);</div><div class="line">    &#125;</div><div class="line">&#125; spam, nonspam, msg;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1048576</span>;</div><div class="line"><span class="keyword">char</span> buf[MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n, m, q;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;n, &amp;m, &amp;q) == <span class="number">3</span> &amp;&amp; n + m + q) &#123;</div><div class="line">        </div><div class="line">        <span class="keyword">while</span> (getchar() != <span class="string">'\n'</span>);</div><div class="line">        spam.init(<span class="number">3</span>), nonspam.init(<span class="number">3</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">while</span>(gets(buf) &amp;&amp; <span class="built_in">strcmp</span>(<span class="string">"ENDMESSAGE"</span>, buf))</div><div class="line">                spam.add(buf);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">while</span>(gets(buf) &amp;&amp; <span class="built_in">strcmp</span>(<span class="string">"ENDMESSAGE"</span>, buf))</div><div class="line">                nonspam.add(buf);</div><div class="line">        &#125;</div><div class="line">        spam.flush(), nonspam.flush();</div><div class="line">            </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Set %d:\n"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</div><div class="line">            msg.init(<span class="number">3</span>);</div><div class="line">            <span class="keyword">while</span>(gets(buf) &amp;&amp; <span class="built_in">strcmp</span>(<span class="string">"ENDMESSAGE"</span>, buf))</div><div class="line">                msg.add(buf);</div><div class="line">            msg.flush();</div><div class="line">            </div><div class="line">            <span class="keyword">double</span> spam_dist = msg.distance(spam);</div><div class="line">            <span class="keyword">double</span> nonspam_dist = msg.distance(nonspam);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.5lf %.5lf\n"</span>, spam_dist, nonspam_dist);</div><div class="line">            <span class="built_in">puts</span>(spam_dist &gt; nonspam_dist + <span class="number">1e-10</span> ? <span class="string">"spam"</span> : <span class="string">"non-spam"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">2 1 1</span></div><div class="line"><span class="comment">AAAA</span></div><div class="line"><span class="comment">BBBB CCCC</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">BBBB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">AAAABBBB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">AAABB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">2 1 2</span></div><div class="line"><span class="comment">AAAA</span></div><div class="line"><span class="comment">BBBB CCCC</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">BBBB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">AAAABBBB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">AAABB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment">AAABB</span></div><div class="line"><span class="comment">ENDMESSAGE</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">0 0 0</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-uva-10498" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/27/uva-10498/" class="article-date">
  <time datetime="2015-04-26T23:25:15.000Z" itemprop="datePublished">2015-04-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/27/uva-10498/">UVa 10498 - Happiness</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/27/uva-10498/" data-id="ckkj23mtc00iun0vrt2oybsm4" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/27/uva-10498/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/simplex/">simplex</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/單純形法/">單純形法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/線性規劃/">線性規劃</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>每個人對於每種食材都有其滿意度，目標滿意度總和不超過上限。</p>
<p>準備一人份食材時，每單位的食材都各自有不同的花費，盡可能花最多的錢。</p>
<p>請問總共要花多少錢。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">3 3</div><div class="line">1 0.67 1.67</div><div class="line">1 2 1 430</div><div class="line">3 0 2 460</div><div class="line">1 4 0 420</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Nasa can spend 1354 taka.</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>每個人都花費相同的金額，因此把目標函數最大化後，乘上總人數即可。</p>
<p>現在要把問題轉換成線性規劃的模型，隨後套用 Simplex algorithm (單純形法)，可以參考 李宇骞《浅谈信息学竞赛中的线性规划——简洁高效的单纯形法实现与应用》的簡報，概略說明模型的架構。資料網路上很多，不談論標準的處理程序。</p>
<p>接著閒聊自己的看法。</p>
<p>利用數形轉換的概念，從幾何概念下手，從三個變數來看，單純形法相當於在一個空間上，拿一個物體與平面找接觸，為了使目標函數最大化，會將物體表面的頂點帶入嘗試。</p>
<p>但是要將所有頂點找出來是相當消耗時間，因此爬行法可能會稍微好一點，也就是說，沿著物體表面，藉由一條邊爬行到更好位置上的頂點。由於線性約束，使得物體一定是凸多面體，在更高維度也是一樣的，不斷地爬升到更好的頂點後，最後一定會在最高點停止。</p>
<p>為了使爬行速度加快，每一次找爬升最多的鄰近點，相當於根據某一個約束，盡可能放大某一個維度上的變數 (有可能會將別的變數變小)，使得目標函數增加的值盡可能地多。根據原始的約束寫法，要找到計算仍然相當困難。</p>
<p>定義一個轉軸操作，讓整個問題的空間座標進行變換，方便撰寫。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">64</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">128</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-10</span>, INF = <span class="number">1e+30</span>;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">	n: #variable</span></div><div class="line"><span class="comment">	m: #inequality constraint</span></div><div class="line"><span class="comment">	#inequality constraint format : \sum&#123;a(j, i) xi&#125; &lt;= bj</span></div><div class="line"><span class="comment">	for all xi &gt;= 0</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Simplex</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> n, m;</div><div class="line">    <span class="keyword">int</span> N[MAXN], M[MAXM];</div><div class="line">    <span class="keyword">double</span> a[MAXM][MAXN], b[MAXM], c[MAXN];</div><div class="line">    <span class="keyword">double</span> xval[MAXN], z;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</div><div class="line">        <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</div><div class="line">        <span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</div><div class="line">        <span class="built_in">memset</span>(c, <span class="number">0</span>, <span class="keyword">sizeof</span>(c));</div><div class="line">        <span class="built_in">memset</span>(xval, <span class="number">0</span>, <span class="keyword">sizeof</span>(xval));</div><div class="line">        z = <span class="number">0</span>;</div><div class="line">        <span class="keyword">this</span>-&gt;n = n + m;</div><div class="line">        <span class="keyword">this</span>-&gt;m = m;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</div><div class="line">            a[i][n+i] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            N[i] = i;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</div><div class="line">            M[i] = n + i;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">cmpZero</span><span class="params">(<span class="keyword">double</span> v)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(v) &lt; eps)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> v &lt; <span class="number">0</span> ? <span class="number">-1</span> : <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">compute_xval</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - m; i++) &#123;</div><div class="line">            xval[i] = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (M[j] == i)</div><div class="line">                    xval[i] = b[j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"c "</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%6.3lf "</span>, c[i]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%6.3lf\n"</span>, z);</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"a "</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%6.3lf "</span>, a[i][j]);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%6.3lf\n"</span>, b[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">"--"</span>);</div><div class="line">        </div><div class="line">        compute_xval();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"x "</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n - m; i++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%6.3lf "</span>, xval[i]);</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pivot</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> col)</span> </span>&#123;</div><div class="line">        <span class="keyword">double</span> e = a[row][col];</div><div class="line">        <span class="comment">// normalization</span></div><div class="line">        b[row] /= e;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            a[row][i] /= e;</div><div class="line">        <span class="comment">// gaussian elimination</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (i == row)</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">double</span> t = a[i][col];</div><div class="line">            b[i] = b[i] - t * b[row];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">                a[i][j] = a[i][j] - t * a[row][j];</div><div class="line">        &#125;</div><div class="line">        z -= b[row] * c[col];</div><div class="line">        </div><div class="line">        <span class="keyword">double</span> t = c[col];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            c[i] = c[i] - t * a[row][i];</div><div class="line">        swap(N[col], M[row]);</div><div class="line"><span class="comment">//        print();</span></div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">simplex</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">double</span> mx;</div><div class="line">        <span class="keyword">int</span> select_col, select_row, mn_row;</div><div class="line">        <span class="comment">// climb</span></div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            mx = -INF, select_col = select_row = mn_row = <span class="number">-1</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (cmpZero(c[i]) &gt; <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">double</span> mn = INF;</div><div class="line">                    <span class="comment">// find minmum increase with inequality constraint</span></div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; m; j++) &#123;</div><div class="line">                        <span class="keyword">if</span> (cmpZero(a[j][i]) &gt; <span class="number">0</span>) &#123;</div><div class="line">                            <span class="keyword">if</span> (b[j] / a[j][i] &lt; mn)</div><div class="line">                                mn = b[j] / a[j][i], mn_row = j;</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                    <span class="comment">// find maxmum climb with axis</span></div><div class="line">                    <span class="keyword">if</span> (mx &lt; mn * c[i]) &#123;</div><div class="line">                        mx = mn * c[i];</div><div class="line">                        select_col = i, select_row = mn_row;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (select_col != <span class="number">-1</span>)</div><div class="line">                pivot(select_row, select_col);</div><div class="line">        &#125; <span class="keyword">while</span> (select_col != <span class="number">-1</span>);</div><div class="line">        </div><div class="line">        compute_xval();</div><div class="line">    &#125;</div><div class="line">&#125; g;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</div><div class="line">        g.init(n, m);</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;g.c[i]);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;g.a[i][j]);</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;g.b[i]);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        g.simplex();</div><div class="line">        </div><div class="line"><span class="comment">//        for (int i = 0; i &lt; n; i++) &#123;</span></div><div class="line"><span class="comment">//            printf("x[%d] = %lf\n", i, g.xval[i]);</span></div><div class="line"><span class="comment">//        &#125;</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Nasa can spend %d taka.\n"</span>, (<span class="keyword">int</span>) <span class="built_in">ceil</span>(-g.z * m));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment"> Max x1 + 14*x2 + 6*x3</span></div><div class="line"><span class="comment"> s.t.</span></div><div class="line"><span class="comment"> x1 + x2 + x3 	&lt;= 4</span></div><div class="line"><span class="comment"> x1              &lt;= 2</span></div><div class="line"><span class="comment"> x3              &lt;= 3</span></div><div class="line"><span class="comment"> 3*x2   + x3     &lt;= 6</span></div><div class="line"><span class="comment"> x1 , x2 , x3 , x4 , x5 , x6 , x7 &gt;= 0</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 3 4</span></div><div class="line"><span class="comment"> 1 14 6</span></div><div class="line"><span class="comment"> 1 1 1  4</span></div><div class="line"><span class="comment"> 1 0 0  2</span></div><div class="line"><span class="comment"> 0 0 1  3</span></div><div class="line"><span class="comment"> 0 3 1  6</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 2 2</span></div><div class="line"><span class="comment"> 1 1</span></div><div class="line"><span class="comment"> 2 1 12</span></div><div class="line"><span class="comment"> 1 2 9</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 2 2</span></div><div class="line"><span class="comment"> -1 -1</span></div><div class="line"><span class="comment"> 2 1 12</span></div><div class="line"><span class="comment"> 1 2 9</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 3 3</span></div><div class="line"><span class="comment"> 1 0.67 1.67</span></div><div class="line"><span class="comment"> 1 2 1 430</span></div><div class="line"><span class="comment"> 3 0 2 460</span></div><div class="line"><span class="comment"> 1 4 0 420</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 3 1</span></div><div class="line"><span class="comment"> 30 10 20</span></div><div class="line"><span class="comment"> 30 1 3 30</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 3 3</span></div><div class="line"><span class="comment"> 30 10 20</span></div><div class="line"><span class="comment"> 30 1 3 30</span></div><div class="line"><span class="comment"> 30 1 3 30</span></div><div class="line"><span class="comment"> 30 1 3 30</span></div><div class="line"><span class="comment"> */</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-diary-20150426" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/26/diary-20150426/" class="article-date">
  <time datetime="2015-04-25T23:19:29.000Z" itemprop="datePublished">2015-04-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/手札日記/">手札日記</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="http://i.imgur.com/nIlbHHe.jpg" rel="gallery_ckkj23mib002cn0vrma1lkbgw">
        <img src="http://i.imgur.com/nIlbHHe.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/26/diary-20150426/">畢業典禮前的寧靜</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/26/diary-20150426/" data-id="ckkj23mib002cn0vrma1lkbgw" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/26/diary-20150426/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="門檻狀態"><a href="#門檻狀態" class="headerlink" title="門檻狀態"></a>門檻狀態</h2><p>隨後去考這學期舉辦兩次的 <strong> 多益測驗 </strong>，沒想到面對這場考試心中是如此地平靜，沒有對選項的猶豫，刷新最低成績是有可能的 (目前 380 分)。這樣就不能畢業了呢！是啊。聽著「<strong> 你努力一下，肯定可以的！ </strong>」「<strong> 你沒有比想像中的還差 </strong>」 … 諸如此類的說法。心中暗自竊笑，連同學拼英文字母都會分辨不出 <code>a - z</code>，這到底是有多笑話？</p>
<p>想到這一點，不知道接下來的日子要為什麼目標努力，就像被判斷有了癌症，日子已無多，那股挫折要往哪裡建立起信心。以前還能欺騙自己，要是往那裏發展，總會有所出路，別人肯定會需要我這種人，然而在即將到來的審判典禮，就像是要上死刑台面對廣場市民們的嘲笑、唾棄。現在正一步一步地接近 <strong> 死刑台 </strong>，由外傳來的喧鬧不斷地在陰暗的走廊上回響。</p>
<p>聽說以後找工作會被翻出來，主管可能看到這負面訊息就不會聘用了吧。俗話說的好，「水往低處流，人往低處走。」 <strong> 希望是人給的，絕望也是 </strong>。</p>
<h2 id="課程系列"><a href="#課程系列" class="headerlink" title="課程系列"></a>課程系列</h2><p>在這一個多月中，寫個遊戲，做個美工。只為了一個課程的小作業，找一堆垃圾素材花了大半時間，設計出不少失敗的半成品，那也作罷，也看出能力也不過如此。</p>
<p>設計一個完整的遊戲是個不錯的經驗，以往都只有實作某個功能，沒有全方面地建造多分枝的架構。至於課程講述，不滿意課程教法，其一是浪費時間，其二是中英交雜，完全聽不懂在講什麼。教授隨口秀個英文，只有名詞也不明白到底想表達什麼，喝過洋墨水就比較厲害，也許只是他有他的上課方式，只是還沒去適應它。</p>
<p>資訊安全那門課，內容真的超有趣的，有數學、密碼、攻擊。內容比較淺，但樂趣還是在的。小考是炸了不少，已經到了不及格。那又如何呢？題目描述會錯意，答非所問，我還是感到樂趣無窮啊，這萌萌哒的學習樂此不彼！看不懂英文是給我懲罰，但也相對地學了不少新概念，不知道能不能多賺幾個 AC！</p>
<h2 id="仇活動廚"><a href="#仇活動廚" class="headerlink" title="仇活動廚"></a>仇活動廚</h2><p>為什麼突然講到 <strong> 仇活動廚 </strong>？其實這就跟仇女廚相同的性質，在大學生活中不乏有兩種極端的生存方式，其一是參與課外活動、其二是不斷地與作業奮戰。在最近會在 <a href="https://www.facebook.com/pages/%E9%9D%A0%E5%8C%97%E4%B8%AD%E5%A4%AE/1514597625469099?sk=timeline" target="_blank" rel="external">靠北中央</a> 看到學弟們在 <strong> 靠北參與活動 </strong> 的人。如果仇活動廚多少因為曾經抱怨他們的文章，影響到系上的學弟深感抱歉，後來體悟得更多「 好不容易進到這所學校，卻找不到一起讀書的夥伴 」「 你們比我更強，為什麼只跑活動？ 」記得把接下來的話看完，先別急著罵我。</p>
<p>學弟這麼回應仇活動廚「學生個個不缺課、勤奮讀書、不互抄作業、 文武雙全、 不在考前翻考古題、 跑活動的個個拿書卷獎？」、「跑活動就腦袋空空？那你卷一了嗎？」</p>
<p>回過頭來看，一定有人善於跑活動，也會有人擅長靜靜地在角落讀書鑽研，從老爸那輩的人描述學習生活中，在照片也看得到它們一起在活動室閒聊、玩樂的照片，但也不少聽說他們一起讀書討論的心路歷程，但卻很少聽到這麼說以前同學，所以是仇恨被消磨、美化掉？還是本來就不存在這個原因？ </p>
<p>來猜猜幾點可能性。</p>
<p>以前的課程若很少講求分組，是否有那段「<strong> 因為最近要跑活動，所以不能參與討論，沒時間去完成。 </strong>」那段心如刀割的話語肯定常常出沒在你我心中，分工合作要是變成 <strong> 分功核作 </strong>，除了 M 以外沒人願意一直接受這個事實，不是說每件事情都必須完成。既然有能力跑活動，肯定會有擅長的項目，即便那不是專業技術，那也是個值得敬重的能力。</p>
<p>即便是參與活動沒時間完成工作，那曾經扮演過 reviewer 嗎？將組員的努力審閱過一次，用自己理解的方式說一遍。但活動咖通常會冷嘲熱諷地說「<strong> 不過就這樣子吧？ </strong>」這可是觸了禁忌，更不能說「<strong> 別組做得更好 </strong>」說好聽一點的話！更多的時候，等待的話語是「這樣理解沒錯吧」「那邊是不是可以作成 XX 的樣子 」「別組做得好，那我們有沒有辦法做得更好 」別忘記組員是自己人啊！你不是旁觀者，當被認為有能力不做事，給點意見、參與討論，討論的說法不只有一種，單一說法會讓人乏味，不斷地變換是 <strong> 交流 </strong>、是 <strong> 基友 </strong>。</p>
<p>像我這類看起來只會讀書，卻根本不會讀書的學生，冒牌下的存活者，多少有羨慕你們這些跑活動、讀書也有資質的人，在你們跑活動的時間，拿來做失敗的嘗試、痛苦的掙扎，累積能量 (讀作浪費時間去放鬆) 去衝刺一個失敗的嘗試 (在嘗試新的想法，必然需要新的刺激，墮落玩樂不是壞事，一昧地在同一個地方打轉，離開一陣子是好事)。就跟仇女風氣一樣，讀書的學生被跑活動的學生當作 <strong> 工具人 </strong>，拾人牙慧的態度讓人感到不愉快。萬一有人跳出來說「你自己選擇當工具人的！」「為什麼不跑活動？學到的內容也不少。」那試想過，如果這群人跟著跑活動，那他們還能在這所大學多久？在他們無法克服作業時，有人願意幫它們嗎？「<strong> 如果我不去做、讀的話，有人可以幫忙嗎？ </strong>」</p>
<blockquote>
<p>吾等非聖人，無法百分之百地做到自己講的內容。</p>
</blockquote>
<h2 id="近期心煩"><a href="#近期心煩" class="headerlink" title="近期心煩"></a>近期心煩</h2><p>聽說系館的樓梯都沒防護網，從最高層落下，能不能保證一定會死呢？畢業典禮那天，說著兒子要在今年上台大的爸媽將第一次看到就讀的環境，已經沒法畢業，要怎麼回應這份期待 … 想著想著，看來不用再煩惱這些了，一切都來不及了。當這樣想時，結局都已經定好，歷史紀錄使得一個人將無法正常化，勢必要排除在許多條件之外。既然已經不被認可、無法被認可，努力其他的條件只是要欺瞞自己。</p>
<p>在這大學四年裡，不斷地想要遇到一個欺騙我的人，即使是 <strong> 謊言 </strong> 也沒問題，讓我有點信心也好。放我一個人努力，在一旁相信我什麼的 … 太多這種人，失敗使我灰心喪智，不會相信你們。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-galois-field" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/25/security-galois-field/" class="article-date">
  <time datetime="2015-04-25T11:16:42.000Z" itemprop="datePublished">2015-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/25/security-galois-field/">資訊安全 Galois Fields C++ 軟體實作體驗</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/25/security-galois-field/" data-id="ckkj23mq000e4n0vr4zcn1moe" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/25/security-galois-field/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>在 AES 中，利用 Galois fields<span>$GF(2^{8})$</span><!-- Has MathJax --> 為運算單位，有效地在 8-bits CPU 上高效地實作。</p>
<p>Galois Fields<span>$GF(p^{n})$</span><!-- Has MathJax --> 限定在質數 p 的 n 次方，便可存在有限的元素集合，支持加減乘除，同時可以利用 <strong> 擴充歐幾里算法 </strong> 得得到乘法反元素。從最簡單的 p = 2 開始看起，將 f(x) 視為一個元素。則</p>
<span>$$f(x) = a_{n-1}x^{n-1} + a_{n-2}x^{n-2} + ... + a_{1}x + a_{0} \\
a_{i} \in [0, p)$$</span><!-- Has MathJax -->
<p>當 p = 2 時，f(x) 就跟一般的二進制數字儲存相同。當選定在 p 的 n 次方時，必須找一個 degree = n 的多項式，不被集合內的任何元素整除，來約束所有的運算保持在一個大小內。特別的是當 p = 2 時，加法和減法是等價運算 (在 p = 2 下，1 乘法反元素是自己本身)。</p>
<p>AES 取 8-bits 作為運算單位的用意很多，其一反元素可以在極小空間內儲存，可以用查表的方式得到。之所以選定 p = 2 的好處在於計算機的儲存架構，若在某些特殊硬體可以支持三進位的情況下，p = 3 則會比較有效率的使用，不然取用 p = 3 在二進制的電腦架構，需要轉換的儲存單位是很沒效率，並且覆蓋的集合大小也沒辦法全部使用。</p>
<p>GF 有什麼好處呢？其一的道理在於加解密設計要 <strong> 防止線性關係 </strong> (線性代數太邪惡，很多種攻擊可以繞過線性關係的運算，拋開未知數也能求解)，對於 AES 的設計概念來說 GF 恰好符合這個條件。</p>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>AES 選用<span>$GF(2^{8})$</span><!-- Has MathJax -->，並且取<span>$m(x) = x^8 + x^4 + x^3 + x + 1$</span><!-- Has MathJax --> 作為模數，然後再設計一個以 GF 作為常數類型的多項式 Polynominal</p>
<span>$f(x) = s_{3}x^{3} + s_{2}x^{2} + s_{1}x + s_{0}$</span><!-- Has MathJax -->
<p>每一個<span>$s_{i}$</span><!-- Has MathJax --> 都是一個 8-bits 的儲存單位，也就是說這個多項式是 32-bits 儲存。並且取用<span>$m(x) = x^4 + 1$</span><!-- Has MathJax --> 作為多項式的模數。AES 藉由 <strong> 多項式相乘 </strong>，將 4 個 8-bits 的資料交互影響產生出新的 4 個 8-bits，這在密碼學裡面造成 <strong> 雪崩效應 </strong>。</p>
<p>跟之前講的一樣，GF 一定存在反操作，也就是乘法反元素，因此取用<span>$03 x^{3} + 01 x^{2} + 01 x^{1} + 02$</span><!-- Has MathJax --> 其乘法反元素為<span>$0B x^{3} + 0D x^{2} + 09 x^{1} + 0E$</span><!-- Has MathJax -->。</p>
<p>接著，寫一個程式驗證反元素的計算吧！</p>
<blockquote>
<p>備註：GF 裡面套用 GF 相當有趣，感覺可以無限擴充大小，當然任意質數也可以找反元素，但也只有 <strong> 梅森質數 </strong> 比較適合在電腦二進制系統中吧？</p>
</blockquote>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">no input</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">00 01 8D F6 CB 52 7B D1 E8 4F 29 C0 B0 E1 E5 C7</div><div class="line">74 B4 AA 4B 99 2B 60 5F 58 3F FD CC FF 40 EE B2</div><div class="line">3A 6E 5A F1 55 4D A8 C9 C1 0A 98 15 30 44 A2 C2</div><div class="line">2C 45 92 6C F3 39 66 42 F2 35 20 6F 77 BB 59 19</div><div class="line">1D FE 37 67 2D 31 F5 69 A7 64 AB 13 54 25 E9 09</div><div class="line">ED 5C 05 CA 4C 24 87 BF 18 3E 22 F0 51 EC 61 17</div><div class="line">16 5E AF D3 49 A6 36 43 F4 47 91 DF 33 93 21 3B</div><div class="line">79 B7 97 85 10 B5 BA 3C B6 70 D0 06 A1 FA 81 82</div><div class="line">83 7E 7F 80 96 73 BE 56 9B 9E 95 D9 F7 02 B9 A4</div><div class="line">DE 6A 32 6D D8 8A 84 72 2A 14 9F 88 F9 DC 89 9A</div><div class="line">FB 7C 2E C3 8F B8 65 48 26 C8 12 4A CE E7 D2 62</div><div class="line">0C E0 1F EF 11 75 78 71 A5 8E 76 3D BD BC 86 57</div><div class="line">0B 28 2F A3 DA D4 E4 0F A9 27 53 04 1B FC AC E6</div><div class="line">7A 07 AE 63 C5 DB E2 EA 94 8B C4 D5 9D F8 90 6B</div><div class="line">B1 0D D6 EB C6 0E CF AD 08 4E D7 E3 5D 50 1E B3</div><div class="line">5B 23 38 34 68 46 03 8C DD 9C 7D A0 CD 1A 41 1C</div><div class="line">03 x^3 + 01 x^2 + 01 x^1 + 02 x^0</div><div class="line">0B x^3 + 0D x^2 + 09 x^1 + 0E x^0</div><div class="line">00 x^3 + 00 x^2 + 00 x^1 + 01 x^0</div><div class="line">0B x^3 + 0D x^2 + 09 x^1 + 0E x^0</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>暴力實作，模擬運算，不考慮電路架構，用最樸素的方式儲存每一個欄位。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// in AES, GF(2^8), m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GaloisField</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> v[<span class="number">32</span>];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    GaloisField() &#123;</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">    &#125;</div><div class="line">    GaloisField(<span class="keyword">int</span> val) &#123;</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</div><div class="line">            v[i] = (val&gt;&gt;i)&amp;<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    GaloisField(<span class="keyword">const</span> <span class="keyword">int</span> a[], <span class="keyword">int</span> an) &#123;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= an; i++)</div><div class="line">            v[i] = a[i];</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>+(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r.n; i++)</div><div class="line">            r.v[i] = v[i] xor a.v[i];</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>-(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> (*<span class="keyword">this</span>) + a;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>*(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a.n; j++) </div><div class="line">                r.v[i+j] = r.v[i+j] xor (v[i] <span class="keyword">and</span> a.v[j]);</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GaloisField <span class="title">shift</span><span class="params">(<span class="keyword">int</span> sn)</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            r.v[i + sn] = v[i];</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span> &amp;&amp; a.v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span> &amp;&amp; a.v[i] == <span class="number">0</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">0</span> &amp;&amp; a.v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>/(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (a.v[i] == <span class="number">1</span> &amp;&amp; v[i] == <span class="number">0</span>)</div><div class="line">                <span class="keyword">return</span> GaloisField();</div><div class="line">            <span class="keyword">if</span> (a.v[i] == <span class="number">0</span> &amp;&amp; v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        GaloisField r, b = (*<span class="keyword">this</span>), c;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            c = a.shift(i);</div><div class="line">            <span class="keyword">if</span> (c &lt; b) &#123;</div><div class="line">                r.v[i] = <span class="number">1</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">16</span>; j &gt;= <span class="number">0</span>; j--)</div><div class="line">                    b.v[j] = b.v[j] xor c.v[j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>%(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField ret = (*<span class="keyword">this</span>) - (*<span class="keyword">this</span>) / a * a;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isZero</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">            <span class="keyword">if</span> (v[i])	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GaloisField <span class="title">inverse</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> m[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, mn = <span class="number">8</span>; <span class="comment">// m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line">        <span class="function">GaloisField <span class="title">y</span><span class="params">(m, mn)</span></span>;</div><div class="line">        GaloisField g, a, b;</div><div class="line">        </div><div class="line">        exgcd((*<span class="keyword">this</span>), y, g, a, b); <span class="comment">// a x + b y = g</span></div><div class="line">        <span class="keyword">return</span> a;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(GaloisField x, GaloisField y, GaloisField &amp;g, GaloisField &amp;a, GaloisField &amp;b)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (y.isZero()) &#123;</div><div class="line">            g = x, a = GaloisField(<span class="number">1</span>), b = GaloisField(<span class="number">0</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            exgcd(y, x%y, g, b, a), b = b - (x / y) * a;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">normal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> m[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, mn = <span class="number">8</span>; <span class="comment">// m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i - mn &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = mn, k = i; j &gt;= <span class="number">0</span>; j--, k--)</div><div class="line">                    v[k] = v[k] xor (m[j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">7</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, v[i]);</div><div class="line">            <span class="keyword">if</span> (i%<span class="number">4</span> == <span class="number">0</span>)	<span class="built_in">printf</span>(<span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getHbits</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v[<span class="number">7</span>]&lt;&lt;<span class="number">3</span> | v[<span class="number">6</span>]&lt;&lt;<span class="number">2</span> | v[<span class="number">5</span>]&lt;&lt;<span class="number">1</span> | v[<span class="number">4</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLbits</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v[<span class="number">3</span>]&lt;&lt;<span class="number">3</span> | v[<span class="number">2</span>]&lt;&lt;<span class="number">2</span> | v[<span class="number">1</span>]&lt;&lt;<span class="number">1</span> | v[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">testGF</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> va[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">int</span> vb[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</div><div class="line">        <span class="function">GaloisField <span class="title">a</span><span class="params">(i)</span></span>;</div><div class="line">        GaloisField b = a.inverse();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%X%X "</span>, b.getHbits(), b.getLbits());</div><div class="line">        <span class="keyword">if</span> (i%<span class="number">16</span> == <span class="number">15</span>) <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GF_Polynominal</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    GaloisField v[<span class="number">32</span>];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    GF_Polynominal() &#123;</div><div class="line">        n = <span class="number">4</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</div><div class="line">            v[i] = GaloisField();</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal(<span class="keyword">const</span> GaloisField a[], <span class="keyword">int</span> an) &#123;</div><div class="line">        n = <span class="number">4</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= an; i++)</div><div class="line">            v[i] = a[i];</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>+(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r.n; i++)</div><div class="line">            r.v[i] = v[i] + a.v[i];</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>-(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> (*<span class="keyword">this</span>) + a;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>*(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a.n; j++) </div><div class="line">                r.v[i+j] = r.v[i+j] + (v[i] * a.v[j]);</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GF_Polynominal <span class="title">shift</span><span class="params">(<span class="keyword">int</span> sn)</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            r.v[i + sn] = v[i];</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero() &amp;&amp; !a.v[i].isZero())</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (v[i].isZero() != a.v[i].isZero())</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>/(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!a.v[i].isZero() &amp;&amp; v[i].isZero())</div><div class="line">                <span class="keyword">return</span> GF_Polynominal();</div><div class="line">            <span class="keyword">if</span> (a.v[i].isZero() &amp;&amp; !v[i].isZero())</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        GF_Polynominal r, b = (*<span class="keyword">this</span>), c;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            c = a.shift(i);</div><div class="line">            <span class="keyword">if</span> (c &lt; b) &#123;</div><div class="line">                GaloisField t, x, y;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">16</span>; j &gt;= <span class="number">0</span>; j--) &#123;</div><div class="line">                    <span class="keyword">if</span> (!c.v[j].isZero()) &#123;</div><div class="line">                        y = c.v[j], x = b.v[j];</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                t = y.inverse() * x;</div><div class="line"><span class="comment">//				b.print();</span></div><div class="line"><span class="comment">//				c.print();</span></div><div class="line"><span class="comment">//				printf("gg %d\n", i);</span></div><div class="line"><span class="comment">//				y.print();</span></div><div class="line"><span class="comment">//				x.print();</span></div><div class="line"><span class="comment">//				y.inverse().print();</span></div><div class="line"><span class="comment">//				t.print();</span></div><div class="line">                r.v[i] = t;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">8</span>; j &gt;= <span class="number">0</span>; j--)</div><div class="line">                    b.v[j] = b.v[j] - c.v[j] * t;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"><span class="comment">//		printf("---&gt; mod "); b.print();</span></div><div class="line"><span class="comment">//		puts("");</span></div><div class="line"><span class="comment">//		puts("div begin");</span></div><div class="line"><span class="comment">//		print();</span></div><div class="line"><span class="comment">//		a.print();</span></div><div class="line"><span class="comment">//		r.print();</span></div><div class="line"><span class="comment">//		(r * a).print();</span></div><div class="line"><span class="comment">//		(r * a + b).print();</span></div><div class="line"><span class="comment">//		puts("div end\n");</span></div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>%(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal ret = (*<span class="keyword">this</span>) - (*<span class="keyword">this</span>) / a * a;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isZero</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero())	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GF_Polynominal <span class="title">inverse</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">1</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">4</span>; <span class="comment">// m(x) = x^4 + 1</span></div><div class="line">        <span class="function">GF_Polynominal <span class="title">y</span><span class="params">(m, mn)</span></span>;</div><div class="line">        GF_Polynominal g, a, b;</div><div class="line">        </div><div class="line">        exgcd((*<span class="keyword">this</span>), y, g, a, b); <span class="comment">// a x + b y = g</span></div><div class="line">        </div><div class="line">        <span class="keyword">return</span> a / g;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(GF_Polynominal x, GF_Polynominal y, GF_Polynominal &amp;g, GF_Polynominal &amp;a, GF_Polynominal &amp;b)</span> </span>&#123;</div><div class="line"><span class="comment">//		puts("exgcd -----------------");</span></div><div class="line"><span class="comment">//		x.print();</span></div><div class="line"><span class="comment">//		y.print();</span></div><div class="line"><span class="comment">//		getchar();</span></div><div class="line">        <span class="keyword">if</span> (y.isZero()) &#123;</div><div class="line">            <span class="keyword">const</span> GaloisField m1[] = &#123;GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">            <span class="keyword">const</span> GaloisField m0[] = &#123;GaloisField(<span class="number">0</span>)&#125;;</div><div class="line">            g = x, a = GF_Polynominal(m1, <span class="number">1</span>), b = GF_Polynominal(m0, <span class="number">1</span>);</div><div class="line">            <span class="comment">// a = g.inverse();</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            exgcd(y, x%y, g, b, a), b = b - (x / y) * a;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">normal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">1</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">4</span>; <span class="comment">// m(x) = x^4 + 1</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i - mn &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero()) &#123;</div><div class="line">                GaloisField t = v[i];</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = mn, k = i; j &gt;= <span class="number">0</span>; j--, k--)</div><div class="line">                    v[k] = v[k] - (m[j] * t);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%X%X "</span>, v[i].getHbits(), v[i].getLbits());</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"x^%d"</span>, i);</div><div class="line">            <span class="keyword">if</span> (i)	<span class="built_in">printf</span>(<span class="string">" + "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">testPoly</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">2</span>), GaloisField(<span class="number">1</span>), GaloisField(<span class="number">1</span>), GaloisField(<span class="number">3</span>)&#125;;</div><div class="line">    <span class="keyword">const</span> GaloisField m2[] = &#123;GaloisField(<span class="number">14</span>), GaloisField(<span class="number">9</span>), GaloisField(<span class="number">13</span>), GaloisField(<span class="number">11</span>)&#125;;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">3</span>, mn2 = <span class="number">3</span>;</div><div class="line">    GF_Polynominal a(m, mn), b(m2, mn2);</div><div class="line">    </div><div class="line">    a.print();</div><div class="line">    b.print();</div><div class="line">    </div><div class="line">    GF_Polynominal c = a * b;</div><div class="line">    c.print();</div><div class="line">    </div><div class="line">    GF_Polynominal d = a.inverse();</div><div class="line">    d.print();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    testGF();</div><div class="line">    testPoly();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/24/security-notes/" class="article-date">
  <time datetime="2015-04-24T02:37:28.000Z" itemprop="datePublished">2015-04-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/24/security-notes/">資訊安全 小考筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/24/security-notes/" data-id="ckkj23mqa00ekn0vrieqdybxb" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/24/security-notes/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><ol>
<li><p>Follow</p>
<ol>
<li>What is a monoalphabetic cipher ?</li>
<li>How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ?</li>
<li>What is the main security weakness of a monoalphabetic cipher ?</li>
<li>Please provide at least 4 approaches to prevent the above weakness.</li>
</ol>
</li>
<li><p>Block ciphers process messages in blocks like an extremely large substitution, but this is very difficult to implement for a very big block size. What is Shannon’s idea to realize a block cipher with big block size ?</p>
</li>
<li><p>The S-box of DES round operation is not invertable, but why DES can decrypt ?</p>
</li>
<li><p>Follow</p>
<ol>
<li>Please explain the OFB mode.</li>
<li>In the OFB mode, we never reuse the same sequence (key+IV). If we reuse the key, then the attacker can recover message. Please describe very precisely (mathematiclly with symbols) how the attack works.</li>
</ol>
</li>
<li><p>Please compare the CFB mode the OFB mode by providing a table indicating at least 5 of their advantage and corresponding disadvantage.</p>
</li>
<li><p>This question is about issues of random access of encryption and decryption. Define notations or symbols you need before providing your answer. Please describe how to use CFB mode and CTR mode to randomly encrypt and decrypt a file Why OFB mode is inappropriate to randomly encrypt and decrypt a file?</p>
</li>
<li><p>Describe the details (as much as you remember) of AES operation and describe how efficiently implement AES on an 8-bit CPU ?</p>
</li>
<li><p>How avalanche happens in AES within the first tow rounds ?</p>
</li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><p>monoalphabetic cipher 簡單來說比凱薩加密難一點，從每個字母都 shift 固定的數量來說，變成變動式的。換句話說就是單純的英文字母替換 (substitute)。由於要維持可逆的解密，替換必須符合一對一，所以方法數為 <code>26! = 403291461126605635584000000</code>。</p>
<p>但這種替換方式容易受到語言統計的攻擊，也就是說在英文的特性中，不是每個字母都出現相同的頻率，因為很多冗詞的使用，導致有些字母會特別多。也因此在找對應時，可以藉由這一個觀點，反向查找可能的替換，大幅度地降低搜索可能，讓解密變得相當容易。</p>
<p>為了解決這一語言統計的攻擊，可以藉由</p>
<ul>
<li>壓縮明文，破壞語言特性，但是壓縮算法有儲存的字典部分，仍可能發生字典結構被攻擊，進而進行解壓縮。</li>
<li>增加垃圾字，撥點冗詞穿插在其中，把頻率不均的問題消彌。</li>
<li>多個字符一起加密，相對於單一字母的替換，可以同時替換兩個以上，如 <code>AA -&gt; WT</code> 之類的。</li>
<li>使用多種替換，在不同時刻使用不同的替換表，同樣地可以把頻率問題解決。</li>
<li>參照後續區段加密的一些技巧，如 CFB、OFB … 等，讓替換表進行變動。</li>
</ul>
<h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><p>區段加密具有相當大的強度，當一次加密 64 bits 時，可以達到的對應種類高達 <code>(2^64)!</code>，沒有辦法將這種表格存放在記憶體，因為也要消耗 <code>2^64</code> bits。</p>
<p>因此有 Shannon’s idea，利用 substitution (S-box)、permutation (P-box) 來完成對應，藉由 S-P 的組合，提供 混淆(confusion) 和 差異 (diffusion)。組合的效應遠比想像中的還大，儘管組合的方法數遠小於 <code>(2^64)!</code>，連兆分之一都不到，但簡單的概念可以在 <code>64KB</code> 記憶體大小內完成，效應上算相當划算。</p>
<h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><p>DES 的 S-box 屬於不可逆的操作 (8-bits to 6-bits)，然而 DES 在解密時，不需要將 S-box 往回推導，也就是不需要逆向操作，因為加密的 key 來自於 master key 和另一段的訊息 L(i) ，最後用 key 加密 R(i) 得到 L(i+1)。解密時，只需要將 R(i+1) (L(i) 會變成 S(i+1))帶入 S-box，就能重新產生出 key。</p>
<p>至於 DES 為什麼可以正確加解密，定義對於所有的任意明文 A, B，產生的密文 E(A) != E(B)。若明文差異在 L(i)，則在 R(i+1) 一定會不同。若明文差異在 R(i)，則在 key 相同，做 L(i+1) = R(i) XOR key 時，L(i+1) 也必定會不同。</p>
<h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><span>$$O_{i} = E_{k}(O_{i-1}); O_{-1} = IV \\
C_{i} = P_{i} \text{ XOR } O_{i}$$</span><!-- Has MathJax -->
<p>為什麼 OFB 不能重新使用 key + IV 呢？原因是因為 <strong> 已知明文攻擊 (Known plaintext attack) </strong> 。假設每一天都重新啟動，那麼攻擊者可以在事後得到密文對應的明文 (可能隔天才知道，儘管對應仍然是很難的)，那麼可以藉由數學概念來完成解密，無須考慮 key 是什麼內容。</p>
<span>$$C_{i} = P_{i} \text{ XOR } O_{i} \\
C_{j} = P_{j} \text{ XOR } O_{i} \\
C_{i} \text{ XOR } C_{j} = P_{i} \text{ XOR } P_{j}$$</span><!-- Has MathJax -->
<p>假設 i 和 j 重複使用 key，那麼會發生已知密文<span>$C_{i}, C_{j}$</span><!-- Has MathJax --> (傳輸上一定會被發現) 和已知明文<span>$P_{i}$</span><!-- Has MathJax -->，只要夾擊做 XOR，就可以直接得到<span>$P_{j}$</span><!-- Has MathJax -->，當已知明文相當長時，竊取的效果就越好。</p>
<h3 id="Part-5"><a href="#Part-5" class="headerlink" title="Part 5"></a>Part 5</h3><p>比較 CFB 和 OFB。</p>
<table>
<thead>
<tr>
<th>特性\模式</th>
<th>CFB</th>
<th>OFB</th>
</tr>
</thead>
<tbody>
<tr>
<td>自同步 (self-synchronization)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>錯誤擴散 (error propagation)</td>
<td>有</td>
<td>無</td>
</tr>
<tr>
<td>預先計算 (preprocess key)</td>
<td>不可</td>
<td>可</td>
</tr>
<tr>
<td>隨機存取 (random access)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>資訊安全性 (message security)</td>
<td>高</td>
<td>低</td>
</tr>
</tbody>
</table>
<ul>
<li><strong> 自同步 (self-synchronization) </strong>，不用告知對方加密狀態，可以藉由數次的傳輸訊息，自動地將兩邊的狀態一致，在此之前會造成一段雜訊。斷線時，不必重複使用 IV 讓兩邊同步 (狀態相同時，才能正確解密)。</li>
<li><strong> 錯誤擴散 (error propagation) </strong> ，也因為自同步的設計，導致在同步前都會有雜訊，或者在訊息被攻擊者竄改時，會影響該週期的狀態 (<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --> )。</li>
<li><strong> 預先計算 (preprocess key) </strong> ，預先計算 key 可以加快加解密速度，同時便可支持平行運算，這原因是因為 message-independent/dependent 之間的差異，狀態不依靠正在傳遞的訊息時，就可以預先處理。</li>
<li><strong> 隨機存取 (random access) </strong> ，當要解析某個密文時，CFB 可以往前查找密文<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax -->，得到當前的解密器所需要的狀態，放上 master key 就能進行解密。OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</li>
<li><strong> 資訊安全性 (message security) </strong> ，由於狀態與訊息獨立，會導致被攻擊者竄改內容時不易發現。在 CFB 中，由於依賴傳遞的訊息，當攻擊者竄改某個密文時會造成錯誤擴散，影響的解密時的明文不只一個，這也讓安全性提高。可以說是一體兩面的特性。</li>
</ul>
<h3 id="Part-6"><a href="#Part-6" class="headerlink" title="Part 6"></a>Part 6</h3><ul>
<li>CFB 狀態為 master key +<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --></li>
<li>CTR 狀態為 master key + counter</li>
</ul>
<p>CFB 解密某個密文時，往前查找密文即可解密。CTR 知道密文 offset 便可得到 counter。在獲得資訊上都是 O(k) 常數，因此支持隨機存取。</p>
<blockquote>
<p>OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</p>
</blockquote>
<p>CFB 和 CTR 到底誰的隨機存取能力好呢？若檔案儲存會切割成數個，那 CFB 的隨機存取能力就更高一點。CTR 必須計算 offset，相較於 CFB 的紀錄架構會稍微地麻煩。</p>
<h3 id="Part-7"><a href="#Part-7" class="headerlink" title="Part 7"></a>Part 7</h3><p>AES 的計算結構都落在 GF(2^8)，一個 cell 的內容都是 GF(2^8)</p>
<ul>
<li>substitue 需要 8-bits to 8-bits</li>
<li>shift rows 對於 8-bit 關聯不大 (移動記憶體的位置)</li>
<li>mixColume 上是 8-bits x 8-bits</li>
<li>add round key 對於每一個 cell XOR 8-bit keys</li>
</ul>
<p>因此 AES 可以在 8-bits CPU 上有更好的實作效能，所需要的 clock cycle 會比較短。</p>
<h3 id="Part-8"><a href="#Part-8" class="headerlink" title="Part 8"></a>Part 8</h3><p>假設有兩個明文的 <strong> 漢明距離 (Hamming distance) </strong> 為 1，在 128 bits 中有一個 1 bits 不同，意即<span>$H(P, Q) = 1$</span><!-- Has MathJax -->。</p>
<table>
<thead>
<tr>
<th>Step\Round</th>
<th>Round 1</th>
<th>Round 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Substitue bytes</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Shift rows</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Mix Columes</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
<tr>
<td>Add Round key</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
</tbody>
</table>
<ul>
<li>在 Substitue bytes 步驟時，S-box 會設計成期望當有一個 1-bits 不同，則替換出來的結果會有 4-bits 不同 (一個 cell 具有 8-bits。替換 8-bits 時，差異最少 0 bits、最多 8-bits，期望值是 4-bits)。</li>
<li>在 Shift rows 步驟時，單純移動 cell 不影響差異。</li>
<li>在 Mix Columes 步驟時，每一個 colume 會根據上一個 colume 的 4 個元素相互影響，因此會增加 4 倍。</li>
<li>在 Add Round key 步驟時，由於 XOR 相同的 key，因此差異並不會改變。</li>
</ul>
<p>最後，在 Round 2 時，能得到平均 64 bits 的差異。加密的明文一次 128 bits，差異期望值也就是一半的情況 64 bits，因此很快地就能達到期望的差異性。在隨後的 Round X 中，差異會在 64-bits 上下浮動都是有可能的。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-game-maker-design" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/22/game-maker-design/" class="article-date">
  <time datetime="2015-04-21T23:15:21.000Z" itemprop="datePublished">2015-04-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/介面設計/">介面設計</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/22/game-maker-design/">Game Maker 遊戲介面設計</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/22/game-maker-design/" data-id="ckkj23mjg004cn0vr5cgxsyiu" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/22/game-maker-design/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/game/">game</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ui/">ui</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>學校課程番外篇，有興趣者可以查閱 <a href="https://github.com/morris821028/hw-GameMaker" target="_blank" rel="external">Github</a>。</p>
<h2 id="本文"><a href="#本文" class="headerlink" title="本文"></a>本文</h2><p>本課程一開始著重 <strong> 尼爾森法則 </strong> 的介面設計，不只是在網頁操作等介面設計，雖然遊戲沒有複雜的狀態跟操作流程，但在設計上的操作反應、都應該要符合尼爾森法則。</p>
<p>Game Maker 這套軟體只是製作 UI 方便，遊戲性跟高難度設計不是很著重，<strong> 不看你的代碼或實作複雜度 </strong>。這也是本課程最弔詭的地方。Game Maker 有一個缺點，製作時的分工無法按照軟體分工的方式，實作部分代碼來完成，除非組員們都會寫 script 並且了解語法的變數存取方式。</p>
<h2 id="從設計開始講起"><a href="#從設計開始講起" class="headerlink" title="從設計開始講起"></a>從設計開始講起</h2><p>可以從課程問卷中看到 <a href="https://github.com/morris821028/hw-GameMaker/blob/master/project/doc/game_questionnaire.md" target="_blank" rel="external">link</a> 幾個遵循的法則。</p>
<h3 id="Visibility-of-system-status"><a href="#Visibility-of-system-status" class="headerlink" title="Visibility of system status"></a>Visibility of system status</h3><p>狀態可視有幾格要點，玩家方便知道當前狀態，例如所在關卡、遊戲模式的狀態、角色資訊的狀態、完成關卡的結算畫面 … 等。</p>
<p><img src="http://i.imgur.com/RKM583h.png" alt="紅框位置處表示狀態"></p>
<p>同時在需要連續操作的完成流程，如銀行手續的設計，會顯示當前步驟進行到幾分之幾，來提示使用者其實還沒有完成所有步驟。然而在遊戲上，完成比例通常不是著重的一環，而是有哪關卡可以玩、有哪些關卡還沒去探訪過。</p>
<h3 id="Match-between-system-and-the-real-world"><a href="#Match-between-system-and-the-real-world" class="headerlink" title="Match between system and the real world"></a>Match between system and the real world</h3><p>主要為圖示運用，<a href="http://www.flaticon.com/packs/" target="_blank" rel="external">icon</a> 對應的操作符合普遍性，通常會遇到的第一個錯誤設計是將原本用在某個地方的圖示拿來放在不應擺放的位置。例如音樂撥放器的撥放、暫停、停止、前轉、循環、 … 等，很容易在選擇上誤用箭頭的格式。</p>
<p>接著是在文字對應，選項的文字也要具有普遍性，符合直觀的反應文字，詞性也應選擇恰當 (當心誤用形容詞當選項文字)，問題描述的正面詢問與反面詢問，反應在選擇選項時應足夠明確 (反問內容是否合理，不常見的反面詢問應該捨棄，防止使用者用既有概念進行操作)。</p>
<p>遊戲規則設計符合合理，當要貼切真實世界時，如物理反應與遊戲元素之間的關聯應該符合，如遊戲中運用到水和火，兩物體若發生碰撞，反應結果應符合消滅對方的關係。</p>
<h3 id="User-control-and-freedom"><a href="#User-control-and-freedom" class="headerlink" title="User control and freedom"></a>User control and freedom</h3><p>所謂的自由度，玩家不會被困在一本道的遊戲設計，但是在抖 M 類型的遊戲中，只要一失敗就必須從頭打起。玩家不會一直被系統帶著跑，而無法中斷、暫停遊戲，同時也表明重新步入遊戲時，可以選擇自己進行的模式。</p>
<p>自由度的操控有很多，客製化玩家的操作、給予玩家改變遊戲的部分設計，如鍵盤控制的改變、允許玩家更動角色的樣貌、樣式，可以更動關卡模式，例如 L4D2 可以選擇專家模式 … 等。</p>
<h3 id="Consistency-and-standards"><a href="#Consistency-and-standards" class="headerlink" title="Consistency and standards"></a>Consistency and standards</h3><p>一致性設計，相當於風格設計。</p>
<ul>
<li>按鈕的圖示在不同狀態若具有相同功能，使用圖示相同。</li>
<li>UI 擺放位置，不常因不同模式而更動 (突然放左、突然放右。)</li>
<li>文字字型的使用統一使用，並且區分遊戲劇情與系統介面，相同類型的文字說明應符合一致。</li>
</ul>
<h3 id="Error-prevention"><a href="#Error-prevention" class="headerlink" title="Error prevention"></a>Error prevention</h3><p>防止錯誤操作，當玩家已經在別款遊戲中擅長使用快捷鍵時，那很有可能在遊戲中使用快捷鍵操作，這可能會造成不預期的反應，如快速關閉遊戲、啟動某個遊戲的系統功能。</p>
<p>因此在防止錯誤，通常會用 <strong> 第二次詢問 </strong> 來防止。在快捷操作上，二次詢問要利用不同的快捷鍵觸發，防止連按的快速操作，如連按兩次 <code>ESC</code> 突然跳出遊戲的蠢事。</p>
<p>提示操作的後果也是相當重要，必須在文字說明上明確描述，盡可能使用簡短的句子和例子來說明操作後果。說明時著重使用者觀點，而非功能性介紹 (介紹對於使用者的感受可能會變成怎麼樣，而不去說明電腦架構的效能 … 等專業知識)。</p>
<p>當遊戲需要高度複雜的邏輯，導致道具使用上的 <strong> 順序性會影響流程 </strong>。當玩家處於無法通關的狀態時，提示哪個步驟錯誤，同時也告知玩家應該重新挑戰。這一類型就是引導提示。</p>
<h3 id="Recognition-rather-than-recall"><a href="#Recognition-rather-than-recall" class="headerlink" title="Recognition rather than recall"></a>Recognition rather than recall</h3><p>在遊戲功能分類上，遊戲道具的使用類型應該設計主動操作與被動操作，在欄位劃分上是其中一種設計。當空間不足與進行欄位劃分，在道具的背景、顏色上的區分是一個解決方案，例如用三角形的外框表示消耗型道具、六角形表示永久的增益型道具。<strong> 用圖示背景與位置來區分操作類型 </strong>，防範使用者如猴子般地等待道具效果。</p>
<h3 id="Flexibility-and-efficiency-of-use"><a href="#Flexibility-and-efficiency-of-use" class="headerlink" title="Flexibility and efficiency of use"></a>Flexibility and efficiency of use</h3><p>操作相當具有彈性跟有效地使用！</p>
<p>有些遊戲需要高度複雜的組合鍵來完成一個動作，同時也要求組合鍵的有效時間。先不論組合鍵的設計，若存在組合鍵，是否符合效率使用，是否可縮減成另一個指令，當分化深度歧異過大時，考量壓縮組合鍵的長度。例如有 5 個技能是由 3 個鍵組合觸發，4 個技能是由 5 個鍵組合觸發，壓縮到 4 個鍵以內 … 等。</p>
<p>正常情況下，有多少使用者會直觀這麼做，組合鍵設計是否合理，是否可以藉由 <strong> 系統輔助來簡化操作流程 </strong> ？這些考量將成為易上手，入門玩家最需要的部分。就如 vim 編輯器的使用，直接面向高端使用者，入門就會相當地困難。</p>
<h3 id="Aesthetic-and-minimalist-design"><a href="#Aesthetic-and-minimalist-design" class="headerlink" title="Aesthetic and minimalist design"></a>Aesthetic and minimalist design</h3><p>提示、排版設計，在 Apple 軟體看得很明顯，操作相當簡單，不會一次把很多功能塞在同一個頁面。在功能性很強的軟體，常常會把很多參數調校放在同一個頁面，而沒有做好區別與預設，即使功能性很強、軟體很好用，但很多功能反而會被忽略，由於沒有好的簡化設計，第一手想要嘗試的使用者，會跳過好幾個功能設定進行反饋。 <strong> 開發者開發的功能就白費了！ </strong></p>
<p>盡可能讓畫面簡潔，縮減不必要的進階資訊，用額外的方式體現，設計不同的介面模式。</p>
<h3 id="Help-users-recognize-diagnose-and-recover-from-errors"><a href="#Help-users-recognize-diagnose-and-recover-from-errors" class="headerlink" title="Help users recognize, diagnose, and recover from errors"></a>Help users recognize, diagnose, and recover from errors</h3><p>系統發生錯誤時，是否有足夠的資訊讓使用者查覺到 <strong> 不是遊戲正常設定 </strong>，來讓使用者回報這些程式設計 Bug。在系統設計的魯棒性，不應一個 Bug 產生而造成系統崩潰，遊戲也是一樣，讓使用者返回上一個正常的狀態，不會造成卡關、或者卡關之後遊戲損毀。</p>
<p>復原狀態對於小遊戲設計上相當困難啊！</p>
<h3 id="Game"><a href="#Game" class="headerlink" title="Game"></a>Game</h3><ul>
<li>故事劇情 (Storyline)</li>
<li>遊戲性 (GamePlay)</li>
<li>美學圖形 (Artistic/Graphics)</li>
<li>音效特效 (Sound/Special effects)</li>
<li>人工智慧 (AI)</li>
</ul>
<p>故事劇情可以結合真實部分，在真假交織下發展。</p>
<p>可以參考 <strong> 《额外加分 Extra Credits》 </strong> 、 <strong> 《TUN高品位低调宅》 </strong> 系列影片，這將會告訴你遊戲如何設計才具有特色。</p>
<p>下面列了兩個影片，更多可以直接去觀看 youtube 上的頻道。</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=UjclHHR2hMk" target="_blank" rel="external">额外加分 Extra Credits：关联学习法</a></li>
<li><a href="https://www.youtube.com/watch?v=__BHBWhSw4g" target="_blank" rel="external">TUN高品位低调宅之黑暗之魂好在哪？</a></li>
</ul>
<p>其他的列點就是一種個人價值觀體現，還沒有詳細學習。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><div class="video-container"><iframe src="//www.youtube.com/embed/In0U3oQJ1LI" frameborder="0" allowfullscreen></iframe></div>
<p>影片加速展示內容。</p>
<h2 id="Github"><a href="#Github" class="headerlink" title="Github"></a>Github</h2><script type="text/javascript" src="http://morris821028.github.io/hexo-tag-oj/jquery.githubRepoWidget.js"></script><div class="github-widget" data-repo="morris821028/hw-GameMaker"></div>
<p>遊戲執行檔和開源代碼都在其中，當然還有遊戲的編輯器。更多的遊戲截圖在裡頭，只支持 windows 平台。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/page/29/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><a class="page-number" href="/page/32/">32</a><span class="space">&hellip;</span><a class="page-number" href="/page/83/">83</a><a class="extend next" rel="next" href="/page/31/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">19</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/01/30/work/company-ghost-story-9/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 9</a>
          </li>
        
          <li>
            <a class="text" href="/2020/12/12/java/java-jni-tls-error/">
              
                <i class="icon-file-o"></i> 
              
            Java JNI Thread Error (EINVAL)</a>
          </li>
        
          <li>
            <a class="text" href="/2020/11/08/work/company-ghost-story-8/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 8</a>
          </li>
        
          <li>
            <a class="text" href="/2020/11/01/work/company-ghost-story-7/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 7</a>
          </li>
        
          <li>
            <a class="text" href="/2020/10/31/lesson/ada-2020-hw1-p3/">
              
                <i class="icon-file-o"></i> 
              
            ADA 2020 Fall P3. ADA Party</a>
          </li>
        
          <li>
            <a class="text" href="/2020/10/31/lesson/ada-2020-hw1-p2/">
              
                <i class="icon-file-o"></i> 
              
            ADA 2020 Fall P2. Bomb Game</a>
          </li>
        
          <li>
            <a class="text" href="/2020/10/25/diary-202010/">
              
                <i class="icon-file-o"></i> 
              
            資訊科學的偏科生 面試者篇</a>
          </li>
        
          <li>
            <a class="text" href="/2020/10/24/work/company-ghost-story-6/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 6</a>
          </li>
        
          <li>
            <a class="text" href="/2020/09/30/work/company-ghost-story-5/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 5</a>
          </li>
        
          <li>
            <a class="text" href="/2020/09/26/work/company-ghost-story-4/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 4</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>