<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 解題區 - UVa | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/解題區-UVa/page/45/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-oj/uva/uva-198" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-198/" class="article-date">
  <time datetime="2014-06-24T10:55:25.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-198/">UVa 198 - Peter&#39;s Calculator</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-198/" data-id="ckpaivccu00m1n8vn6lzkhy5k" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-198/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/五則運算/">五則運算</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Unfortunately, Peter’s Calculator broke down last week. Now Peter is left with his computer, which has no calculator application, and paper and pencil, which is too tiresome for an engineer. As one of Peter’s friends, you are asked to write him a calculator application. After talking to him, you figure out the following:</p>
<ul>
<li>Peter does only integer arithmetic. The operations he needs are addition, subtraction and multiplication.</li>
<li>He would like to use an arbitrary number of variables whose names are not longer than 50 characters.</li>
<li>His main way of doing calculations are to type in a few formulas and to assign them to variables. Some formulas are complicated expressions, which can refer to yet undefined variables, while other formulas consist of a single number. Then Peter asks for the value of some variables, i.e. he evaluates the formulas.</li>
<li>Peters wants to redefine some variables and then to reevaluate formulas that depend on these variables.  </li>
</ul>
<p>The input strictly adheres to the following syntax (given in EBNF):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">file = line &#123; line &#125; &lt;EOF&gt;.</span><br><span class="line">line = [ assignment | print | reset ] &lt;CR&gt;.</span><br><span class="line">assignment = var &quot;:=&quot; expression.</span><br><span class="line">print = &quot;PRINT&quot; var.</span><br><span class="line">reset = &quot;RESET&quot;.</span><br><span class="line">expression = term &#123; addop term &#125;.</span><br><span class="line">term = factor &#123; mulop factor &#125;.</span><br><span class="line">factor = &quot;(&quot; expression &quot;)&quot; | var | number.</span><br><span class="line">addop = &quot;+&quot; | &quot;-&quot;.</span><br><span class="line">mulop = &quot;*&quot;.</span><br></pre></td></tr></table></figure>

<p>In the Extended Backus-Naur Formalism (EBNF), A = B C declares that the grammatical construct A consists of a B followed by a C . A = B | C means that A consists of a B or, alternatively, of a C . A = [ B ] defines construct A to be either a B or nothing and A = B tells you that A consists of the concatenation of any number of B’s (including none).</p>
<p>The production var stands for the name of a variable, which starts with a letter followed by up to 49 letters or digits. Letters may be uppercase or lowercase. The production number stands for a integer number. The precise syntax for these productions are given below. The case of letters is important for both variables and statements.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var = letter &#123; letter | digit &#125;.</span><br><span class="line">number = [ &quot;-&quot; ] digit &#123; digit &#125;.</span><br><span class="line">letter = &quot;A&quot; | &quot;B&quot; | ... | &quot;Z&quot; | &quot;a&quot; | &quot;b&quot; | ... | &quot;z&quot;.</span><br><span class="line">digit = &quot;0&quot; | &quot;1&quot; | ... | &quot;8&quot; | &quot;9&quot;.</span><br></pre></td></tr></table></figure>

<p>Between the parts of a grammatical construct but not within the names of variables or integer numbers, any number of spaces may appear. <EOF> stands for the end of the input file and <CR> stands for the new-line character. All lines in the input file are shorter than 200 characters.</p>
<p>The value of a variable is said to be undefined:</p>
<ul>
<li>if it has not yet been defined or it refers to a variable, which has not yet been defined;</li>
<li>if the definition of the variable contains a cycle. </li>
</ul>
<p>Your are to write a program that implements Peter’s calculator. It should store all variable definitions and for each “PRINT” statement evaluate the specified variable based on the latest variable definitions. If your program encounters a “RESET” statement, it should delete all stored variables so that all variables become undefined.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input file contains calculations adhering to the syntax given above. Each line contains either an assignment to a variable, a “PRINT” statement, a “RESET” statement or nothing.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each “PRINT” statement found in the input file, your program should output a line containing the numerical value of the specified variable or the word “UNDEF” if the variable is undefined.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a := b + c</span><br><span class="line">b := 3</span><br><span class="line">c := 5</span><br><span class="line">PRINT d</span><br><span class="line">PRINT a</span><br><span class="line">b := 8</span><br><span class="line">PRINT a</span><br><span class="line">RESET</span><br><span class="line">PRINT a</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UNDEF</span><br><span class="line">8</span><br><span class="line">13</span><br><span class="line">UNDEF</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>輸入有一連串的變數函數，適時地打印出詢問的變數值，如果存在循環依靠 (無法推論) 或者是變數尚未定義，直接輸出 UNDEF。</p>
<p>後輸入的變數函數會覆蓋原先的函數。</p>
<p>** 題目解法： **</p>
<p>將每一組函數轉成後序運算式子，爾後再使用深度優先搜索走訪查看是否有環。</p>
<p>著重的問題在於負數的分析，例如 <code>0 - -50</code>, <code>(a + b) - 50</code> 等等。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;ctype.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority_op</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span>(c) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:<span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isoperator</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="built_in"><span class="keyword">switch</span></span>(c) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;(&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;)&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:<span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>: <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isvariable</span><span class="params">(string token)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">isalpha</span>(token[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trans</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *infix, <span class="keyword">char</span> buffer[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="built_in">strlen</span>(infix), prevOp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">char</span> *ptr = buffer;</span><br><span class="line">    stack&lt;<span class="keyword">char</span>&gt; op;</span><br><span class="line">    *ptr = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">isalpha</span>(infix[i]) || <span class="built_in">isdigit</span>(infix[i]) </span><br><span class="line">            || (infix[i] == <span class="string">&#x27;-&#x27;</span> &amp;&amp; <span class="built_in">isdigit</span>(infix[i+<span class="number">1</span>]) &amp;&amp; prevOp)) &#123;</span><br><span class="line">            prevOp = <span class="number">0</span>;</span><br><span class="line">        	<span class="built_in">sprintf</span>(ptr, <span class="string">&quot;%c&quot;</span>, infix[i]), i++;</span><br><span class="line">        	<span class="keyword">while</span>(*ptr)    ptr++;</span><br><span class="line">            <span class="keyword">while</span>(<span class="built_in">isalpha</span>(infix[i]) || <span class="built_in">isdigit</span>(infix[i])) &#123;</span><br><span class="line">            	<span class="built_in">sprintf</span>(ptr, <span class="string">&quot;%c&quot;</span>, infix[i]), i++;</span><br><span class="line">            	<span class="keyword">while</span>(*ptr)    ptr++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">sprintf</span>(ptr, <span class="string">&quot; &quot;</span>), i--;</span><br><span class="line">            <span class="keyword">while</span>(*ptr)		ptr++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        	prevOp = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span>(infix[i] == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span>(!op.<span class="built_in">empty</span>() &amp;&amp; op.<span class="built_in">top</span>() != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    <span class="built_in">sprintf</span>(ptr, <span class="string">&quot;%c &quot;</span>, op.<span class="built_in">top</span>()), op.<span class="built_in">pop</span>();</span><br><span class="line">                    <span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">                &#125;</span><br><span class="line">                op.<span class="built_in">pop</span>();</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(infix[i] != <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">                    <span class="keyword">while</span>(!op.<span class="built_in">empty</span>() &amp;&amp; <span class="built_in">priority_op</span>(op.<span class="built_in">top</span>()) &gt;= <span class="built_in">priority_op</span>(infix[i])) &#123;</span><br><span class="line">                        <span class="built_in">sprintf</span>(ptr, <span class="string">&quot;%c &quot;</span>, op.<span class="built_in">top</span>()), op.<span class="built_in">pop</span>();</span><br><span class="line">                        <span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">                    &#125;</span><br><span class="line">            	&#125;</span><br><span class="line">            	prevOp = <span class="number">1</span>;</span><br><span class="line">                op.<span class="built_in">push</span>(infix[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!op.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(ptr, <span class="string">&quot;%c &quot;</span>, op.<span class="built_in">top</span>()), op.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">while</span>(*ptr) ptr++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">trimWhiteSpace</span><span class="params">(<span class="keyword">char</span> s[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; s[i]; i++)</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">isspace</span>(s[i]))</span><br><span class="line">            s[j++] = s[i];</span><br><span class="line">    s[j] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">map&lt;string, string&gt; VAL_exp;</span><br><span class="line">map&lt;string, <span class="keyword">int</span>&gt;	VAL_val;</span><br><span class="line">map&lt;string, <span class="keyword">int</span>&gt;	VAL_stk;</span><br><span class="line"><span class="keyword">int</span> error_FLAG;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calcPostfix</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* postfix)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">(string VAL_name)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">isvariable</span>(VAL_name)) &#123;</span><br><span class="line">    	<span class="function">stringstream <span class="title">scin</span><span class="params">(VAL_name)</span></span>;</span><br><span class="line">    	<span class="keyword">int</span> value;</span><br><span class="line">    	scin &gt;&gt; value;</span><br><span class="line">    	<span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(VAL_exp.<span class="built_in">find</span>(VAL_name) == VAL_exp.<span class="built_in">end</span>() || VAL_stk[VAL_name]) &#123;</span><br><span class="line">        error_FLAG = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(VAL_val.<span class="built_in">find</span>(VAL_name) == VAL_val.<span class="built_in">end</span>()) &#123;</span><br><span class="line">        VAL_stk[VAL_name] = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;solving &quot; &lt;&lt; VAL_name &lt;&lt; &quot;, &quot; &lt;&lt; VAL_exp[VAL_name] &lt;&lt; endl; </span></span><br><span class="line">        VAL_val[VAL_name] = <span class="built_in">calcPostfix</span>(VAL_exp[VAL_name].<span class="built_in">c_str</span>());</span><br><span class="line"><span class="comment">//		cout &lt;&lt; &quot;solved &quot; &lt;&lt; VAL_name &lt;&lt; &quot;, val = &quot; &lt;&lt; VAL_val[VAL_name] &lt;&lt; endl;</span></span><br><span class="line">        VAL_stk[VAL_name] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> VAL_val[VAL_name];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calcPostfix</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* postfix)</span> </span>&#123;</span><br><span class="line">    <span class="function">stringstream 	<span class="title">scin</span><span class="params">(postfix)</span></span>;</span><br><span class="line">    stack&lt;<span class="keyword">int</span>&gt; 		stk;</span><br><span class="line">    string			token;</span><br><span class="line">    <span class="keyword">int</span> 			a, b;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(scin &gt;&gt; token) &#123;</span><br><span class="line">    	<span class="keyword">if</span>(token.<span class="built_in">length</span>() == <span class="number">1</span> &amp;&amp; <span class="built_in">isoperator</span>(token[<span class="number">0</span>])) &#123;</span><br><span class="line">            b = stk.<span class="built_in">top</span>(), stk.<span class="built_in">pop</span>();</span><br><span class="line">            a = stk.<span class="built_in">top</span>(), stk.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="built_in"><span class="keyword">switch</span></span>(token[<span class="number">0</span>]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: a = a+b;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>: a = a-b;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>: a = a*b;<span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>: a = a/b;<span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(a);</span><br><span class="line">    	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    		stk.<span class="built_in">push</span>(<span class="built_in">getValue</span>(token));</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="keyword">if</span>(error_FLAG)	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stk.<span class="built_in">top</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printVal</span><span class="params">(string valName)</span> </span>&#123;</span><br><span class="line">    error_FLAG = <span class="number">0</span>;</span><br><span class="line">    VAL_val.<span class="built_in">clear</span>();</span><br><span class="line">    VAL_stk.<span class="built_in">clear</span>();</span><br><span class="line">    <span class="keyword">int</span> val = <span class="built_in">getValue</span>(valName);</span><br><span class="line">    <span class="keyword">if</span>(error_FLAG)</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;UNDEF&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, val);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//	freopen(&quot;input.txt&quot;, &quot;r+t&quot;, stdin);</span></span><br><span class="line"><span class="comment">//	freopen(&quot;out.txt&quot;, &quot;w+t&quot;, stdout); </span></span><br><span class="line">    string 	LHS, RHS;</span><br><span class="line">    <span class="keyword">int</span> 	pos;</span><br><span class="line">    <span class="keyword">char</span> 	postfix[<span class="number">32767</span>], lines[<span class="number">32767</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">gets</span>(lines)) &#123;</span><br><span class="line">    	<span class="built_in">trimWhiteSpace</span>(lines);</span><br><span class="line">    	<span class="function">string <span class="title">str</span><span class="params">(lines)</span></span>;</span><br><span class="line">    	<span class="keyword">if</span>(str.<span class="built_in">find</span>(<span class="string">&quot;:=&quot;</span>) != string::npos) &#123;</span><br><span class="line">    		pos = str.<span class="built_in">find</span>(<span class="string">&quot;:=&quot;</span>);</span><br><span class="line">    		LHS = str.<span class="built_in">substr</span>(<span class="number">0</span>, pos);</span><br><span class="line">    		RHS = str.<span class="built_in">substr</span>(pos + <span class="number">2</span>);</span><br><span class="line">    		<span class="built_in">trans</span>(RHS.<span class="built_in">c_str</span>(), postfix);</span><br><span class="line">    		VAL_exp[LHS] = postfix;</span><br><span class="line">    	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(str.<span class="built_in">find</span>(<span class="string">&quot;PRINT&quot;</span>) != string::npos) &#123;</span><br><span class="line">    		pos = str.<span class="built_in">find</span>(<span class="string">&quot;PRINT&quot;</span>);</span><br><span class="line">    		RHS = str.<span class="built_in">substr</span>(pos + <span class="number">5</span>);</span><br><span class="line">    		<span class="built_in">printVal</span>(RHS);</span><br><span class="line">    	&#125; <span class="keyword">else</span> <span class="keyword">if</span>(str.<span class="built_in">find</span>(<span class="string">&quot;RESET&quot;</span>) != string::npos) &#123;</span><br><span class="line">    		VAL_exp.<span class="built_in">clear</span>();</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11178" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-11178/" class="article-date">
  <time datetime="2014-06-24T09:56:23.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-11178/">UVa 11178 - Morley&#39;s Theorem</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-11178/" data-id="ckpaivcbg00g8n8vn4pzi92ko" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-11178/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Morley’s theorem states that that the lines trisecting the angles of an arbitrary plane triangle meet at the vertices of an equilateral triangle. For example in the figure below the tri-sectors of angles A, B and C has intersected and created an equilateral triangle DEF. </p>
<p>Of course the theorem has various generalizations, in particular if all of the tri-sectors are intersected one obtains four other equilateral triangles. But in the original theorem only tri-sectors nearest to BC are allowed to intersect to get point D, tri-sectors nearest to CA are allowed to intersect point E and tri-sectors nearest to AB are intersected to get point F. Trisector like BD and CE are not allowed to intersect. So ultimately we get only one equilateral triangle DEF. Now your task is to find the Cartesian coordinates of D, E and F given the coordinates of A, B, and C.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>First line of the input file contains an integer N (0&lt;N&lt;5001) which denotes the number of test cases to follow. Each of the next lines contain six integers . This six integers actually indicates that the Cartesian coordinates of point A, B and C are  respectively. You can assume that the area of triangle ABC is not equal to zero,  and the points A, B and C are in counter clockwise order.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each line of input you should produce one line of output. This line contains six floating point numbers  separated by a single space. These six floating-point actually means that the Cartesian coordinates of D, E and F are  respectively. Errors less than   will be accepted.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">1 1 2 2 1 2</span><br><span class="line">0 0 100 0 50 50</span><br></pre></td></tr></table></figure>

<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.316987 1.816987 1.183013 1.683013 1.366025 1.633975</span><br><span class="line">56.698730 25.000000 43.301270 25.000000 50.000000 13.397460</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>給一個三角形，將每一個角三等分後，交三角形內部三個點，求這三個點座標。</p>
<p>** 題目解法： **</p>
<p>向量旋轉、射線交點。</p>
<p>射線交點的部分採用最簡單的克拉瑪方程求解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pt</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    <span class="built_in">Pt</span>(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</span><br><span class="line">    	<span class="built_in">x</span>(a), <span class="built_in">y</span>(b) &#123;&#125;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(x-a.x) &gt; eps)</span><br><span class="line">            <span class="keyword">return</span> x &lt; a.x;</span><br><span class="line">        <span class="keyword">return</span> y &lt; a.y;</span><br><span class="line">    &#125;</span><br><span class="line">    Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</span><br><span class="line">        Pt ret;</span><br><span class="line">        ret.x = x - a.x;</span><br><span class="line">        ret.y = y - a.y;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hypot</span>(a.x - b.x, a.y - b.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">length</span><span class="params">(Pt a)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">hypot</span>(a.x, a.y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.x + a.y * b.y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a.x * b.y - a.y * b.x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Pt o, Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y) - (a.y-o.y)*(b.x-o.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">angle</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">acos</span>(<span class="built_in">dot</span>(a, b) / <span class="built_in">length</span>(a) / <span class="built_in">length</span>(b));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Pt <span class="title">rotateRadian</span><span class="params">(Pt a, <span class="keyword">double</span> radian)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    x = a.x * <span class="built_in">cos</span>(radian) - a.y * <span class="built_in">sin</span>(radian);</span><br><span class="line">    y = a.x * <span class="built_in">sin</span>(radian) + a.y * <span class="built_in">cos</span>(radian);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Pt</span>(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Pt <span class="title">getIntersection</span><span class="params">(Pt p, Pt l1, Pt q, Pt l2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a1, a2, b1, b2, c1, c2;</span><br><span class="line">    <span class="keyword">double</span> dx, dy, d;</span><br><span class="line">    a1 = l1.y, b1 = -l1.x, c1 = a1 * p.x + b1 * p.y;</span><br><span class="line">    a2 = l2.y, b2 = -l2.x, c2 = a2 * q.x + b2 * q.y;</span><br><span class="line">    d = a1 * b2 - a2 * b1;</span><br><span class="line">    dx = b2 * c1 - b1 * c2;</span><br><span class="line">    dy = a1 * c2 - a2 * c1;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Pt</span>(dx / d, dy / d);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Pt <span class="title">solve</span><span class="params">(Pt A, Pt B, Pt C)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> radABC = <span class="built_in">angle</span>(A - B, C - B);</span><br><span class="line">    <span class="keyword">double</span> radACB = <span class="built_in">angle</span>(A - C, B - C);</span><br><span class="line">    </span><br><span class="line">    Pt vB = <span class="built_in">rotateRadian</span>(C - B, radABC /<span class="number">3</span>);</span><br><span class="line">    Pt vC = <span class="built_in">rotateRadian</span>(B - C, - radACB /<span class="number">3</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">getIntersection</span>(B, vB, C, vC);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        Pt A, B, C, D, E, F;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;A.x, &amp;A.y);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;B.x, &amp;B.y);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf&quot;</span>, &amp;C.x, &amp;C.y);</span><br><span class="line">        D = <span class="built_in">solve</span>(A, B, C);</span><br><span class="line">        E = <span class="built_in">solve</span>(B, C, A);</span><br><span class="line">        F = <span class="built_in">solve</span>(C, A, B);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lf %lf %lf %lf %lf %lf\n&quot;</span>, D.x, D.y, E.x, E.y, F.x, F.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-427" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-427/" class="article-date">
  <time datetime="2014-06-24T09:33:19.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-427/">UVa 427 - FlatLand Piano Movers</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-427/" data-id="ckpaivccy00mgn8vngh752bho" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-427/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/三分/">三分</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>FlatLand Piano Movers, as part of their Total Quality Management project, has decided to focus on the job estimation process. Part of this process involves walking the proposed paths that are to be used to move a piano to see if it will fit through corridors and around corners. Now this is harder than it might seem, since FlatLand is a 2-dimensional world.</p>
<p>FlatLand pianos are rectangles of various sizes. FlatLand building codes require all turns in corridors to be right angle turns and prohibit <code>T</code> intersections. All dimensions are in furlongs. You can assume that each portion of a corridor is long enough so that other corners or doors into rooms don’t have any effect on getting around a turn. You can also assume that the piano is narrower than the width of any corridor. Note that the piano actually has to turn in the corner, since it can only be pushed or pulled on one of its shorter sides (there are no square pianos).</p>
<p>Your team’s job is to write a program for a palmtop computer that will determine if a given piano will fit around a corner in a corridor.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input consists of a series of lines up to 80 columns in width followed by the end-of-file. Each line consists of a series of number pairs. The numbers of a pair are separated by a comma and the pairs are separated by at least one space. The first pair is the size of a piano, and the remaining pairs are the widths of corridors on each side of the turns. Consider the example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">600,200 300,500 837,500 350,350</span><br></pre></td></tr></table></figure>

<p>This is a 600 by 200 piano. The first turn is from a 300 furlong wide corridor through a right angle turn into a 500 furlong wide corridor. The next turn is from an 837 furlong wide corridor into one 500 furlongs wide. The last turn is from a 350 furlong wide corridor into another 350 furlong wide corridor.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each piano, your program is to produce a yes-or-no answer for each turn. If the piano will fit around the turn, print <code>Y&#39;&#39;; if not, print </code>N’’. The results for each piano should be printed on a separate line.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">600,200   300,500   837,500  350,350 </span><br><span class="line">137,1200 600,500 600,400</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">YYN</span><br><span class="line">YN</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>一台鋼琴長寬 W, H，接著要經過一個 T 字路口，進去之後向右轉，一開始進去的寬度為 X，右轉之後的寬度為 Y，問能不能順利轉彎。</p>
<p>每組輸入給定一台鋼琴長寬，接著給定多組路口寬組合。</p>
<p>** 題目解法： **</p>
<blockquote><p><img src="/img/2011082521262354.jpg" alt="三分"></p>
<p>汽车拐弯问题，给定 X, Y, l, d 判断是否能够拐弯。首先当 X 或者 Y 小于 d，那么一定不能。<br>其次我们发现随着角度 θ 的增大，最大高度 h 先增长后减小，即为凸性函数，可以用三分法来求解。</p>
<p>这里的 Calc 函数需要比较繁琐的推倒公式：<br>s = l * cos(θ) + w * sin(θ) - x;<br>h = s * tan(θ) + w * cos(θ);<br>其中 s 为汽车最右边的点离拐角的水平距离, h 为里拐点最高的距离, θ 范围从 0 到 90。</p>
<footer><strong>轉貼備份</strong><cite><a href="http://www.cnblogs.com/newpanderking/archive/2011/08/25/2153777.html">www.cnblogs.com/newpanderking/archive/2011/08/25/2153777.html</a></cite></footer></blockquote>

<p>看著大神給的三分搜索的式子，用簡單的凸性勾勒出來。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// http://www.cnblogs.com/newpanderking/archive/2011/08/25/2153777.html</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6 </span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">ternary_search</span><span class="params">(<span class="keyword">double</span> H, <span class="keyword">double</span> W, <span class="keyword">double</span> X, <span class="keyword">double</span> Y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> l = <span class="number">0</span>, r = pi /<span class="number">2</span>, mid, midmid;</span><br><span class="line">    <span class="keyword">double</span> s1, h1, s2, h2;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">fabs</span>(l - r) &gt; eps) &#123;</span><br><span class="line">        mid = (l + r) /<span class="number">2</span>;</span><br><span class="line">        midmid = (mid + r) /<span class="number">2</span>;</span><br><span class="line">        s1 = H * <span class="built_in">cos</span>(mid) + W * <span class="built_in">sin</span>(mid) - X;</span><br><span class="line">        h1 = s1 * <span class="built_in">tan</span>(mid) + W * <span class="built_in">cos</span>(mid);</span><br><span class="line">        s2 = H * <span class="built_in">cos</span>(midmid) + W * <span class="built_in">sin</span>(midmid) - X;</span><br><span class="line">        h2 = s2 * <span class="built_in">tan</span>(midmid) + W * <span class="built_in">cos</span>(midmid);</span><br><span class="line">        <span class="keyword">if</span>(h1 &lt; h2)</span><br><span class="line">            l = mid;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r = mid;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> line[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">gets</span>(line)) &#123;</span><br><span class="line">        <span class="function">stringstream <span class="title">sin</span><span class="params">(line)</span></span>;</span><br><span class="line">        string token;</span><br><span class="line">        sin &gt;&gt; token;</span><br><span class="line">        <span class="keyword">double</span> H, W, X, Y;</span><br><span class="line">        <span class="built_in">sscanf</span>(token.<span class="built_in">c_str</span>(), <span class="string">&quot;%lf,%lf&quot;</span>, &amp;H, &amp;W);</span><br><span class="line">        <span class="keyword">if</span>(H &lt; W)</span><br><span class="line">            <span class="built_in">swap</span>(H, W);</span><br><span class="line">        <span class="keyword">while</span>(sin &gt;&gt; token) &#123;</span><br><span class="line">            <span class="built_in">sscanf</span>(token.<span class="built_in">c_str</span>(), <span class="string">&quot;%lf,%lf&quot;</span>, &amp;X, &amp;Y);</span><br><span class="line">            <span class="keyword">double</span> h = <span class="built_in">ternary_search</span>(H, W, X, Y);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, h &lt;= Y ? <span class="string">&#x27;Y&#x27;</span> : <span class="string">&#x27;N&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-174" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-174/" class="article-date">
  <time datetime="2014-06-24T09:17:39.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-174/">UVa 174 - Strategy</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/" data-id="ckpaivccu00lyn8vn6nxc7lyo" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴分析/">遞迴分析</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one point. If one TRADEs and the other CHEATs then the TRADEr loses 2 points and the CHEATer wins 2. If both CHEAT then each loses 1 point.</p>
<p>There are a variety of different strategies for playing this game, although most people are either unable to find a winning strategy, or, having decided on a strategy, do not stick to it. Thus it is fairer to attempt to evaluate these strategies by simulation on a computer. Each strategy is simulated by an automaton. An automaton is characterised by a program incorporating the strategy, a memory for previous encounters and a count reflecting the score of that automaton. The count starts at zero and is altered according to the above rules after each encounter. The memory is able to determine what happened on up to the last two encounters with each other contender.</p>
<p>Write a program that will read in details of up to 10 different strategies, play each strategy against each other strategy 10 times and then print out the final scores. Strategies will be in the form of simple programs obeying the following grammar:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;program&gt; ::= &lt;statement&gt;.</span><br><span class="line">&lt;statement&gt; ::= &lt;command&gt; tex2html_wrap_inline45 &lt;ifstat&gt;</span><br><span class="line">&lt;ifstat&gt; ::= IF &lt;condition&gt; THEN &lt;statement&gt; ELSE &lt;statement&gt;</span><br><span class="line">&lt;condition&gt; ::= &lt;cond&gt; tex2html_wrap_inline45 &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</span><br><span class="line">&lt;op&gt; ::= AND tex2html_wrap_inline45 OR</span><br><span class="line">&lt;cond&gt; ::= &lt;memory&gt; &#123;= tex2html_wrap_inline45 #&#125; &#123;&lt;command&gt; tex2html_wrap_inline45 NULL&#125;</span><br><span class="line">&lt;memory&gt; ::= &#123;MY tex2html_wrap_inline45 YOUR&#125; LAST &#123;1 tex2html_wrap_inline45 2&#125;</span><br><span class="line">&lt;command&gt; ::= TRADE tex2html_wrap_inline45 CHEAT </span><br></pre></td></tr></table></figure>

<p>Note that LAST1 refers to the previous encounter between these two automata, LAST2 to the encounter before that and that <code>MY&#39; and </code>YOUR’ have the obvious meanings. Spaces and line breaks may appear anywhere in the program and are for legibility only. The symbol <code>#&#39; means </code>is not equal to’. NULL indicates that an encounter has not ocurred. The following are valid programs:</p>
<p>CHEAT.<br>IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.<br>IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE<br>ELSECHEAT.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of a series of programs. Each program will be no longer than 255 characters and may be split over several lines for convenience. There will be no more than 10 programs. The file will be terminated by a line containing only a single `#’.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of one line for each line of input. Each line will consist of the final score of the relevant program right justified in a field of width 3.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CHEAT.</span><br><span class="line">IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.</span><br><span class="line">IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE</span><br><span class="line">ELSECHEAT.</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  1</span><br><span class="line">-12</span><br><span class="line">-13</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>現在這邊有兩台機器人，玩類似 “吹牛” 的紙牌遊戲，欺騙成功者將獲得點數。</p>
<p>而每一台機器的策略也有所不同，並且能根據對方前幾次和自己前幾次的策略進行判斷，給予每一台機器的策略模式，請兩兩互打 10 回合，最後輸出每一台機器的得分概況。</p>
<p>** 題目解法： **</p>
<p>這題不只有語法分析，還有語意分析。總之，遞迴分析是最主要的技巧。<br>對於 AND 和 OR 運算，測資中似乎沒有優先順序的情況，所以直接由左而右進行即可。</p>
<p>而在分析的時候，嘗試將指針一直往後移動，並且解析出第一個符合條件的 token。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">#include &lt;assert.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">enum ACTION &#123;TRADE, CHEAT, EMPTY&#125;;</span><br><span class="line">enum RECORD &#123;LAST1, LAST2&#125;;</span><br><span class="line">class Memory &#123;</span><br><span class="line">public:</span><br><span class="line">    map&lt;RECORD, ACTION&gt; R;</span><br><span class="line">    Memory() &#123;</span><br><span class="line">        R[LAST1] = EMPTY;</span><br><span class="line">        R[LAST2] = EMPTY;</span><br><span class="line">    &#125;</span><br><span class="line">    static ACTION getAction(string s) &#123;</span><br><span class="line">        if(s == &quot;TRADE&quot;)    return TRADE;</span><br><span class="line">        if(s == &quot;CHEAT&quot;)    return CHEAT;</span><br><span class="line">        if(s == &quot;EMPTY&quot;)    return EMPTY;</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION getMemory(string addr) &#123;</span><br><span class="line">        if (addr == &quot;LAST1&quot;)</span><br><span class="line">            return R[LAST1];</span><br><span class="line">        if (addr == &quot;LAST2&quot;)</span><br><span class="line">            return R[LAST2];</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    void record(ACTION a) &#123;</span><br><span class="line">        ACTION last1 = R[LAST1], last2 = R[LAST2];</span><br><span class="line">        R[LAST1] = a;</span><br><span class="line">        R[LAST2] = last1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">class Strategy &#123;</span><br><span class="line">public:</span><br><span class="line">    char prog[1024];</span><br><span class="line">    Strategy(string s) &#123;</span><br><span class="line">        for (int i = 0; i &lt; s.length(); i++) &#123;</span><br><span class="line">            prog[i] = s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        prog[s.length()] = &#x27;\0&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    char* match(char *str, const char *p) &#123;</span><br><span class="line">        if (str == NULL)</span><br><span class="line">            return  NULL;</span><br><span class="line">        if (memcmp(str, p, strlen(p)) == 0)</span><br><span class="line">            return str + strlen(p);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line">/*</span><br><span class="line"> &lt;condition&gt; ::= &lt;cond&gt; | &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</span><br><span class="line"> &lt;op&gt; ::= AND | OR</span><br><span class="line"> &lt;cond&gt; ::= &lt;memory&gt; &#123;= | #&#125; &#123;&lt;command&gt; | NULL&#125;</span><br><span class="line"> &lt;memory&gt; ::= &#123;MY | YOUR&#125; LAST &#123;1 | 2&#125;</span><br><span class="line"> &lt;command&gt; ::= TRADE | CHEAT</span><br><span class="line"> */</span><br><span class="line">    bool cond(char* &amp;p, Memory MY, Memory YOUR) &#123;</span><br><span class="line">        // printf(&quot;condition %s\n&quot;, p);</span><br><span class="line">        char        *q;</span><br><span class="line">        Memory      *addr = NULL;</span><br><span class="line">        string      read, equal, kind;</span><br><span class="line">        /* &lt;memory&gt; */</span><br><span class="line">        q = match(p, &quot;MY&quot;);</span><br><span class="line">        if(q != NULL)   p = q, addr = &amp;MY;</span><br><span class="line">        q = match(p, &quot;YOUR&quot;);</span><br><span class="line">        if(q != NULL)   p = q, addr = &amp;YOUR;</span><br><span class="line">        q = match(p, &quot;LAST1&quot;);</span><br><span class="line">        if(q != NULL)   p = q, read = &quot;LAST1&quot;;</span><br><span class="line">        q = match(p, &quot;LAST2&quot;);</span><br><span class="line">        if(q != NULL)   p = q, read = &quot;LAST2&quot;;</span><br><span class="line">        /* &#123;= | #&#125; */</span><br><span class="line">        q = match(p, &quot;=&quot;);</span><br><span class="line">        if(q != NULL)   p = q, equal = &quot;=&quot;;</span><br><span class="line">        q = match(p, &quot;#&quot;);</span><br><span class="line">        if(q != NULL)   p = q, equal = &quot;#&quot;;</span><br><span class="line">        /* &#123;&lt;command&gt; | NULL&#125; */</span><br><span class="line">        q = match(p, &quot;TRADE&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;TRADE&quot;;</span><br><span class="line">        q = match(p, &quot;CHEAT&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;CHEAT&quot;;</span><br><span class="line">        q = match(p, &quot;NULL&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;EMPTY&quot;;</span><br><span class="line">        bool ret = equal == &quot;=&quot; ? addr-&gt;getMemory(read) == Memory::getAction(kind) :</span><br><span class="line">                                    addr-&gt;getMemory(read) != Memory::getAction(kind);</span><br><span class="line">        // cout &lt;&lt; &quot;ADDR: &quot; &lt;&lt; addr-&gt;getMemory(read) &lt;&lt; &quot;, ACTION: &quot; &lt;&lt; Memory::getAction(kind) &lt;&lt; endl;</span><br><span class="line">        // cout &lt;&lt; read &lt;&lt; &quot;, &quot; &lt;&lt; kind &lt;&lt; endl; </span><br><span class="line">        /* &lt;op&gt; &lt;condition&gt; */</span><br><span class="line">        q = match(p, &quot;AND&quot;);</span><br><span class="line">        if(q != NULL)  p = q, ret = ret&amp;cond(p, MY, YOUR);</span><br><span class="line">        q = match(p, &quot;OR&quot;);</span><br><span class="line">        if(q != NULL)  p = q, ret = ret|cond(p, MY, YOUR);</span><br><span class="line">        // cout &lt;&lt; &quot;return &quot; &lt;&lt; ret &lt;&lt; endl;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION ifstat(char* &amp;p, Memory a, Memory b) &#123;</span><br><span class="line">        char *q;</span><br><span class="line">        q = match(p, &quot;IF&quot;);</span><br><span class="line">        if (q != NULL) &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            bool f = cond(p, a, b);</span><br><span class="line">            ACTION a1, a2;</span><br><span class="line">            q = match(p, &quot;THEN&quot;);</span><br><span class="line">            p = q;</span><br><span class="line">            a1 = statement(p, a, b);</span><br><span class="line">            q = match(p, &quot;ELSE&quot;);</span><br><span class="line">        	p = q;</span><br><span class="line">        	a2 = statement(p, a, b);</span><br><span class="line">        	return f ? a1 : a2;</span><br><span class="line">        &#125;</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION statement(char* &amp;p, Memory a, Memory b) &#123;</span><br><span class="line">        // printf(&quot;%s\n&quot;, p);</span><br><span class="line">        char *q;</span><br><span class="line">        q = match(p, &quot;TRADE&quot;);</span><br><span class="line">        if (q != NULL)  &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            return TRADE;</span><br><span class="line">        &#125;</span><br><span class="line">        q = match(p, &quot;CHEAT&quot;);</span><br><span class="line">        if (q != NULL) &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            return CHEAT;</span><br><span class="line">        &#125;</span><br><span class="line">        return ifstat(p, a, b);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION eval(char* &amp;p, Memory a, Memory b) &#123; // read only</span><br><span class="line">        // printf(&quot;eval %s\n&quot;, p);</span><br><span class="line">        return statement(p, a, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main() &#123;</span><br><span class="line">    char c, s[1024];</span><br><span class="line">    vector&lt;Strategy&gt; machine;</span><br><span class="line">    while (true) &#123;</span><br><span class="line">        int n = 0;</span><br><span class="line">        while ((c = getchar()) != EOF) &#123;</span><br><span class="line">            if(c == &#x27;.&#x27; || (c == &#x27;#&#x27; &amp;&amp; n == 0) )</span><br><span class="line">                break;</span><br><span class="line">            if(isspace(c))</span><br><span class="line">                continue;</span><br><span class="line">            s[n++] = c;</span><br><span class="line">        &#125;</span><br><span class="line">        if (n == 0)</span><br><span class="line">            break;</span><br><span class="line">        s[n++] = &#x27;\0&#x27;;</span><br><span class="line">        machine.push_back(Strategy(s));</span><br><span class="line">    &#125;</span><br><span class="line">#define MAXN 20</span><br><span class="line">    int SCORE[MAXN] = &#123;&#125;;</span><br><span class="line">    for (int i = 0; i &lt; machine.size(); i++) &#123;</span><br><span class="line">        for (int j = i + 1; j &lt; machine.size(); j++) &#123;</span><br><span class="line">            Memory      ma, mb;</span><br><span class="line">            Strategy    &amp;A = machine[i];</span><br><span class="line">            Strategy    &amp;B = machine[j];</span><br><span class="line">            char        *p;</span><br><span class="line">            </span><br><span class="line">            for (int k = 0; k &lt; 10; k++) &#123;</span><br><span class="line">                ACTION ia = A.eval(p = A.prog, ma, mb);</span><br><span class="line">                ACTION ib = B.eval(p = B.prog, mb, ma);</span><br><span class="line">                if(ia == TRADE &amp;&amp; ib == TRADE)</span><br><span class="line">                	SCORE[i]++, SCORE[j]++;</span><br><span class="line">                else if(ia == TRADE &amp;&amp; ib == CHEAT)</span><br><span class="line">                	SCORE[i] -= 2, SCORE[j] += 2;</span><br><span class="line">                else if(ia == CHEAT &amp;&amp; ib == TRADE)</span><br><span class="line">                	SCORE[i] += 2, SCORE[j] -= 2;</span><br><span class="line">                else</span><br><span class="line">                	SCORE[i]--, SCORE[j]--;</span><br><span class="line">                ma.record(ia), mb.record(ib);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i = 0; i &lt; machine.size(); i++)</span><br><span class="line">    	printf(&quot;%3d\n&quot;, SCORE[i]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-171" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-171/" class="article-date">
  <time datetime="2014-06-24T09:08:12.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/24/oj/uva/uva-171/">UVa 171 - Car Trialling</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-171/" data-id="ckpaivcfv00nzn8vnc2t27hca" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-171/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SLR/">SLR</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Car trialling requires the following of carefully worded instructions. When setting a trial, the organiser places traps in the instructions to catch out the unwary.</p>
<p>Write a program to determine whether an instruction obeys the following rules, which are loosely based on real car trialling instructions. ** BOLD-TEXT ** indicates text as it appears in the instruction (case sensitive), <code>|</code> separates options of which exactly one must be chosen, and .. expands, so A..D is equivalent to A | B | C | D .</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">instruction = navigational | time-keeping | navigational AND time-keeping</span><br><span class="line"></span><br><span class="line">navigational = directional | navigational AND THEN directional</span><br><span class="line"></span><br><span class="line">directional = how direction | how direction where</span><br><span class="line"></span><br><span class="line">how = GO | GO when | KEEP</span><br><span class="line"></span><br><span class="line">direction = RIGHT | LEFT</span><br><span class="line"></span><br><span class="line">when = FIRST | SECOND | THIRD</span><br><span class="line"></span><br><span class="line">where = AT sign</span><br><span class="line"></span><br><span class="line">sign = &quot;signwords&quot;</span><br><span class="line"></span><br><span class="line">signwords = s-word | signwords s-word</span><br><span class="line"></span><br><span class="line">s-word = letter | s-word letter</span><br><span class="line"></span><br><span class="line">letter = A..Z | .</span><br><span class="line"></span><br><span class="line">time-keeping = record tex2html_wrap_inline61 change</span><br><span class="line"></span><br><span class="line">record = RECORD TIME</span><br><span class="line"></span><br><span class="line">change = cas TO nnn KMH</span><br><span class="line"></span><br><span class="line">cas = CHANGE AVERAGE SPEED | CAS</span><br><span class="line"></span><br><span class="line">nnn = digit | nnn digit</span><br></pre></td></tr></table></figure>

<p>digit = 0..9 Note that s-word and nnn are sequences of letters and digits respectively, with no intervening spaces. There will be one or more spaces between items except before a period (.), after the opening speech marks or before the closing speech marks.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Each input line will consist of not more than 75 characters. The input will be terminated by a line consisting of a single #.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>The output will consist of a series of sequentially numbered lines, either containing the valid instruction, or the text Trap! if the line did not obey the rules. The line number will be right justified in a field of 3 characters, followed by a full-stop, a single space, and the instruction, with sequences of more than one space reduced to single spaces.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">KEEP LEFT AND THEN GO RIGHT</span><br><span class="line">CAS TO 20 KMH</span><br><span class="line">GO FIRST       RIGHT AT &quot;SMITH ST.&quot;  AND   CAS TO 20 KMH</span><br><span class="line">GO 2nd RIGHT</span><br><span class="line">GO LEFT AT &quot;SMITH STREET AND RECORD TIME</span><br><span class="line">KEEP RIGHT AND THEN RECORD TIME</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. KEEP LEFT AND THEN GO RIGHT</span><br><span class="line">2. CAS TO 20 KMH</span><br><span class="line">3. GO FIRST RIGHT AT &quot;SMITH ST.&quot; AND CAS TO 20 KMH</span><br><span class="line">4. Trap!</span><br><span class="line">5. Trap!</span><br><span class="line">6. Trap!</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>根據題目給定的規則，將汽車引領的命令句子做合法語句判斷。</p>
<p>** 題目解法： **</p>
<p>根據編譯器的方式，採用 LL(1) 修改題目給定的規則後，要進行建表，但是發現有幾處無法排除的語法規則，之後採用 SLR(1) 來完成。</p>
<p>SLR(1) 是由 LR(0) 加上 follow set 完成。</p>
<p>詳細的運作過程請詳見 wiki 說明，或者是修編譯器。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There will be one or more spaces between items except before a period (.), after the opening speech marks or before the closing speech marks.</span><br></pre></td></tr></table></figure>

<p>本題最邪惡的地方在這裡，句號（.）前不可以用空白，前雙引號後不可有空白、後雙引號前不可以有空白。</p>
<p>雖然題目有包含這些 token 的語法產生，但還是用最暴力的方式將句子做基礎的 token 切割。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;sstream&gt;</span><br><span class="line">#include &lt;string&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">#include &lt;set&gt;</span><br><span class="line">#include &lt;queue&gt;</span><br><span class="line">#include &lt;stack&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">#include &lt;assert.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">#define HTMLProduction</span><br><span class="line">// #define DEBUG</span><br><span class="line"></span><br><span class="line">class Production &#123;</span><br><span class="line">    public:</span><br><span class="line">        int 			label;</span><br><span class="line">        string 			LHS;</span><br><span class="line">        vector&lt;string&gt; 	RHS;</span><br><span class="line">        </span><br><span class="line">        Production(string L = &quot;&quot;, vector&lt;string&gt; R = vector&lt;string&gt;(), int l=0) &#123;</span><br><span class="line">            LHS = L;</span><br><span class="line">            RHS = R;</span><br><span class="line">            label = l;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        bool operator&lt;(const Production &amp;p) const &#123;</span><br><span class="line">            if(LHS != p.LHS)</span><br><span class="line">                return LHS &lt; p.LHS;</span><br><span class="line">            for(size_t i = 0, j = 0; i &lt; RHS.size() &amp;&amp; j &lt; p.RHS.size(); i++, j++) &#123;</span><br><span class="line">                if(RHS[i] != p.RHS[i])</span><br><span class="line">                    return RHS[i] &lt; p.RHS[i];</span><br><span class="line">            &#125;</span><br><span class="line">            return RHS.size() &lt; p.RHS.size();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        bool operator==(const Production &amp;p) const &#123;</span><br><span class="line">            if(LHS != p.LHS || RHS.size() != p.RHS.size())</span><br><span class="line">                return false;</span><br><span class="line">            for(size_t i = 0, j = 0; i &lt; RHS.size(); i++, j++) &#123;</span><br><span class="line">                if(RHS[i] != p.RHS[i])</span><br><span class="line">                    return false;</span><br><span class="line">            &#125;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        bool operator!=(const Production &amp;p) const &#123;</span><br><span class="line">            return !(*this == p);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        void print() &#123;</span><br><span class="line">            printf(&quot;%s -&gt; &quot;, LHS.c_str());</span><br><span class="line">            for(size_t i = 0; i &lt; RHS.size(); i++)</span><br><span class="line">                printf(&quot;%s&quot;, RHS[i].c_str());</span><br><span class="line">        &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">class Grammar &#123;</span><br><span class="line">    public:</span><br><span class="line">        /* LR parsing */</span><br><span class="line">        class ConfigurationSet &#123;</span><br><span class="line">            public:</span><br><span class="line">                class State &#123;</span><br><span class="line">                    public:</span><br><span class="line">                        int dot;</span><br><span class="line">                        vector&lt;string&gt; lookahead;</span><br><span class="line">                        </span><br><span class="line">                        State(int d=0, vector&lt;string&gt; l=vector&lt;string&gt;()):</span><br><span class="line">                            dot(d), lookahead(l) &#123;&#125;</span><br><span class="line">                        bool operator&lt;(const State &amp;x) const &#123;</span><br><span class="line">                            return dot &lt; x.dot;</span><br><span class="line">                        &#125;</span><br><span class="line">                        bool operator!=(const State &amp;x) const &#123;</span><br><span class="line">                            return dot != x.dot;</span><br><span class="line">                        &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">                </span><br><span class="line">                set&lt; pair&lt;Production, State&gt; &gt; 	configs;</span><br><span class="line">                int 							label;</span><br><span class="line">                ConfigurationSet() &#123;</span><br><span class="line">                    label = 0;</span><br><span class="line">                &#125;</span><br><span class="line">                /* method */</span><br><span class="line">                static ConfigurationSet closure0(ConfigurationSet&amp; s, Grammar&amp; g);</span><br><span class="line">                static ConfigurationSet go_to0(ConfigurationSet&amp; s, string X, Grammar&amp; g);</span><br><span class="line">                void print(Grammar &amp;g) &#123;</span><br><span class="line">                    set&lt; pair&lt;Production, State&gt; &gt;::iterator it;</span><br><span class="line">                    Production p;</span><br><span class="line">                    </span><br><span class="line">                    for(it = configs.begin(); it != configs.end(); it++) &#123;</span><br><span class="line">                        p = it-&gt;first;</span><br><span class="line">                        printf(&quot;%s -&gt;&quot;, p.LHS.c_str());</span><br><span class="line">                        for(size_t i = 0; i &lt; p.RHS.size(); i++) &#123;</span><br><span class="line">                            if(i == it-&gt;second.dot)</span><br><span class="line">                                printf(&quot;¡E&quot;);</span><br><span class="line">                            printf(&quot; %s &quot;, p.RHS[i].c_str());</span><br><span class="line">                        &#125;</span><br><span class="line">                        if(it-&gt;second.dot == p.RHS.size())</span><br><span class="line">                            printf(&quot;¡E&quot;);</span><br><span class="line">                        printf(&quot; ,&#123;&quot;);</span><br><span class="line">                        set&lt;string&gt; fset = g.follow_set[p.LHS];</span><br><span class="line">                        for(set&lt;string&gt;::iterator jt = fset.begin();</span><br><span class="line">                            jt != fset.end(); jt++) &#123;</span><br><span class="line">                            if(jt != fset.begin())</span><br><span class="line">                                cout &lt;&lt; &quot;, &quot;;</span><br><span class="line">                            cout &lt;&lt; *jt;</span><br><span class="line">                        &#125;</span><br><span class="line">                        printf(&quot;&#125;&quot;);</span><br><span class="line">                        puts(&quot;&quot;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                bool operator&lt;(const ConfigurationSet &amp;x) const &#123;</span><br><span class="line">                    if(configs.size() != x.configs.size())</span><br><span class="line">                        return configs.size() &lt; x.configs.size();</span><br><span class="line">                    for(set&lt; pair&lt;Production, State&gt; &gt;::iterator it = configs.begin(), jt = x.configs.begin();</span><br><span class="line">                        it != configs.end(); it++, jt++) &#123;</span><br><span class="line">                        if(it-&gt;first != jt-&gt;first)</span><br><span class="line">                            return it-&gt;first &lt; jt-&gt;first;</span><br><span class="line">                        if(it-&gt;second != jt-&gt;second)</span><br><span class="line">                            return it-&gt;second &lt; jt-&gt;second;</span><br><span class="line">                    &#125;</span><br><span class="line">                    return false;</span><br><span class="line">                    // return label &lt; x.label;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;;		</span><br><span class="line">        </span><br><span class="line">        static const string 		lambda;</span><br><span class="line">        set&lt;string&gt;					symbols;</span><br><span class="line">        string 						start_symbol;</span><br><span class="line">        vector&lt;Production&gt; 			rules;</span><br><span class="line">        /* LL(1) attribute */</span><br><span class="line">        map&lt;string, set&lt;string&gt; &gt; 	first_set;</span><br><span class="line">        map&lt;string, set&lt;string&gt; &gt; 	follow_set;</span><br><span class="line">        map&lt;string, bool&gt; 			derives_lambda;</span><br><span class="line">        map&lt;string, map&lt;string, Production&gt; &gt;	lltable;</span><br><span class="line">        /* LR attribute */</span><br><span class="line">        vector&lt;ConfigurationSet&gt;	LRstates;</span><br><span class="line">        map&lt;int, map&lt;string, int&gt; &gt;	go_to_table;</span><br><span class="line">        map&lt;int, int&gt;				action_table;</span><br><span class="line">        </span><br><span class="line">        /* common method */</span><br><span class="line">        static bool isNonterminal(string token);</span><br><span class="line">        void buildSymbols();</span><br><span class="line">        /* LL(1) method */</span><br><span class="line">        map&lt;string, bool&gt; mark_lambda();</span><br><span class="line">        void fill_first_set();</span><br><span class="line">        void fill_follow_set();</span><br><span class="line">        set&lt;string&gt; compute_first(vector&lt;string&gt; rhs);</span><br><span class="line">        set&lt;string&gt; get_predict_set(Production p);</span><br><span class="line">        void fill_lltable();</span><br><span class="line">        void lldriver(queue&lt;string&gt; tokens);</span><br><span class="line">        /* LR method*/</span><br><span class="line">        void build_CFSM();</span><br><span class="line">        void build_action();</span><br><span class="line">        void lr0driver(queue&lt;string&gt; tokens);</span><br><span class="line">        int slr1driver(queue&lt;string&gt; tokens);</span><br><span class="line">        void lalr1driver(queue&lt;string&gt; tokens);</span><br><span class="line">        /* homework */</span><br><span class="line">        void hw_build_CFSM();</span><br><span class="line">&#125;;</span><br><span class="line">/* ------------------------</span><br><span class="line">ConfigurationSet method</span><br><span class="line">-------------------------- */</span><br><span class="line">Grammar::ConfigurationSet Grammar::ConfigurationSet::closure0(ConfigurationSet&amp; s, Grammar&amp; g) &#123;</span><br><span class="line">    ConfigurationSet 	r = s;</span><br><span class="line">    bool				changes;</span><br><span class="line">    string				A;</span><br><span class="line">    Production			P;</span><br><span class="line">    int 				dotPos;</span><br><span class="line">    </span><br><span class="line">    set&lt; pair&lt;Production, State&gt; &gt;::iterator it;</span><br><span class="line">    do &#123;</span><br><span class="line">        changes = false;</span><br><span class="line">        for(it = r.configs.begin(); it != r.configs.end(); it++) &#123;</span><br><span class="line">            P = it-&gt;first;</span><br><span class="line">            dotPos = it-&gt;second.dot;</span><br><span class="line">            if(dotPos &gt;= P.RHS.size() || P.RHS[dotPos] == Grammar::lambda)</span><br><span class="line">                continue;</span><br><span class="line">            A = P.RHS[dotPos];</span><br><span class="line">            if(Grammar::isNonterminal(A)) &#123;</span><br><span class="line">                /* B -&gt; x.Ay */</span><br><span class="line">                /* Predict productions with A as the left-hand side */</span><br><span class="line">                for(size_t i = 0; i &lt; g.rules.size(); i++) &#123;</span><br><span class="line">                    if(g.rules[i].LHS == A) &#123;</span><br><span class="line">                        if(r.configs.find(make_pair(g.rules[i], State(0))) == r.configs.end()) &#123;</span><br><span class="line">                            r.configs.insert(make_pair(g.rules[i], State(0)));</span><br><span class="line">                            changes = true;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; while(changes);</span><br><span class="line">    return r;</span><br><span class="line">&#125;</span><br><span class="line">Grammar::ConfigurationSet Grammar::ConfigurationSet::go_to0(ConfigurationSet&amp; s, string X, Grammar&amp; g) &#123;</span><br><span class="line">    ConfigurationSet sb;</span><br><span class="line">    set&lt; pair&lt;Production, State&gt; &gt;::iterator it;</span><br><span class="line">    Production 	P;</span><br><span class="line">    int 		dotPos;</span><br><span class="line">    </span><br><span class="line">    for(it = s.configs.begin(); it != s.configs.end(); it++) &#123;</span><br><span class="line">        P = it-&gt;first;</span><br><span class="line">        dotPos = it-&gt;second.dot;</span><br><span class="line">        if(dotPos &gt;= P.RHS.size() || P.RHS[dotPos] == Grammar::lambda)</span><br><span class="line">            continue;</span><br><span class="line">        if(P.RHS[dotPos] == X) &#123;</span><br><span class="line">            State state(dotPos + 1, it-&gt;second.lookahead);</span><br><span class="line">            sb.configs.insert(make_pair(P, state));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return closure0(sb, g);</span><br><span class="line">&#125;</span><br><span class="line">/* ------------------------</span><br><span class="line">Grammar method</span><br><span class="line">-------------------------- */</span><br><span class="line">const string Grammar::lambda(&quot;l&quot;);</span><br><span class="line"></span><br><span class="line">set&lt;string&gt; Grammar::compute_first(vector&lt;string&gt; rhs) &#123;</span><br><span class="line">    set&lt;string&gt; result;</span><br><span class="line">    size_t 		i;</span><br><span class="line">    </span><br><span class="line">    if(rhs.size() == 0 || rhs[0] == Grammar::lambda) &#123;</span><br><span class="line">        result.insert(Grammar::lambda);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        result = first_set[rhs[0]];</span><br><span class="line">        for(i = 1; i &lt; rhs.size() &amp;&amp; </span><br><span class="line">            first_set[rhs[i-1]].find(Grammar::lambda) != first_set[rhs[i-1]].end(); i++) &#123;</span><br><span class="line">            set&lt;string&gt; f = first_set[rhs[i]];</span><br><span class="line">            f.erase(Grammar::lambda);</span><br><span class="line">            result.insert(f.begin(), f.end());	</span><br><span class="line">        &#125;</span><br><span class="line">        if(i == rhs.size() </span><br><span class="line">            &amp;&amp; first_set[rhs[i-1]].find(Grammar::lambda) != first_set[rhs[i-1]].end()) &#123;</span><br><span class="line">            result.insert(Grammar::lambda);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            result.erase(Grammar::lambda);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return result;</span><br><span class="line">&#125; </span><br><span class="line">/*</span><br><span class="line"> * please call get_predict_set() after fill_follow_set() and fill_first_set()</span><br><span class="line"> */</span><br><span class="line">set&lt;string&gt; Grammar::get_predict_set(Production p) &#123;</span><br><span class="line">    set&lt;string&gt; result;</span><br><span class="line">    set&lt;string&gt; rfirst;</span><br><span class="line">    </span><br><span class="line">    rfirst = compute_first(p.RHS);</span><br><span class="line">    if(rfirst.find(Grammar::lambda) != rfirst.end()) &#123;</span><br><span class="line">        rfirst.erase(Grammar::lambda);</span><br><span class="line">        result.insert(rfirst.begin(), rfirst.end());</span><br><span class="line">        rfirst = follow_set[p.LHS];</span><br><span class="line">        result.insert(rfirst.begin(), rfirst.end());</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        result.insert(rfirst.begin(), rfirst.end());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line">/*</span><br><span class="line"> * </span><br><span class="line"> */</span><br><span class="line">void Grammar::fill_lltable() &#123;</span><br><span class="line">    string		A; // nonterminal</span><br><span class="line">    Production 	p;</span><br><span class="line">    </span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        p = rules[i];</span><br><span class="line">        A = p.LHS;</span><br><span class="line">        set&lt;string&gt; predict_set = get_predict_set(p);</span><br><span class="line">        </span><br><span class="line">        for(set&lt;string&gt;::iterator it = predict_set.begin();</span><br><span class="line">            it != predict_set.end(); it++) &#123;</span><br><span class="line">            assert(lltable[A].find(*it) == lltable[A].end());</span><br><span class="line">            lltable[A][*it] = p;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">void Grammar::buildSymbols() &#123;</span><br><span class="line">    symbols.clear();</span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        symbols.insert(rules[i].LHS);</span><br><span class="line">        for(size_t j = 0; j &lt; rules[i].RHS.size(); j++) &#123;</span><br><span class="line">            symbols.insert(rules[i].RHS[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">bool Grammar::isNonterminal(string token) &#123;</span><br><span class="line"></span><br><span class="line">#ifdef HTMLProduction</span><br><span class="line">    if(token == Grammar::lambda)</span><br><span class="line">        return false;</span><br><span class="line">    if(token[0] == &#x27;&lt;&#x27; &amp;&amp; token[token.length() - 1] == &#x27;&gt;&#x27;)</span><br><span class="line">        return true;</span><br><span class="line">    return false;</span><br><span class="line">#else</span><br><span class="line">    if(token == Grammar::lambda)</span><br><span class="line">        return false;</span><br><span class="line">    for(size_t i = 0; i &lt; token.length(); i++) &#123;</span><br><span class="line">        if(isupper(token[i]))</span><br><span class="line">            return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br><span class="line">/* ------------------------</span><br><span class="line">Grammar LL method</span><br><span class="line">-------------------------- */</span><br><span class="line">map&lt;string, bool&gt; Grammar::mark_lambda() &#123;</span><br><span class="line">    bool 				rhs_derives_lambda;</span><br><span class="line">    bool 				changes;</span><br><span class="line">    Production 			p;</span><br><span class="line">    </span><br><span class="line">    derives_lambda.clear();</span><br><span class="line">    </span><br><span class="line">    /* initially, nothing is marked. */</span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        derives_lambda[rules[i].LHS] = false;</span><br><span class="line">    &#125;</span><br><span class="line">    do &#123;</span><br><span class="line">        changes = false;</span><br><span class="line">        for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">            p = rules[i];</span><br><span class="line">            if(!derives_lambda[p.LHS]) &#123;</span><br><span class="line">                if(p.RHS.size() == 0 || p.RHS[0] == Grammar::lambda) &#123;</span><br><span class="line">                    changes = derives_lambda[p.LHS] = true;</span><br><span class="line">                    continue;</span><br><span class="line">                &#125;</span><br><span class="line">                /* does each part of RHS derive lambda ? */</span><br><span class="line">                rhs_derives_lambda = derives_lambda[string(p.RHS[0])];</span><br><span class="line">                for(size_t j = 1; j &lt; p.RHS.size(); j++) &#123;</span><br><span class="line">                    rhs_derives_lambda &amp;= derives_lambda[p.RHS[j]];</span><br><span class="line">                &#125;</span><br><span class="line">                if(rhs_derives_lambda) &#123;</span><br><span class="line">                    changes = true;</span><br><span class="line">                    derives_lambda[p.LHS] = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; while(changes);</span><br><span class="line">    return derives_lambda;</span><br><span class="line">&#125;</span><br><span class="line">void Grammar::fill_first_set() &#123;</span><br><span class="line">    </span><br><span class="line">    string 		A; // nonterminal</span><br><span class="line">    string 		a; // terminal</span><br><span class="line">    Production 	p;</span><br><span class="line">    bool 		changes;</span><br><span class="line">        </span><br><span class="line">    mark_lambda();</span><br><span class="line">    first_set.clear();</span><br><span class="line">    </span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        A = rules[i].LHS;</span><br><span class="line">        if(derives_lambda[A])</span><br><span class="line">            first_set[A].insert(Grammar::lambda);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        for(size_t j = 0; j &lt; rules[i].RHS.size(); j++) &#123;</span><br><span class="line">            a = rules[i].RHS[j];</span><br><span class="line">            if(!isNonterminal(a)) &#123;</span><br><span class="line">                if(a != Grammar::lambda)</span><br><span class="line">                    first_set[a].insert(a);</span><br><span class="line">                if(j == 0) &#123; // A -&gt; aXX</span><br><span class="line">                    first_set[rules[i].LHS].insert(a);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    do &#123;</span><br><span class="line">        changes = false;</span><br><span class="line">        for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">            p = rules[i];</span><br><span class="line">            set&lt;string&gt; rfirst = compute_first(p.RHS);</span><br><span class="line">            size_t oldsize = first_set[p.LHS].size();</span><br><span class="line">            first_set[p.LHS].insert(rfirst.begin(), rfirst.end());</span><br><span class="line">            size_t newsize = first_set[p.LHS].size();</span><br><span class="line">            if(oldsize != newsize)</span><br><span class="line">                changes = true;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; while(changes);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">void Grammar::fill_follow_set() &#123;</span><br><span class="line">    string 	A, B; // nonterminal</span><br><span class="line">    Production 	p;</span><br><span class="line">    bool 	changes;</span><br><span class="line">    </span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        A = rules[i].LHS;</span><br><span class="line">        follow_set[A].clear();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    follow_set[start_symbol].insert(Grammar::lambda);</span><br><span class="line">        </span><br><span class="line">    do &#123;</span><br><span class="line">        changes = false;</span><br><span class="line">        for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">            /* A -&gt; a B b</span><br><span class="line">             * I.e. for each production and each occurrence</span><br><span class="line">             * of a nonterminal in its right-hand side. </span><br><span class="line">             */</span><br><span class="line">            p = rules[i];</span><br><span class="line">            A = p.LHS;</span><br><span class="line">            for(size_t j = 0; j &lt; p.RHS.size(); j++) &#123;</span><br><span class="line">                B = p.RHS[j];</span><br><span class="line">                if(isNonterminal(B)) &#123;</span><br><span class="line">                    vector&lt;string&gt; beta(p.RHS.begin() + j + 1, p.RHS.end());</span><br><span class="line">                    set&lt;string&gt; rfirst = compute_first(beta);</span><br><span class="line">                    size_t oldsize = follow_set[B].size();</span><br><span class="line">                    </span><br><span class="line">                    if(rfirst.find(Grammar::lambda) == rfirst.end()) &#123;</span><br><span class="line">                        follow_set[B].insert(rfirst.begin(), rfirst.end());	</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        rfirst.erase(Grammar::lambda);</span><br><span class="line">                        follow_set[B].insert(rfirst.begin(), rfirst.end());	</span><br><span class="line">                        rfirst = follow_set[A];</span><br><span class="line">                        follow_set[B].insert(rfirst.begin(), rfirst.end());</span><br><span class="line">                    &#125;</span><br><span class="line">                    size_t newsize = follow_set[B].size();			</span><br><span class="line">                    if(oldsize != newsize)</span><br><span class="line">                        changes = true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; while(changes);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Grammar::lldriver(queue&lt;string&gt; tokens) &#123;</span><br><span class="line">    stack&lt;string&gt; 	stk;</span><br><span class="line">    string 			X;</span><br><span class="line">    string			a;</span><br><span class="line">    Production		p;</span><br><span class="line">    /* Push the Start Symbol onto an empty stack */</span><br><span class="line">    stk.push(start_symbol);</span><br><span class="line">    </span><br><span class="line">    while(!stk.empty() &amp;&amp; !tokens.empty()) &#123;</span><br><span class="line">        X = stk.top();</span><br><span class="line">        a = tokens.front();</span><br><span class="line">        // cout &lt;&lt; X &lt;&lt; &quot; &quot; &lt;&lt; a &lt;&lt; endl;</span><br><span class="line">        if(isNonterminal(X) &amp;&amp; lltable[X].find(a) != lltable[X].end()) &#123;</span><br><span class="line">            p = lltable[X][a];</span><br><span class="line">            stk.pop();</span><br><span class="line">            for(int i = p.RHS.size() - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">                if(p.RHS[i] == Grammar::lambda)</span><br><span class="line">                    continue;</span><br><span class="line">                stk.push(p.RHS[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else if(X == a) &#123;</span><br><span class="line">            stk.pop();</span><br><span class="line">            tokens.pop();</span><br><span class="line">        &#125; else if(lltable[X].find(Grammar::lambda) != lltable[X].end()) &#123;</span><br><span class="line">            stk.pop();</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            /* Process syntax error. */</span><br><span class="line">            puts(&quot;Bad!&quot;);</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while(!stk.empty()) &#123;</span><br><span class="line">        X = stk.top();</span><br><span class="line">        if(lltable[X].find(Grammar::lambda) != lltable[X].end())</span><br><span class="line">            stk.pop();</span><br><span class="line">        else</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">    if(tokens.size() == 0 &amp;&amp; stk.size() == 0)</span><br><span class="line">        puts(&quot;Good&quot;);</span><br><span class="line">    else</span><br><span class="line">        puts(&quot;Bad!&quot;);</span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br><span class="line">/* ------------------------</span><br><span class="line">Grammar LR method</span><br><span class="line">-------------------------- */</span><br><span class="line">void Grammar::build_action() &#123;</span><br><span class="line">    ConfigurationSet 	s;</span><br><span class="line">    Production 			P;</span><br><span class="line">    int					dotPos;</span><br><span class="line">    set&lt; pair&lt;Production, ConfigurationSet::State&gt; &gt;::iterator it;</span><br><span class="line">    </span><br><span class="line">    for(size_t i = 0; i &lt; LRstates.size(); i++) &#123;</span><br><span class="line">        s = LRstates[i];</span><br><span class="line">        int reduce = 0, rule = 0, accept = 1;</span><br><span class="line">        for(it = s.configs.begin(); it != s.configs.end(); it++) &#123;</span><br><span class="line">            P = it-&gt;first, dotPos = it-&gt;second.dot;</span><br><span class="line">            if(dotPos == P.RHS.size())</span><br><span class="line">                reduce++, rule = P.label;</span><br><span class="line">            accept &amp;= P.LHS == Grammar::start_symbol;</span><br><span class="line">        &#125;</span><br><span class="line">        if(accept == 1)</span><br><span class="line">            action_table[i] = 0;</span><br><span class="line">        else if(reduce == 1)</span><br><span class="line">            action_table[i] = -1;</span><br><span class="line">        else</span><br><span class="line">            action_table[i] = 1;</span><br><span class="line">    &#125;</span><br><span class="line">#ifdef DEBUG</span><br><span class="line">    printf(&quot;State |&quot;);</span><br><span class="line">    for(size_t i = 0; i &lt; LRstates.size(); i++)</span><br><span class="line">        printf(&quot;%5d|&quot;, i);</span><br><span class="line">    puts(&quot;&quot;);</span><br><span class="line">    printf(&quot;Action|&quot;);</span><br><span class="line">    for(size_t i = 0; i &lt; action_table.size(); i++) &#123;</span><br><span class="line">        printf(&quot;%5d|&quot;, action_table[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    puts(&quot;&quot;);</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br><span class="line">void Grammar::build_CFSM() &#123;</span><br><span class="line">    set&lt;ConfigurationSet&gt; 	S;</span><br><span class="line">    queue&lt;ConfigurationSet&gt;	Q;</span><br><span class="line">    ConfigurationSet 		s0, sb;</span><br><span class="line">    int 					label = 0;</span><br><span class="line">    ConfigurationSet::State state;</span><br><span class="line">    </span><br><span class="line">    state.dot = 0;</span><br><span class="line">    state.lookahead = vector&lt;string&gt;();</span><br><span class="line">    state.lookahead.push_back(Grammar::lambda);</span><br><span class="line">    for(size_t i = 0; i &lt; rules.size(); i++) &#123;</span><br><span class="line">        if(rules[i].LHS == this-&gt;start_symbol) &#123;</span><br><span class="line">            s0.configs.insert(make_pair(rules[i], state));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    s0 = ConfigurationSet::closure0(s0, *this);</span><br><span class="line">    s0.label = label++;</span><br><span class="line">    </span><br><span class="line">    S.insert(s0);</span><br><span class="line">    Q.push(s0);</span><br><span class="line">    </span><br><span class="line">    buildSymbols();</span><br><span class="line">    /* hw need */</span><br><span class="line">    map&lt;int, vector&lt; pair&lt;int, string&gt; &gt; &gt; hwPrint;</span><br><span class="line">    /* hw need */</span><br><span class="line">    while(!Q.empty()) &#123;</span><br><span class="line">        s0 = Q.front(), Q.pop();</span><br><span class="line">        LRstates.push_back(s0);</span><br><span class="line">        for(set&lt;string&gt;::iterator it = symbols.begin();</span><br><span class="line">            it != symbols.end(); it++) &#123;</span><br><span class="line">            sb = ConfigurationSet::go_to0(s0, *it, *this);</span><br><span class="line">            if(sb.configs.size() &gt; 0) &#123;</span><br><span class="line">                if(S.find(sb) == S.end()) &#123;</span><br><span class="line">                    sb.label = label++;</span><br><span class="line">                    S.insert(sb);</span><br><span class="line">                    Q.push(sb);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                go_to_table[s0.label][*it] = (* S.find(sb)).label;</span><br><span class="line">                /* hw need */</span><br><span class="line">                hwPrint[(* S.find(sb)).label].push_back(make_pair(s0.label, *it));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // build_action();</span><br><span class="line">#ifdef DEBUG	</span><br><span class="line">    printf(&quot;Total State: %d\n&quot;, label);</span><br><span class="line">    for(int i = 0; i &lt; label; i++) &#123;</span><br><span class="line">        if(hwPrint[i].size() &gt; 0) &#123;</span><br><span class="line">            printf(&quot;State %d from&quot;, i);</span><br><span class="line">            for(vector&lt; pair&lt;int, string&gt; &gt;::iterator it = hwPrint[i].begin();</span><br><span class="line">                it != hwPrint[i].end(); it++) &#123;</span><br><span class="line">                printf(&quot;%cState %d(%s)&quot;, it == hwPrint[i].begin() ? &#x27; &#x27; : &#x27;,&#x27;, it-&gt;first, it-&gt;second.c_str());</span><br><span class="line">            &#125;</span><br><span class="line">            puts(&quot;&quot;);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            printf(&quot;State %d\n&quot;, i);</span><br><span class="line">        &#125;</span><br><span class="line">        LRstates[i].print(*this);</span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">#endif</span><br><span class="line">&#125;</span><br><span class="line">int Grammar::slr1driver(queue&lt;string&gt; tokens) &#123;</span><br><span class="line">    stack&lt;int&gt; 		stateStk;</span><br><span class="line">    stack&lt;string&gt; 	tokenStk;</span><br><span class="line">    int 			state;</span><br><span class="line">    string			X;</span><br><span class="line">    </span><br><span class="line">    stateStk.push(0); /* push start state */</span><br><span class="line">    while(!tokens.empty()) &#123;</span><br><span class="line">        state = stateStk.top();</span><br><span class="line">        X = tokens.front();</span><br><span class="line">#ifdef DEBUG </span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">        printf(&quot;state %d front %s\n&quot;, state, X.c_str());</span><br><span class="line">        LRstates[state].print(*this);</span><br><span class="line">        for (std::stack&lt;int&gt; dump = stateStk; !dump.empty(); dump.pop())</span><br><span class="line">        	std::cout &lt;&lt; &quot;state stack &quot;&lt;&lt; dump.top() &lt;&lt; &#x27;\n&#x27;;</span><br><span class="line">        for (std::stack&lt;string&gt; dump = tokenStk; !dump.empty(); dump.pop())</span><br><span class="line">        	std::cout &lt;&lt; &quot;token stack &quot;&lt;&lt; dump.top() &lt;&lt; &#x27;\n&#x27;;</span><br><span class="line">#endif</span><br><span class="line">        int reduce = 0, shift = 0;</span><br><span class="line">        Production P;</span><br><span class="line">        for(set&lt; pair&lt;Production, ConfigurationSet::State&gt; &gt;::iterator it = LRstates[state].configs.begin(); </span><br><span class="line">            it != LRstates[state].configs.end(); it++) &#123;</span><br><span class="line">            Production q = it-&gt;first;</span><br><span class="line">            ConfigurationSet::State s = it-&gt;second;</span><br><span class="line">            if(follow_set[q.LHS].find(X) != follow_set[q.LHS].end() &amp;&amp; </span><br><span class="line">                    (s.dot == q.RHS.size() || q.RHS[0] == Grammar::lambda)) &#123;</span><br><span class="line">                reduce++;</span><br><span class="line">                P = q;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(go_to_table[state].find(X) != go_to_table[state].end())</span><br><span class="line">            shift++;</span><br><span class="line">        if(reduce + shift &gt;= 2)</span><br><span class="line">            assert(false); // grammar can&#x27;t use simple LR.</span><br><span class="line">        if(reduce + shift == 0)</span><br><span class="line">            return 0;</span><br><span class="line">        if(reduce == 1) &#123; // Reduce</span><br><span class="line">            for(size_t i = 0; i &lt; P.RHS.size(); i++) </span><br><span class="line">                tokenStk.pop(), stateStk.pop();</span><br><span class="line"></span><br><span class="line">            tokenStk.push(P.LHS);</span><br><span class="line">            state = stateStk.top();</span><br><span class="line">            if(go_to_table[state].find(P.LHS) == go_to_table[state].end()) &#123;</span><br><span class="line">                return 0;</span><br><span class="line">            &#125;</span><br><span class="line">            state = go_to_table[state][P.LHS];</span><br><span class="line">            stateStk.push(state);</span><br><span class="line">        &#125; else &#123; // shift</span><br><span class="line">            state = go_to_table[state][X];</span><br><span class="line">            stateStk.push(state);</span><br><span class="line">            tokenStk.push(X);</span><br><span class="line">            tokens.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while(!stateStk.empty()) &#123;</span><br><span class="line">        state = stateStk.top();</span><br><span class="line">        X = Grammar::lambda;</span><br><span class="line">#ifdef DEBUG </span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">        printf(&quot;state %d front %s\n&quot;, state, X.c_str());</span><br><span class="line">        LRstates[state].print(*this);</span><br><span class="line">        for (std::stack&lt;int&gt; dump = stateStk; !dump.empty(); dump.pop())</span><br><span class="line">        	std::cout &lt;&lt; &quot;state stack &quot;&lt;&lt; dump.top() &lt;&lt; &#x27;\n&#x27;;</span><br><span class="line">        for (std::stack&lt;string&gt; dump = tokenStk; !dump.empty(); dump.pop())</span><br><span class="line">        	std::cout &lt;&lt; &quot;token stack &quot;&lt;&lt; dump.top() &lt;&lt; &#x27;\n&#x27;;</span><br><span class="line">#endif</span><br><span class="line">        int reduce = 0, shift = 0;</span><br><span class="line">        Production P;</span><br><span class="line">        for(set&lt; pair&lt;Production, ConfigurationSet::State&gt; &gt;::iterator it = LRstates[state].configs.begin(); </span><br><span class="line">            it != LRstates[state].configs.end(); it++) &#123;</span><br><span class="line">            Production q = it-&gt;first;</span><br><span class="line">            ConfigurationSet::State s = it-&gt;second;</span><br><span class="line">            if(follow_set[q.LHS].find(X) != follow_set[q.LHS].end() &amp;&amp; </span><br><span class="line">                    (s.dot == q.RHS.size() || q.RHS[0] == Grammar::lambda)) &#123;</span><br><span class="line">                reduce++;</span><br><span class="line">                P = q;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(go_to_table[state].find(X) != go_to_table[state].end())</span><br><span class="line">            shift++;</span><br><span class="line">        if(reduce + shift &gt;= 2)</span><br><span class="line">            assert(false); // grammar can&#x27;t use simple LR.</span><br><span class="line">        if(reduce + shift == 0)</span><br><span class="line">            return 0;</span><br><span class="line">        if(reduce == 1) &#123; // Reduce</span><br><span class="line">            for(size_t i = 0; i &lt; P.RHS.size(); i++) </span><br><span class="line">                tokenStk.pop(), stateStk.pop();</span><br><span class="line"></span><br><span class="line">            tokenStk.push(P.LHS);</span><br><span class="line">            state = stateStk.top();</span><br><span class="line">            if(go_to_table[state].find(P.LHS) == go_to_table[state].end()) &#123;</span><br><span class="line">                if(P.LHS == Grammar::start_symbol)</span><br><span class="line">                    return 1;</span><br><span class="line">                return 0;</span><br><span class="line">            &#125;</span><br><span class="line">            state = go_to_table[state][P.LHS];</span><br><span class="line">            stateStk.push(state);</span><br><span class="line">        &#125; else &#123; // shift</span><br><span class="line">            state = go_to_table[state][X];</span><br><span class="line">            stateStk.push(state);</span><br><span class="line">            tokenStk.push(X);</span><br><span class="line">            tokens.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">void parsingProduction(string r, Grammar &amp;g) &#123;</span><br><span class="line">    static int 		production_label = 0;</span><br><span class="line">    stringstream 	sin(r);</span><br><span class="line">    string 			lhs, foo;</span><br><span class="line">    vector&lt;string&gt; 	tokens;</span><br><span class="line">    sin &gt;&gt; lhs &gt;&gt; foo;</span><br><span class="line">    while(sin &gt;&gt; foo)</span><br><span class="line">        tokens.push_back(foo);</span><br><span class="line">    Production p(lhs, tokens);</span><br><span class="line">    p.label = ++production_label;</span><br><span class="line">    g.rules.push_back(p);</span><br><span class="line">&#125;</span><br><span class="line">bool isNumber(string str) &#123;</span><br><span class="line">    for(int i = 0; i &lt; str.length(); i++) &#123;</span><br><span class="line">        if(!isdigit(str[i]))</span><br><span class="line">            return false;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br><span class="line">int scanTokens(char s[], queue&lt;string&gt;&amp; tokens, vector&lt;string&gt;&amp; val) &#123;</span><br><span class="line">    string keyword[18] = &#123;&quot;AND&quot;, &quot;THEN&quot;, &quot;GO&quot;, &quot;KEEP&quot;, </span><br><span class="line">            &quot;RIGHT&quot;, &quot;LEFT&quot;, &quot;FIRST&quot;, &quot;SECOND&quot;, &quot;THIRD&quot;, </span><br><span class="line">            &quot;AT&quot;, &quot;RECORD&quot;, &quot;TIME&quot;, &quot;TO&quot;, &quot;KMH&quot;, &quot;CHANGE&quot;,</span><br><span class="line">            &quot;AVERAGE&quot;, &quot;SPEED&quot;, &quot;CAS&quot;&#125;;</span><br><span class="line">    for(int i = 0; s[i]; i++) &#123;</span><br><span class="line">        if(s[i] == &#x27;&quot;&#x27;) &#123;</span><br><span class="line">            // s-word can&#x27;t empty, and after the opening speech marks no more space.</span><br><span class="line">            if(s[i + 1] == &#x27;&quot;&#x27; || isspace(s[i + 1]))	</span><br><span class="line">                return 0;</span><br><span class="line">            i++;</span><br><span class="line">            while(s[i] != &#x27;&quot;&#x27;) &#123;</span><br><span class="line">                if(isupper(s[i])) &#123;&#125;</span><br><span class="line">                else if(isspace(s[i])) &#123;s[i] = &#x27;_&#x27;;&#125;</span><br><span class="line">                else if(s[i] == &#x27;.&#x27;) &#123;</span><br><span class="line">                    if(isspace(s[i - 1]) || s[i - 1] == &#x27;_&#x27;) &#123;</span><br><span class="line">                        return 0;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    return 0;</span><br><span class="line">                &#125;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            if(s[i] == &#x27;\0&#x27; || isspace(s[i - 1]) || s[i - 1] == &#x27;_&#x27;)</span><br><span class="line">                return 0;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    stringstream 	sin(s);</span><br><span class="line">    string 			token;</span><br><span class="line">    while(sin &gt;&gt; token) &#123;</span><br><span class="line">        int f = 0;</span><br><span class="line">        for(int i = 0; i &lt; 18; i++) &#123;</span><br><span class="line">            if(token == keyword[i])</span><br><span class="line">                tokens.push(token), val.push_back(token), f = 1;</span><br><span class="line">        &#125;</span><br><span class="line">        if(f)	continue;</span><br><span class="line">        if(token[0] == &#x27;&quot;&#x27;)</span><br><span class="line">            tokens.push(&quot;SIGNWORDS&quot;), val.push_back(token), f = 1;</span><br><span class="line">        if(f)	continue;</span><br><span class="line">        if(isNumber(token))</span><br><span class="line">            tokens.push(&quot;NNN&quot;), val.push_back(token), f = 1;</span><br><span class="line">        if(f)	continue;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">//	freopen(&quot;in.txt&quot;, &quot;r+t&quot;, stdin);</span><br><span class="line">//	freopen(&quot;out.txt&quot;, &quot;w+t&quot;, stdout);</span><br><span class="line">    Grammar g;</span><br><span class="line">    parsingProduction(&quot;&lt;instruction&gt; 	-&gt; &lt;navigational&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;instruction&gt; 	-&gt; &lt;time-keeping&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;instruction&gt; 	-&gt; &lt;navigational&gt; AND &lt;time-keeping&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;navigational&gt; 	-&gt; &lt;directional&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;navigational&gt; 	-&gt; &lt;navigational&gt; AND THEN &lt;directional&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;directional&gt; 	-&gt; &lt;how&gt; &lt;direction&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;directional&gt; 	-&gt; &lt;how&gt; &lt;direction&gt; &lt;where&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;how&gt; 			-&gt; GO&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;how&gt; 			-&gt; GO &lt;when&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;how&gt;			-&gt; KEEP&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;direction&gt; 		-&gt; RIGHT&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;direction&gt;		-&gt; LEFT&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;when&gt;			-&gt; FIRST&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;when&gt;			-&gt; SECOND&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;when&gt;			-&gt; THIRD&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;where&gt; 			-&gt; AT &lt;sign&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;sign&gt;			-&gt; SIGNWORDS&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;time-keeping&gt; 	-&gt; &lt;record&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;time-keeping&gt;	-&gt; &lt;change&gt;&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;record&gt;			-&gt; RECORD TIME&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;change&gt;			-&gt; &lt;cas&gt; TO NNN KMH&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;cas&gt;			-&gt; CHANGE AVERAGE SPEED&quot;, g);</span><br><span class="line">    parsingProduction(&quot;&lt;cas&gt; 			-&gt; CAS&quot;, g);</span><br><span class="line">    g.start_symbol = &quot;&lt;instruction&gt;&quot;;</span><br><span class="line">        </span><br><span class="line">    g.fill_first_set();</span><br><span class="line">    g.fill_follow_set();</span><br><span class="line">    g.build_CFSM();</span><br><span class="line">    </span><br><span class="line">    char 	line[1024];</span><br><span class="line">    int 	cases = 0;</span><br><span class="line">    while(gets(line)) &#123;</span><br><span class="line">        if(!strcmp(line, &quot;#&quot;))</span><br><span class="line">            break;</span><br><span class="line">        queue&lt;string&gt; tokens;</span><br><span class="line">        vector&lt;string&gt; val;</span><br><span class="line">        int f = scanTokens(line, tokens, val);</span><br><span class="line">        printf(&quot;%3d.&quot;, ++cases);</span><br><span class="line">        if(!f) &#123;</span><br><span class="line">            puts(&quot; Trap!&quot;);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        f = g.slr1driver(tokens);</span><br><span class="line">        if(!f) &#123;</span><br><span class="line">            puts(&quot; Trap!&quot;);</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i = 0; i &lt; val.size(); i++) &#123;</span><br><span class="line">            if(val[i][0] == &#x27;&quot;&#x27;)</span><br><span class="line">                for(int j = 0; j &lt; val[i].length(); j++)</span><br><span class="line">                    if(val[i][j] == &#x27;_&#x27;)</span><br><span class="line">                        val[i][j] = &#x27; &#x27;;</span><br><span class="line">            printf(&quot; %s&quot;, val[i].c_str());</span><br><span class="line">        &#125;</span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-345" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/19/oj/uva/uva-345/" class="article-date">
  <time datetime="2014-06-18T23:08:16.000Z" itemprop="datePublished">2014-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/19/oj/uva/uva-345/">UVa 345 - It&#39;s Ir-Resist-Able</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/19/oj/uva/uva-345/" data-id="ckpaivccx00mdn8vn2e36fmvy" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/19/oj/uva/uva-345/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/高斯消去/">高斯消去</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>A common component in electronic circuits is the resistor. Each resistor has two terminals, and when current flows through a resistor, some of it is converted to heat, thus ``resisting”; the flow of the current. The extent to which it does this is indicated by a single positive numeric value, cleverly called the resistance of the resistor. By the way, the units of resistance are Ohms. Here’s what a single resistor looks like in a diagram of an electronic circuit:</p>
<p>When two resistors are connected in series, as shown below, then their equivalent resistance is just the sum of the resistances of the individual resistors. For example, if the two resistors below had resistances of 100 and 200 Ohms, respectively, then the combined resistance (from point A to point B) would be 300 Ohms. Of course, combining three or more resistors in series would yield a resistance equal to sum of all the individual resistances.</p>
<p>Resistors may also be connected in parallel, like this:</p>
<p>If these two resistors had resistances of 100 and 150 Ohms, then the parallel combination would yield an equivalent resistance between points A and B of</p>
<p>displaymath61</p>
<p>Connecting three resistors in parallel uses the same rule, so a 100 Ohm, 150 Ohm, and 300 Ohm resistor in parallel would yield a combined resistance of just 50 Ohms: that is,</p>
<p>displaymath63</p>
<p>In this problem you’re provided one or more descriptions of resistors and their interconnections. Each possible interconnection point (the terminals of a resistor) is identified by a unique positive integer, its label. And each resistor is specified by giving its two interconnection point labels and its resistance (as a real number).</p>
<p>For example, the input</p>
<p>1 2 100</p>
<p>would tell us that a 100 Ohm resistor was connected between points 1 and 2. A pair of resistors connected in series might be specified like this:</p>
<p>1 2 100<br>2 3 200</p>
<p>Here we’ve got our 100 Ohm resistor connected at points 1 and 2, and another 200 Ohm resistor connected to points 2 and 3. Two resistors in parallel would be similarly specified:</p>
<p>1 2 100<br>1 2 150</p>
<p>Once you know how the resistors are interconnected, and the resistance of each resistor, it’s possible to determine the equivalent resistance between any two points using the simple rules given above. In some cases, that is. Some interconnections of resistors can’t be solved using this approach: you won’t encounter any of these in this problem, however.</p>
<p>Notes</p>
<ul>
<li>Be aware that there may be input test cases with some resistors that don’t contribute to the overall resistance between the indicated points. For example, in the last case shown in the Sample Input section below, the resistor between points 1 and 2 is unused. There must be some flow through a resistor if it is to contribute to the overall resistance.</li>
<li>No resistor will have its ends connected together. That is, the labels associated with the ends of a resistor will always be distinct. </li>
</ul>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>There will be one or more cases to consider. Each will begin with a line containing three integers N, A, and B. A and B indicate the labels of points between which you are to determine the equivalent resistance. N is the number of individual resistors, and will be no larger than 30. N, A and B will all be zero in the line following the last case. Following each <code>N A B</code> line will be N lines, each specifying the labels of the points where a resistor is connected, and the resistance of that resistor, given as a real number.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each input case, display a line that includes the case number (they are numbered sequentially starting with 1) and the equivalent resistance, accurate to two decimal places.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">2 1 3</span><br><span class="line">1 2 100</span><br><span class="line">2 3 200</span><br><span class="line">2 1 2</span><br><span class="line">1 2 100</span><br><span class="line">1 2 150</span><br><span class="line">6 1 6</span><br><span class="line">1 2 500</span><br><span class="line">1 3 15</span><br><span class="line">3 4 40</span><br><span class="line">3 5 100</span><br><span class="line">4 6 60</span><br><span class="line">5 6 50</span><br><span class="line">0 0 0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Case 1: 300.00 Ohms</span><br><span class="line">Case 2: 60.00 Ohms</span><br><span class="line">Case 3: 75.00 Ohms</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>給定指定的兩個端點 A B，接著會有 N 個電阻，每個電阻值位於端點 X Y 之間。<br>求 A B 之間的等效電阻，特別注意到端點編號是任意整數，並且有可能兩個端點相同 (A = B)，也有可能會有無會流經的電路區域。</p>
<p>** 題目解法： **</p>
<p>我們假設每個端點的電動勢 (Volt)，使用克希荷夫電路定律（Kirchhoff Circuit Laws）中的 ** 電流定律 **，得到下列公式。</p>
<p>對於每一個端點而言，入電流總量等於出電流總量：</p>
<span>$\sum_{j = 1}^{n} \frac{V_{j} - V_{i}}{R_{i, j}} = 0$</span><!-- Has MathJax -->

<p>但是題目給定的起點和終點並不會在其中，因此假設起點 <code>V[A] = INF</code>，終點 <code>V[B] = 0</code>，接著算出其他所有點的電動勢。共有 <code>n - 2</code> 條方程式，<code>n - 2</code> 個變數，使用高斯消去求解。</p>
<ul>
<li>必須預處理與起點、終點之間的電流關係。</li>
<li>特別注意到起點和終點相同，直接輸出等效電阻 0。</li>
<li>端點編號離散化集中處理。</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="comment">// learn: http://blog.csdn.net/jiangshibiao/article/details/28661223		</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 105</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 1e+6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-9</span></span><br><span class="line"><span class="keyword">double</span> R[MAXN][MAXN] = &#123;&#125;, V[MAXN] = &#123;&#125;; <span class="comment">// R: resist, V: voltage</span></span><br><span class="line"><span class="keyword">double</span> f[MAXN][MAXN] = &#123;&#125;; <span class="comment">// function need solved;</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N, A, B;</span><br><span class="line">    <span class="keyword">int</span> x, y, l;</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> w;</span><br><span class="line">    <span class="keyword">char</span> s1[<span class="number">105</span>], s2[<span class="number">105</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;N, &amp;A, &amp;B) == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(N == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; label;</span><br><span class="line">        l = label[A];</span><br><span class="line">        <span class="keyword">if</span>(l == <span class="number">0</span>)	label[A] = label.<span class="built_in">size</span>();</span><br><span class="line">        A = label[A];</span><br><span class="line">        </span><br><span class="line">        l = label[B];</span><br><span class="line">        <span class="keyword">if</span>(l == <span class="number">0</span>)	label[B] = label.<span class="built_in">size</span>();</span><br><span class="line">        B = label[B];</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">memset</span>(R, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(R));</span><br><span class="line">        <span class="built_in">memset</span>(V, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(V));</span><br><span class="line">        <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(f));</span><br><span class="line">        vector&lt;<span class="keyword">double</span>&gt; g[MAXN][MAXN];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %lf&quot;</span>, &amp;x, &amp;y, &amp;w);</span><br><span class="line">            </span><br><span class="line">            l = label[x];</span><br><span class="line">            <span class="keyword">if</span>(l == <span class="number">0</span>)	label[x] = label.<span class="built_in">size</span>();</span><br><span class="line">            x = label[x];</span><br><span class="line">            </span><br><span class="line">            l = label[y];</span><br><span class="line">            <span class="keyword">if</span>(l == <span class="number">0</span>)	label[y] = label.<span class="built_in">size</span>();</span><br><span class="line">            y = label[y];</span><br><span class="line">            </span><br><span class="line">            g[x][y].<span class="built_in">push_back</span>(w);</span><br><span class="line">            g[y][x].<span class="built_in">push_back</span>(w);</span><br><span class="line">        &#125;</span><br><span class="line">        N = label.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(g[i][j].<span class="built_in">size</span>()) &#123;</span><br><span class="line">                    <span class="keyword">double</span> r = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; g[i][j].<span class="built_in">size</span>(); k++) &#123;</span><br><span class="line">                        r += <span class="number">1.0</span> / g[i][j][k];</span><br><span class="line">                    &#125;</span><br><span class="line">                    R[i][j] = <span class="number">1.0</span> / r;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        V[A] = INF, V[B] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i == A)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(i == B)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(R[i][A] &gt; <span class="number">0</span>)</span><br><span class="line">                f[i][i] -= <span class="number">1.0</span> / R[i][A], f[i][N + <span class="number">1</span>] -= V[A] / R[i][A];</span><br><span class="line">            <span class="keyword">if</span>(R[i][B] &gt; <span class="number">0</span>)</span><br><span class="line">                f[i][i] -= <span class="number">1.0</span> / R[i][B], f[i][N + <span class="number">1</span>] -= V[B] / R[i][B];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(R[i][j] &gt; <span class="number">0</span> &amp;&amp; i != j &amp;&amp; j != A &amp;&amp; j != B)</span><br><span class="line">                    f[i][j] = <span class="number">1.0</span> / R[i][j], f[i][i] -= <span class="number">1.0</span> / R[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Gaussian Elimination</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> k = i;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt;= N; j++)</span><br><span class="line">                <span class="keyword">if</span>(f[j][i] &gt; <span class="number">0</span>)</span><br><span class="line">                    k = j;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">fabs</span>(f[k][i]) &lt; eps)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N + <span class="number">1</span>; j++)</span><br><span class="line">                <span class="built_in">swap</span>(f[i][j], f[k][j]);</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(i == j)	<span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = N + <span class="number">1</span>; k &gt;= i; k--)</span><br><span class="line">                    f[j][k] = f[j][k] - f[j][i] / f[i][i] * f[i][k];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i == A)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(i == B)	<span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">fabs</span>(f[i][i]) &gt; eps)</span><br><span class="line">                V[i] = f[i][N + <span class="number">1</span>] / f[i][i];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">double</span> IB = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</span><br><span class="line">            <span class="keyword">if</span>(R[i][B] &gt; <span class="number">0</span>)</span><br><span class="line">                IB += V[i] / R[i][B];</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(IB) &lt; eps)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Case %d: %.2lf Ohms\n&quot;</span>, ++cases, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Case %d: %.2lf Ohms\n&quot;</span>, ++cases, (V[A] - V[B]) / IB);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-313" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/17/oj/uva/uva-313/" class="article-date">
  <time datetime="2014-06-16T23:19:14.000Z" itemprop="datePublished">2014-06-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/17/oj/uva/uva-313/">UVa 313 - Intervals</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/17/oj/uva/uva-313/" data-id="ckpaivccx00mcn8vn95o52chh" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/17/oj/uva/uva-313/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/掃描線/">掃描線</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>In the ceiling in the basement of a newly open developers building a light source has been installed. Unfortunately, the material used to cover the floor is very sensitive to light. It turned out that its expected life time is decreasing dramatically. To avoid this, authorities have decided to protect light sensitive areas from strong light by covering them. The solution was not very easy because, as it is common, in the basement there are different pipelines under the ceiling and the authorities want to install the covers just on those parts of the floor that are not shielded from the light by pipes. To cope with the situation, the first decision was to simplify the real situation and, instead of solving the problem in 3D space, to construct a 2D model first.</p>
<p>Within this model, the x-axis has been aligned with the level of the floor. The light is considered to be a point light source with integer co-ordinates tex2html_wrap_inline36 . The pipes are represented by circles. The center of the circle i has the integer co-ordinates tex2html_wrap_inline40 and an integer radius tex2html_wrap_inline42 . As pipes are made from solid material, circles cannot overlap. Pipes cannot reflect the light and the light cannot go through the pipes. You have to write a program which will determine the non-overlapping intervals on the x-axis where there is, due to the pipes, no light from the light source.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input file consists of blocks of lines, each of which except the last describes one situation in the basement. The first line of each block contains a positive integer number N &lt; 500 expressing the number of pipes. The second line of the block contains two integers tex2html_wrap_inline48 and tex2html_wrap_inline50 separated by one space. Each of the next N lines of the block contains integers tex2html_wrap_inline54 , tex2html_wrap_inline56 and tex2html_wrap_inline42 , where tex2html_wrap_inline60 . Integers in individual lines are separated by one space. The last block consists of one line containing n = 0.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>The output file consists of blocks of lines, corresponding to the blocks in the file (except the last one). One empty line must be put after each block in the output file. Each of the individual lines of the blocks in the output file will contain two real numbers, the endpoints of the interval where there is no light from the given point light source. The reals are exact to two decimal places and separated by one space. The intervals are sorted according to increasing x-coordinate.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">6</span><br><span class="line">300 450</span><br><span class="line">70 50 30</span><br><span class="line">120 20 20</span><br><span class="line">270 40 10</span><br><span class="line">250 85 20</span><br><span class="line">220 30 30</span><br><span class="line">380 100 100</span><br><span class="line">1</span><br><span class="line">300 300</span><br><span class="line">300 150 90</span><br><span class="line">1</span><br><span class="line">300 300</span><br><span class="line">390 150 90</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0.72 78.86</span><br><span class="line">88.50 133.94</span><br><span class="line">181.04 549.93</span><br><span class="line"></span><br><span class="line">75.00 525.00</span><br><span class="line"></span><br><span class="line">300.00 862.50</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>現在天花板上面有一盞燈，然後下方有數個圓，請問陰影部分的區間由小至大輸出分別為何。<br>假設不會有圓的高度大於燈的位置，而陰影呈現在 x 軸上。</p>
<p>** 題目解法： **</p>
<p>求圓 (cx, cy, r) 外一點的切線，由於點 (a, b) 在圓外，通常此點切於圓的線會有兩條。</p>
<p>假設該線斜率為 m，則通過的線為 <code>y = m * (x - a) + b</code>。</p>
<p>藉由點線距公式 <code>|m * (cx - a) - cy + b |/sqrt(m*m + 1) = r</code>，求得 m 之後得到兩條切線，往後求交 x 軸的位置即可。(特別考慮 m 不存在的情況)</p>
<p>最後使用掃描線算法來算聯集。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">    int N;</span><br><span class="line">    double bx, by, cx, cy, cr;</span><br><span class="line">    while (scanf(&quot;%d&quot;, &amp;N) == 1 &amp;&amp; N) &#123;</span><br><span class="line">    	scanf(&quot;%lf %lf&quot;, &amp;bx, &amp;by);</span><br><span class="line">        vector&lt; pair&lt;double, double&gt; &gt; interval;</span><br><span class="line">        for (int i = 0; i &lt; N; i++) &#123;</span><br><span class="line">            scanf(&quot;%lf %lf %lf&quot;, &amp;cx, &amp;cy, &amp;cr);</span><br><span class="line">            double a, b, c;</span><br><span class="line">            a = (cx - bx) * (cx - bx) - cr * cr;</span><br><span class="line">            b = 2 * (cx - bx) * (by - cy);</span><br><span class="line">            c = (by - cy) * (by - cy) - cr * cr;</span><br><span class="line">            if (b * b - 4 * a * c &gt; 0) &#123;</span><br><span class="line">#define eps 1e-6</span><br><span class="line">                if (fabs(a) &gt; eps) &#123;</span><br><span class="line">                    double m1 = (-b + sqrt(b * b - 4 * a * c))/(2 * a);</span><br><span class="line">                    double m2 = (-b - sqrt(b * b - 4 * a * c))/(2 * a);</span><br><span class="line">                    double l, r;</span><br><span class="line">                    c = by - m1 * bx;</span><br><span class="line">                    l = -c / m1;</span><br><span class="line">                    c = by - m2 * bx;</span><br><span class="line">                    r = -c / m2;</span><br><span class="line">                    if (l &gt;= r)</span><br><span class="line">                        swap(l, r);</span><br><span class="line">                    interval.push_back(make_pair(l, r));</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    double m1 = -c / b;</span><br><span class="line">                    double l, r;</span><br><span class="line">                    c = by - m1 * bx;</span><br><span class="line">                    l = -c / m1;</span><br><span class="line">                    r = bx;</span><br><span class="line">                    if (l &gt;= r)</span><br><span class="line">                        swap(l, r);</span><br><span class="line">                    interval.push_back(make_pair(l, r));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sort(interval.begin(), interval.end());</span><br><span class="line">        double coverL, coverR;</span><br><span class="line">        coverL = interval[0].first;</span><br><span class="line">        coverR = interval[0].second;</span><br><span class="line">        for (int i = 0; i &lt; interval.size(); i++) &#123;</span><br><span class="line">            if (interval[i].first &lt;= coverR) &#123;</span><br><span class="line">                coverR = max(coverR, interval[i].second);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                printf(&quot;%.2lf %.2lf\n&quot;, coverL, coverR);</span><br><span class="line">                coverL = interval[i].first;</span><br><span class="line">                coverR = interval[i].second;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        printf(&quot;%.2lf %.2lf\n&quot;, coverL, coverR);</span><br><span class="line">        puts(&quot;&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-10118" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/16/oj/uva/uva-10118/" class="article-date">
  <time datetime="2014-06-15T23:06:43.000Z" itemprop="datePublished">2014-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/16/oj/uva/uva-10118/">UVa 10118 - Free Candies</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/" data-id="ckpaivcb500f2n8vnbk3p4qm9" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搜索/">搜索</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h2><p>Little Bob is playing a game. He wants to win some candies in it - as many as possible.</p>
<p>There are 4 piles, each pile contains N candies. Bob is given a basket which can hold at most 5 candies. Each time, he puts a candy at the top of one pile into the basket, and if there’re two candies of the same color in it ,he can take both of them outside the basket and put them into his own pocket. When the basket is full and there are no two candies of the same color, the game ends. If the game is played perfectly, the game will end with no candies left in the piles.</p>
<p>For example, Bob may play this game like this (N=5):</p>
<p>Step1     Initial Piles     Step2     Take one from pile #2<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1 2 3 4<br>1 5 6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>nothing     nothing     
</code></pre>
<p>1   3 4<br>1 5 6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2     nothing
</code></pre>
<p>Step3     Take one from pile #2     Step4     Take one from pile #3<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1   3 4<br>1   6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 5     nothing     
</code></pre>
<p>1     4<br>1   6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 3 5     nothing
</code></pre>
<p>Step5     Take one from pile #2     Step6     put two candies into his pocket<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1     4<br>1   6 7<br>2   3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 3 3 5     nothing     
</code></pre>
<p>1     4<br>1   6 7<br>2   3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 5     a pair of 3
</code></pre>
<p>Note that different numbers indicate different colors, there are 20 kinds of colors numbered 1..20.</p>
<p>‘Seems so hard…’Bob got very much puzzled. How many pairs of candies could he take home at most?</p>
<h2 id="The-Input"><a href="#The-Input" class="headerlink" title="The Input"></a>The Input</h2><p>The input will contain no more than 10 test cases. Each test case begins with a line containing a single integer n(1&lt;=n&lt;=40) representing the height of the piles. In the following n lines, each line contains four integers xi1,xi2,xi3,xi4 (in the range 1..20). Each integer indicates the color of the corresponding candy. The test case containing n=0 will terminate the input, you should not give an answer to this case.</p>
<h2 id="The-Output"><a href="#The-Output" class="headerlink" title="The Output"></a>The Output</h2><p>Output the number of pairs of candies that the cleverest little child can take home. Print your answer in a single line for each test case.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">5</span><br><span class="line">1 2 3 4</span><br><span class="line">1 5 6 7</span><br><span class="line">2 3 3 3</span><br><span class="line">4 9 8 6</span><br><span class="line">8 7 2 1</span><br><span class="line">1</span><br><span class="line">1 2 3 4</span><br><span class="line">3</span><br><span class="line">1 2 3 4</span><br><span class="line">5 6 7 8</span><br><span class="line">1 2 3 4</span><br><span class="line">0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">8</span><br><span class="line">0</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>現在盤面上共有 4 堆，每一堆呈現 stack 的方式，並且每一堆都會有 n 個糖果，接下來每一步將會把每一堆的 top 糖果放入籃子中，假使籃子中有相同編號的糖果，則會將這兩個相同編號的糖果收入口袋。請問到籃子滿 5 個糖果之前，最多有多少對的糖果可以帶回家。</p>
<p>** 題目解法： **</p>
<p>將搜索狀態進行標記，之後走訪遇到相同狀態直接退回。這個問題在相同狀態下的結果必然相同。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 45</span></span><br><span class="line"><span class="keyword">int</span> N, pile[<span class="number">4</span>][MAXN];</span><br><span class="line"><span class="keyword">int</span> used[MAXN][MAXN][MAXN][MAXN] = &#123;&#125;, testcase = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> dp[MAXN][MAXN][MAXN][MAXN];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p1, <span class="keyword">int</span> p2, <span class="keyword">int</span> p3, <span class="keyword">int</span> p4, <span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(__builtin_popcount(state) == <span class="number">5</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(used[p1][p2][p3][p4] == testcase)</span><br><span class="line">        <span class="keyword">return</span> dp[p1][p2][p3][p4];</span><br><span class="line">    used[p1][p2][p3][p4] = testcase;</span><br><span class="line">    <span class="keyword">int</span> &amp;ret = dp[p1][p2][p3][p4];</span><br><span class="line">    <span class="keyword">int</span> t, v;</span><br><span class="line">    ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(p1 &lt; N) &#123;</span><br><span class="line">        t = pile[<span class="number">0</span>][p1];</span><br><span class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, v + <span class="built_in">dfs</span>(p1+<span class="number">1</span>, p2, p3, p4, state^(<span class="number">1</span>&lt;&lt;t)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p2 &lt; N) &#123;</span><br><span class="line">        t = pile[<span class="number">1</span>][p2];</span><br><span class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, v + <span class="built_in">dfs</span>(p1, p2+<span class="number">1</span>, p3, p4, state^(<span class="number">1</span>&lt;&lt;t)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p3 &lt; N) &#123;</span><br><span class="line">        t = pile[<span class="number">2</span>][p3];</span><br><span class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, v + <span class="built_in">dfs</span>(p1, p2, p3+<span class="number">1</span>, p4, state^(<span class="number">1</span>&lt;&lt;t)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p4 &lt; N) &#123;</span><br><span class="line">        t = pile[<span class="number">3</span>][p4];</span><br><span class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</span><br><span class="line">        ret = <span class="built_in">max</span>(ret, v + <span class="built_in">dfs</span>(p1, p2, p3, p4+<span class="number">1</span>, state^(<span class="number">1</span>&lt;&lt;t)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;N) == <span class="number">1</span> &amp;&amp; N) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;pile[j][i]);</span><br><span class="line">        testcase++;</span><br><span class="line">        <span class="keyword">int</span> ret = <span class="built_in">dfs</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, ret);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12598" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/14/oj/uva/uva-12598/" class="article-date">
  <time datetime="2014-06-14T01:00:08.000Z" itemprop="datePublished">2014-06-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/14/oj/uva/uva-12598/">UVa 12598 - Starting School</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/14/oj/uva/uva-12598/" data-id="ckpaivcca00jkn8vn9o7s1dc4" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/14/oj/uva/uva-12598/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分/">二分</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>The first day of school is a very memorable day to everyone. Po is starting school from today and Po is very excited. As this is Po’s first day at school, no one is assigned roll number yet. So all the students form a line in the school field and they are being assigned roll number one by one. The teacher is a bit crazy. Instead of assigning roll number from 1, she starts assigning them one by one in a random fashion. Po watches this madness for the first K students and then steps up. Po says Po can assign them very easily for the rest of the students. The idea is very simple. Roll number should be unique and a student should get the smallest roll number that has not been assigned yet to any of the students. For example if K = 4, total number of students are 10 and the first K students’ roll numbers are 1, 3, 5, 10 then the next 6 roll numbers should be 2, 4, 6, 7, 8 and 9.</p>
<blockquote>
<p>開學第一天是值得紀念的，Po 從今天開始在這所學校上課，他相當地興奮。Po 到達學校的第一天，沒有人被指派座號，因此所有的學生都在操場上等著被一個接著一個發送座號。老師有點喪心病狂，一開始從 1 號開始發送，但是他採用隨機發送，並沒有按著順序發。Po 看到前 K 位同學被這麼發送，Po 認為自己可以發送剩餘的學生編號，而發送方式相當簡單，將剩餘的最小座號發送給當前編號最小 (一開始規定學生編號為 1 - n) 的學生。</p>
</blockquote>
<blockquote>
<p>K = 4，一開始指派編號給 1 3 5 10 的學生座號，而剩餘座號就是發送順序為 2 4 6 7 8 9。</p>
</blockquote>
<p>Though this is a very good idea, the teacher got mad at Po. So she starts asking the roll number for various students. As there are many students, Po is feeling helpless. Can you help Po?</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>First line will contain an integer T (T &lt;= 30), the number of test cases. Each case will start with three integers N (0 &lt; N &lt;= 109), K (0 &lt; K &lt;= 50,000 and K &lt;= N) and Q (0 &lt; Q &lt;= 50,000). N is the total number of students, K is described earlier and Q is the number of queries of the crazy teacher. Next line will contain K distinct integers, the first K roll number assigned by the teacher. These values will be between 1 and 1000000000 (inclusive). Next will be Q integers, each indicating a position of students. These values will be between 1 and N (inclusive). (Large input output file, use faster I/O)</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each case print one line “Case T:” where T is the case number. Then for each query print one line with the roll number of the student standing on the queried position. See sample I/O for clarity.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2</span><br><span class="line">10 4 4</span><br><span class="line">1 3 5 2</span><br><span class="line">5 6 9 10</span><br><span class="line">10 3 2</span><br><span class="line">10 1 9</span><br><span class="line">4 10</span><br></pre></td></tr></table></figure>

<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Case 1:</span><br><span class="line">4</span><br><span class="line">6</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">Case 2:</span><br><span class="line">2</span><br><span class="line">8</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目解法：**</p>
<p>將沒有分配到的連續區間壓縮，接著對於詢問二分搜索即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">int</span> A[<span class="number">65536</span>], B[<span class="number">65536</span>], C[<span class="number">65536</span>], D[<span class="number">65536</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>, N, K, Q;</span><br><span class="line">    <span class="keyword">int</span> x, l, r;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;N, &amp;K, &amp;Q);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;A[i]), B[i] = A[i];</span><br><span class="line">        <span class="built_in">sort</span>(B + <span class="number">1</span>, B + <span class="number">1</span> + K);</span><br><span class="line">        B[<span class="number">0</span>] = <span class="number">0</span>, B[K+<span class="number">1</span>] = N + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> M = <span class="number">1</span>;</span><br><span class="line">        C[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K + <span class="number">1</span>; i++) &#123;</span><br><span class="line">            l = B[i - <span class="number">1</span>] + <span class="number">1</span>, r = B[i] - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(l &lt;= r) &#123;</span><br><span class="line">                C[M] = C[M - <span class="number">1</span>] + r - l + <span class="number">1</span>;</span><br><span class="line">                D[M] = l;</span><br><span class="line">                M++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d:\n&quot;</span>, ++cases);</span><br><span class="line">        <span class="keyword">while</span>(Q--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;x);</span><br><span class="line">            <span class="keyword">if</span>(x &lt;= K)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, A[x]);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                x -= K;</span><br><span class="line">                <span class="keyword">int</span> pos = <span class="built_in">lower_bound</span>(C, C + M, x) - C;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, D[pos] + x - C[pos<span class="number">-1</span>] - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>加速 IO 的做法如下，優化輸入函數，以及反饋的二分搜索，但是排名還是沒有達到想要的目標。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">int</span> A[<span class="number">65536</span>], B[<span class="number">65536</span>], C[<span class="number">65536</span>], D[<span class="number">65536</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">readchar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1048576</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> buf[N];</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> *p = buf, *end = buf;</span><br><span class="line">    <span class="keyword">if</span>(p == end) &#123;</span><br><span class="line">        <span class="keyword">if</span>((end = buf + <span class="built_in">fread</span>(buf, <span class="number">1</span>, N, stdin)) == buf) <span class="keyword">return</span> EOF;</span><br><span class="line">        p = buf;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> *p++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ReadInt</span><span class="params">(<span class="keyword">int</span> *x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">char</span> c, neg;</span><br><span class="line">    <span class="keyword">while</span>((c = <span class="built_in">readchar</span>()) &lt; <span class="string">&#x27;-&#x27;</span>)    &#123;<span class="keyword">if</span>(c == EOF) <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">    neg = (c == <span class="string">&#x27;-&#x27;</span>) ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">    *x = (neg == <span class="number">1</span>) ? c-<span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((c = <span class="built_in">readchar</span>()) &gt;= <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        *x = (*x &lt;&lt; <span class="number">3</span>) + (*x &lt;&lt; <span class="number">1</span>) + c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    *x *= neg;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>, N, K, Q;</span><br><span class="line">    <span class="keyword">int</span> x, l, r;</span><br><span class="line">    <span class="built_in">ReadInt</span>(&amp;testcase);</span><br><span class="line">    <span class="keyword">while</span>(testcase--) &#123;</span><br><span class="line">        <span class="built_in">ReadInt</span>(&amp;N);</span><br><span class="line">        <span class="built_in">ReadInt</span>(&amp;K);</span><br><span class="line">        <span class="built_in">ReadInt</span>(&amp;Q);</span><br><span class="line">        <span class="keyword">int</span> *p = A + <span class="number">1</span>, *q = B + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K; i++, p++, q++) &#123;</span><br><span class="line">            <span class="built_in">ReadInt</span>(p), *q = *p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(B + <span class="number">1</span>, B + <span class="number">1</span> + K);</span><br><span class="line">        B[<span class="number">0</span>] = <span class="number">0</span>, B[K+<span class="number">1</span>] = N + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> M = <span class="number">1</span>;</span><br><span class="line">        C[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        p = B, q = p+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= K + <span class="number">1</span>; i++, p = q++) &#123;</span><br><span class="line">            l = *p + <span class="number">1</span>, r = *q - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(l &lt;= r) &#123;</span><br><span class="line">                C[M] = C[M - <span class="number">1</span>] + r - l + <span class="number">1</span>;</span><br><span class="line">                D[M] = l;</span><br><span class="line">                M++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Case %d:\n&quot;</span>, ++cases);</span><br><span class="line">        <span class="keyword">int</span> prevX = <span class="number">0</span>, prevP = <span class="number">0</span>, pos;</span><br><span class="line">        <span class="keyword">while</span>(Q--) &#123;</span><br><span class="line">            <span class="built_in">ReadInt</span>(&amp;x);</span><br><span class="line">            <span class="keyword">if</span>(x &lt;= K)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, A[x]);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                x -= K;</span><br><span class="line">                <span class="keyword">if</span>(x &gt;= prevX)</span><br><span class="line">                    pos = <span class="built_in">lower_bound</span>(C + prevP, C + M, x) - C;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    pos = <span class="built_in">lower_bound</span>(C, C + prevP, x) - C;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, D[pos] + x - C[pos<span class="number">-1</span>] - <span class="number">1</span>);</span><br><span class="line">                prevX = x, prevP = pos;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-11031" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/12/oj/uva/uva-11031/" class="article-date">
  <time datetime="2014-06-11T23:40:31.000Z" itemprop="datePublished">2014-06-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/12/oj/uva/uva-11031/">UVa 11031 - Looking for a Subset</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/12/oj/uva/uva-11031/" data-id="ckpaivcbf00g1n8vn1nih0hql" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/12/oj/uva/uva-11031/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BIT/">BIT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Greedy/">Greedy</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Given a set S = { a1, a2, a3, … , an }, you have to find a subset of S, P = { ax1, ax2, ax3, … , axm } such that ( x1 &lt; x2 &lt; … &lt; xm ) and ( ax1&lt; ax2&lt; … &lt; axm ). If there are several subsets possible then you should find the subset where x1 is minimum. If there is still a tie then check for the lowest x2 and so on.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The input file contains several sets of inputs. The total number of test cases will be less than 25. The description of each set is given below:</p>
<p>Each case starts with two integers n (1 ≤ n ≤ 10000) and q (1 ≤ q ≤ 100), q is the number of queries. The next line contains n integers (seperated by a space) denoting a1, a2, a3, … , an respectively. And the next q lines, each contains an integer denoting m (1 ≤ m ≤ n). There is no number in the input file that contains more than 8 digits.</p>
<p>The input will be terminated by the case where n = q = 0. And this case should not be processed.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each case in the input, you should first print the case number starting from 1.<br>Then for each query first print the query number starting from 1. And for each m you have to find the result.<br>If there exists a subset as described above you should print the elements of the subset in a single line. The numbers should be seperated by a space.<br>Otherwise print ``Impossible’’ without the quotes.</p>
<p>See the sample input-output for more details. Output should be formatted like the sample output. </p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">6 3</span><br><span class="line">3 4 1 2 3 6</span><br><span class="line">6</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6 2</span><br><span class="line">2 4 6 1 3 5</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">0 0</span><br></pre></td></tr></table></figure>
<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Set 1:</span><br><span class="line">  Subset 1:</span><br><span class="line">    Impossible</span><br><span class="line">  Subset 2:</span><br><span class="line">    1 2 3 6</span><br><span class="line">  Subset 3:</span><br><span class="line">    Impossible</span><br><span class="line">Set 2:</span><br><span class="line">  Subset 1:</span><br><span class="line">    2 4 6</span><br><span class="line">  Subset 2:</span><br><span class="line">    Impossible</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述：**</p>
<p>對於每次詢問 m，找到一個嚴格遞增的子序列，並且子序列長度等於 m 且字典順序最小。</p>
<p>** 題目解法：**</p>
<p>基於每次字典順序最小，只能採用 greedy 的掃描方式，因此對於每次詢問必須到達 O(n)，無法在 O(m) 的時間完成。</p>
<p>關於貪心的操作，建造反向的遞減序列，狀態為 從這個位置為子序列的頭最長的遞減序列長度為何。</p>
<p>為了在 O(n log n) 得到 LDS 表格，這裡使用一個 binary indexed tree 來完成操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt; </span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">#define maxN 10005</span><br><span class="line">int A[maxN], LDS[maxN];</span><br><span class="line">int BIT[maxN];</span><br><span class="line">void modify(int i, int val, int L) &#123;</span><br><span class="line">    while(i &lt;= L) &#123;</span><br><span class="line">        BIT[i] = max(BIT[i], val);</span><br><span class="line">        i += i&amp;(-i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">int query(int i) &#123;</span><br><span class="line">    int ret = 0;</span><br><span class="line">    while(i) &#123;</span><br><span class="line">        ret = max(ret, BIT[i]);</span><br><span class="line">        i -= i&amp;(-i);</span><br><span class="line">    &#125;</span><br><span class="line">    return ret;</span><br><span class="line">&#125;</span><br><span class="line">inline int readchar() &#123;</span><br><span class="line">    const int N = 1048576;</span><br><span class="line">    static char buf[N];</span><br><span class="line">    static char *p = buf, *end = buf;</span><br><span class="line">    if(p == end) &#123;</span><br><span class="line">        if((end = buf + fread(buf, 1, N, stdin)) == buf) return EOF;</span><br><span class="line">        p = buf;</span><br><span class="line">    &#125;</span><br><span class="line">    return *p++;</span><br><span class="line">&#125;</span><br><span class="line">inline int ReadInt(int *x) &#123;</span><br><span class="line">    static char c, neg;</span><br><span class="line">    while((c = readchar()) &lt; &#x27;-&#x27;)    &#123;if(c == EOF) return 0;&#125;</span><br><span class="line">    neg = (c == &#x27;-&#x27;) ? -1 : 1;</span><br><span class="line">    *x = (neg == 1) ? c-&#x27;0&#x27; : 0;</span><br><span class="line">    while((c = readchar()) &gt;= &#x27;0&#x27;)</span><br><span class="line">        *x = (*x &lt;&lt; 3) + (*x &lt;&lt; 1) + c-&#x27;0&#x27;;</span><br><span class="line">    *x *= neg;</span><br><span class="line">    return 1;</span><br><span class="line">&#125;</span><br><span class="line">int main() &#123;</span><br><span class="line">    int N, Q, M, u;</span><br><span class="line">    int cases = 0;</span><br><span class="line">    while(ReadInt(&amp;N) &amp;&amp; ReadInt(&amp;Q) &amp;&amp; N+Q) &#123;</span><br><span class="line">        map&lt;int, int&gt; R;</span><br><span class="line">        for(int i = 0; i &lt; N; i++) &#123;</span><br><span class="line">            ReadInt(A+i);</span><br><span class="line">            R[A[i]] = 0;</span><br><span class="line">        &#125;</span><br><span class="line">        for(int i = 1; i &lt;= N; i++)</span><br><span class="line">            BIT[i] = 0;</span><br><span class="line">            </span><br><span class="line">        int size = R.size();</span><br><span class="line">        for(map&lt;int, int&gt;::iterator it = R.begin();</span><br><span class="line">            it != R.end(); it++) &#123;</span><br><span class="line">            it-&gt;second = size--;</span><br><span class="line">        &#125;</span><br><span class="line">        /* reverse LDS with ending at i-th element */</span><br><span class="line">        int maxLDS = 0;</span><br><span class="line">        for(int i = N-1; i &gt;= 0; i--) &#123;</span><br><span class="line">            LDS[i] = query((u = R[A[i]]) - 1) + 1;</span><br><span class="line">            modify(u, LDS[i], R.size());</span><br><span class="line">            maxLDS = max(maxLDS, LDS[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        printf(&quot;Set %d:\n&quot;, ++cases);</span><br><span class="line">        for(int i = 1; i &lt;= Q; i++) &#123;</span><br><span class="line">            ReadInt(&amp;M);</span><br><span class="line">            printf(&quot;  Subset %d:\n&quot;, i);</span><br><span class="line">            if(M &gt; maxLDS) &#123;</span><br><span class="line">                printf(&quot;    Impossible\n&quot;);</span><br><span class="line">                continue;</span><br><span class="line">            &#125;</span><br><span class="line">            printf(&quot;   &quot;);</span><br><span class="line">            int prevA = -0x3f3f3f3f;</span><br><span class="line">            for(int j = 0; j &lt; N &amp;&amp; M; j++) &#123;</span><br><span class="line">                if(LDS[j] &gt;= M &amp;&amp; prevA &lt; A[j]) &#123;</span><br><span class="line">                    printf(&quot; %d&quot;, A[j]);</span><br><span class="line">                    M--, prevA = A[j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            puts(&quot;&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/categories/解題區/解題區-UVa/page/44/">&laquo; Prev</a><a class="page-number" href="/categories/解題區/解題區-UVa/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/43/">43</a><a class="page-number" href="/categories/解題區/解題區-UVa/page/44/">44</a><span class="page-number current">45</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/46/">46</a><a class="page-number" href="/categories/解題區/解題區-UVa/page/47/">47</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/49/">49</a><a class="extend next" rel="next" href="/categories/解題區/解題區-UVa/page/46/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">30</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-handover/">
              
                <i class="icon-file-o"></i> 
              
            Handover</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-interview-recursion/">
              
                <i class="icon-file-o"></i> 
              
            Interview &amp; Recursion</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-job-build/">
              
                <i class="icon-file-o"></i> 
              
            Job Build</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-lang/">
              
                <i class="icon-file-o"></i> 
              
            Programming Language Impostors</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-machine-learning-newbie/">
              
                <i class="icon-file-o"></i> 
              
            Machine Learning for Newbie</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-parallel-gc/">
              
                <i class="icon-file-o"></i> 
              
            Parallel &amp; Garbage Collection</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>