<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 解題區 - UVa | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/解題區-UVa/page/35/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <!-- <link rel="import" href="/bower_components/app-layout/app-layout.html"> --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-oj/uva/uva-12648" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12648/" class="article-date">
  <time datetime="2014-08-02T08:57:02.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12648/">UVa 12648 - Boss</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12648/" data-id="cl4lxkpl6039aegvnbfi7kx1t" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12648/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dfs/">dfs</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一個管理階層圖 (DAG)，一名員工可能被很多上司管理</p>
<ul>
<li>員工之間可能會交換職位</li>
<li>詢問某名員工最年輕的上司年紀為何 (包含上司的上司 …)</li>
</ul>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">7 8 9</div><div class="line">21 33 33 18 42 22 26</div><div class="line">1 2</div><div class="line">1 3</div><div class="line">2 5</div><div class="line">3 5</div><div class="line">3 6</div><div class="line">4 6</div><div class="line">4 7</div><div class="line">6 7</div><div class="line">P 7</div><div class="line">T 4 2</div><div class="line">P 7</div><div class="line">P 5</div><div class="line">T 1 4</div><div class="line">P 7</div><div class="line">T 4 7</div><div class="line">P 2</div><div class="line">P 6</div><div class="line">6 5 6</div><div class="line">10 20 30 40 50 60</div><div class="line">1 5</div><div class="line">1 4</div><div class="line">3 6</div><div class="line">2 5</div><div class="line">4 5</div><div class="line">P 1</div><div class="line">P 5</div><div class="line">P 6</div><div class="line">T 1 6</div><div class="line">P 1</div><div class="line">P 4</div></pre></td></tr></table></figure>
<h2 id="Sample-Output-1"><a href="#Sample-Output-1" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">18</div><div class="line">21</div><div class="line">18</div><div class="line">18</div><div class="line">*</div><div class="line">26</div><div class="line">*</div><div class="line">10</div><div class="line">30</div><div class="line">30</div><div class="line">60</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>粗劣一點暴力將圖的上司全找到，接著使用映射將員工和年齡的關係圖修正。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> visited[<span class="number">512</span>];</div><div class="line"><span class="keyword">int</span> age[<span class="number">512</span>];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[<span class="number">512</span>], boss[<span class="number">512</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> em)</span> </span>&#123;</div><div class="line">    visited[u] = <span class="number">1</span>, boss[em].push_back(u);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) &#123;</div><div class="line">        <span class="keyword">int</span> v = g[u][i];</div><div class="line">        <span class="keyword">if</span>(visited[v])	<span class="keyword">continue</span>;</div><div class="line">        dfs(v, em);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> N, M, I, x, y, em;</div><div class="line">    <span class="keyword">char</span> cmd[<span class="number">10</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;M, &amp;I) == <span class="number">3</span>) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;age[i]);</div><div class="line">            g[i].clear(), boss[i].clear();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            g[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> mp[<span class="number">512</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            mp[i] = i;</div><div class="line">            <span class="built_in">memset</span>(visited, <span class="number">0</span>, <span class="keyword">sizeof</span>(visited));</div><div class="line">            visited[i] = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; g[i].size(); j++)</div><div class="line">                <span class="keyword">if</span>(!visited[g[i][j]])</div><div class="line">                    dfs(g[i][j], i);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; I; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, cmd);</div><div class="line">            <span class="keyword">if</span>(cmd[<span class="number">0</span>] == <span class="string">'P'</span>) &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;em);</div><div class="line">                <span class="keyword">int</span> ret = <span class="number">0x3f3f3f3f</span>;</div><div class="line">                em = mp[em];</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; boss[em].size(); i++)</div><div class="line">                    ret = min(ret, age[boss[em][i]]);</div><div class="line">                <span class="keyword">if</span>(ret == <span class="number">0x3f3f3f3f</span>)</div><div class="line">                    <span class="built_in">puts</span>(<span class="string">"*"</span>);</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">                swap(age[mp[x]], age[mp[y]]);</div><div class="line">                swap(mp[x], mp[y]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125; </div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12489" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12489/" class="article-date">
  <time datetime="2014-08-02T08:41:01.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12489/">UVa 12489 - Combating cancer</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12489/" data-id="cl4lxkpjf037oegvnj3wf7npd" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12489/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tree/">tree</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最小表示法/">最小表示法</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>求兩個無根樹，請問這兩個樹是否同構。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">7</div><div class="line">1 2</div><div class="line">2 3</div><div class="line">3 4</div><div class="line">4 5</div><div class="line">6 2</div><div class="line">7 3</div><div class="line">1 2</div><div class="line">2 3</div><div class="line">3 4</div><div class="line">4 5</div><div class="line">6 2</div><div class="line">7 4</div><div class="line">6</div><div class="line">1 2</div><div class="line">1 3</div><div class="line">2 4</div><div class="line">2 5</div><div class="line">3 6</div><div class="line">2 4</div><div class="line">5 3</div><div class="line">6 4</div><div class="line">1 4</div><div class="line">5 6</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">N</div><div class="line">S</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>找到樹的最小表示法，用括號來表示一棵樹，則可以對所有的子樹的最小表示法做排序，就可以構成這個樹的最小表示法。一直遞歸下去就可以得到最小表示法。</p>
<p>但是這個最小表示法只能用在有根樹，因此對於無根樹利用拓樸排序找到樹的中心 (一個或者是兩個)。</p>
<p>因此最後相互比較中心的情況。</p>
<p>這一題為了加快可以使用 hash，而把字串比較和排序撇開，但是千萬不要拿不同中心兩個 hash 取最小值，再進行同構比較。原因會發生在於中心的取捨，如果直接定義拓樸最後兩個點作為中心，則有可能一點不是中心，那麼就會造成分析上的錯誤。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfsMinExp</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[])</span> </span>&#123;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;	branch;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) &#123;</div><div class="line">        <span class="keyword">int</span> v = g[u][i];</div><div class="line">        <span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;</div><div class="line">        branch.push_back(dfsMinExp(v, u, g));</div><div class="line">    &#125;</div><div class="line">    sort(branch.begin(), branch.end());</div><div class="line"></div><div class="line"><span class="comment">//	string exp = "";</span></div><div class="line"><span class="comment">//	for(int i = 0; i &lt; branch.size(); i++)</span></div><div class="line"><span class="comment">//		exp += branch[i];	</span></div><div class="line"><span class="comment">//	return "(" + exp + ")";	</span></div><div class="line">    <span class="keyword">int</span> a = <span class="number">63689</span>, b = <span class="number">378551</span>;</div><div class="line">    <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">    branch.push_back(<span class="number">1</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; branch.size(); i++)</div><div class="line">        ret = ret * a + branch[i], a *= b;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; getTreeMinExp(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[], <span class="keyword">int</span> n) &#123;</div><div class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)	<span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(&#123;<span class="number">1</span>&#125;);</div><div class="line">    <span class="keyword">int</span> deg[<span class="number">10005</span>] = &#123;&#125;, u, v;</div><div class="line">    <span class="keyword">int</span> topo[<span class="number">10005</span>] = &#123;&#125;, idx = <span class="number">0</span>;</div><div class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">        deg[i] = g[i].size();</div><div class="line">        <span class="keyword">if</span>(deg[i] == <span class="number">1</span>)	Q.push(i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(!Q.empty()) &#123;</div><div class="line">        u = Q.front(), Q.pop();</div><div class="line">        topo[idx++] = u;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) &#123;</div><div class="line">            v = g[u][i];</div><div class="line">            <span class="keyword">if</span>(--deg[v] == <span class="number">1</span>)</div><div class="line">                Q.push(v);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ret;</div><div class="line">    ret.push_back(dfsMinExp(topo[idx<span class="number">-1</span>], <span class="number">-1</span>, g));</div><div class="line">    ret.push_back(dfsMinExp(topo[idx<span class="number">-2</span>], <span class="number">-1</span>, g));</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout); </span></div><div class="line">    <span class="keyword">int</span> n, x, y;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g1[<span class="number">65536</span>], g2[<span class="number">65536</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">            g1[i].clear(), g2[i].clear();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            g1[x].push_back(y);</div><div class="line">            g1[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            g2[x].push_back(y);</div><div class="line">            g2[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; hash1 = getTreeMinExp(g1, n);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; hash2 = getTreeMinExp(g2, n);</div><div class="line">        <span class="keyword">int</span> same = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; hash1.size(); i++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; hash2.size(); j++)</div><div class="line">                same |= hash1[i] == hash2[j];</div><div class="line">        <span class="built_in">puts</span>(same ? <span class="string">"S"</span> : <span class="string">"N"</span>);</div><div class="line"><span class="comment">//		printf("%d %d\n", hash1, hash2);</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12486" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12486/" class="article-date">
  <time datetime="2014-08-02T08:31:57.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12486/">UVa 12486 - Space Elevator</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12486/" data-id="cl4lxkpk8038gegvns4hn30s5" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12486/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>將所有數字中出現 4 或者是 13 為子字串排除，將剩餘數字排序後，根據輸入輸出 i-th 的結果為何。(傳統避諱的樓層命名方式)</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">4</div><div class="line">11</div><div class="line">12</div><div class="line">440</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">1</div><div class="line">5</div><div class="line">12</div><div class="line">15</div><div class="line">666</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><ul>
<li><code>dp[i][0]</code> 表示長度為 i 的情況下，不以 3 開頭的所有符合數字</li>
<li><code>dp[i][1]</code> 表示長度為 i 的情況下，以 3 開頭的所有符合數字</li>
</ul>
<p>接著，企圖添加 digit 在長度為 i-1 的數字前面，只要不添加 1 湊出 13 即可。直接禁用 4 就沒有什麼問題。</p>
<p>而隨後要輸出 i-th 的時候，用扣的方式依序得到 lower_bound。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> n;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">30</span>][<span class="number">2</span>] = &#123;&#125;;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> sum[<span class="number">30</span>] = &#123;&#125;;</div><div class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>; <span class="comment">// [1-9^3], dp[i][1] - [3(0-9)*]</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">30</span>; i++) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">2</span>; j++) &#123;</div><div class="line">            dp[i][<span class="number">0</span>] = <span class="number">8</span> * dp[i<span class="number">-1</span>][<span class="number">0</span>] + <span class="number">7</span> * dp[i<span class="number">-1</span>][<span class="number">1</span>];</div><div class="line">            dp[i][<span class="number">1</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">30</span>; i++)</div><div class="line">        sum[i] = sum[i<span class="number">-1</span>] + (dp[i<span class="number">-1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>])* <span class="number">7</span> + dp[i][<span class="number">1</span>] - dp[i<span class="number">-1</span>][<span class="number">1</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%llu"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(len = <span class="number">1</span>; sum[len] &lt;= n; len++);</div><div class="line">        <span class="keyword">int</span> prev = <span class="number">0</span>;</div><div class="line">        n -= sum[len<span class="number">-1</span>];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; i--) &#123;</div><div class="line">            <span class="keyword">int</span> last = <span class="number">-1</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = (i == len); j &lt;= <span class="number">9</span>; j++) &#123;</div><div class="line">                <span class="keyword">if</span>(j == <span class="number">4</span> || (prev == <span class="number">1</span> &amp;&amp; j == <span class="number">3</span>))	<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span>(j == <span class="number">1</span>) &#123; <span class="comment">// [1] - [0-9^3]</span></div><div class="line">                    <span class="keyword">if</span>(n &gt; dp[i<span class="number">-1</span>][<span class="number">0</span>]) &#123;</div><div class="line">                        n -= dp[i<span class="number">-1</span>][<span class="number">0</span>], last = j;</div><div class="line"><span class="comment">//						printf("%llu test\n", dp[i-1][0]);</span></div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">if</span>(n &gt; dp[i<span class="number">-1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>]) &#123;</div><div class="line">                        n -= dp[i<span class="number">-1</span>][<span class="number">0</span>] + dp[i<span class="number">-1</span>][<span class="number">1</span>], last = j;</div><div class="line"><span class="comment">//						printf("%llu test\n", dp[i-1][0] + dp[i-1][1]);</span></div><div class="line">                    &#125; <span class="keyword">else</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            last++;</div><div class="line">            <span class="keyword">if</span>(last == <span class="number">4</span>)	last++;</div><div class="line">            <span class="keyword">if</span>(i == len &amp;&amp; last == <span class="number">0</span>)	last = <span class="number">1</span>;</div><div class="line">            <span class="keyword">if</span>(prev == <span class="number">1</span> &amp;&amp; last == <span class="number">3</span>)	last = <span class="number">5</span>;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, last), prev = last;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12484" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12484/" class="article-date">
  <time datetime="2014-08-02T08:23:44.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12484/">UVa 12484 - Cards</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12484/" data-id="cl4lxkpjx0385egvnasi8skdu" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12484/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/滾動數組/">滾動數組</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>每一個序列，每次只能拿走首元素或者尾元素，Alberto 和 Wanderley 輪流取牌，由 Alberto 先手，請問遊戲最後 Alberto 最高能得多少分，而 Wanderley 會盡力阻止她。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">0 -3 5 10</div><div class="line">4</div><div class="line">0 -3 5 7</div><div class="line">4</div><div class="line">47 50 -3 7</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">10</div><div class="line">7</div><div class="line">57</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>照著 dp 的思路下去，因為要輪流取，而 Wanderley 只會想要最小化 Alberto 分數，不會考慮自己的分數，因此轉移的時候會盡可能地小。</p>
<p><code>dp[i][j]</code> 表示當前剩餘長度為 i, 起始首元素為 j，由於狀態太多，必須靠滾動數組來完成 dp。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, a[<span class="number">10005</span>];</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">2</span>][<span class="number">10005</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</div><div class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j + i &lt; n; j++) &#123;</div><div class="line">                <span class="keyword">if</span>((i&amp;<span class="number">1</span>) == <span class="number">1</span>)</div><div class="line">                    dp[<span class="number">0</span>][j] = max(dp[<span class="number">1</span>][j+<span class="number">1</span>] + a[j], dp[<span class="number">1</span>][j] + a[j+i]);</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    dp[<span class="number">1</span>][j] = min(dp[<span class="number">0</span>][j+<span class="number">1</span>], dp[<span class="number">0</span>][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, dp[<span class="number">0</span>][<span class="number">0</span>]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12483" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12483/" class="article-date">
  <time datetime="2014-08-02T08:14:57.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12483/">UVa 12483 - Toboggan of Marbles</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12483/" data-id="cl4lxkpjc037legvnig7tuh8k" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12483/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/幾何/">幾何</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給彈珠檯的高度和寬度，以及左右兩側延伸出的平台，問彈珠滾落的最大直徑為何？</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">3</div><div class="line">6 10</div><div class="line">9 3 8</div><div class="line">6 2 5</div><div class="line">4 3 1</div><div class="line">3 </div><div class="line">5 10</div><div class="line">9 3 7</div><div class="line">7 2 4</div><div class="line">2 3 0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">2.00</div><div class="line">1.41</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>兩線段最近距離</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> eps 1e-6</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Pt</span> &#123;</span></div><div class="line">    <span class="keyword">double</span> x, y;</div><div class="line">    Pt(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>):</div><div class="line">    	x(a), y(b) &#123;&#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">fabs</span>(x-a.x) &gt; eps)</div><div class="line">            <span class="keyword">return</span> x &lt; a.x;</div><div class="line">        <span class="keyword">return</span> y &lt; a.y;</div><div class="line">    &#125;</div><div class="line">    Pt <span class="keyword">operator</span>-(<span class="keyword">const</span> Pt &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        Pt ret;</div><div class="line">        ret.x = x - a.x;</div><div class="line">        ret.y = y - a.y;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">enum</span> LINE_TYPE &#123;LINE, SEGMENT&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LINE2D</span> &#123;</span></div><div class="line">    Pt s, e;</div><div class="line">    LINE_TYPE type;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> hypot(a.x - b.x, a.y - b.y);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">dot</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.x + a.y * b.y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross2</span><span class="params">(Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.x * b.y - a.y * b.x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(Pt o, Pt a, Pt b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> (a.x-o.x)*(b.y-o.y)-(a.y-o.y)*(b.x-o.x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">between</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> dot(c - a, b - a) &gt;= <span class="number">0</span> &amp;&amp; dot(c - b, a - b) &gt;= <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">onSeg</span><span class="params">(Pt a, Pt b, Pt c)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> between(a, b, c) &amp;&amp; <span class="built_in">fabs</span>(cross(a, b, c)) &lt; eps;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">intersection</span><span class="params">(Pt as, Pt at, Pt bs, Pt bt)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(cross(as, at, bs) * cross(as, at, bt) &lt; <span class="number">0</span> &amp;&amp;</div><div class="line">       cross(at, as, bs) * cross(at, as, bt) &lt; <span class="number">0</span> &amp;&amp;</div><div class="line">       cross(bs, bt, as) * cross(bs, bt, at) &lt; <span class="number">0</span> &amp;&amp;</div><div class="line">       cross(bt, bs, as) * cross(bt, bs, at) &lt; <span class="number">0</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">distProjection</span><span class="params">(Pt as, Pt at, Pt s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> a, b, c;</div><div class="line">    a = at.y - as.y;</div><div class="line">    b = as.x - at.x;</div><div class="line">    c = - (a * as.x + b * as.y);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(a * s.x + b * s.y + c) / hypot(a, b);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">closest</span><span class="params">(LINE2D l1, LINE2D l2)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l1.type == SEGMENT &amp;&amp; l2.type == SEGMENT) &#123;</div><div class="line">        <span class="keyword">if</span>(intersection(l1.s, l1.e, l2.s, l2.e))</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">double</span> c = <span class="number">1e+30</span>;</div><div class="line">        <span class="keyword">if</span>(between(l1.s, l1.e, l2.s))</div><div class="line">            c = min(c, distProjection(l1.s, l1.e, l2.s));</div><div class="line">        <span class="keyword">else</span></div><div class="line">            c = min(c, min(dist(l1.s, l2.s), dist(l1.e, l2.s)));</div><div class="line">            </div><div class="line">        <span class="keyword">if</span>(between(l1.s, l1.e, l2.e))</div><div class="line">            c = min(c, distProjection(l1.s, l1.e, l2.e));</div><div class="line">        <span class="keyword">else</span></div><div class="line">            c = min(c, min(dist(l1.s, l2.e), dist(l1.e, l2.e)));</div><div class="line">        <span class="comment">/* opposite */</span></div><div class="line">        <span class="keyword">if</span>(between(l2.s, l2.e, l1.s))</div><div class="line">            c = min(c, distProjection(l2.s, l2.e, l1.s));</div><div class="line">        <span class="keyword">else</span></div><div class="line">            c = min(c, min(dist(l1.s, l2.s), dist(l1.e, l2.s)));</div><div class="line">            </div><div class="line">        <span class="keyword">if</span>(between(l2.s, l2.e, l1.e))</div><div class="line">            c = min(c, distProjection(l2.s, l2.e, l1.e));</div><div class="line">        <span class="keyword">else</span></div><div class="line">            c = min(c, min(dist(l2.s, l1.e), dist(l2.e, l1.e)));</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(l1.type == LINE &amp;&amp; l2.type == LINE) &#123;</div><div class="line">        <span class="keyword">double</span> a1, a2, b1, b2, c1, c2;</div><div class="line">        a1 = l1.s.y - l1.e.y;</div><div class="line">        b1 = l1.e.x - l1.s.x;</div><div class="line">        c1 = - (a1 * l1.s.x + b1 * l1.s.y);</div><div class="line">        a2 = l2.s.y - l2.e.y;</div><div class="line">        b2 = l2.e.x - l2.s.x;</div><div class="line">        c2 = - (a2 * l2.s.x + b2 * l2.s.y);</div><div class="line">        <span class="keyword">if</span>(a1 * b2 - a2 * b1 != <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> distProjection(l1.s, l1.e, l2.s);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(l1.type != l2.type) &#123;</div><div class="line">        <span class="keyword">if</span>(l1.type == SEGMENT)</div><div class="line">            swap(l1, l2);</div><div class="line">        <span class="comment">/* l1 LINE, l2 SEGMENT*/</span></div><div class="line">        <span class="keyword">double</span> a1, b1, c1;</div><div class="line">        a1 = l1.s.y - l1.e.y;</div><div class="line">        b1 = l1.e.x - l1.s.x;</div><div class="line">        c1 = - (a1 * l1.s.x + b1 * l1.s.y);</div><div class="line">        <span class="keyword">int</span> v1, v2;</div><div class="line">        v1 = a1 * l2.s.x + b1 * l2.s.y + c1;</div><div class="line">        v2 = a1 * l2.e.x + b1 * l2.e.y + c1;</div><div class="line">        <span class="keyword">if</span>(v1 * v2 &lt;= <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// different side</span></div><div class="line">        <span class="keyword">return</span> min(distProjection(l1.s, l1.e, l2.s), distProjection(l1.s, l1.e, l2.e));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">double</span> L, H;</div><div class="line">    LINE2D D[<span class="number">1024</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf %lf"</span>, &amp;L, &amp;H);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            D[i].s.x = i&amp;<span class="number">1</span> ? L : <span class="number">0</span>;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf %lf %lf"</span>, &amp;D[i].s.y, &amp;D[i].e.x, &amp;D[i].e.y);</div><div class="line">            D[i].type = SEGMENT;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        LINE2D wall1, wall2;</div><div class="line">        wall1.type = wall2.type = LINE;</div><div class="line">        wall1.s.x = wall1.e.x = <span class="number">0</span>;</div><div class="line">        wall1.s.y = <span class="number">1</span>, wall1.e.y = <span class="number">0</span>;</div><div class="line">        </div><div class="line">        wall2.s.x = wall2.e.x = L;</div><div class="line">        wall2.s.y = <span class="number">1</span>, wall2.e.y = <span class="number">0</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">double</span> r = L;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span>(i&amp;<span class="number">1</span>)</div><div class="line">                r = min(r, closest(wall1, D[i]));</div><div class="line">            <span class="keyword">else</span></div><div class="line">                r = min(r, closest(wall2, D[i]));</div><div class="line">            <span class="keyword">if</span>(i + <span class="number">1</span> &lt; n) &#123;</div><div class="line">                r = min(r, closest(D[i], D[i+<span class="number">1</span>]));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.2lf\n"</span>, r);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12446" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12446/" class="article-date">
  <time datetime="2014-08-02T08:03:23.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12446/">UVa 12446 - How Many... in 3D!</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12446/" data-id="cl4lxkpji037segvnf0nhbqdj" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12446/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞廻/">遞廻</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>Given a 2x2xN box, in how many ways can you fill it with 1x1x2 blocks?<br>Input Format</p>
<p>The input starts with an integer T - the number of test cases (T &lt;= 10,000). T cases follow on each subsequent line, each of them containing the integer N (1 &lt;= N &lt;= 1,000,000).</p>
<h2 id="Output-Format"><a href="#Output-Format" class="headerlink" title="Output Format"></a>Output Format</h2><p>For each test case, print the number of ways to fill the box modulo 1,000,000,007</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">3</div><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2</div><div class="line">9</div><div class="line">32</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>把幾種情況畫出來，會發現有一種特別的之之型，最後會接上一個 1x2 的來湊滿一個 2 x 2 x N 的情況，為此我們必須要知道有多少這種之之型可以從哪裡拆分出來。</p>
<p>會在代碼中發現一個變數 c 存放的便是以之之型結束的方法數，之之型可以把最後一個 1x2 拿走，繼續延伸。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">1048576</span>] = &#123;&#125;;</div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> mod = <span class="number">1000000007L</span>L;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>, dp[<span class="number">1</span>] = <span class="number">2</span>, dp[<span class="number">2</span>] = <span class="number">9</span>, dp[<span class="number">3</span>] = <span class="number">32</span>;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> c = <span class="number">4</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>; i &lt;= <span class="number">1000000</span>; i++) &#123;</div><div class="line">        c = (c + dp[i<span class="number">-3</span>] * <span class="number">4</span>)%mod; <span class="comment">// &#123;ZigZag&#125;</span></div><div class="line">        dp[i] = (dp[i<span class="number">-1</span>] * <span class="number">2</span> + dp[i<span class="number">-2</span>] * <span class="number">5</span> + c)%mod; </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> testcase, n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span>(testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, dp[n]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">1000</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">3</span></div><div class="line"><span class="comment">4</span></div><div class="line"><span class="comment">5</span></div><div class="line"><span class="comment">6</span></div><div class="line"><span class="comment">7</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">2</span></div><div class="line"><span class="comment">9</span></div><div class="line"><span class="comment">32</span></div><div class="line"><span class="comment">121</span></div><div class="line"><span class="comment">450</span></div><div class="line"><span class="comment">1681</span></div><div class="line"><span class="comment">6272</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12436" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12436/" class="article-date">
  <time datetime="2014-08-02T06:20:17.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12436/">UVa 12436 - Rip Van Winkle&#39;s Code</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/" data-id="cl4lxkpj8037hegvn9dxmcp0l" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ST/">ST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/線段樹/">線段樹</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">long long data[250001];</div><div class="line"></div><div class="line">void A( int st, int nd ) &#123;</div><div class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = data[i] + (i - st + 1);</div><div class="line">&#125;</div><div class="line">void B( int st, int nd ) &#123;</div><div class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = data[i] + (nd - i + 1);</div><div class="line">&#125;</div><div class="line">void C( int st, int nd, int x ) &#123;</div><div class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = x;</div><div class="line">&#125;</div><div class="line">long long S( int st, int nd ) &#123;</div><div class="line">    long long res = 0;</div><div class="line">    for( int i = st; i &lt;= nd; i++ ) res += data[i];</div><div class="line">    return res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of input will contain T (≤ 4*105) denoting the number of operations. Each of the next T lines starts with a character (‘A’, ‘B’, ‘C’ or ‘S’), which indicates the type of operation. Character ‘A’, ‘B’ or ‘S’ will be followed by two integers, st and nd in the same line. Character ‘C’ is followed by three integers, st, nd and x. It’s assumed that, 1 ≤ st ≤ nd ≤ 250000 and -105 ≤ x ≤ 105. The meanings of these integers are explained by the code of Rip Van Winkle.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each line starting with the character ‘S’, print S( st, nd ) as defined in the code. Dataset is huge, so use faster I/O methods.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">7</div><div class="line">A 1 4</div><div class="line">B 2 3</div><div class="line">S 1 3</div><div class="line">C 3 4 -2</div><div class="line">S 2 4</div><div class="line">B 1 3</div><div class="line">S 2 4</div></pre></td></tr></table></figure>
<p>Output for Sample Input<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">9</div><div class="line">0</div><div class="line">3</div></pre></td></tr></table></figure></p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>紀錄該區間的首項和公差即可，保證公差可以疊加。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 262144</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 1048576 + 10 </span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line">LL sum[MAXM];</div><div class="line">LL preB[MAXM], preD[MAXM]; <span class="comment">// base, diff</span></div><div class="line">LL sufB[MAXM], sufD[MAXM];</div><div class="line">LL setB[MAXM], setD[MAXM];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushUp</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</div><div class="line">    sum[k] = sum[k&lt;&lt;<span class="number">1</span>] + sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushDown</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> m = (l + r) /<span class="number">2</span>;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span>(setB[k]) &#123;</div><div class="line">        setB[k&lt;&lt;<span class="number">1</span>] = <span class="number">1</span>, setD[k&lt;&lt;<span class="number">1</span>] = setD[k];</div><div class="line">        setB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = <span class="number">1</span>, setD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = setD[k];</div><div class="line">        preB[k&lt;&lt;<span class="number">1</span>] = preD[k&lt;&lt;<span class="number">1</span>] = sufB[k&lt;&lt;<span class="number">1</span>] = sufD[k&lt;&lt;<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">        preB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = preD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = sufB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = sufD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>] = (m - l + <span class="number">1</span>) * setD[k];</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = (r - m) * setD[k];</div><div class="line">        setB[k] = setD[k] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(preB[k]) &#123;</div><div class="line">        preB[k&lt;&lt;<span class="number">1</span>] += preB[k], preD[k&lt;&lt;<span class="number">1</span>] += preD[k];</div><div class="line">        preB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += preB[k] + preD[k] * (m - l + <span class="number">1</span>), preD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += preD[k];</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>] += (<span class="number">2</span> * preB[k] + (m - l) * preD[k]) * (m - l + <span class="number">1</span>)/<span class="number">2</span>;</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += (<span class="number">2</span> * preB[k] + (r - l + m + <span class="number">1</span> - l) * preD[k]) * (r - m)/<span class="number">2</span>;</div><div class="line">        preB[k] = preD[k] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(sufB[k]) &#123;</div><div class="line">        sufB[k&lt;&lt;<span class="number">1</span>] += sufB[k] + (r - m) * sufD[k], sufD[k&lt;&lt;<span class="number">1</span>] += sufD[k];</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>] += (<span class="number">2</span> * sufB[k] + (r - m + r - l) * sufD[k]) * (m - l + <span class="number">1</span>)/<span class="number">2</span>;</div><div class="line">        sufB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += sufB[k], sufD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += sufD[k];</div><div class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += (<span class="number">2</span> * sufB[k] + (r - m - <span class="number">1</span>) * sufD[k]) * (r - m)/<span class="number">2</span>;</div><div class="line"><span class="comment">//		printf("[%d %d] suffix %lld %lld , = %lld %lld\n", l, r, sufB[k], sufD[k], sum[k&lt;&lt;1], sum[k&lt;&lt;1|1]);</span></div><div class="line">        sufB[k] = sufD[k] = <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyA</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</div><div class="line">        preB[k] += l - x + <span class="number">1</span>, preD[k]++;</div><div class="line">        sum[k] += (LL)(<span class="number">2</span> * (l - x + <span class="number">1</span>) + r - l) * (r - l + <span class="number">1</span>)/<span class="number">2</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    pushDown(k, l, r);</div><div class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span>(y &lt;= m)</div><div class="line">        modifyA(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</div><div class="line">        modifyA(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        modifyA(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</div><div class="line">        modifyA(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</div><div class="line">    &#125;</div><div class="line">    pushUp(k);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyB</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</div><div class="line">    pushDown(k, l, r);</div><div class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</div><div class="line">        sufB[k] += y - r + <span class="number">1</span>, sufD[k]++;</div><div class="line">        sum[k] += (LL)(<span class="number">2</span> * (y - r + <span class="number">1</span>) + r - l) * (r - l + <span class="number">1</span>)/<span class="number">2</span>;</div><div class="line"><span class="comment">//		printf("BB [%d %d] %d\n", l, r, base);</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span>(y &lt;= m)</div><div class="line">        modifyB(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</div><div class="line">        modifyB(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        modifyB(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</div><div class="line">        modifyB(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</div><div class="line">    &#125;</div><div class="line">    pushUp(k);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyC</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mm)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</div><div class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</div><div class="line">        setB[k] = <span class="number">1</span>, setD[k] = mm;</div><div class="line">        preB[k] = preD[k] = sufB[k] = sufD[k] = <span class="number">0</span>;</div><div class="line">        sum[k] = (LL)mm * (r - l + <span class="number">1</span>);</div><div class="line"><span class="comment">//		printf("CCCC [%d %d] %lld\n", l, r, sum[k]);</span></div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    pushDown(k, l, r);</div><div class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</div><div class="line">    <span class="keyword">if</span>(y &lt;= m)</div><div class="line">        modifyC(k&lt;&lt;<span class="number">1</span>, l, m, x, y, mm);</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</div><div class="line">        modifyC(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y, mm);</div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">        modifyC(k&lt;&lt;<span class="number">1</span>, l, m, x, y, mm);</div><div class="line">        modifyC(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y, mm);</div><div class="line">    &#125;</div><div class="line">    pushUp(k);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    pushDown(k, l, r);</div><div class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y) &#123;</div><div class="line"><span class="comment">//		printf("qq[%d %d] %lld\n", l, r, sum[k]);</span></div><div class="line">        <span class="keyword">return</span> sum[k];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> m = (l + r)/<span class="number">2</span>;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(x &lt;= m)</div><div class="line">        ret += query(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</div><div class="line">    <span class="keyword">if</span>(y &gt; m)</div><div class="line">        ret += query(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out2.txt", "w+t", stdout); </span></div><div class="line">    <span class="keyword">int</span> T, st, nd, x;</div><div class="line">    <span class="keyword">char</span> cmd[<span class="number">128</span>];</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;T) == <span class="number">1</span>) &#123;</div><div class="line">        <span class="built_in">memset</span>(sum, <span class="number">0</span>, <span class="keyword">sizeof</span>(sum));</div><div class="line">        <span class="built_in">memset</span>(preB, <span class="number">0</span>, <span class="keyword">sizeof</span>(preB));</div><div class="line">        <span class="built_in">memset</span>(preD, <span class="number">0</span>, <span class="keyword">sizeof</span>(preD));</div><div class="line">        <span class="built_in">memset</span>(sufB, <span class="number">0</span>, <span class="keyword">sizeof</span>(sufB));</div><div class="line">        <span class="built_in">memset</span>(sufD, <span class="number">0</span>, <span class="keyword">sizeof</span>(sufD));</div><div class="line">        <span class="built_in">memset</span>(setB, <span class="number">0</span>, <span class="keyword">sizeof</span>(setB));</div><div class="line">        <span class="built_in">memset</span>(setD, <span class="number">0</span>, <span class="keyword">sizeof</span>(setD));</div><div class="line">        <span class="keyword">while</span>(T--) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, cmd);</div><div class="line">            <span class="keyword">if</span>(cmd[<span class="number">0</span>] == <span class="string">'C'</span>)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;st, &amp;nd, &amp;x);</div><div class="line">            <span class="keyword">else</span></div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;st, &amp;nd);</div><div class="line">            <span class="keyword">switch</span>(cmd[<span class="number">0</span>]) &#123;</div><div class="line">                <span class="keyword">case</span> <span class="string">'A'</span>:</div><div class="line">                    modifyA(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'B'</span>:</div><div class="line">                    modifyB(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'C'</span>:</div><div class="line">                    modifyC(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd, x);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                <span class="keyword">case</span> <span class="string">'S'</span>:</div><div class="line">                    <span class="keyword">long</span> <span class="keyword">long</span> ret = query(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</div><div class="line">                    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">        &#125; </div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">1000</span></div><div class="line"><span class="comment">S 2 3</span></div><div class="line"><span class="comment">A 7 15</span></div><div class="line"><span class="comment">B 4 5</span></div><div class="line"><span class="comment">B 15 16</span></div><div class="line"><span class="comment">C 2 10 3</span></div><div class="line"><span class="comment">B 14 15</span></div><div class="line"><span class="comment">A 10 18</span></div><div class="line"><span class="comment">S 4 4</span></div><div class="line"><span class="comment">A 3 16</span></div><div class="line"><span class="comment">B 6 14</span></div><div class="line"><span class="comment">B 4 7</span></div><div class="line"><span class="comment">S 8 11</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12396" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12396/" class="article-date">
  <time datetime="2014-08-02T06:17:05.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12396/">UVa 12396 - Remoteland</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12396/" data-id="cl4lxkpjn037vegvncrle4l49" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12396/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sieve/">sieve</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>求 N! 的因數中最大的完全平方數。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">9348095</div><div class="line">6297540</div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">177582252</div><div class="line">644064736</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>對 N! 做因數分解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxL (10000000&gt;&gt;5)+1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> GET(x) (mark[x&gt;&gt;5]&gt;&gt;(x&amp;31)&amp;1)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> SET(x) (mark[x&gt;&gt;5] |= 1&lt;&lt;(x&amp;31))</span></div><div class="line"><span class="keyword">int</span> mark[maxL];</div><div class="line"><span class="keyword">int</span> P[<span class="number">1048576</span>], Pt = <span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">sieve</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">register</span> <span class="keyword">int</span> i, j, k;</div><div class="line">    SET(<span class="number">1</span>);</div><div class="line">    <span class="keyword">int</span> n = <span class="number">10000000</span>;</div><div class="line">    <span class="keyword">for</span>(i = <span class="number">2</span>; i &lt;= n; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(!GET(i)) &#123;</div><div class="line">            <span class="keyword">for</span>(k = n/i, j = i*k; k &gt;= i; k--, j -= i)</div><div class="line">                SET(j);</div><div class="line">            P[Pt++] = i; </div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">mpow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y, <span class="keyword">long</span> <span class="keyword">long</span> mod)</span> </span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span>(y) &#123;</div><div class="line">        <span class="keyword">if</span>(y&amp;<span class="number">1</span>)</div><div class="line">            ret *= x, ret %= mod;</div><div class="line">        y &gt;&gt;= <span class="number">1</span>, x = (x * x)%mod;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    sieve();</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> mod = <span class="number">1000000007L</span>L;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Pt; i++) &#123;</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> p = P[i], cnt = <span class="number">0</span>;</div><div class="line">            <span class="keyword">while</span>(p &lt;= n)</div><div class="line">                cnt += n / p, p *= P[i];</div><div class="line">            <span class="keyword">if</span>(cnt &lt; <span class="number">2</span>)	<span class="keyword">break</span>;</div><div class="line">            ret *= mpow(P[i], cnt/<span class="number">2</span>*<span class="number">2</span>, mod);</div><div class="line">            ret %= mod;</div><div class="line">        &#125; </div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12368" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12368/" class="article-date">
  <time datetime="2014-08-02T06:09:15.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12368/">UVa 12368 - Candles</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12368/" data-id="cl4lxkpir0373egvngj2nvkvh" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12368/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/建表/">建表</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/窮舉/">窮舉</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>現在只有 0 - 9 共計 10 根蠟燭，有 N 個人過生日，每個人的生日年紀不大於 100。</p>
<p>最多用 10 根蠟燭，來表示每一個人的生日。每個人的生日可以用兩個整數加總，或者單純用一個整數表示。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">2 10 11</div><div class="line">1 30</div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Output-for-Sample-Input"><a href="#Output-for-Sample-Input" class="headerlink" title="Output for Sample Input"></a>Output for Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Case 1: 654</div><div class="line">Case 2: 30</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>預建表，找到所有數字 <code>[1, 100]</code> 能用哪幾種蠟燭建出來。</p>
<p>測資很緊，不建表會一直 TLE。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> able[<span class="number">128</span>][<span class="number">1024</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> d1, d2, d3, d4;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">100</span>; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(i &lt; <span class="number">100</span>) &#123;</div><div class="line">            <span class="keyword">if</span>(i &lt; <span class="number">10</span>) &#123;</div><div class="line">                d1 = i;</div><div class="line">                able[i][<span class="number">1</span>&lt;&lt;d1] = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                d1 = i%<span class="number">10</span>, d2 = i/<span class="number">10</span>;</div><div class="line">                <span class="keyword">if</span>(d1 != d2)</div><div class="line">                    able[i][(<span class="number">1</span>&lt;&lt;d1)|(<span class="number">1</span>&lt;&lt;d2)] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; j++) &#123;</div><div class="line">            <span class="keyword">int</span> a = j, b = i - j, mask = <span class="number">0</span>;</div><div class="line"></div><div class="line">            <span class="keyword">if</span>(a &lt; <span class="number">10</span>) &#123;</div><div class="line">                mask |= <span class="number">1</span>&lt;&lt;a;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                d1 = a%<span class="number">10</span>, d2 = a/<span class="number">10</span>;</div><div class="line">                <span class="keyword">if</span>(d1 == d2)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                mask |= (<span class="number">1</span>&lt;&lt;d1)|(<span class="number">1</span>&lt;&lt;d2);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(b &lt; <span class="number">10</span>) &#123;</div><div class="line">                <span class="keyword">if</span>(mask&amp;(<span class="number">1</span>&lt;&lt;b))</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                mask |= <span class="number">1</span>&lt;&lt;b;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                d1 = b%<span class="number">10</span>, d2 = b/<span class="number">10</span>;</div><div class="line">                <span class="keyword">if</span>(d1 == d2)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span>(mask&amp;((<span class="number">1</span>&lt;&lt;d1)|(<span class="number">1</span>&lt;&lt;d2)))</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                mask |= (<span class="number">1</span>&lt;&lt;d1)|(<span class="number">1</span>&lt;&lt;d2);</div><div class="line">            &#125;</div><div class="line">            able[i][mask] = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">128</span>; i++) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">1024</span>; j++) &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k = j; k; k = k&amp;(k<span class="number">-1</span>))</div><div class="line">                able[i][j] |= able[i][j&amp;(k<span class="number">-1</span>)];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    build();</div><div class="line"><span class="comment">//	freopen("in.txt", "r+t", stdin);</span></div><div class="line"><span class="comment">//	freopen("out.txt", "w+t", stdout);</span></div><div class="line">    <span class="keyword">int</span> n, A[<span class="number">10</span>], cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</div><div class="line">        <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; R;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i]);</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> ret = (<span class="number">1</span>&lt;&lt;<span class="number">10</span>)<span class="number">-1</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span>&lt;&lt;<span class="number">10</span>); i++) &#123;</div><div class="line">            <span class="keyword">if</span>(__builtin_popcount(i) &gt;= __builtin_popcount(ret))</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">int</span> f = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n &amp;&amp; f; j++)</div><div class="line">                f &amp;= able[A[j]][i];</div><div class="line">            <span class="keyword">if</span>(f) &#123;</div><div class="line">                ret = i;		</div><div class="line"></div><div class="line">            &#125;</div><div class="line">        &#125;							</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: "</span>, ++cases);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">9</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span>((ret&gt;&gt;i)&amp;<span class="number">1</span>)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">"%d"</span>, i);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-oj/uva/uva-12363" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12363/" class="article-date">
  <time datetime="2014-08-02T06:01:07.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/08/02/oj/uva/uva-12363/">UVa 12363 - Hedge Mazes</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12363/" data-id="cl4lxkpiz037aegvncbb65vrw" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12363/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bridge/">bridge</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/并查集/">并查集</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/橋/">橋</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給一無向圖，問任兩點是否存在唯一的路徑到達。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">6 5 3</div><div class="line">1 2</div><div class="line">2 3</div><div class="line">2 4</div><div class="line">2 5</div><div class="line">4 5</div><div class="line">1 3</div><div class="line">1 5</div><div class="line">2 6</div><div class="line">4 2 3</div><div class="line">1 2</div><div class="line">2 3</div><div class="line">1 4</div><div class="line">1 3</div><div class="line">1 2</div><div class="line">0 0 0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Y</div><div class="line">N</div><div class="line">N</div><div class="line">-</div><div class="line">N</div><div class="line">Y</div><div class="line">Y</div><div class="line">-</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>唯一路徑，保證 x - y 之間走過的只會有橋 (由很多橋構成)，將所有橋找到，並且將橋兩端利用并查集合併 (構成大橋)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g[<span class="number">131072</span>];</div><div class="line"></div><div class="line"><span class="keyword">int</span> visited[<span class="number">131072</span>], depth[<span class="number">131072</span>];</div><div class="line"><span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; bridge;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findBridge</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p, <span class="keyword">int</span> dep)</span> </span>&#123;</div><div class="line">    visited[u] = <span class="number">1</span>, depth[u] = dep;</div><div class="line">    <span class="keyword">int</span> back = <span class="number">0x3f3f3f3f</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; g[u].size(); i++) &#123;</div><div class="line">        <span class="keyword">int</span> v = g[u][i];</div><div class="line">        <span class="keyword">if</span>(v == p)	<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">if</span>(!visited[v]) &#123;</div><div class="line">            <span class="keyword">int</span> b = findBridge(v, u, dep+<span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span>(b &gt; dep) &#123;</div><div class="line">                bridge.push_back(make_pair(u, v));</div><div class="line">            &#125;</div><div class="line">            back = min(back, b);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            back = min(back, depth[v]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> back;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> rank[<span class="number">131072</span>], parent[<span class="number">131072</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">findp</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> parent[x] == x ? x : parent[x]=findp(parent[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">joint</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    x = findp(x), y = findp(y);</div><div class="line">    <span class="keyword">if</span>(x == y)	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(rank[x] &gt; rank[y])</div><div class="line">        rank[x] += rank[y], parent[y] = x;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        rank[y] += rank[x], parent[x] = y;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n, m, q, x, y;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;n, &amp;m, &amp;q) == <span class="number">3</span> &amp;&amp; n+m) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            g[i].clear();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            x--, y--;</div><div class="line">            g[x].push_back(y);</div><div class="line">            g[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        bridge.clear();</div><div class="line">        <span class="built_in">memset</span>(visited, <span class="number">0</span>, <span class="keyword">sizeof</span>(visited));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span>(!visited[i]) &#123;</div><div class="line">                findBridge(i, <span class="number">-1</span>, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            rank[i] = <span class="number">1</span>, parent[i] = i;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; bridge.size(); i++)</div><div class="line">            joint(bridge[i].first, bridge[i].second);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; q; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x ,&amp;y);</div><div class="line">            x--, y--;</div><div class="line">            <span class="built_in">puts</span>(findp(x) == findp(y) ? <span class="string">"Y"</span> : <span class="string">"N"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">"-"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/categories/解題區/解題區-UVa/page/34/">&laquo; Prev</a><a class="page-number" href="/categories/解題區/解題區-UVa/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/33/">33</a><a class="page-number" href="/categories/解題區/解題區-UVa/page/34/">34</a><span class="page-number current">35</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/36/">36</a><a class="page-number" href="/categories/解題區/解題區-UVa/page/37/">37</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-UVa/page/49/">49</a><a class="extend next" rel="next" href="/categories/解題區/解題區-UVa/page/36/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">39</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/其他/">其他</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">15</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">61</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2022/06/20/note/diary-20220620/">
              
                <i class="icon-file-o"></i> 
              
            維護作業</a>
          </li>
        
          <li>
            <a class="text" href="/2022/06/19/work/company-ghost-story-15/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 15</a>
          </li>
        
          <li>
            <a class="text" href="/2022/03/27/note/diary-20220327/">
              
                <i class="icon-file-o"></i> 
              
            規劃 ‧ 生活</a>
          </li>
        
          <li>
            <a class="text" href="/2022/01/03/note/diary-20220103-encrypt/">
              
                <i class="icon-file-o"></i> 
              
            《批改娘串起得那段經歷·玖 冬暄》</a>
          </li>
        
          <li>
            <a class="text" href="/2022/01/02/note/diary-20220102-encrypt/">
              
                <i class="icon-file-o"></i> 
              
            《批改娘串起得那段經歷·捌 風暴》</a>
          </li>
        
          <li>
            <a class="text" href="/2022/01/01/note/diary-20220101-encrypt/">
              
                <i class="icon-file-o"></i> 
              
            《批改娘串起得那段經歷·柒 暗潮》</a>
          </li>
        
          <li>
            <a class="text" href="/2022/01/01/note/diary-20220101/">
              
                <i class="icon-file-o"></i> 
              
            二八 ‧ 年尾</a>
          </li>
        
          <li>
            <a class="text" href="/2022/01/01/note/clove-letter/">
              
                <i class="icon-file-o"></i> 
              
            《獻給某工程師的情書》</a>
          </li>
        
          <li>
            <a class="text" href="/2021/12/31/note/diary-20211231-encrypt/">
              
                <i class="icon-file-o"></i> 
              
            《批改娘串起得那段經歷·陸 二八》</a>
          </li>
        
          <li>
            <a class="text" href="/2021/12/26/note/diary-20211226-encrypt/">
              
                <i class="icon-file-o"></i> 
              
            《批改娘串起得那段經歷·伍 坦白》</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
        <ul>
          <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
        </ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2022 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>