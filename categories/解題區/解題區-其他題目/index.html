<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 解題區 - 其他題目 | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/解題區-其他題目/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <!-- <link rel="import" href="/bower_components/app-layout/app-layout.html"> --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-lesson/ada-2020-hw1-p3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/31/lesson/ada-2020-hw1-p3/" class="article-date">
  <time datetime="2020-10-31T08:30:00.000Z" itemprop="datePublished">2020-10-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/31/lesson/ada-2020-hw1-p3/">ADA 2020 Fall P3. ADA Party</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2020/10/31/lesson/ada-2020-hw1-p3/" data-id="cktgvu6jf02bcmwvnd3ep7mxm" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2020/10/31/lesson/ada-2020-hw1-p3/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分治/">分治</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/排容/">排容</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>Algorithm Design and Analysis (NTU CSIE, Fall 2020)</p>
</blockquote>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給 <span>$N$</span><!-- Has MathJax --> 個堆，每個堆有 <span>$a_i$</span><!-- Has MathJax --> 個糖果，現在邀請 <span>$K$</span><!-- Has MathJax --> 個人，現在問有多少種挑選區間的方法，滿足扣掉最大堆和最小堆後，區間內的糖果總數可以被 <span>$K$</span><!-- Has MathJax --> 整除。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">10 2</div><div class="line">6 9 3 4 5 6 1 7 8 3</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">25</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><blockquote>
<p>由於沒辦法參與課程，就測測自己產的測試資料，正確性有待確認。</p>
</blockquote>
<p>分治處理可行解的組合，每一次剖半計算，統計跨區間的答案個數。</p>
<p>討論項目分別為</p>
<ul>
<li>最大值、最小值嚴格都在左側</li>
<li>最大值、最小值嚴格都在右側</li>
<li>最大值在左側、最小值在右側</li>
<li>最大值在右側、最小值在左側</li>
</ul>
<p>最後兩項會有交集部分，則扣除 在左側的最大最小值接等於右側的最大最小值。對於每一項回答，搭配單調運行的滑動窗口解決。</p>
<p>時間複雜度 <span>$\mathcal{O}(n \log n)$</span><!-- Has MathJax -->、空間複雜度 <span>$\mathcal{O}(n)$</span><!-- Has MathJax --> </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="comment">// Algorithm Design and Analysis (NTU CSIE, Fall 2020)</span></div><div class="line"><span class="comment">// Problem 3. ADA Party</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">500005</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int32_t</span> MIN = LONG_MIN;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int32_t</span> MAX = LONG_MAX;</div><div class="line"><span class="keyword">int32_t</span> a[MAXN];</div><div class="line"><span class="keyword">int32_t</span> lsum[MAXN], rsum[MAXN];</div><div class="line"><span class="keyword">int32_t</span> lmin[MAXN], lmax[MAXN];</div><div class="line"><span class="keyword">int32_t</span> rmin[MAXN], rmax[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">int</span> cases = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> mark[MAXN];</div><div class="line"><span class="keyword">int</span> counter[MAXN];</div><div class="line"><span class="keyword">int</span> n, k;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">inc</span><span class="params">(<span class="keyword">int32_t</span> val)</span> </span>&#123;</div><div class="line">    val = (val%k+k)%k;</div><div class="line">    <span class="keyword">if</span> (mark[val] != cases)</div><div class="line">        mark[val] = cases, counter[val] = <span class="number">0</span>;</div><div class="line">    counter[val]++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dec</span><span class="params">(<span class="keyword">int32_t</span> val)</span> </span>&#123;</div><div class="line">    val = (val%k+k)%k;</div><div class="line">    <span class="keyword">if</span> (mark[val] != cases)</div><div class="line">        mark[val] = cases, counter[val] = <span class="number">0</span>;</div><div class="line">    counter[val]--;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int32_t</span> val)</span> </span>&#123;</div><div class="line">    val = (val%k+k)%k;</div><div class="line">    <span class="keyword">if</span> (mark[val] != cases)</div><div class="line">        mark[val] = cases, counter[val] = <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> counter[val];</div><div class="line">&#125;</div><div class="line"><span class="keyword">int64_t</span> common(<span class="keyword">int</span> l, <span class="keyword">int</span> m, <span class="keyword">int</span> r) &#123;</div><div class="line">    <span class="keyword">int64_t</span> ret = <span class="number">0</span>;</div><div class="line">    cases++;  <span class="comment">// max and min is same on both end</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m, j = m+<span class="number">1</span>, jl = m+<span class="number">1</span>; i &gt;= l; i--) &#123;</div><div class="line">        <span class="keyword">while</span> (j &lt;= r &amp;&amp; (rmax[j] &lt;= lmax[i] &amp;&amp; rmin[j] &gt;= lmin[i])) &#123;</div><div class="line">            inc(rsum[j]-rmin[j]);</div><div class="line">            j++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (jl &lt; j &amp;&amp; (rmin[jl] &gt; lmin[i] || rmax[jl] &lt; lmax[i])) &#123;</div><div class="line">            dec(rsum[jl]-rmin[jl]);</div><div class="line">            jl++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (j &gt; m+<span class="number">1</span> &amp;&amp; lmin[i] == rmin[j<span class="number">-1</span>] &amp;&amp; lmax[i] == rmax[j<span class="number">-1</span>])</div><div class="line">            ret += get(k-(lsum[i]-lmax[i]));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int64_t</span> divide(<span class="keyword">int</span> l, <span class="keyword">int</span> r) &#123;</div><div class="line">    <span class="keyword">if</span> (l &gt;= r)</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> m = (l+r)/<span class="number">2</span>;</div><div class="line">    <span class="keyword">int32_t</span> sum = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int32_t</span> mn = MAX, mx = MIN;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m; i &gt;= l; i--) &#123;</div><div class="line">        sum += a[i], mn = min(mn, a[i]), mx = max(mx, a[i]);</div><div class="line">        <span class="keyword">if</span> (sum &gt;= k)	sum %= k;</div><div class="line">        lsum[i] = sum, lmin[i] = mn, lmax[i] = mx;</div><div class="line">    &#125;</div><div class="line">    sum = <span class="number">0</span>, mn = MAX, mx = MIN;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m+<span class="number">1</span>; i &lt;= r; i++) &#123;</div><div class="line">        sum += a[i], mn = min(mn, a[i]), mx = max(mx, a[i]);</div><div class="line">        <span class="keyword">if</span> (sum &gt;= k)	sum %= k;</div><div class="line">        rsum[i] = sum, rmin[i] = mn, rmax[i] = mx;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int64_t</span> c1 = <span class="number">0</span>, c2 = <span class="number">0</span>, c3 = <span class="number">0</span>, c4 = <span class="number">0</span>;</div><div class="line"></div><div class="line">    cases++; <span class="comment">// min max on the left</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m, j = m+<span class="number">1</span>; i &gt;= l; i--) &#123;</div><div class="line">        <span class="keyword">while</span> (j &lt;= r &amp;&amp; lmin[i] &lt; a[j] &amp;&amp; a[j] &lt; lmax[i]) &#123;</div><div class="line">            inc(rsum[j]);</div><div class="line">            j++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (i &lt; m)</div><div class="line">            c1 += get(k-(lsum[i]-lmin[i]-lmax[i]));</div><div class="line">    &#125;</div><div class="line">    cases++; <span class="comment">// min max on the right</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m+<span class="number">1</span>, j = m; i &lt;= r; i++) &#123;</div><div class="line">        <span class="keyword">while</span> (j &gt;= l &amp;&amp; rmin[i] &lt; a[j] &amp;&amp; a[j] &lt; rmax[i]) &#123;</div><div class="line">            inc(lsum[j]);</div><div class="line">            j--;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (i &gt; m+<span class="number">1</span>)</div><div class="line">            c2 += get(k-(rsum[i]-rmin[i]-rmax[i]));</div><div class="line">    &#125; </div><div class="line"></div><div class="line">    cases++;  <span class="comment">// min on the left, max on the right</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m, j = m+<span class="number">1</span>, jl = m+<span class="number">1</span>; i &gt;= l; i--) &#123;</div><div class="line">        <span class="keyword">while</span> (j &lt;= r &amp;&amp; rmin[j] &gt;= lmin[i]) &#123;</div><div class="line">            inc(rsum[j]-rmax[j]);</div><div class="line">            j++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (jl &lt; j &amp;&amp; rmax[jl] &lt; lmax[i]) &#123;</div><div class="line">            dec(rsum[jl]-rmax[jl]);</div><div class="line">            jl++;</div><div class="line">        &#125;</div><div class="line">        c3 += get(k-(lsum[i]-lmin[i]));</div><div class="line">    &#125;</div><div class="line">    cases++; <span class="comment">// min on the right, max on the left</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = m+<span class="number">1</span>, j = m, jl = m; i &lt;= r; i++) &#123;</div><div class="line">        <span class="keyword">while</span> (j &gt;= l &amp;&amp; lmin[j] &gt;= rmin[i]) &#123;</div><div class="line">            inc(lsum[j]-lmax[j]);</div><div class="line">            j--;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (jl &gt; j &amp;&amp; lmax[jl] &lt; rmax[i]) &#123;</div><div class="line">            dec(lsum[jl]-lmax[jl]);</div><div class="line">            jl--;</div><div class="line">        &#125;</div><div class="line">        c4 += get(k-(rsum[i]-rmin[i]));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int64_t</span> local = c1 + c2 + c3 + c4 - common(l, m, r);</div><div class="line">    <span class="keyword">return</span> local + divide(l, m) + divide(m+<span class="number">1</span>, r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;k) == <span class="number">2</span>) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;a[i]);</div><div class="line">        <span class="built_in">memset</span>(counter, <span class="number">0</span>, <span class="keyword">sizeof</span>(counter[<span class="number">0</span>])*k);</div><div class="line">        <span class="keyword">int64_t</span> ret = divide(<span class="number">0</span>, n<span class="number">-1</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-lesson/ada-2020-hw1-p2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/10/31/lesson/ada-2020-hw1-p2/" class="article-date">
  <time datetime="2020-10-31T08:00:00.000Z" itemprop="datePublished">2020-10-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/10/31/lesson/ada-2020-hw1-p2/">ADA 2020 Fall P2. Bomb Game</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2020/10/31/lesson/ada-2020-hw1-p2/" data-id="cktgvu6j802b4mwvn4w40ew29" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2020/10/31/lesson/ada-2020-hw1-p2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/BIT/">BIT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分治/">分治</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/整體二分/">整體二分</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>Algorithm Design and Analysis (NTU CSIE, Fall 2020)</p>
</blockquote>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>有數名玩家依序抵達遊戲，並且落在位置 <span>$c_i$</span><!-- Has MathJax -->，並且具有防禦力 <span>$d_i$</span><!-- Has MathJax -->，過程中會有炸彈發生於 <span>$[l_i, r_i]$</span><!-- Has MathJax -->，對防禦力小於等於 <span>$p_i$</span><!-- Has MathJax --> 造成 <span>$k_i$</span><!-- Has MathJax --> 點傷害。</p>
<p>回報遊戲最後每一名玩家所受的傷害總額。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">10 10</div><div class="line">P 3 5</div><div class="line">A 2 8 15 5</div><div class="line">P 7 10</div><div class="line">A 4 10 5 3</div><div class="line">A 1 9 10 7</div><div class="line">P 6 20</div><div class="line">P 5 1</div><div class="line">A 4 9 17 2</div><div class="line">A 1 2 20 4</div><div class="line">P 9 5</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">12</div><div class="line">9</div><div class="line">0</div><div class="line">2</div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><blockquote>
<p>由於沒辦法參與課程，就測測自己產的測試資料，正確性有待確認。</p>
</blockquote>
<p>如果這一題目強制在線對答，則需要一個樹套樹在 <span>$\mathcal{O}(\log^2 n)$</span><!-- Has MathJax --> 內回答每一個結果，需要一個動態開區間的實作方法。</p>
<p>如果採用離線處理，則可以透過逆序處理來回答，可以透過二維空間的 BIT 結構來完成，這時候空間上會是另一個問題，即使使用懶惰標記，預期可能會達到 <span>$\mathcal{O}(C \; D)$</span><!-- Has MathJax -->，通常是不允許的。</p>
<p>從分治算法切入，預想防禦能力高影響不受到攻擊力低的炸彈影響，無論時間與否都不受到影響。接下來，對防禦能力和攻擊力統稱力量。在分治的時候，對力量低的累計出答案，在合併階段受時間順序的影響才能回答。最後：</p>
<ol>
<li>對力量從小到大排序</li>
<li>分治算法<ol>
<li>對左區間和右區間按照時間由大到小排序</li>
<li>對於每一個左區間的詢問，插入所有滿足的右區間</li>
</ol>
</li>
</ol>
<p>時間複雜度 <span>$\mathcal{O}(n \log^2 n)$</span><!-- Has MathJax -->、空間複雜度 <span>$\mathcal{O}(n)$</span><!-- Has MathJax --> </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="comment">// Algorithm Design and Analysis (NTU CSIE, Fall 2020)</span></div><div class="line"><span class="comment">// Problem 2. Bomb Game</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">200005</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BIT</span> &#123;</span></div><div class="line">    <span class="keyword">int64_t</span> a[MAXN];</div><div class="line">    <span class="keyword">int</span> l[MAXN];</div><div class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (x &lt;= n) &#123;</div><div class="line">            <span class="keyword">if</span> (l[x] != cases)</div><div class="line">                l[x] = cases, a[x] = <span class="number">0</span>;</div><div class="line">            a[x] += val, x += x&amp;(-x);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">int64_t</span> sum(<span class="keyword">int</span> x) &#123;</div><div class="line">        <span class="keyword">int64_t</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (x) &#123;</div><div class="line">            <span class="keyword">if</span> (l[x] != cases)</div><div class="line">                l[x] = cases, a[x] = <span class="number">0</span>;</div><div class="line">            ret += a[x], x -= x&amp;(-x);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reset</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        cases++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> k, <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        add(l, k, n);</div><div class="line">        add(r+<span class="number">1</span>, -k, n);</div><div class="line">    &#125;</div><div class="line">&#125; bit;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PEvent</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> c, d, i;</div><div class="line">&#125;;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AEvent</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> l, r, p, k;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Event</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> type; <span class="comment">// 'P' 0 or 'A' 1</span></div><div class="line">    <span class="keyword">int</span> time; <span class="comment">// input order</span></div><div class="line">    <span class="keyword">union</span> &#123;</div><div class="line">        PEvent p;</div><div class="line">        AEvent a;</div><div class="line">    &#125; data;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">power</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (type == <span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> data.p.d;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> data.a.p;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (type == <span class="number">0</span>)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"P %d %d\n"</span>, data.p.c, data.p.d);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"A %d %d %d %d\n"</span>, data.a.l, data.a.r, data.a.p, data.a.k);</div><div class="line">    &#125;</div><div class="line">&#125; events[MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">cmp_p</span><span class="params">(Event &amp;a, Event &amp;b)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> pa = a.power();</div><div class="line">    <span class="keyword">int</span> pb = b.power();</div><div class="line">    <span class="keyword">if</span> (pa != pb)</div><div class="line">        <span class="keyword">return</span> pa &lt; pb;</div><div class="line">    <span class="keyword">return</span> a.time &lt; b.time;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">cmp_t</span><span class="params">(Event &amp;a, Event &amp;b)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> a.time &gt; b.time;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">int</span> ret[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">resolve</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> m, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    sort(events+l, events+m+<span class="number">1</span>, <span class="keyword">cmp_t</span>);</div><div class="line">    sort(events+m+<span class="number">1</span>, events+r+<span class="number">1</span>, <span class="keyword">cmp_t</span>);</div><div class="line"></div><div class="line">    <span class="comment">//	printf("resolve %d %d =========\n", l, r);</span></div><div class="line">    <span class="comment">//	for (int i = l; i &lt;= m; i++)</span></div><div class="line">    <span class="comment">//		events[i].println();</span></div><div class="line">    <span class="comment">//	puts("---");</span></div><div class="line">    <span class="comment">//	for (int i = m+1; i &lt;= r; i++)</span></div><div class="line">    <span class="comment">//		events[i].println();</span></div><div class="line">    bit.reset(n);</div><div class="line">    <span class="keyword">int</span> j = m+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= m; i++) &#123;</div><div class="line">        <span class="keyword">if</span> (events[i].type)</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">int</span> qtime = events[i].time;</div><div class="line">        <span class="keyword">while</span> (j &lt;= r &amp;&amp; events[j].time &gt; qtime) &#123;</div><div class="line">            <span class="keyword">if</span> (events[j].type) &#123;</div><div class="line">                bit.add(events[j].data.a.l,</div><div class="line">                        events[j].data.a.r,</div><div class="line">                        events[j].data.a.k,</div><div class="line">                        n);</div><div class="line">                <span class="comment">//				printf("add %d %d %d %d\n", events[j].data.a.l,</span></div><div class="line">                <span class="comment">//						events[j].data.a.r,</span></div><div class="line">                <span class="comment">//						events[j].data.a.p,</span></div><div class="line">                <span class="comment">//						events[j].data.a.k);</span></div><div class="line">            &#125;</div><div class="line">            j++;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">//		printf("%d --- %d\n", events[i].data.p.i, bit.sum(events[i].data.p.c));</span></div><div class="line">        ret[events[i].data.p.i] += bit.sum(events[i].data.p.c);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">divide</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (l &gt;= r)</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    <span class="keyword">int</span> m = (l+r)/<span class="number">2</span>;</div><div class="line">    divide(l, m);</div><div class="line">    divide(m+<span class="number">1</span>, r);</div><div class="line"></div><div class="line">    resolve(l, m, r);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> m;</div><div class="line">    <span class="keyword">char</span> s[<span class="number">2</span>];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</div><div class="line"></div><div class="line">    <span class="keyword">int</span> id = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">        events[i].time = i;</div><div class="line">        <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'P'</span>) &#123;</div><div class="line">            events[i].type = <span class="number">0</span>;</div><div class="line">            events[i].data.p.i = id++;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>,</div><div class="line">                    &amp;events[i].data.p.c,</div><div class="line">                    &amp;events[i].data.p.d);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            events[i].type = <span class="number">1</span>;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d %d %d"</span>,</div><div class="line">                    &amp;events[i].data.a.l, </div><div class="line">                    &amp;events[i].data.a.r,</div><div class="line">                    &amp;events[i].data.a.p,</div><div class="line">                    &amp;events[i].data.a.k);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sort(events, events+m, cmp_p);</div><div class="line">    divide(<span class="number">0</span>, m<span class="number">-1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; id; i++)	</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-big-integer-division" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/09/big-integer-division/" class="article-date">
  <time datetime="2017-04-09T08:13:14.000Z" itemprop="datePublished">2017-04-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="http://i.imgur.com/BuPUpad.jpg" rel="gallery_cktgvu5ky001emwvnke9gkprs">
        <img src="http://i.imgur.com/BuPUpad.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/09/big-integer-division/">關於高效大數除法的那些事</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2017/04/09/big-integer-division/" data-id="cktgvu5ky001emwvnke9gkprs" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2017/04/09/big-integer-division/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FFT/">FFT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/大數/">大數</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="前情提要"><a href="#前情提要" class="headerlink" title="前情提要"></a>前情提要</h2><p>從國小開始學起加減乘除，腦海裡計算加法比減法簡單，減法可以換成加法，乘法則可以換成數個加法。即使到了中國最強的利器——珠心算，我們學習這古老的快速運算時，也都採取這類方法，而除法最為複雜，需要去估算商，嘗試去扣完，再做細微調整。然而，當整數位數為 <span>$N$</span><!-- Has MathJax --> 時，加減法效能為 <span>$N$</span><!-- Has MathJax --> 基礎運算，而乘除法為 <span>$N^2$</span><!-- Has MathJax --> 次基礎運算，一次基礎運算通常定義在查表，例如背誦的九九乘法表，使得我們在借位和乘積運算達到非常快速。</p>
<p>這些方法在計算機發展後，硬體實作大致使用這些算法，直到了快速傅立葉 (FFT) 算法能在 <span>$O(N \log N)$</span><!-- Has MathJax --> 時間內完成旋積 (卷積) 計算，順利地解決了多項式乘法的問題，使得大數乘法能在 <span>$O(N \log N)$</span><!-- Has MathJax --> 時間內完成。</p>
<p>一開始我們知道乘法和除法都可以在 <span>$O(N^2)$</span><!-- Has MathJax --> 時間內完成，有了 FFT 之後，除法是不是也能跟乘法一樣在 <span>$O(N \log N)$</span><!-- Has MathJax --> 內完成？</p>
<h2 id="大數除法"><a href="#大數除法" class="headerlink" title="大數除法"></a>大數除法</h2><p>就目前研究來看，除法可以轉換成乘法運算，在數論的整數域中，若存在乘法反元素，除一個數相當於成一個數，而我們發展的計算機，有效運算為 32/64-bit，其超過的部分視為溢位 (overflow)，溢位則可視為模數。因此，早期 CPU 設計中，除法需要的運行次數比乘法多一些，編譯器會將除法轉換乘法運算 (企圖找到反元素)，來加速運算。現在，由於 intel 的黑魔法，導致幾乎一模一樣快而沒人注意到這些瑣事。</p>
<p>回過頭來，我們介紹一個藉由 FFT 達到的除法運算 <span>$O(N \log N \log N)$</span><!-- Has MathJax --> 的算法。而那多的 <span>$O(\log N)$</span><!-- Has MathJax --> 來自於牛頓迭代法。目標算出 <span>$C = \lfloor A/B \rfloor$</span><!-- Has MathJax -->，轉換成 <span>$C = \lfloor A \ast (1/B) \rfloor$</span><!-- Has MathJax -->，快速算出 <span>$1/B$</span><!-- Has MathJax --> 的值，採用牛頓迭代法。</p>
<p>額外要求整數長度 <span>$n = \text{length}(A)$</span><!-- Has MathJax -->、<span>$m = \text{length}(B)$</span><!-- Has MathJax -->，當計算 <span>$1/B$</span><!-- Has MathJax --> 時，要求精準度到小數點後 <span>$n$</span><!-- Has MathJax --> 位才行。</p>
<h3 id="牛頓迭代法"><a href="#牛頓迭代法" class="headerlink" title="牛頓迭代法"></a>牛頓迭代法</h3><p>目標求 <span>$f(x) = 0$</span><!-- Has MathJax --> 的一組解。</p>
<span>$$\begin{align}
x_{n+1} = x_n - \frac{f(x_n)}{f&apos;(x_n)}
\end{align}$$</span><!-- Has MathJax -->
<p>不斷地迭代逼近找解。若有多組解，則依賴初始值 <span>$x_0$</span><!-- Has MathJax --> 決定優先找到哪一組解。</p>
<blockquote>
<p>這部分也應用在快速開根號——反平方根快速演算法 <a href="https://en.wikipedia.org/wiki/Fast_inverse_square_root" target="_blank" rel="external">Fast inverse square root</a></p>
</blockquote>
<h3 id="倒數計算"><a href="#倒數計算" class="headerlink" title="倒數計算"></a>倒數計算</h3><p>藉由下述定義，找到 <span>$x = 1/B$</span><!-- Has MathJax --></p>
<span>$$\begin{align}
f(x) = \frac{1}{x} - B, \; f&apos;(x) = -\frac{1}{x^2}
\end{align}$$</span><!-- Has MathJax -->
<p>接著推導牛頓迭代法的公式</p>
<span>$$\begin{align}
x_{n+1} &amp;= x_n - \frac{f(x_n)}{f&apos;(x_n)} \\
&Tab;&Tab;&amp;= x_n - \frac{\frac{1}{x} - B}{-\frac{1}{x^2}} = (2 - x_n B) x_n
\end{align}$$</span><!-- Has MathJax -->
<h3 id="運行範例"><a href="#運行範例" class="headerlink" title="運行範例"></a>運行範例</h3><p>當 <span>$A = 7123456, \; B = 123$</span><!-- Has MathJax -->，計算倒數 <span>$1/B = 1/123$</span><!-- Has MathJax -->，由於 <span>$A$</span><!-- Has MathJax --> 為 <span>$n=7$</span><!-- Has MathJax --> 位數，小數點後精準 7 位，意即迭代比較小數點後 7 位不再變動時停止。</p>
<p>以下描述皆以 <strong>十進制</strong> (在程式運行時我們可能會偏向萬進制，甚至億進制來充分利用 32-bit 暫存器)</p>
<ul>
<li>決定 <span>$x_0$</span><!-- Has MathJax --> 是很重要的一步，這嚴重影響著迭代次數。</li>
<li><span>$x_0$</span><!-- Has MathJax --> 拿 <span>$B$</span><!-- Has MathJax --> 的最高位數 1 進行大數除小數，得到 <span>$x_0 = 0.01$</span><!-- Has MathJax --></li>
<li><span>$x_1 = (2 - x_0 \ast B) \ast x_0 = 0.0077$</span><!-- Has MathJax --></li>
<li><span>$x_2 = (2 - x_1 \ast B) \ast x_1 = 0.0081073$</span><!-- Has MathJax --></li>
<li><span>$x_3 = (2 - x_2 \ast B) \ast x_2 = 0.00813001$</span><!-- Has MathJax --></li>
<li><span>$x_4 = (2 - x_3 \ast B) \ast x_3 = 0.00813008$</span><!-- Has MathJax -->
</li>
</ul>
<p>接下來進行移位到整數部分，進行乘法後再移回去即可。</p>
<h3 id="實作細節"><a href="#實作細節" class="headerlink" title="實作細節"></a>實作細節</h3><h4 id="精準度"><a href="#精準度" class="headerlink" title="精準度"></a>精準度</h4><p>使用浮點數實作的 FFT，需要小心精準度，網路上有些代碼利用合角公式取代建表。這類型的優化，在精準度不需要很高的時候提供較好的效能，卻無法提供精準的值，誤差修正成了一道難題。</p>
<h4 id="牛頓迭代"><a href="#牛頓迭代" class="headerlink" title="牛頓迭代"></a>牛頓迭代</h4><p>由於有 FFT 造成的誤差，檢查收斂必須更加地保守，我們可能需要保留小數點下 <span>$n+10$</span><!-- Has MathJax --> 位，在收斂時檢查 <span>$n+5$</span><!-- Has MathJax --> 位確保收斂。通常收斂可以在 20 次左右完成，若發現迭代次數過多，有可能是第一個精準度造成的影響，盡可能使用內建函數得到的三角函數值。</p>
<h4 id="加速優化"><a href="#加速優化" class="headerlink" title="加速優化"></a>加速優化</h4><p>一般使用 IEEE-754 的浮點數格式，根據 FFT 的長度，要避開超過的震級，因此，在 Zerojudge b960 中，最多使用十萬進制進行加速。</p>
<h4 id="誤差修正"><a href="#誤差修正" class="headerlink" title="誤差修正"></a>誤差修正</h4><p>儘管算出的商 <span>$C=A \ast (1/B)$</span><!-- Has MathJax -->，得到的 <span>$C$</span><!-- Has MathJax --> 可能會差個 1，需要在後續乘法中檢驗。</p>
<h2 id="參考題目-資料"><a href="#參考題目-資料" class="headerlink" title="參考題目/資料"></a>參考題目/資料</h2><ul>
<li><a href="https://zerojudge.tw/ShowProblem?problemid=b960" target="_blank" rel="external">Zerojudge b960</a></li>
<li><a href="http://www.spoj.com/problems/VFDIV/" target="_blank" rel="external">SPOJ VFDIV - Very Fast Division</a></li>
<li><a href="http://edisonx.pixnet.net/blog/post/94569776-%5B%E5%A4%A7%E6%95%B8%5D-c-%E8%AA%9E%E8%A8%80%E5%A4%A7%E6%95%B8%E6%BC%94%E7%AE%97%E6%B3%95-for-general-(iii" target="_blank" rel="external">C 語言大數演算法 for general (III) - 大數除法 / Edison.X. Blog</a>—%E5%A4%A7%E6%95%B8)</li>
</ul>
<h2 id="b960-的亂碼"><a href="#b960-的亂碼" class="headerlink" title="b960 的亂碼"></a>b960 的亂碼</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">class</span> <span class="title">TOOL_FFT</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">complex</span> &#123;</span></div><div class="line">        T x, y;</div><div class="line">        <span class="keyword">complex</span>(T x = <span class="number">0</span>, T y = <span class="number">0</span>):</div><div class="line">            x(x), y(y) &#123;&#125;</div><div class="line">        <span class="keyword">complex</span> <span class="keyword">operator</span>+(<span class="keyword">const</span> <span class="keyword">complex</span> &amp;A) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">complex</span>(x+A.x,y+A.y);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">complex</span> <span class="keyword">operator</span>-(<span class="keyword">const</span> <span class="keyword">complex</span> &amp;A) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">complex</span>(x-A.x,y-A.y);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">complex</span> <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">complex</span> &amp;A) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">complex</span>(x*A.x-y*A.y,x*A.y+y*A.x);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    T PI;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span>&lt;&lt;<span class="number">17</span>;</div><div class="line">    <span class="keyword">complex</span> p[<span class="number">2</span>][MAXN];</div><div class="line">    <span class="keyword">int</span> reversePos[MAXN];</div><div class="line">    TOOL_FFT() &#123;</div><div class="line">        PI = <span class="built_in">acos</span>(<span class="number">-1</span>);</div><div class="line">        preprocessing();</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">NumberOfBitsNeeded</span><span class="params">(<span class="keyword">int</span> PowerOfTwo)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;; ++i) &#123;</div><div class="line">            <span class="keyword">if</span> (PowerOfTwo &amp; (<span class="number">1</span> &lt;&lt; i)) &#123;</div><div class="line">                <span class="keyword">return</span> i;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">inline</span> uint32_t <span class="title">FastReverseBits</span><span class="params">(<span class="keyword">uint32_t</span> a, <span class="keyword">int</span> NumBits)</span> </span>&#123;</div><div class="line">        a = ( ( a &amp; <span class="number">0x55555555</span>U ) &lt;&lt; <span class="number">1</span> ) | ( ( a &amp; <span class="number">0xAAAAAAAA</span>U ) &gt;&gt; <span class="number">1</span> ) ;</div><div class="line">        a = ( ( a &amp; <span class="number">0x33333333</span>U ) &lt;&lt; <span class="number">2</span> ) | ( ( a &amp; <span class="number">0xCCCCCCCC</span>U ) &gt;&gt; <span class="number">2</span> ) ;</div><div class="line">        a = ( ( a &amp; <span class="number">0x0F0F0F0F</span>U ) &lt;&lt; <span class="number">4</span> ) | ( ( a &amp; <span class="number">0xF0F0F0F0</span>U ) &gt;&gt; <span class="number">4</span> ) ;</div><div class="line">        a = ( ( a &amp; <span class="number">0x00FF00FF</span>U ) &lt;&lt; <span class="number">8</span> ) | ( ( a &amp; <span class="number">0xFF00FF00</span>U ) &gt;&gt; <span class="number">8</span> ) ;</div><div class="line">        a = ( ( a &amp; <span class="number">0x0000FFFF</span>U ) &lt;&lt; <span class="number">16</span> ) | ( ( a &amp; <span class="number">0xFFFF0000</span>U ) &gt;&gt; <span class="number">16</span> ) ;</div><div class="line">        <span class="keyword">return</span> a &gt;&gt; (<span class="number">32</span> - NumBits);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">bool</span> InverseTransform, <span class="keyword">complex</span> In[], <span class="keyword">complex</span> Out[], <span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">        <span class="comment">// simultaneous data copy and bit-reversal ordering into outputs</span></div><div class="line">        <span class="keyword">int</span> NumSamples = n;</div><div class="line">        <span class="keyword">int</span> NumBits = NumberOfBitsNeeded(NumSamples);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; NumSamples; ++i) </div><div class="line">            Out[reversePos[i]] = In[i];</div><div class="line">            </div><div class="line">        <span class="comment">// the FFT process</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= NumBits; i++) &#123;</div><div class="line">            <span class="keyword">int</span> BlockSize = <span class="number">1</span>&lt;&lt;i, BlockEnd = BlockSize&gt;&gt;<span class="number">1</span>, BlockCnt = NumSamples/BlockSize;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; NumSamples; j += BlockSize) &#123;</div><div class="line">                <span class="keyword">complex</span> *t = p[InverseTransform];</div><div class="line">                <span class="keyword">int</span> k = <span class="number">0</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> UNLOOP_SIZE 8</span></div><div class="line">                <span class="keyword">for</span> (; k+UNLOOP_SIZE &lt; BlockEnd; ) &#123;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> UNLOOP &#123; \</span></div><div class="line">    <span class="keyword">complex</span> a = (*t) * Out[k+j+BlockEnd]; \</div><div class="line">    Out[k+j+BlockEnd] = Out[k+j] - a; \</div><div class="line">    Out[k+j] = Out[k+j] + a;\</div><div class="line">    k++, t += BlockCnt;\</div><div class="line">&#125;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> UNLOOP4 &#123;UNLOOP UNLOOP UNLOOP UNLOOP;&#125;</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> UNLOOP8 &#123;UNLOOP4 UNLOOP4;&#125;</span></div><div class="line">                    UNLOOP8;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">for</span> (; k &lt; BlockEnd;)</div><div class="line">                    UNLOOP;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// normalize if inverse transform</span></div><div class="line">        <span class="keyword">if</span> (InverseTransform) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; NumSamples; ++i) &#123;</div><div class="line">                Out[i] = Out[i].x / NumSamples;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">convolution</span><span class="params">(T *a, T *b, <span class="keyword">int</span> n, T *c)</span> </span>&#123;</div><div class="line">        <span class="keyword">static</span> <span class="keyword">complex</span> s[MAXN], d1[MAXN], d2[MAXN], y[MAXN];</div><div class="line">    	n = MAXN;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">            s[i] = <span class="keyword">complex</span>(a[i], <span class="number">0</span>);</div><div class="line">        FFT(<span class="literal">false</span>, s, d1, n);</div><div class="line">        s[<span class="number">0</span>] = <span class="keyword">complex</span>(b[<span class="number">0</span>], <span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i)</div><div class="line">            s[i] = <span class="keyword">complex</span>(b[n - i], <span class="number">0</span>);</div><div class="line">        FFT(<span class="literal">false</span>, s, d2, n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">            y[i] = d1[i] * d2[i];</div><div class="line">        FFT(<span class="literal">true</span>, y, s, n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)</div><div class="line">            c[i] = s[i].x;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preprocessing</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = MAXN;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i ++) &#123;</div><div class="line">            p[<span class="number">0</span>][i] = <span class="keyword">complex</span>(<span class="built_in">cos</span>(<span class="number">2</span>*i*PI / n), <span class="built_in">sin</span>(<span class="number">2</span>*i*PI / n));</div><div class="line">            p[<span class="number">1</span>][i] = <span class="keyword">complex</span>(p[<span class="number">0</span>][i].x, -p[<span class="number">0</span>][i].y);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> NumBits = NumberOfBitsNeeded(n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">        	reversePos[i] = FastReverseBits(i, NumBits);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">TOOL_FFT&lt;<span class="keyword">double</span>&gt; tool;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">BigInt</span> &#123;</span></div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> *v;</div><div class="line">    <span class="keyword">int</span> size;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> DIGITS = <span class="number">5</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span>&lt;&lt;<span class="number">17</span>;</div><div class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(<span class="keyword">const</span> BigInt a, <span class="keyword">const</span> BigInt b)</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = MAXN<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (a.v[i] &lt; b.v[i])</div><div class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">            <span class="keyword">if</span> (a.v[i] &gt; b.v[i])</div><div class="line">                <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">str2int</span><span class="params">(<span class="keyword">char</span> *s, <span class="keyword">long</span> <span class="keyword">long</span> buf[])</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s);</div><div class="line">        size = (n+DIGITS<span class="number">-1</span>) / DIGITS;</div><div class="line">        <span class="keyword">int</span> cnt = n%DIGITS == <span class="number">0</span> ? DIGITS : n%DIGITS;</div><div class="line">        <span class="keyword">int</span> x = <span class="number">0</span>, pos = size<span class="number">-1</span>;</div><div class="line">        v = buf;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            x = x*<span class="number">10</span> + s[i] - <span class="string">'0'</span>;</div><div class="line">            <span class="keyword">if</span> (--cnt == <span class="number">0</span>) &#123;</div><div class="line">                cnt = DIGITS;</div><div class="line">                v[pos--] = x, x = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">println</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld"</span>, v[size<span class="number">-1</span>]);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> pos = size<span class="number">-2</span>; pos &gt;= <span class="number">0</span>; pos--)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%05lld"</span>, v[pos]);</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function">BigInt <span class="title">multiply</span><span class="params">(<span class="keyword">const</span> BigInt &amp;other, <span class="keyword">long</span> <span class="keyword">long</span> buf[])</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> m = MAXN;</div><div class="line">        <span class="keyword">static</span> <span class="keyword">double</span> na[MAXN], nb[MAXN];</div><div class="line">        <span class="keyword">static</span> <span class="keyword">double</span> tmp[MAXN];</div><div class="line">        <span class="built_in">memset</span>(na+size, <span class="number">0</span>, <span class="keyword">sizeof</span>(v[<span class="number">0</span>])*(m-size));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++)</div><div class="line">            na[i] = v[i];</div><div class="line">        <span class="built_in">memset</span>(nb+<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(v[<span class="number">0</span>])*(m-other.size));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = m<span class="number">-1</span>; i &lt; other.size; i++, j--)</div><div class="line">            nb[j] = other.v[i];</div><div class="line">        nb[<span class="number">0</span>] = other.v[<span class="number">0</span>];</div><div class="line">        tool.convolution(na, nb, m, tmp);</div><div class="line">        BigInt ret;</div><div class="line">        ret.size = m;</div><div class="line">        ret.v = buf;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</div><div class="line">        	buf[i] = (<span class="keyword">long</span> <span class="keyword">long</span>) (tmp[i] + <span class="number">1.5e-1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">        	<span class="keyword">if</span> (buf[i] &gt;= <span class="number">100000</span>)</div><div class="line">        		buf[i+<span class="number">1</span>] += buf[i]/<span class="number">100000</span>, buf[i] %= <span class="number">100000</span>;</div><div class="line">        &#125;</div><div class="line">        ret.reduce();</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reduce</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">while</span> (size &gt; <span class="number">1</span> &amp;&amp; <span class="built_in">fabs</span>(v[size<span class="number">-1</span>]) &lt; <span class="number">5e-1</span>)</div><div class="line">            size--;</div><div class="line">    &#125;</div><div class="line">    <span class="function">BigInt <span class="title">divide</span><span class="params">(<span class="keyword">const</span> BigInt &amp;other, <span class="keyword">long</span> <span class="keyword">long</span> buf[])</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> cmp = compare(*<span class="keyword">this</span>, other);</div><div class="line">            BigInt ret;</div><div class="line">            ret.size = MAXN<span class="number">-1</span>, ret.v = buf;</div><div class="line">            <span class="keyword">if</span> (cmp == <span class="number">0</span>) &#123;</div><div class="line">                <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf[<span class="number">0</span>])*MAXN);</div><div class="line">                buf[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">                ret.reduce();</div><div class="line">                <span class="keyword">return</span> ret;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cmp &lt; <span class="number">0</span>) &#123;</div><div class="line">                <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf[<span class="number">0</span>])*MAXN);</div><div class="line">                buf[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">                ret.reduce();</div><div class="line">                <span class="keyword">return</span> ret;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="comment">// A / B = A * (1/B)</span></div><div class="line">        <span class="comment">// x' = (2 - x * B) * x</span></div><div class="line">        <span class="keyword">int</span> m = MAXN;</div><div class="line">        <span class="keyword">static</span> <span class="keyword">double</span> na[MAXN], nb[MAXN];</div><div class="line">        <span class="keyword">static</span> <span class="keyword">double</span> invB[MAXN], netB[MAXN], tmpB[MAXN];</div><div class="line">        <span class="keyword">static</span> <span class="keyword">long</span> <span class="keyword">long</span> bufB[MAXN];</div><div class="line">        <span class="keyword">int</span> PRECISION = size+<span class="number">10</span>;</div><div class="line">        <span class="built_in">memset</span>(nb+<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(v[<span class="number">0</span>])*(m-other.size));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = m<span class="number">-1</span>; i &lt; other.size; i++, j--)</div><div class="line">            nb[j] = other.v[i];</div><div class="line">        nb[<span class="number">0</span>] = other.v[<span class="number">0</span>];</div><div class="line">        </div><div class="line">        <span class="built_in">memset</span>(invB, <span class="number">0</span>, <span class="keyword">sizeof</span>(invB[<span class="number">0</span>])*m);</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> t = <span class="number">100000</span>, a = other.v[other.size<span class="number">-1</span>];</div><div class="line">            <span class="keyword">if</span> (other.size<span class="number">-2</span> &gt;= <span class="number">0</span>)</div><div class="line">                t = t*<span class="number">100000</span>, a = a*<span class="number">100000</span>+other.v[other.size<span class="number">-2</span>];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = PRECISION-other.size; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">                invB[i] = t/a;</div><div class="line">                t = (t%a)*<span class="number">100000</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> it = <span class="number">0</span>; it &lt; <span class="number">100</span>; it++) &#123;</div><div class="line">            <span class="comment">// netB = xi * B</span></div><div class="line">            tool.convolution(invB, nb, m, netB);</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> carry = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= PRECISION*<span class="number">2</span>; i++) &#123;</div><div class="line">            	bufB[i] = carry + (<span class="keyword">long</span> <span class="keyword">long</span>) (netB[i] + <span class="number">1.5e-1</span>);</div><div class="line">            	<span class="keyword">if</span> (bufB[i] &gt;= <span class="number">100000</span>)</div><div class="line">            		carry = bufB[i]/<span class="number">100000</span>, bufB[i] %= <span class="number">100000</span>;</div><div class="line">            	<span class="keyword">else</span></div><div class="line">            		carry = <span class="number">0</span>;</div><div class="line">                bufB[i] = -bufB[i];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// tmpB = 2 - xi * B</span></div><div class="line">            bufB[PRECISION] += <span class="number">2</span>;</div><div class="line">            <span class="built_in">memset</span>(tmpB, <span class="number">0</span>, <span class="keyword">sizeof</span>(tmpB[<span class="number">0</span>])*m);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= PRECISION*<span class="number">2</span>; i++) &#123;</div><div class="line">            	<span class="keyword">if</span> (bufB[i] &lt; <span class="number">0</span>)</div><div class="line">            		bufB[i] += <span class="number">100000</span>, bufB[i+<span class="number">1</span>]--;</div><div class="line">            	<span class="keyword">if</span> (i != <span class="number">0</span>)</div><div class="line">            		tmpB[m-i] = bufB[i];</div><div class="line">            	<span class="keyword">else</span></div><div class="line">            		tmpB[i] = bufB[i];</div><div class="line">            &#125;</div><div class="line">            <span class="comment">// netB = tmpB * invB</span></div><div class="line">            tool.convolution(invB, tmpB, m, netB);</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> carry = <span class="number">0</span>;</div><div class="line">                <span class="built_in">memset</span>(bufB, <span class="number">0</span>, <span class="keyword">sizeof</span>(bufB[<span class="number">0</span>])*m);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= PRECISION*<span class="number">2</span>; i++) &#123;</div><div class="line">                    bufB[i] = carry + (<span class="keyword">long</span> <span class="keyword">long</span>) (netB[i] + <span class="number">1.5e-1</span>);</div><div class="line">                    <span class="keyword">if</span> (bufB[i] &gt;= <span class="number">100000</span>)</div><div class="line">            			carry = bufB[i]/<span class="number">100000</span>, bufB[i] %= <span class="number">100000</span>;</div><div class="line">            		<span class="keyword">else</span></div><div class="line">            			carry = <span class="number">0</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            &#123;</div><div class="line">                <span class="keyword">int</span> same = <span class="number">1</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = PRECISION; same &amp;&amp; i &gt;= <span class="number">5</span>; i--)</div><div class="line">                    same &amp;= ((<span class="keyword">long</span> <span class="keyword">long</span>) (invB[i]) == bufB[i+PRECISION]);</div><div class="line">                <span class="keyword">if</span> (same)</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">memset</span>(invB, <span class="number">0</span>, <span class="keyword">sizeof</span>(invB[<span class="number">0</span>])*m);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i+PRECISION &lt;= PRECISION*<span class="number">2</span>; i++)</div><div class="line">            	invB[i] = bufB[i+PRECISION];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="built_in">memset</span>(na+<span class="number">1</span>, <span class="number">0</span>, <span class="keyword">sizeof</span>(v[<span class="number">0</span>])*(m-size));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = m<span class="number">-1</span>; i &lt; size; i++, j--)</div><div class="line">            na[j] = v[i];</div><div class="line">        na[<span class="number">0</span>] = v[<span class="number">0</span>];</div><div class="line">        tool.convolution(invB, na, m, netB);</div><div class="line">        </div><div class="line">        BigInt ret;</div><div class="line">        ret.size = m<span class="number">-1</span>;</div><div class="line">        ret.v = buf;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> carry = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">        	buf[i] = carry + (<span class="keyword">long</span> <span class="keyword">long</span>) (netB[i] + <span class="number">1.5e-1</span>);</div><div class="line">        	<span class="keyword">if</span> (buf[i] &gt;= <span class="number">100000</span>)</div><div class="line">        		carry = buf[i]/<span class="number">100000</span>, buf[i] %= <span class="number">100000</span>;</div><div class="line">        	<span class="keyword">else</span></div><div class="line">        		carry = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i+PRECISION &lt; m; i++)</div><div class="line">            buf[i] = buf[i+PRECISION];</div><div class="line">        <span class="built_in">memset</span>(buf+PRECISION, <span class="number">0</span>, <span class="keyword">sizeof</span>(buf[<span class="number">0</span>])*(m-PRECISION));</div><div class="line">        &#123;</div><div class="line">        	<span class="built_in">memset</span>(na, <span class="number">0</span>, <span class="keyword">sizeof</span>(na[<span class="number">0</span>])*m);</div><div class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>, j = m<span class="number">-1</span>; i &lt; m<span class="number">-1</span>; i++, j--)</div><div class="line">                na[j] = buf[i];</div><div class="line">            na[<span class="number">0</span>] = buf[<span class="number">0</span>];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</div><div class="line">            	nb[i] = other.v[i];</div><div class="line">    		tool.convolution(nb, na, m, netB);</div><div class="line">    		<span class="keyword">long</span> <span class="keyword">long</span> carry = <span class="number">0</span>;</div><div class="line">    		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">    			bufB[i] = (carry + (<span class="keyword">long</span> <span class="keyword">long</span>) (netB[i] + <span class="number">1e-1</span>));</div><div class="line">            	<span class="keyword">if</span> (bufB[i] &gt;= <span class="number">100000</span>)</div><div class="line">            		carry = bufB[i]/<span class="number">100000</span>, bufB[i] %= <span class="number">100000</span>;</div><div class="line">            	<span class="keyword">else</span></div><div class="line">            		carry = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            carry = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">                bufB[i] = v[i] - bufB[i] + carry;</div><div class="line">                <span class="keyword">if</span> (bufB[i] &lt; <span class="number">0</span>)</div><div class="line">            		bufB[i] += <span class="number">100000</span>, carry = <span class="number">-1</span>;</div><div class="line">            	<span class="keyword">else</span></div><div class="line">            		carry = <span class="number">0</span>;</div><div class="line">            &#125;</div><div class="line">            BigInt R;</div><div class="line">            R.size = m<span class="number">-1</span>, R.v = bufB;</div><div class="line">            <span class="keyword">if</span> (compare(other, R) &lt;= <span class="number">0</span>) &#123;</div><div class="line">                buf[<span class="number">0</span>]++;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; buf[i] &gt;= <span class="number">100000</span>; i++)</div><div class="line">                    buf[i+<span class="number">1</span>]++, buf[i] -= <span class="number">100000</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ret.reduce();</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">char</span> sa[<span class="number">1</span>&lt;&lt;<span class="number">20</span>], sb[<span class="number">1</span>&lt;&lt;<span class="number">20</span>];</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%s %s"</span>, sa, sb) == <span class="number">2</span>) &#123;</div><div class="line">        <span class="keyword">static</span> <span class="keyword">long</span> <span class="keyword">long</span> da[<span class="number">1</span>&lt;&lt;<span class="number">19</span>], db[<span class="number">1</span>&lt;&lt;<span class="number">19</span>], dc[<span class="number">1</span>&lt;&lt;<span class="number">19</span>];</div><div class="line">        </div><div class="line">        BigInt a, b, c;</div><div class="line">        a.str2int(sa, da);</div><div class="line">        b.str2int(sb, db);</div><div class="line">        c = a.divide(b, dc);</div><div class="line">        c.println();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2017-google-code-jam-qr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/04/09/2017-google-code-jam-qr/" class="article-date">
  <time datetime="2017-04-09T06:21:32.000Z" itemprop="datePublished">2017-04-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="http://i.imgur.com/KrHRAeT.jpg" rel="gallery_cktgvu5ko000rmwvnbbw5zf0p">
        <img src="http://i.imgur.com/KrHRAeT.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/04/09/2017-google-code-jam-qr/">2017 Google Code Jam Round QR</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2017/04/09/2017-google-code-jam-qr/" data-id="cktgvu5ko000rmwvnbbw5zf0p" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2017/04/09/2017-google-code-jam-qr/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/二分匹配/">二分匹配</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/貪心/">貪心</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>「在 24 小時內想不到解法，就註定這一生為處男」－《解題暴君》</p>
<blockquote>
<p>感謝小夥伴們、茵可、妮可的提醒和翻譯，提醒要比賽，結果題目意思猜了一個下午 …</p>
</blockquote>
<h2 id="A-Oversized-Pancake-Flipper"><a href="#A-Oversized-Pancake-Flipper" class="headerlink" title="A. Oversized Pancake Flipper"></a>A. Oversized Pancake Flipper</h2><p>有 <span>$N$</span><!-- Has MathJax --> 個煎餅排成一列，每個煎餅有正反兩面，分別以 <code>+</code> 和 <code>-</code> 表示，現在有一個超大的煎餅翻轉氣，一次可以翻轉恰好連續 <span>$K$</span><!-- Has MathJax --> 個煎餅的狀態，若一次不滿 <span>$K$</span><!-- Has MathJax --> 視為無效操作。給予起始盤面，請問至少要操作幾次才能使其全部都成為正面。</p>
<p>由邊界開始觀察，最左的正面一定不再被翻，如果翻了必然為多一次操作，不斷地推移下去，只有最左邊的反面要依序翻轉，貪心模擬即可。</p>
<h2 id="B-Tidy-Numbers"><a href="#B-Tidy-Numbers" class="headerlink" title="B. Tidy Numbers"></a>B. Tidy Numbers</h2><p>要找到一種特別的數字，這些數字滿足從高位到低位的每一位呈現非嚴格遞減，請問從數字 <span>$1$</span><!-- Has MathJax --> 判斷到 <span>$N$</span><!-- Has MathJax --> 最後一個滿足的數字為何。</p>
<p>最直觀的方案就 <span>$N$</span><!-- Has MathJax --> 開始倒退過去找第一個符合的解。為解決大測資，<span>$N$</span><!-- Has MathJax --> 大到不太可能窮舉，即便很容易出現 <code>???999999</code> 的解，我們可以用更簡單的貪心算法找到這個小於等於 <span>$N$</span><!-- Has MathJax --> 的解。</p>
<ul>
<li>例如輸入為 423</li>
<li>從最高位開始窮舉，第一位不能放 4，其原因在於貪心 444 已經大於 423，退而求其次 333 是可行的一組解</li>
<li>接著再考慮下一位時，我們不必要求小於等於 2，因為前一次窮舉保證小於 423，直接從 9 開始嘗試 399 是否符合解 … 類推。</li>
</ul>
<p>這樣的解法效能為 <span>$O(m^2)$</span><!-- Has MathJax -->，由於位數很小，就可以偷懶地去寫它。</p>
<h2 id="C-Bathroom-Stalls"><a href="#C-Bathroom-Stalls" class="headerlink" title="C. Bathroom Stalls"></a>C. Bathroom Stalls</h2><p>在公共澡堂中，有 <span>$N$</span><!-- Has MathJax --> 個位子排成一列，最左和最右有守衛。現在 <span>$M$</span><!-- Has MathJax --> 名使用者依照順序進入澡堂，每一個人會遠則離其他人盡可能遠的位置，意即往左和往右到第一個人的距離最小值最大化，往左距離為 <span>$L_s$</span><!-- Has MathJax --> 往右為 <span>$R_s$</span><!-- Has MathJax -->，這樣的位置也許會有好幾個，這時候優先選擇 <span>$\max(L_s, R_s)$</span><!-- Has MathJax --> 最大的那一個 (也就是盡可能靠左側)。請問最後一個人的 <span>$\max(L_s, R_s)$</span><!-- Has MathJax --> 和 <span>$\min(L_s, R_s)$</span><!-- Has MathJax --> 分別為多少？</p>
<p>若使用純模擬，時間複雜度可能高達 <span>$O(NM)$</span><!-- Has MathJax -->，大測資是無法在時間內通過的。仔細觀察到題目並未要求找到最後一個人的所在位置，在數學推敲上並不要求太高，那麼我們轉向繼續連續為空的區段分別有多少個。</p>
<ul>
<li>例如一開始長度為 <span>$N=10$</span><!-- Has MathJax --></li>
<li>有一段長度為 10，第一個人必然會將這一個分成兩段 4 和 5</li>
<li>下一個人則會把 5 再分成 2 和 2</li>
<li>下一個人則會把 4 再分成 1 和 2</li>
</ul>
<p>計算過程中，我們按照長度高到低依序挑出，便可以知道最終的結果。為了加速運算，需要紀錄某個長度有多少個，一次統計會使用相同挑選方案的人，來逼近最終的 <span>$M$</span><!-- Has MathJax --> 個人。時間複雜度 <span>$O(\log N)$</span><!-- Has MathJax -->？</p>
<h2 id="D-Fashion-Show"><a href="#D-Fashion-Show" class="headerlink" title="D. Fashion Show"></a>D. Fashion Show</h2><p>在一個方型時尚展場中，我們可以放置 3 種不同的服裝，分別為 <code>+</code>, <code>x</code>, <code>o</code> 三種，其中 <code>+</code>, <code>x</code> 可以為展場增添 1 分，<code>o</code> 可以增添 2 分，我們希望按照下述的規則使得展場總分最高：</p>
<ul>
<li>對於同行或者同列的放置服裝，任兩個之中，至少要有一個為 <code>+</code></li>
<li>對於斜對角 45 度的放置服裝，任兩個之中，至少要有一個為 <code>x</code></li>
</ul>
<p>現在給予一個空的展場和一些已經放置服裝的位置，你只能升級 <code>+</code>, <code>x</code> 服裝為 <code>o</code> 和增加新的服裝在空位置上，使得分數最高，輸出其中一組解即可。</p>
<p>如果只看行列，通常我們可以轉換成二分匹配，其中 <code>(行 i) -- (列 j)</code> 表明了一種放置方案，而中間的匹配邊成為最終的放置選擇。現在多了斜對角，匹配成為最難處理的部份，</p>
<p>題目的規則可以轉換成，行列最多放置一個非 <code>+</code>，同理對角最多放置一個非 <code>x</code>。按照原先的匹配思路，如果放置 <code>x</code>，則相當於匹配某行某列。同理，放置 <code>+</code>，則相當於匹配某斜和某反斜。這裡我們發現如果同時匹配，則視為 <code>o</code>，其匹配數恰好符合題目要求的得分。</p>
<p>對於已經擺設上去的點，預先將其匹配，並且那些行、列、斜線及反斜的代表點則不再與其他節點匹配，最後，我們構造節點個數為 <span>$6N$</span><!-- Has MathJax --> 的二分匹配圖，運行匈牙利或者是最大流算法都可解決。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="A"><a href="#A" class="headerlink" title="A"></a>A</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>, K;</div><div class="line">    <span class="keyword">char</span> s[<span class="number">1024</span>];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s %d"</span>, s, &amp;K);</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s);</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>, valid = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (s[i] == <span class="string">'+'</span>)</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">if</span> (i+K &lt;= n) &#123;</div><div class="line">                ret++;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">                    <span class="keyword">if</span> (s[i+j] == <span class="string">'-'</span>)</div><div class="line">                        s[i+j] = <span class="string">'+'</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        s[i+j] = <span class="string">'-'</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        valid = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            valid &amp;= s[i] == <span class="string">'+'</span>;</div><div class="line">        <span class="keyword">if</span> (valid)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case #%d: IMPOSSIBLE\n"</span>, ++cases);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">uint64_t</span> N;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">char</span> s[<span class="number">1024</span>];</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">        <span class="built_in">sscanf</span>(s, <span class="string">"%llu"</span>, &amp;N);</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s);</div><div class="line">        <span class="keyword">uint64_t</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> begin_small = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">int</span> prev = ret%<span class="number">10</span>;</div><div class="line">            <span class="keyword">int</span> st = begin_small ? <span class="number">9</span> : (s[i]-<span class="string">'0'</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = st; j &gt;= prev; j--) &#123;</div><div class="line">                <span class="keyword">uint64_t</span> test = ret;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = i; k &lt; n; k++)</div><div class="line">                    test = test*<span class="number">10</span> + j;</div><div class="line">                <span class="keyword">if</span> (test &lt;= N) &#123;</div><div class="line">                    <span class="keyword">if</span> (!begin_small &amp;&amp; j != s[i]-<span class="string">'0'</span>)</div><div class="line">                        begin_small = <span class="number">1</span>;</div><div class="line">                    ret = ret*<span class="number">10</span> + j;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %llu\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> n, m;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld %lld"</span>, &amp;n, &amp;m);</div><div class="line">        <span class="built_in">map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; S;</div><div class="line">        S[n] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret1 = <span class="number">-1</span>, ret2 = <span class="number">-1</span>;</div><div class="line">        <span class="keyword">while</span> (m) &#123;</div><div class="line">            pair&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; e = *S.rbegin();</div><div class="line">            S.erase(e.first);</div><div class="line">            <span class="keyword">if</span> (e.second &gt;= m) &#123;</div><div class="line">                ret1 = e.first/<span class="number">2</span>, ret2 = (e.first<span class="number">-1</span>)/<span class="number">2</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            m -= e.second;</div><div class="line">            <span class="keyword">if</span> (e.first%<span class="number">2</span>) &#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> t = e.first/<span class="number">2</span>;</div><div class="line">                S[t] += <span class="number">2L</span>L*e.second;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> t = e.first/<span class="number">2</span>;</div><div class="line">                S[t] += e.second;</div><div class="line">                S[t<span class="number">-1</span>] += e.second;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld %lld\n"</span>, ++cases, ret1, ret2);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="D"><a href="#D" class="headerlink" title="D"></a>D</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">40010</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXE = MAXV * <span class="number">200</span> * <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">1</span>&lt;&lt;<span class="number">29</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> v, cap, flow;</div><div class="line">    Edge *next, *re;</div><div class="line">&#125; Edge;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MaxFlow</span> &#123;</span></div><div class="line">    <span class="keyword">public</span>:</div><div class="line">    Edge edge[MAXE], *adj[MAXV], *pre[MAXV], *arc[MAXV];</div><div class="line">    <span class="keyword">int</span> e, n, level[MAXV], lvCnt[MAXV], Q[MAXV];</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">        n = x, e = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) adj[i] = <span class="literal">NULL</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> flow)</span></span>&#123;</div><div class="line">        edge[e].v = y, edge[e].cap = flow, edge[e].next = adj[x];</div><div class="line">        edge[e].re = &amp;edge[e+<span class="number">1</span>], adj[x] = &amp;edge[e++];</div><div class="line">        edge[e].v = x, edge[e].cap = <span class="number">0</span>, edge[e].next = adj[y];</div><div class="line">        edge[e].re = &amp;edge[e<span class="number">-1</span>], adj[y] = &amp;edge[e++];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Bfs</span><span class="params">(<span class="keyword">int</span> v)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> front = <span class="number">0</span>, rear = <span class="number">0</span>, r = <span class="number">0</span>, dis = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) level[i] = n, lvCnt[i] = <span class="number">0</span>;</div><div class="line">        level[v] = <span class="number">0</span>, ++lvCnt[<span class="number">0</span>];</div><div class="line">        Q[rear++] = v;</div><div class="line">        <span class="keyword">while</span> (front != rear)&#123;</div><div class="line">            <span class="keyword">if</span> (front == r) ++dis, r = rear;</div><div class="line">            v = Q[front++];</div><div class="line">            <span class="keyword">for</span> (Edge *i = adj[v]; i != <span class="literal">NULL</span>; i = i-&gt;next) &#123;</div><div class="line">                <span class="keyword">int</span> t = i-&gt;v;</div><div class="line">                <span class="keyword">if</span> (level[t] == n) level[t] = dis, Q[rear++] = t, ++lvCnt[dis];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Maxflow</span><span class="params">(<span class="keyword">int</span> s, <span class="keyword">int</span> t)</span></span>&#123;</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>, i, j;</div><div class="line">        Bfs(t);</div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; n; ++i) pre[i] = <span class="literal">NULL</span>, arc[i] = adj[i];</div><div class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; e; ++i) edge[i].flow = edge[i].cap;</div><div class="line">        i = s;</div><div class="line">        <span class="keyword">while</span> (level[s] &lt; n)&#123;</div><div class="line">            <span class="keyword">while</span> (arc[i] &amp;&amp; (level[i] != level[arc[i]-&gt;v]+<span class="number">1</span> || !arc[i]-&gt;flow)) </div><div class="line">                arc[i] = arc[i]-&gt;next;</div><div class="line">            <span class="keyword">if</span> (arc[i])&#123;</div><div class="line">                j = arc[i]-&gt;v;</div><div class="line">                pre[j] = arc[i];</div><div class="line">                i = j;</div><div class="line">                <span class="keyword">if</span> (i == t)&#123;</div><div class="line">                    <span class="keyword">int</span> update = INF;</div><div class="line">                    <span class="keyword">for</span> (Edge *p = pre[t]; p != <span class="literal">NULL</span>; p = pre[p-&gt;re-&gt;v])</div><div class="line">                        <span class="keyword">if</span> (update &gt; p-&gt;flow) update = p-&gt;flow;</div><div class="line">                    ret += update;</div><div class="line">                    <span class="keyword">for</span> (Edge *p = pre[t]; p != <span class="literal">NULL</span>; p = pre[p-&gt;re-&gt;v])</div><div class="line">                        p-&gt;flow -= update, p-&gt;re-&gt;flow += update;</div><div class="line">                    i = s;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span>&#123;</div><div class="line">                <span class="keyword">int</span> depth = n<span class="number">-1</span>;</div><div class="line">                <span class="keyword">for</span> (Edge *p = adj[i]; p != <span class="literal">NULL</span>; p = p-&gt;next)</div><div class="line">                    <span class="keyword">if</span> (p-&gt;flow &amp;&amp; depth &gt; level[p-&gt;v]) depth = level[p-&gt;v];</div><div class="line">                <span class="keyword">if</span> (--lvCnt[level[i]] == <span class="number">0</span>) <span class="keyword">return</span> ret;</div><div class="line">                level[i] = depth+<span class="number">1</span>;</div><div class="line">                ++lvCnt[level[i]];</div><div class="line">                arc[i] = adj[i];</div><div class="line">                <span class="keyword">if</span> (i != s) i = pre[i]-&gt;re-&gt;v;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125; g;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> n, m;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;n, &amp;m);</div><div class="line">        </div><div class="line">        g.Init(<span class="number">6</span>*n+<span class="number">5</span>);</div><div class="line">        <span class="keyword">static</span> <span class="keyword">int</span> mm[<span class="number">800</span>][<span class="number">800</span>];</div><div class="line">        <span class="keyword">static</span> <span class="keyword">int</span> mmPos[<span class="number">800</span>][<span class="number">800</span>][<span class="number">2</span>];</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="built_in">memset</span>(mm, <span class="number">0</span>, <span class="keyword">sizeof</span>(mm));</div><div class="line">        <span class="keyword">int</span> source = <span class="number">6</span>*n+<span class="number">1</span>, sink = <span class="number">6</span>*n+<span class="number">2</span>;</div><div class="line">        <span class="keyword">int</span> board[<span class="number">128</span>][<span class="number">128</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">int</span> <span class="keyword">board_t</span>[<span class="number">128</span>][<span class="number">128</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">char</span> board_s[<span class="number">128</span>][<span class="number">128</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">int</span> ban[<span class="number">800</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</div><div class="line">                mm[i][j+n] = <span class="number">1</span>;</div><div class="line">                mm[(i+j)+<span class="number">2</span>*n][(i-j+n<span class="number">-1</span>)+<span class="number">4</span>*n] = <span class="number">1</span>;</div><div class="line">                mmPos[i][j+n][<span class="number">0</span>] = i;</div><div class="line">                mmPos[i][j+n][<span class="number">1</span>] = j;</div><div class="line">                mmPos[(i+j)+<span class="number">2</span>*n][(i-j+n<span class="number">-1</span>)+<span class="number">4</span>*n][<span class="number">0</span>] = i;</div><div class="line">                mmPos[(i+j)+<span class="number">2</span>*n][(i-j+n<span class="number">-1</span>)+<span class="number">4</span>*n][<span class="number">1</span>] = j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">char</span> s[<span class="number">16</span>];</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s %d %d"</span>, s, &amp;x, &amp;y);</div><div class="line">            x--, y--;</div><div class="line">            board_s[x][y] = s[<span class="number">0</span>];</div><div class="line">            <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'o'</span>) &#123;</div><div class="line">                ret += <span class="number">2</span>, board[x][y] = <span class="number">2</span>;</div><div class="line">                ban[x] = <span class="number">1</span>, ban[y+n] = <span class="number">1</span>;</div><div class="line">                ban[(x+y)+(<span class="number">2</span>*n)] = <span class="number">1</span>;</div><div class="line">                ban[(x-y+n<span class="number">-1</span>)+<span class="number">4</span>*n] = <span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'+'</span>) &#123;</div><div class="line">                ret += <span class="number">1</span>, board[x][y] = <span class="number">1</span>;</div><div class="line">                ban[(x+y)+(<span class="number">2</span>*n)] = <span class="number">1</span>;</div><div class="line">                ban[(x-y+n<span class="number">-1</span>)+<span class="number">4</span>*n] = <span class="number">1</span>;</div><div class="line"><span class="comment">//				printf("%d %d\n", x+y+2*n, x-y+n-1+4*n);</span></div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (s[<span class="number">0</span>] == <span class="string">'x'</span>) &#123;</div><div class="line">                ret += <span class="number">1</span>, board[x][y] = <span class="number">1</span>;</div><div class="line">                ban[x] = <span class="number">1</span>, ban[y+n] = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">memcpy</span>(<span class="keyword">board_t</span>, board, <span class="keyword">sizeof</span>(board));</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            g.Addedge(source, i, <span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>*n; i &lt; <span class="number">4</span>*n; i++)</div><div class="line">            g.Addedge(source, i, <span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &lt; <span class="number">2</span>*n; i++)</div><div class="line">            g.Addedge(i, sink, <span class="number">1</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">4</span>*n; i &lt; <span class="number">6</span>*n; i++)</div><div class="line">            g.Addedge(i, sink, <span class="number">1</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = n; j &lt; <span class="number">2</span>*n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (ban[i] || ban[j] || !mm[i][j])</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                g.Addedge(i, j, <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>*n; i &lt; <span class="number">4</span>*n<span class="number">-1</span>; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">4</span>*n; j &lt; <span class="number">6</span>*n<span class="number">-1</span>; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (ban[i] || ban[j] || !mm[i][j])</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                g.Addedge(i, j, <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> flow = g.Maxflow(source, sink);</div><div class="line">        </div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (Edge *p = g.adj[i]; p != <span class="literal">NULL</span>; p = p-&gt;next) &#123;</div><div class="line">                <span class="keyword">if</span> (p-&gt;v &gt;= n &amp;&amp; p-&gt;v &lt; <span class="number">2</span>*n &amp;&amp; p-&gt;flow == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">board_t</span>[mmPos[i][p-&gt;v][<span class="number">0</span>]][mmPos[i][p-&gt;v][<span class="number">1</span>]]++;</div><div class="line"><span class="comment">//					printf("---- %d %d\n", mmPos[i][p-&gt;v][0], mmPos[i][p-&gt;v][1]);</span></div><div class="line">                    board_s[mmPos[i][p-&gt;v][<span class="number">0</span>]][mmPos[i][p-&gt;v][<span class="number">1</span>]] = <span class="string">'x'</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>*n; i &lt; <span class="number">4</span>*n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (Edge *p = g.adj[i]; p != <span class="literal">NULL</span>; p = p-&gt;next) &#123;</div><div class="line">                <span class="keyword">if</span> (p-&gt;v &gt;= <span class="number">4</span>*n &amp;&amp; p-&gt;v &lt; <span class="number">6</span>*n &amp;&amp; p-&gt;flow == <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">board_t</span>[mmPos[i][p-&gt;v][<span class="number">0</span>]][mmPos[i][p-&gt;v][<span class="number">1</span>]]++;</div><div class="line"><span class="comment">//					printf("---- %d %d\n", mmPos[i][p-&gt;v][0], mmPos[i][p-&gt;v][1]);</span></div><div class="line">                    board_s[mmPos[i][p-&gt;v][<span class="number">0</span>]][mmPos[i][p-&gt;v][<span class="number">1</span>]] = <span class="string">'+'</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">DD</span> &#123;</span></div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            <span class="keyword">char</span> val;</div><div class="line">            DD(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">char</span> val): x(x), y(y), val(val) &#123;&#125;</div><div class="line">        &#125;;</div><div class="line">        <span class="built_in">vector</span>&lt;DD&gt; V;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (<span class="keyword">board_t</span>[i][j] != board[i][j]) &#123;</div><div class="line">                    <span class="keyword">if</span> (<span class="keyword">board_t</span>[i][j] == <span class="number">2</span>)</div><div class="line">                        V.push_back(DD(i+<span class="number">1</span>, j+<span class="number">1</span>, <span class="string">'o'</span>));</div><div class="line"><span class="comment">//						printf("o %d %d\n", i+1, j+1);</span></div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">board_t</span>[i][j] == <span class="number">1</span>)</div><div class="line">                        V.push_back(DD(i+<span class="number">1</span>, j+<span class="number">1</span>, board_s[i][j]));</div><div class="line"><span class="comment">//						printf("%c %d %d\n", board_s[i][j], i+1, j+1);</span></div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d %d\n"</span>, ++cases, ret+flow, V.size());</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.size(); i++)</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%c %d %d\n"</span>, V[i].val, V[i].x, V[i].y);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2017-facebook-hacker-cup-round-1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/16/2017-facebook-hacker-cup-round-1/" class="article-date">
  <time datetime="2017-01-16T03:30:15.000Z" itemprop="datePublished">2017-01-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/2017-facebook-hacker-cup-round-1/">2017 Facebook Hacker Cup Round 1</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2017/01/16/2017-facebook-hacker-cup-round-1/" data-id="cktgvu5kn000omwvnwlaic6qg" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2017/01/16/2017-facebook-hacker-cup-round-1/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>感謝小夥伴妮可、茵可熱情支援</p>
</blockquote>
<h2 id="Facebook-2017-Hacker-Cup-Round-1"><a href="#Facebook-2017-Hacker-Cup-Round-1" class="headerlink" title="Facebook 2017 Hacker Cup Round 1"></a>Facebook 2017 Hacker Cup Round 1</h2><h3 id="A-Pie-Progress"><a href="#A-Pie-Progress" class="headerlink" title="A. Pie Progress"></a>A. Pie Progress</h3><p>單身狗的 <span>$N$</span><!-- Has MathJax --> 天日子中 (娛樂性質翻譯)，每天晚餐想要一道點心派搭配。每天早晨決定到當地的餅舖採購，每天一定會生產 <span>$M$</span><!-- Has MathJax --> 派，每一種派的價格也有所不同，不用考慮派會壞掉的情況，預先庫存保留著吃。為防止不當商人購買數量過多，當天若購買 <span>$K$</span><!-- Has MathJax --> 個派，需要額外支付 <span>$K^2$</span><!-- Has MathJax --> 的交易手續費，請問採購花費最少為何。</p>
<p>明顯地，每一天的狀態就是採購了多少個派，得到狀態 <span>$\text{dp}[i][j]$</span><!-- Has MathJax --> 表示前 <span>$i$</span><!-- Has MathJax --> 天總共採購 <span>$j$</span><!-- Has MathJax --> 個餅，轉移過程中要保證數量足夠支付每一天，意即只對 <span>$i \le j$</span><!-- Has MathJax --> 進行轉移。每一天窮舉購買的數量，窮舉採購的花費時，勢必要先排序每塊派的價格，每次只挑選前幾個小的，時間複雜度 <span>$O(N^2 M)$</span><!-- Has MathJax --> 。</p>
<span>$$\begin{align*}
dp[i][j] = \left\{\begin{matrix}
0 &amp;&amp; i = 0\;, j = 0\\
\min(dp[i-1][j-k-1] + \text{SumC}[k] + (k+1)^2) &amp;&amp; i \le j \\
\infty &amp;&amp; \text{otherwise}
\end{matrix}\right.
\end{align*}$$</span><!-- Has MathJax -->
<h3 id="B-Fighting-the-Zombies"><a href="#B-Fighting-the-Zombies" class="headerlink" title="B. Fighting the Zombies"></a>B. Fighting the Zombies</h3><p>在 D&amp;D 遊戲，身為一個魔法師要消滅地圖上的殭屍們。一次操作有兩個步驟，第一步驟圈選任意半徑內的所有殭屍，不改變其相對位置將他們進行轉移，第二步驟選擇長寬為 <span>$R$</span><!-- Has MathJax --> 的方形內的所有殭屍，請問一次操作最多可以消滅多少殭屍。</p>
<p>從第二步驟中觀察到消滅的大小是固定的，因此圈選半徑會被約束在 <span>$R$</span><!-- Has MathJax --> 內，實際上也不用考慮圓，因為方形被包含在圓裏。最後，我們直接求第一步驟的所有方形情況，將內部的殭屍全部移除後，再窮舉一次方形範圍內部的其他殭屍，所有可能取最大值即可。時間複雜度 <span>$O(N^6)$</span><!-- Has MathJax --> 。由於 <span>$N \le 50$</span><!-- Has MathJax --> ，六分鐘內是可以容忍的。</p>
<h3 id="C-Manic-Moving"><a href="#C-Manic-Moving" class="headerlink" title="C. Manic Moving"></a>C. Manic Moving</h3><p>搬家公司在 <span>$N$</span><!-- Has MathJax --> 個城鎮之間服務，貨車司機打算用最小的油量花費依序完成公司給定 <span>$K$</span><!-- Has MathJax --> 個訂單。第 <span>$i$</span><!-- Has MathJax --> 名客戶要求從 <span>$S_i$</span><!-- Has MathJax --> 地搬到 <span>$D_i$</span><!-- Has MathJax --> ，貨車一次可以載運兩名客戶的量。根據訂單順序，先來的就要載貨，同理也要先卸貨。</p>
<p>從題目中發現對於順序要求非常嚴苛，定出每一階段的狀態 <span>$dp[i][j][2]$</span><!-- Has MathJax --> 表示完成前 <span>$i$</span><!-- Has MathJax --> 個訂單、最後停留位置在 <span>$j$</span><!-- Has MathJax --> 地，最後的 <code>[2]</code> 表示前一個階段是否已經卸貨。分成兩種方式討論，時間複雜度 <span>$O(KN)$</span><!-- Has MathJax --> 。</p>
<h3 id="D-Beach-Umbrellas"><a href="#D-Beach-Umbrellas" class="headerlink" title="D. Beach Umbrellas"></a>D. Beach Umbrellas</h3><p>有 <span>$N$</span><!-- Has MathJax --> 個人各自帶著半徑 <span>$R_i$</span><!-- Has MathJax --> 的降落傘，在海岸進行降落，岸上有 <span>$M$</span><!-- Has MathJax --> 個降落點，每個降落點間隔一公尺，請問有多少種降落方式使得他們不會碰撞。</p>
<p>從題目給的說明中，我們發現到左右兩側的降落點比較特別，因為他們的傘的一部份可能會落在 <span>$M$</span><!-- Has MathJax --> 點之外，因此考慮窮舉降落在左右側的所有方法數 <span>$N^2$</span><!-- Has MathJax --> ，若要計算固定左右兩側的方法數，可以使用重複組合 H 得到 (滿足 <span>$x_1 + x_2 + \cdots + x_n = Y$</span><!-- Has MathJax --> 且每個數皆為非負整數的方法數)。然而，這樣計算方法缺少順序，最後補上排列計數 <span>$(N-2)!$</span><!-- Has MathJax --> 。</p>
<p>來講講窮舉左右兩側之後怎麼算出方法數</p>
<ul>
<li>左右兩側分別為 <span>$R_i$</span><!-- Has MathJax --> 和 <span>$R_j$</span><!-- Has MathJax --> 的情況</li>
<li>海岸左寬度增加 <span>$R_i$</span><!-- Has MathJax -->，同理右寬度增加 <span>$R_j$</span><!-- Has MathJax --> </li>
<li>如此一來，左右變數的情況就能套用重複組合分配 <span>$N$</span><!-- Has MathJax --> 個變數，總和為 <span>$M + R_i + R_j$</span><!-- Has MathJax --> ，每個變數至少大於等於 <span>$R_i$</span><!-- Has MathJax --></li>
</ul>
<p>特別地，變數 <span>$M$</span><!-- Has MathJax --> 過大。在窮舉所有情況中，組合類型最多 <span>$2R$</span><!-- Has MathJax --> 種，而非 <span>$N^2$</span><!-- Has MathJax --> 種。計算量多到必須預先建表，每一個組合數 <span>$C^{M+?}_{N}$</span><!-- Has MathJax --> ，由於底數是固定的，利用區間滑動在 <span>$O(1)$</span><!-- Has MathJax --> 轉換 (需要乘法反元素支援)。預先建表的時間 <span>$O(R)$</span><!-- Has MathJax -->，窮舉部分 <span>$O(N^2 \log R)$</span><!-- Has MathJax --> 。</p>
<h3 id="Solution-A"><a href="#Solution-A" class="headerlink" title="Solution A"></a>Solution A</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, M;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;M);</div><div class="line">        <span class="keyword">int</span> dp[<span class="number">305</span>][<span class="number">305</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= N; j++)</div><div class="line">                dp[i][j] = INF;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">int</span> A[<span class="number">305</span>];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; M; j++)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[j]);</div><div class="line">            sort(A, A+M);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, sum = <span class="number">0</span>; j &lt; M; j++) &#123;</div><div class="line">                sum += A[j];</div><div class="line">                A[j] = sum;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; N; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (dp[i][j] == INF)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; M &amp;&amp; k+j &lt;= N; k++) &#123;</div><div class="line">                    dp[i+<span class="number">1</span>][j+k+<span class="number">1</span>] = min(dp[i+<span class="number">1</span>][j+k+<span class="number">1</span>], dp[i][j] + A[k] + (k+<span class="number">1</span>)*(k+<span class="number">1</span>));</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt;= N; j++)</div><div class="line">                dp[i+<span class="number">1</span>][j] = min(dp[i+<span class="number">1</span>][j], dp[i][j]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, dp[N][N]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Solution-B"><a href="#Solution-B" class="headerlink" title="Solution B"></a>Solution B</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, R;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;R);</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; A;</div><div class="line">        <span class="built_in">set</span>&lt;<span class="keyword">int</span>&gt; SX, SY;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            A.push_back(make_pair(x, y));</div><div class="line">            SX.insert(x), SY.insert(y);</div><div class="line">        &#125;</div><div class="line">        sort(A.begin(), A.end());</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> LX : SX) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> LY : SY) &#123;</div><div class="line">                <span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">                <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; used(N, <span class="number">0</span>);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">                    <span class="keyword">if</span> (A[i].first &gt;= LX &amp;&amp; A[i].first &lt;= LX+R</div><div class="line">                        &amp;&amp; A[i].second &gt;= LY &amp;&amp; A[i].second &lt;= LY+R)</div><div class="line">                    cnt++, used[i] = <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> TX : SX) &#123;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">auto</span> TY: SY) &#123;</div><div class="line">                        <span class="keyword">int</span> dd = <span class="number">0</span>;</div><div class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">                            <span class="keyword">if</span> (used[i])</div><div class="line">                                <span class="keyword">continue</span>;</div><div class="line">                            <span class="keyword">if</span> (A[i].first &gt;= TX &amp;&amp; A[i].first &lt;= TX+R</div><div class="line">                                &amp;&amp; A[i].second &gt;= TY &amp;&amp; A[i].second &lt;= TY+R)</div><div class="line">                                dd++;</div><div class="line">                        &#125;</div><div class="line">                        ret = max(ret, dd+cnt);</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Solution-C"><a href="#Solution-C" class="headerlink" title="Solution C"></a>Solution C</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, M, K;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;M, &amp;K);</div><div class="line">        </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> g[<span class="number">105</span>][<span class="number">105</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> INF = <span class="number">1L</span>L&lt;&lt;<span class="number">60</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++)</div><div class="line">                g[i][j] = INF;</div><div class="line">            g[i][i] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; i++) &#123;</div><div class="line">            <span class="keyword">int</span> A, B;</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> G;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d %lld"</span>, &amp;A, &amp;B, &amp;G);</div><div class="line">            g[A][B] = min(g[A][B], G);</div><div class="line">            g[B][A] = min(g[B][A], G);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= N; k++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++)</div><div class="line">                    g[i][j] = min(g[i][j], g[i][k]+g[k][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line"><span class="comment">//		for (int i = 1; i &lt;= N; i++) &#123;</span></div><div class="line"><span class="comment">//			for (int j = 1; j &lt;= N; j++)</span></div><div class="line"><span class="comment">//				printf("%lld ", g[i][j]);</span></div><div class="line"><span class="comment">//			puts("");</span></div><div class="line"><span class="comment">//		&#125;</span></div><div class="line">        </div><div class="line">        <span class="keyword">int</span> S[<span class="number">5005</span>], D[<span class="number">5005</span>];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;S[i], &amp;D[i]);</div><div class="line">        <span class="keyword">static</span> <span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">5005</span>][<span class="number">105</span>][<span class="number">2</span>] = &#123;&#125;;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= K; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= N; j++)</div><div class="line">                dp[i][j][<span class="number">0</span>] = INF, dp[i][j][<span class="number">1</span>] = INF;;</div><div class="line">        &#125;</div><div class="line">        dp[<span class="number">0</span>][<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;</div><div class="line">            <span class="keyword">int</span> s1 = S[i], d1 = D[i];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= N; j++) &#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> cc;</div><div class="line">                cc = g[j][s1]+g[s1][d1];</div><div class="line">                dp[i+<span class="number">1</span>][d1][<span class="number">0</span>] = min(dp[i+<span class="number">1</span>][d1][<span class="number">0</span>], dp[i][j][<span class="number">0</span>] + cc);</div><div class="line">                cc = g[j][s1];</div><div class="line">                dp[i+<span class="number">1</span>][s1][<span class="number">1</span>] = min(dp[i+<span class="number">1</span>][s1][<span class="number">1</span>], dp[i][j][<span class="number">0</span>] + cc);</div><div class="line">                </div><div class="line">                <span class="keyword">if</span> (dp[i][j][<span class="number">1</span>] != INF &amp;&amp; i &gt; <span class="number">0</span>) &#123;</div><div class="line">                    <span class="keyword">int</span> sP = S[i<span class="number">-1</span>], dP = D[i<span class="number">-1</span>];</div><div class="line">                    cc = g[j][s1]+g[s1][dP];</div><div class="line">                    dp[i+<span class="number">1</span>][dP][<span class="number">1</span>] = min(dp[i+<span class="number">1</span>][dP][<span class="number">1</span>], dp[i][j][<span class="number">1</span>] + cc);</div><div class="line">                    cc = g[j][s1]+g[s1][dP]+g[dP][d1];</div><div class="line">                    dp[i+<span class="number">1</span>][d1][<span class="number">0</span>] = min(dp[i+<span class="number">1</span>][d1][<span class="number">0</span>], dp[i][j][<span class="number">1</span>] + cc);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            </div><div class="line"><span class="comment">//			for (int j = 1; j &lt;= N; j++)</span></div><div class="line"><span class="comment">//				printf("%lld ", dp[i+1][j][0]);</span></div><div class="line"><span class="comment">//			puts("");</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">-1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (dp[K][i][<span class="number">0</span>] != INF)</div><div class="line">                ret = max(ret, dp[K][i][<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Solution-D"><a href="#Solution-D" class="headerlink" title="Solution D"></a>Solution D</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1000000007L</span>L;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y, <span class="keyword">long</span> <span class="keyword">long</span> &amp;g, </span></span></div><div class="line"><span class="function"><span class="params">	<span class="keyword">long</span> <span class="keyword">long</span> &amp;a, <span class="keyword">long</span> <span class="keyword">long</span> &amp;b)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (y == <span class="number">0</span>)</div><div class="line">        g = x, a = <span class="number">1</span>, b = <span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span></div><div class="line">        exgcd(y, x%y, g, b, a), b -= (x/y) * a;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">inverse</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> p)</span> </span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> g, b, r;</div><div class="line">    exgcd(x, p, g, r, b);</div><div class="line">    <span class="keyword">if</span> (g &lt; <span class="number">0</span>)	r = -r;</div><div class="line">    <span class="keyword">return</span> (r%p + p)%p;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, M, R[<span class="number">2048</span>], S = <span class="number">0</span>, mxR = <span class="number">0</span>;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;M);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;R[i]), S += R[i], mxR = max(mxR, R[i]);</div><div class="line">        <span class="keyword">if</span> (N == <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, M);</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"%d %d %d\n"</span>, N, S, M);</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> invNplus = <span class="number">1</span>;</div><div class="line">        <span class="built_in">map</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>, <span class="keyword">long</span> <span class="keyword">long</span>&gt; C;</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">long</span> <span class="keyword">long</span> f = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</div><div class="line">                f = (f * i)%MOD;</div><div class="line">            invNplus = inverse(f, MOD);</div><div class="line">            </div><div class="line">            <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">1</span>;</div><div class="line">            f = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = M - <span class="number">2</span>*S; i &lt;= M - <span class="number">2</span>*S + <span class="number">2</span>*mxR; i++) &#123;</div><div class="line">                <span class="keyword">int</span> tM = i+N<span class="number">-1</span>;</div><div class="line">                <span class="keyword">if</span> (tM &lt; N)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">int</span> L = tM-N+<span class="number">1</span>, R = tM;</div><div class="line">                <span class="keyword">if</span> (r &lt; L)</div><div class="line">                    l = r = f = L;</div><div class="line">                <span class="keyword">while</span> (l &lt; L)</div><div class="line">                    f = (f*inverse(l, MOD))%MOD, l++;</div><div class="line">                <span class="keyword">while</span> (r &lt; R)</div><div class="line">                    r++, f = (f * r)%MOD;</div><div class="line">                C[tM] = (f * invNplus)%MOD;</div><div class="line"><span class="comment">//				printf("C(%lld %d) = %lld, %lld\n", tM, N, C[tM], f);</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (i == j)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">int</span> tM = M + R[i] + R[j] - <span class="number">2</span>*S;</div><div class="line">                <span class="keyword">if</span> (tM+N<span class="number">-1</span> &lt; N)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line"><span class="comment">//				printf("add C(%d %d)\n", tM+N-1, N);</span></div><div class="line">                ret += C[tM+N<span class="number">-1</span>];</div><div class="line">                ret %= MOD;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> f = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N<span class="number">-2</span>; i++)</div><div class="line">            f = (f * i)%MOD;</div><div class="line">        ret = ret * f;</div><div class="line">        ret %= MOD;</div><div class="line">        assert(ret &gt;= <span class="number">0</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2017-facebook-hacker-cup-qualification" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/16/2017-facebook-hacker-cup-qualification/" class="article-date">
  <time datetime="2017-01-16T02:23:56.000Z" itemprop="datePublished">2017-01-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/2017-facebook-hacker-cup-qualification/">2017 Facebook Hacker Cup 資格賽</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2017/01/16/2017-facebook-hacker-cup-qualification/" data-id="cktgvu5km000mmwvnaqhq68ey" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2017/01/16/2017-facebook-hacker-cup-qualification/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>原本只是想推碩一學弟去寫，學弟邀著邀著，我這個老骨頭只好跟著寫</p>
</blockquote>
<h2 id="Facebook-Hacker-Cup-2017-Qualification-Round"><a href="#Facebook-Hacker-Cup-2017-Qualification-Round" class="headerlink" title="Facebook Hacker Cup 2017 Qualification Round"></a>Facebook Hacker Cup 2017 Qualification Round</h2><h3 id="A-Progress-Pie"><a href="#A-Progress-Pie" class="headerlink" title="A. Progress Pie"></a>A. Progress Pie</h3><p>給一個落在 <span>$(0, 0)\; , (100, 100)$</span><!-- Has MathJax --> 矩形內部的圓餅圖，並且從垂直十二點方向開始，順時針繞一圈 <span>$P \%$</span><!-- Has MathJax --> ，又額外給一座標，請問該點是黑色還是白色，並且保證任何一組詢問點，鄰近 <span>$10^{-6}$</span><!-- Has MathJax --> 都屬於相同顏色。</p>
<p>從最後一個條件來看，我們處理邊界條件的誤差是可以容忍的。由於輸入都是整數，完全在整數上操作的部分尚未想到，但我們可以透過內積外積得到詢問點是順時針轉了 <span>$R, \; 0 \le R &lt; 2 \pi$</span><!-- Has MathJax --> ，只需要判斷 <span>$R$</span><!-- Has MathJax --> 是否小於等於 <span>$P$</span><!-- Has MathJax --> 即可。</p>
<p>十二點鐘的方向向量為 <span>$\vec{v} = (0, 50)$</span><!-- Has MathJax --> ，詢問點與圓心的向量為 <span>$\vec{u} = (X-50, Y-50)$</span><!-- Has MathJax --> ，計算這兩個向量的夾角 <span>$\theta = \cos^{-1}(\frac{u \cdot v}{|u| |v|})$</span><!-- Has MathJax --> ，這樣算出來的角度只會落在 <span>$[0, \pi)$</span><!-- Has MathJax --> ，接著透過外積決定順時針還是逆時針，補回來即可。</p>
<h3 id="B-Lazy-Loading"><a href="#B-Lazy-Loading" class="headerlink" title="B. Lazy Loading"></a>B. Lazy Loading</h3><p>搬家公司的工人要搬運 <span>$N$</span><!-- Has MathJax --> 個重量不同的傢俱，主管要求每次搬運至少 50 磅，工人為了偷懶，每次只搬運一部份的傢俱，然而主管不會準確計算工人搬運的總重，只會問一次搬運的最大重量和個數，工人想藉由分配方法來增加工作天數，請問要怎麼符合需求達到最多搬運天數。</p>
<p>可想而知，我們只需要貪心計算即可，每次挑選最重的那一個，接著搭配當前最輕的來湊數，一超過 50 磅就當作一天的搬運方案，直到沒有物品。一開始排序好 <span>$O(N \log N)$</span><!-- Has MathJax --> ，接著只需要掃描一次 <span>$O(N)$</span><!-- Has MathJax --> 即可完成。</p>
<h3 id="C-Fighting-the-Zombie"><a href="#C-Fighting-the-Zombie" class="headerlink" title="C. Fighting the Zombie"></a>C. Fighting the Zombie</h3><p>在 D&amp;D 遊戲中，我們需要施放技能攻擊血量為 <span>$H$</span><!-- Has MathJax --> 的殭屍，施放採用擲骰子的方式，骰一個 <span>$Y$</span><!-- Has MathJax --> 面骰 <span>$X$</span><!-- Has MathJax --> 次得到的點數總和加上固定值 <span>$Z$</span><!-- Has MathJax --> ，請問一擊必殺的機率最高為何，由於盤面上有許多骰子可以挑選，請輸出機率最高的那個骰子的機率為何。</p>
<p>首先，我們必須先瞭解最基礎的六面骰，投擲 <span>$X$</span><!-- Has MathJax --> 總和的方法數怎麼計算，定義 <span>$\text{dp}[i][j]$</span><!-- Has MathJax --> 表示投擲 <span>$i$</span><!-- Has MathJax --> 次，點數總和為 <span>$j$</span><!-- Has MathJax --> 的方法數。我們得到</p>
<span>$$\begin{align*}
dp[i][j] = \left\{\begin{matrix}
1 &amp;&amp; i = 0\;, j = 0\\
dp[i-1][j-1] + dp[i-1][j-2] + \cdots + dp[i-1][j-6] &amp;&amp; i \le j \\
0 &amp;&amp; \text{otherwise}
\end{matrix}\right.
\end{align*}$$</span><!-- Has MathJax -->
<p>上述的遞迴考慮 <span>$i-1$</span><!-- Has MathJax --> 個骰子的總和方法數，再決定第 <span>$i$</span><!-- Has MathJax --> 個骰子擲出哪一種點數。然而，這種方法不適用此題計算機率，很容易發生 overflow，方法數的總和為 <span>$Y^X$</span><!-- Has MathJax --> ，所以一開始我們就採用機率的方式統計。</p>
<span>$$\begin{align*}
dp[i][j] = \left\{\begin{matrix}
1 &amp;&amp; i = 0\;, j = 0\\
(dp[i-1][j-1] + dp[i-1][j-2] + \cdots + dp[i-1][j-6])/6 &amp;&amp; i \le j \\
0 &amp;&amp; \text{otherwise}
\end{matrix}\right.
\end{align*}$$</span><!-- Has MathJax -->
<p>這樣的 DP 計算消耗時間 <span>$O(X^2 Y^2)$</span><!-- Has MathJax --> ，加上滑動窗口統計總和則可以落在 <span>$O(X^2 Y)$</span><!-- Has MathJax --> 。</p>
<blockquote>
<p>比賽當下寫的，思路不是很清楚，變數命名和邏輯判斷會有點醜，沒有好好整理。</p>
</blockquote>
<h3 id="Solution-A"><a href="#Solution-A" class="headerlink" title="Solution A"></a>Solution A</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> P, X, Y;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;P, &amp;X, &amp;Y);</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (X == <span class="number">50</span> &amp;&amp; Y == <span class="number">50</span>) &#123;</div><div class="line">            ret = <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hypot(X<span class="number">-50</span>, Y<span class="number">-50</span>) &gt; <span class="number">50</span>) &#123;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (P == <span class="number">100</span>) &#123;</div><div class="line">            ret = <span class="number">1</span>;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (P == <span class="number">0</span>) &#123;</div><div class="line">            </div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">int</span> vx = X<span class="number">-50</span>, vy = Y<span class="number">-50</span>;</div><div class="line">            <span class="keyword">int</span> tx = <span class="number">0</span>, ty = <span class="number">50</span>;</div><div class="line">            <span class="keyword">double</span> theta = <span class="built_in">acos</span>((vx*tx+vy*ty)/hypot(vx, vy)/hypot(tx, ty));</div><div class="line">            <span class="keyword">if</span> (tx*vy - ty*vx &gt; <span class="number">0</span>)</div><div class="line">                theta = <span class="number">2</span>*pi-theta;</div><div class="line">            <span class="keyword">double</span> t = (<span class="keyword">double</span>) P/<span class="number">100.0</span>*<span class="number">2</span>*pi;</div><div class="line">            <span class="keyword">if</span> (theta &lt;= t)</div><div class="line">                ret = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %s\n"</span>, ++cases, ret ? <span class="string">"black"</span> : <span class="string">"white"</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Solution-B"><a href="#Solution-B" class="headerlink" title="Solution B"></a>Solution B</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> n;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; A;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">int</span> x;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">            A.push_back(x);</div><div class="line">        &#125;</div><div class="line">        sort(A.begin(), A.end());</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> r = n<span class="number">-1</span>, l = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (r &gt;= l) &#123;</div><div class="line">            <span class="keyword">int</span> need = ((<span class="number">50</span> + A[r]<span class="number">-1</span>) / A[r]);</div><div class="line">            <span class="keyword">if</span> (l + need<span class="number">-1</span> &gt; r)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            l += need<span class="number">-1</span>, r--;</div><div class="line">            ret++;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Solution-C"><a href="#Solution-C" class="headerlink" title="Solution C"></a>Solution C</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> H, S;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;H, &amp;S);</div><div class="line">        <span class="built_in">vector</span>&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; A;</div><div class="line">        <span class="keyword">double</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; S; i++) &#123;</div><div class="line">            <span class="keyword">char</span> s[<span class="number">128</span>];</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">            <span class="keyword">int</span> X = <span class="number">0</span>, Y = <span class="number">0</span>, Z = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>, x = <span class="number">0</span>, sign = <span class="number">1</span>, idx = <span class="number">0</span>; s[j]; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (<span class="built_in">isdigit</span>(s[j]))</div><div class="line">                    x = x * <span class="number">10</span> + s[j] - <span class="string">'0'</span>;</div><div class="line">                <span class="keyword">if</span> (s[j+<span class="number">1</span>] == <span class="string">'\0'</span> || !<span class="built_in">isdigit</span>(s[j])) &#123;</div><div class="line">                    x = x * sign;</div><div class="line">                    <span class="keyword">if</span> (idx == <span class="number">0</span>)</div><div class="line">                        X = x;</div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (idx == <span class="number">1</span>)</div><div class="line">                        Y = x;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        Z = x;</div><div class="line">                    <span class="keyword">if</span> (s[j] == <span class="string">'-'</span>)</div><div class="line">                        sign = <span class="number">-1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        sign = <span class="number">1</span>;</div><div class="line">                    x = <span class="number">0</span>, idx++;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> l = X+Z, r = X*Y+Z;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> OFF = <span class="number">1024</span>;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">double</span> dp[<span class="number">2</span>][OFF];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; OFF; i++)</div><div class="line">                dp[<span class="number">0</span>][i] = dp[<span class="number">1</span>][i] = <span class="number">0</span>;</div><div class="line">            dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; X; i++) &#123;</div><div class="line">                <span class="keyword">int</span> p = i&amp;<span class="number">1</span>, q = i&amp;<span class="number">1</span>^<span class="number">1</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; OFF; j++)</div><div class="line">                    dp[q][j] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; OFF; j++) &#123;</div><div class="line">                    <span class="keyword">if</span> (dp[p][j] &lt;= <span class="number">0</span>)	<span class="keyword">continue</span>;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt;= Y; k++)</div><div class="line">                        dp[q][j+k] += dp[p][j]*((<span class="keyword">double</span>) <span class="number">1.f</span>/Y);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= X*Y; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (j+Z &gt;= H)</div><div class="line">                    sum += dp[(X<span class="number">-1</span>)&amp;<span class="number">1</span>^<span class="number">1</span>][j];</div><div class="line">            &#125;</div><div class="line">            ret = max(ret, sum);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %.6lf\n"</span>,++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-jg-10038" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/06/24/jg-10038/" class="article-date">
  <time datetime="2016-06-24T02:28:47.000Z" itemprop="datePublished">2016-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" href="http://i.imgur.com/fR0IDd3.jpg" rel="gallery_cktgvu5mu006dmwvni4neaxgc">
        <img src="http://i.imgur.com/fR0IDd3.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/24/jg-10038/">批改娘 10038. Fast Covering Problem</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2016/06/24/jg-10038/" data-id="cktgvu5mu006dmwvni4neaxgc" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2016/06/24/jg-10038/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DLX/">DLX</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/branch-and-reduce-algorithm/">branch-and-reduce algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/批改娘/">批改娘</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最少重複覆蓋/">最少重複覆蓋</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最少點集覆蓋/">最少點集覆蓋</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="題目背景"><a href="#題目背景" class="headerlink" title="題目背景"></a>題目背景</h2><p>終於把所有練習題都放上 Judge Girl，測資都已經確認過一遍，某 M 打算離開一陣子。「反正是個令人唾棄的助教吧 …」</p>
<h2 id="題目描述"><a href="#題目描述" class="headerlink" title="題目描述"></a>題目描述</h2><p>考試出題總很難讓所有人滿意，老師決定給予學生們選擇考試出題方向，但每一個人只能提出兩種意見，接著老師會出一套方案滿足每一位學生的其中一種意見。由於出一套題步驟繁瑣，把數個意見出在同一題非常困難，最後每一種意見將單獨被出成一道題。</p>
<p>由於助教們要負責出測資、檢驗測資正確與可行性，希望題目數量越少越好，否則助教會忙翻天。現在要找到最少題目來滿足所有學生的需求。</p>
<p>例如 :</p>
<ul>
<li>現在有 4 名學生的意見</li>
<li>四名學生分別提案 $(0, 1), (100, 1), (100, 0), (100, 200)$</li>
<li>如果選擇 ${ 0, 100 }$ 或者是 ${ 1, 100 }$ 都是最好的選擇，助教只需要完成 2 題的檢驗。相反地，如果 ${0, 100, 200 }$ 雖然可以滿足所有學生，但需要出成 3 道題目。</li>
</ul>
<h2 id="輸入格式"><a href="#輸入格式" class="headerlink" title="輸入格式"></a>輸入格式</h2><p>只有一組測資，每組第一行會有一個整數 $N$，表示有多少位學生，接下來會有 $N$ 行，每 $i$ 行上會有兩個整數 $A_i, B_i$ 表示第 $i$ 個學生的出題意見。</p>
<ul>
<li>$0 &lt; N \le 1000$</li>
<li>$0 \le A_i, \; B_i \le 10000$</li>
<li>意見類型總數不超過 100 種</li>
</ul>
<h2 id="輸出格式"><a href="#輸出格式" class="headerlink" title="輸出格式"></a>輸出格式</h2><p>對於每一組測資輸出一行，表示最少要準備的方案數量能滿足所有學生。</p>
<h2 id="範例輸入"><a href="#範例輸入" class="headerlink" title="範例輸入"></a>範例輸入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">4</div><div class="line">0 1</div><div class="line">100 1</div><div class="line">100 0</div><div class="line">100 200</div></pre></td></tr></table></figure>
<h2 id="範例輸出"><a href="#範例輸出" class="headerlink" title="範例輸出"></a>範例輸出</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">2</div></pre></td></tr></table></figure>
<h2 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h2><p>DLX </p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>當年在 NCPC 搞不出來的 Problem I Christmas Gifts (NP-hard)，在賽後用 DLX 運行效果不錯，在啟發函數加上延遲標記更是屹立排名前數位已久。最近又因為平行把題目挖回來討論，在去年釣到大一學弟來解，便以飛快的速度擊破測資，最後達到加速 20x。再把當初需要跑 30 秒的測資來運行，現在只需要短短的 50ms。</p>
<blockquote>
<p>原本要拿來出平行題目，看到這麼驚人的速度，想必就不要出題。</p>
</blockquote>
<p>通用解法 DLX 加上啟發式函數就能解決最少重複覆蓋，然而在圖論的最少點集覆蓋問題中，性質又變得更加強烈。當不選某一個點時，必然與其相連的邊為了要覆蓋，另一端必然成為必選點。這時候搜索空間大幅度地下降。若在一般 DLX 算法中提及的最少可能的列中，窮舉某行來覆蓋一些列，那麼就很難看到搜索空間下降的性質。</p>
<p>因此，步驟簡單分成下列步驟：</p>
<ol>
<li>將圖轉換成某行可以覆蓋哪幾列，轉換成 Dancing Links 的格式</li>
<li>找到可以覆蓋最多尚未覆蓋列最多的那一行<ol>
<li>選擇這一行，並且移除這一行所有覆蓋列，遞迴窮舉。</li>
<li>移除這一行，選擇必選行，並嘗試移除等價行。</li>
</ol>
</li>
</ol>
<hr>
<p>附錄：和交通大學謝旻錚(Min-Zheng Shieh) 教練的討論</p>
<blockquote>
<p>在想確實能用 dancing links 來搞，還要搭配維護 degree order，不過這算法吳邦一老師是說 worst case 為 3 regular graph。<br>另外先前找過日本人 iwi 的論文，他也搞了個高級 VC solver 並做了測試，詳見論文 Branch-and-reduce exponential/FPT algorithms in practice: A case study of vertex cover, Takuya Akiba, Yoichi Iwata </p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;assert.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;limits.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXNODE 100000</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXCOL 5005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 5005</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">DancingNode</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> left, right, up, down;</div><div class="line">    <span class="keyword">int</span> ch, rh;</div><div class="line">&#125; DL[MAXNODE];</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HelperNode</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> head, size, next, prev;</div><div class="line">&#125; HN[MAXNODE];</div><div class="line"><span class="keyword">int</span> help_head;</div><div class="line"><span class="keyword">int</span> s[MAXCOL];</div><div class="line"><span class="keyword">int</span> head, size, Ans, Dep;</div><div class="line"><span class="keyword">int</span> markStk[MAXNODE], markIdx = <span class="number">-1</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Remove</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = DL[c].down; i != c; i = DL[i].down) &#123;</div><div class="line">    	<span class="keyword">if</span> (HN[DL[i].rh].head == i)</div><div class="line">    		HN[DL[i].rh].head = DL[i].left;</div><div class="line">    	HN[DL[i].rh].size--;</div><div class="line">        DL[DL[i].right].left = DL[i].left;</div><div class="line">        DL[DL[i].left].right = DL[i].right;</div><div class="line">        s[DL[i].ch]--;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Resume</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = DL[c].down; i != c; i = DL[i].down) &#123;</div><div class="line">    	<span class="keyword">if</span> (HN[DL[i].rh].head == i)</div><div class="line">    		HN[DL[i].rh].head = DL[i].right;</div><div class="line">    	HN[DL[i].rh].size++;</div><div class="line">        DL[DL[i].right].left = i;</div><div class="line">        DL[DL[i].left].right = i;</div><div class="line">        s[DL[i].ch]++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Reduce</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> t = DL[i].rh;</div><div class="line">    HN[HN[t].next].prev = HN[t].prev;</div><div class="line">    HN[HN[t].prev].next = HN[t].next;</div><div class="line">    s[DL[i].ch]--;</div><div class="line">    DL[DL[i].down].up = DL[i].up;</div><div class="line">    DL[DL[i].up].down = DL[i].down;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = DL[i].right; k != i; k = DL[k].right) &#123;</div><div class="line">        DL[DL[k].down].up = DL[k].up;</div><div class="line">        DL[DL[k].up].down = DL[k].down;</div><div class="line">        s[DL[k].ch]--;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Recover</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> t = DL[i].rh;</div><div class="line">    HN[HN[t].next].prev = t;</div><div class="line">    HN[HN[t].prev].next = t;</div><div class="line">    s[DL[i].ch]++;</div><div class="line">    DL[DL[i].down].up = i;</div><div class="line">    DL[DL[i].up].down = i;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> k = DL[i].right; k != i; k = DL[k].right) &#123;</div><div class="line">        DL[DL[k].down].up = k;</div><div class="line">        DL[DL[k].up].down = k;</div><div class="line">        s[DL[k].ch]++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Select</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> s = DL[i].rh;</div><div class="line">    HN[HN[s].next].prev = HN[s].prev;</div><div class="line">    HN[HN[s].prev].next = HN[s].next;</div><div class="line">    Remove(i);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = DL[i].right; j != i; j = DL[j].right)</div><div class="line">        Remove(j);</div><div class="line">    Dep++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Cancel</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> s = DL[i].rh;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = DL[i].right; j != i; j = DL[j].right)</div><div class="line">        Resume(j);</div><div class="line">    Resume(i);    </div><div class="line">    HN[HN[s].next].prev = s;</div><div class="line">    HN[HN[s].prev].next = s;</div><div class="line">    Dep--;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Decision</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> has = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = DL[head].right; i != head; i = DL[i].right) &#123;</div><div class="line">        <span class="keyword">if</span> (s[i] == <span class="number">1</span>) &#123;</div><div class="line">            Select(DL[i].down);</div><div class="line">            markStk[++markIdx] = DL[i].down;</div><div class="line">            has = <span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> has;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Subset</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;	<span class="comment">// 0: x in y, 1: y in x </span></div><div class="line">    assert(DL[x].ch == DL[y].ch);</div><div class="line">    <span class="keyword">int</span> a = <span class="number">0</span>, b = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> i, j;</div><div class="line">    <span class="keyword">for</span> (i = DL[x].right, j = DL[y].right; i != x &amp;&amp; j != y; ) &#123;</div><div class="line">        <span class="keyword">if</span> (DL[i].ch == DL[j].ch)</div><div class="line">            i = DL[i].right, j = DL[j].right;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (DL[i].ch &lt; DL[j].ch)</div><div class="line">            i = DL[i].right, a = <span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            j = DL[j].right, b = <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (a &amp;&amp; b)</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (i != x)    a = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (j != y)    b = <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> a || b ? (a - b) : <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Duplicate</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> has = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = DL[head].right; i != head; i = DL[i].right) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = DL[i].down; j != i; j = DL[j].down) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = DL[j].down; k != j &amp;&amp; k != i; k = DL[k].down) &#123;</div><div class="line">                <span class="keyword">int</span> cmp = Subset(j, k);</div><div class="line">                <span class="keyword">if</span> (cmp == <span class="number">0</span>)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span> (cmp == <span class="number">1</span>) &#123;</div><div class="line">                	markStk[++markIdx] = j;</div><div class="line">                	Select(j);</div><div class="line">            	&#125; <span class="keyword">else</span> &#123;</div><div class="line">            		markStk[++markIdx] = k;</div><div class="line">                	Select(k);</div><div class="line">                &#125;</div><div class="line">                has = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> has;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">H</span><span class="params">(<span class="keyword">int</span> limit)</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> c, ret, i, j, time = <span class="number">0</span>;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">int</span> used[MAXCOL] = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> (c = DL[head].right, ++time, ret = <span class="number">0</span>; c != head; c = DL[c].right) &#123;</div><div class="line">        <span class="keyword">if</span> (used[c] == time)</div><div class="line">        	<span class="keyword">continue</span>;</div><div class="line">    	ret ++, used[c] = time;</div><div class="line">    	<span class="keyword">if</span> (ret &gt;= limit)	<span class="keyword">return</span> ret;</div><div class="line">        <span class="keyword">for</span> (i = DL[c].down; i != c; i = DL[i].down) &#123;</div><div class="line">            <span class="keyword">for</span> (j = DL[i].right; j != i; j = DL[j].right)</div><div class="line">            	used[DL[j].ch] = time;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">DFS</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> hval = H(Ans - Dep);</div><div class="line">    <span class="keyword">if</span> (DL[head].right == head &amp;&amp; Dep &lt; Ans)</div><div class="line">    	Ans = Dep;</div><div class="line">    <span class="keyword">if</span> (Dep + hval &gt;= Ans)</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    <span class="keyword">int</span> cover_max = <span class="number">-1</span>, cover_idx = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = HN[help_head].next; i != help_head; i = HN[i].next) &#123;</div><div class="line">        <span class="keyword">if</span> (HN[i].size &gt; cover_max) &#123;</div><div class="line">            cover_max = HN[i].size;</div><div class="line">            cover_idx = HN[i].head;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    Select(cover_idx);</div><div class="line">    DFS();</div><div class="line">    Cancel(cover_idx);</div><div class="line">    </div><div class="line">    Reduce(cover_idx);</div><div class="line">    <span class="keyword">int</span> markEsp = markIdx;</div><div class="line">    <span class="keyword">while</span> (!Decision() &amp;&amp; !Duplicate());</div><div class="line">    DFS();</div><div class="line">    <span class="keyword">while</span> (markIdx &gt; markEsp)</div><div class="line">        Cancel(markStk[markIdx--]);</div><div class="line">    Recover(cover_idx);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">new_node</span><span class="params">(<span class="keyword">int</span> up, <span class="keyword">int</span> down, <span class="keyword">int</span> left, <span class="keyword">int</span> right)</span> </span>&#123;</div><div class="line">    DL[size].up = up, DL[size].down = down;</div><div class="line">    DL[size].left = left, DL[size].right = right;</div><div class="line">    DL[up].down = DL[down].up = DL[left].right = DL[right].left = size;</div><div class="line">    <span class="keyword">return</span> size++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">new_row</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> Row[], <span class="keyword">int</span> rh)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> r, row = <span class="number">-1</span>, k;</div><div class="line">    <span class="keyword">int</span> h = size;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">        r = Row[i];</div><div class="line">        DL[size].ch = r, s[r]++;</div><div class="line">        DL[size].rh = rh;</div><div class="line">        <span class="keyword">if</span> (row == <span class="number">-1</span>) &#123;</div><div class="line">            row = new_node(DL[DL[r].ch].up, DL[r].ch, size, size);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            k = new_node(DL[DL[r].ch].up, DL[r].ch, DL[row].left, row);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    HN[rh].size = n;</div><div class="line">    HN[rh].head = h;</div><div class="line">    HN[rh].next = HN[help_head].next;</div><div class="line">    HN[rh].prev = help_head;</div><div class="line">    HN[HN[help_head].next].prev = rh;</div><div class="line">    HN[help_head].next = rh;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> m)</span> </span>&#123;</div><div class="line">    size = <span class="number">0</span>;</div><div class="line">    help_head = <span class="number">0</span>, HN[help_head].next = HN[help_head].prev = help_head;</div><div class="line">    head = new_node(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= m; i++) &#123;</div><div class="line">        new_node(i, i, DL[head].left, head);</div><div class="line">        DL[i].ch = i, s[i] = <span class="number">0</span>;</div><div class="line">        DL[i].rh = <span class="number">0</span>;	<span class="comment">// important pointer (fail pointer)</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n) == <span class="number">1</span> &amp;&amp; n) &#123;</div><div class="line">    	<span class="keyword">int</span> A[MAXN], B[MAXN];</div><div class="line">        <span class="keyword">int</span> toy[<span class="number">10005</span>] = &#123;&#125;, R[MAXCOL];</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;A[i], &amp;B[i]);</div><div class="line">            toy[A[i]]++, toy[B[i]]++;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        init(n);</div><div class="line">        <span class="keyword">int</span> run_id = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">10000</span>; i++) &#123;</div><div class="line">            <span class="keyword">int</span> nt = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (A[j] == i || B[j] == i)</div><div class="line">                    R[nt++] = j;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (nt) &#123;</div><div class="line">                run_id++;</div><div class="line">                new_row(nt, R, run_id);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        Ans = n;</div><div class="line">        Dep = <span class="number">0</span>, markIdx = <span class="number">-1</span>;</div><div class="line">        Decision();</div><div class="line">        DFS();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, Ans);</div><div class="line">        fflush(<span class="built_in">stdout</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2016-google-code-jam-1A" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/16/2016-google-code-jam-1A/" class="article-date">
  <time datetime="2016-04-16T05:41:52.000Z" itemprop="datePublished">2016-04-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/16/2016-google-code-jam-1A/">2016 Google Code Jam Round 1A</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2016/04/16/2016-google-code-jam-1A/" data-id="cktgvu5kk000imwvnkm2uoyug" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2016/04/16/2016-google-code-jam-1A/#disqus_thread" class="article-comment-link">Comments</a>
      
      
    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="A-The-Last-Word"><a href="#A-The-Last-Word" class="headerlink" title="A. The Last Word"></a>A. The Last Word</h2><p>每一字串 <span>$S$</span><!-- Has MathJax -->，可視為一串操作，依序讀入一個字元 <span>$C$</span><!-- Has MathJax -->，可以選擇把字元 <span>$C$</span><!-- Has MathJax --> 插入字串首或尾，請問字典順序最大為何？</p>
<p>類似 ZJ. 一串數字 之類的貪心方式，優先考慮最大字元在哪一個位置，抓取之後拆分兩串分開貪心合併，每一次由後往前找到第一個最大字典順序字元 <span>$T$</span><!-- Has MathJax -->，<span>$T$</span><!-- Has MathJax --> 移到最前方，此時會將字串分成前半 <span>$A$</span><!-- Has MathJax --> 和後半 <span>$B$</span><!-- Has MathJax -->，然而後半 <span>$B$</span><!-- Has MathJax --> 要排在 <span>$T$</span><!-- Has MathJax --> 字元之後，勢必只能按照順序丟入隊尾。因此 <span>$\textit{MAXEXPR}(F) = T + \textit{MAXEXPR}(A) + B$</span><!-- Has MathJax -->。</p>
<h2 id="B-Rank-and-File"><a href="#B-Rank-and-File" class="headerlink" title="B. Rank and File"></a>B. Rank and File</h2><p>給定一個 <span>$N \times N$</span><!-- Has MathJax --> 方格，每一行或列都是嚴格遞增，現在給定數個行、數個列的排列情況，請問缺漏的那一行或列的序列為何？</p>
<p>明顯地每一個數字都恰好出現偶數次，按照大小順序印出奇數次數字即可。</p>
<h2 id="C-BFFs"><a href="#C-BFFs" class="headerlink" title="C. BFFs"></a>C. BFFs</h2><p>給同學都有一位摯友，給定 <span>$N$</span><!-- Has MathJax --> 個人的好友資訊，現在要求盡可能多的人圍成一圈，並且每一個人其中一側是他們自己的摯友，請問圈最多幾個人。</p>
<p>明顯地，若不看方向性，每一個連通圖至多一個環。若一個連通圖式一個環，保證無法與其他方案合併在一起，因此用 <span>$\mathcal{O}(N^2)$</span><!-- Has MathJax --> 優先排除是環的解，在其中找最大圈即可。</p>
<p>接著考慮有觸手的水母圖，當水母大小恰好由兩個點構成時才會有解，因為三個點以上不符合題目要求的環。最後找到經過兩端點的最長觸手，這些點可以自我滿足，把所有最長觸手合併在一起可以構成一組特殊解。兩種方案取最大。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="A"><a href="#A" class="headerlink" title="A"></a>A</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="built_in">string</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> n, <span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>)	<span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">    <span class="keyword">char</span> mx = s[<span class="number">0</span>];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">        mx = max(mx, s[i]);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">        <span class="keyword">if</span> (s[i] == mx) &#123;</div><div class="line">            <span class="built_in">string</span> mm = <span class="built_in">string</span>(<span class="number">1</span>, mx);</div><div class="line">            <span class="keyword">return</span> mm + dfs(i, s.substr(<span class="number">0</span>, i)) + s.substr(i+<span class="number">1</span>) ;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">""</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">char</span> cs[<span class="number">1024</span>];</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, cs);</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(cs);</div><div class="line">        <span class="built_in">string</span> v = dfs(n, cs);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %s\n"</span>, ++cases, v.c_str());</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="B"><a href="#B" class="headerlink" title="B"></a>B</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> n, m, x;</div><div class="line">        <span class="built_in">map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; R;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        m = <span class="number">2</span>*n<span class="number">-1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">                R[x]++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:"</span>, ++cases);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> e : R) &#123;</div><div class="line">            <span class="keyword">if</span> (e.second % <span class="number">2</span> == <span class="number">1</span>)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">" %d"</span>, e.first);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> g[<span class="number">1024</span>][<span class="number">1024</span>];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; gg[<span class="number">1024</span>];</div><div class="line"><span class="keyword">int</span> cc[<span class="number">1024</span>];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> dep)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> ret = dep;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> v : gg[u]) &#123;</div><div class="line">        <span class="keyword">if</span> (cc[v])	<span class="keyword">continue</span>;</div><div class="line">        <span class="keyword">int</span> tmp = dfs(v, dep+<span class="number">1</span>);</div><div class="line">        ret = max(ret, tmp);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> n, A[<span class="number">1024</span>];</div><div class="line">        </div><div class="line">        <span class="built_in">memset</span>(g, <span class="number">0</span>, <span class="keyword">sizeof</span>(g));</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">            gg[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;A[i]), g[i][A[i]] = <span class="number">1</span>, gg[A[i]].push_back(i);</div><div class="line">        <span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            <span class="keyword">int</span> used[<span class="number">1024</span>] = &#123;&#125;;</div><div class="line">            <span class="keyword">int</span> u = i, cnt = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (; used[u] == <span class="number">0</span>; u = A[u]) &#123;</div><div class="line">                used[u] = <span class="number">1</span>, cnt++;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (u == i) </div><div class="line">                ret = max(ret, cnt);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">memset</span>(cc, <span class="number">0</span>, <span class="keyword">sizeof</span>(cc));</div><div class="line">        <span class="keyword">int</span> cctot = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= n; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (i == j)	<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span> (cc[i] || cc[j])	<span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">if</span> (g[i][j] == <span class="number">0</span> || g[j][i] == <span class="number">0</span>)</div><div class="line">                    <span class="keyword">continue</span>;</div><div class="line">                cc[i] = <span class="number">1</span>, cc[j] = <span class="number">1</span>;</div><div class="line">                cctot += <span class="number">2</span>;</div><div class="line">                cctot += dfs(i, <span class="number">0</span>) + dfs(j, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ret = max(ret, cctot);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2016-google-code-jam-qr" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/04/10/2016-google-code-jam-qr/" class="article-date">
  <time datetime="2016-04-10T13:35:59.000Z" itemprop="datePublished">2016-04-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/10/2016-google-code-jam-qr/">2016 Google Code Jam Round QR</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2016/04/10/2016-google-code-jam-qr/" data-id="cktgvu5kl000kmwvniy58vl7j" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2016/04/10/2016-google-code-jam-qr/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/貪心/">貪心</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>一年一度的 GCJ 資格賽又開打了，這次的題目類型挺開放的，也就是有很多不同的解法可以通過。也許是因為都用了奇怪的方法解決。全寫完 Rank 400 名以內。</p>
<p>打完比賽完全沒心情寫水泥數學的作業證明。不！其實是不會寫。</p>
<h2 id="A-Counting-Sheep"><a href="#A-Counting-Sheep" class="headerlink" title="A. Counting Sheep"></a>A. Counting Sheep</h2><p>睡覺前數羊，從一個基數 <span>$N$</span><!-- Has MathJax --> 開始，數 <span>$N$</span><!-- Has MathJax -->, <span>$2N$</span><!-- Has MathJax -->, <span>$3N$</span><!-- Has MathJax -->, …, <span>$?N$</span><!-- Has MathJax -->，直到 10 個位數都出現過，請問最後一個數的數 <span>$?N$</span><!-- Has MathJax --> 為何。</p>
<p>除了 <span>$N = 0$</span><!-- Has MathJax --> 的特殊情況外，直接模擬即可。最重要的是它不只有看個位數字，把每一位全看的狀況下，要湊滿 0-9 所有 digits 都出現過就不是難事。</p>
<h2 id="B-Revenge-of-the-Pancakes"><a href="#B-Revenge-of-the-Pancakes" class="headerlink" title="B. Revenge of the Pancakes"></a>B. Revenge of the Pancakes</h2><p>現在 <span>$N$</span><!-- Has MathJax --> 個煎餅位於堆上，並且有分成兩個正反面狀態，每一次可以把煎餅從堆頂開始連續得拿出，並反轉序列放回堆中，同時把煎餅正反反轉，請問從一個開始序列轉移到全部皆為正面的操作次數最少為何？</p>
<p>一開始的策略是亂貪心一番，甚至題目看錯都能亂過小測資。必要任務一定是先把堆底那片煎餅翻成正的，這時一定堆頂為反，進行一次反轉讓堆底便成正的，為了讓堆頂為反，貪心策略盡可能讓堆頂一連續全部變成反。不斷地模擬此步驟即可。</p>
<h2 id="C-Coin-Jam"><a href="#C-Coin-Jam" class="headerlink" title="C. Coin Jam"></a>C. Coin Jam</h2><p>產生一個數字 <span>$X$</span><!-- Has MathJax -->，<span>$X$</span><!-- Has MathJax --> 長度恰為 <span>$N$</span><!-- Has MathJax -->，必須首尾皆為 1，只能由 0/1 構成。請產生數字 <span>$X$</span><!-- Has MathJax -->，滿足在二進制、三進制 … 到十進制下皆為合成數。</p>
<p>這題莫名其妙指定 <span>$N = 16, \; 32$</span><!-- Has MathJax -->，特殊的 <span>$N$</span><!-- Has MathJax --> 使得找到 <span>$J$</span><!-- Has MathJax --> 個 <span>$X$</span><!-- Has MathJax --> 並不難，更由於 <span>$J$</span><!-- Has MathJax --> 不大，各種解法都可以完成。從以往得概念，假設有一個數字 <span>$A = 123123$</span><!-- Has MathJax -->，那麼保證不進位的情況下，找得到一組 <span>$A = 123 \times 1001$</span><!-- Has MathJax -->，因此指定 <span>$A = 1????1$</span><!-- Has MathJax -->，湊滿 <span>$X = AA \cdots A$</span><!-- Has MathJax -->，不管在哪個進制下，勢必被 <span>$A$</span><!-- Has MathJax --> 整除。</p>
<h2 id="D-Fractiles"><a href="#D-Fractiles" class="headerlink" title="D. Fractiles"></a>D. Fractiles</h2><p>詭異的數學碎形考古，給一個長度為 <span>$K$</span><!-- Has MathJax --> 的起始字串 <span>$X$</span><!-- Has MathJax -->，<span>$X$</span><!-- Has MathJax --> 只由 <span>$G$</span><!-- Has MathJax --> 和 <span>$L$</span><!-- Has MathJax --> 構成。碎形迭代 <span>$C$</span><!-- Has MathJax --> 次，產生長度為 <span>$K^C$</span><!-- Has MathJax --> 的字串。現在雇用 <span>$S$</span><!-- Has MathJax --> 個學生，每個學生只能檢查一個位子，只要確定那一個位子有 <span>$G$</span><!-- Has MathJax -->，那麼原始字串保證有 <span>$G$</span><!-- Has MathJax -->。在限定學生數量下，請問要怎麼安排學生們的檢查工作。</p>
<p>由於長度為 <span>$K$</span><!-- Has MathJax --> 的起始字串有 <span>$2^K$</span><!-- Has MathJax --> 種，實際上只要剃除 <span>$LL \cdots L$</span><!-- Has MathJax --> 的字串。為了要在最少檢查位置下處理，必然要一個位置能否有 <span>$G$</span><!-- Has MathJax -->，就能檢查原始字串的數個位置是否有 <span>$G$</span><!-- Has MathJax -->。</p>
<p>窮舉只有 1 個 <span>$G$</span><!-- Has MathJax --> 個字串 <span>$GLL...L$</span><!-- Has MathJax -->、<span>$LGL...L$</span><!-- Has MathJax -->、… 等 <span>$K$</span><!-- Has MathJax --> 個，追蹤迭代 <span>$C$</span><!-- Has MathJax --> 次後，<span>$K^C$</span><!-- Has MathJax --> 長度下，每一個字串 <span>$G$</span><!-- Has MathJax --> 的出現位置。當 <span>$C = 2$</span><!-- Has MathJax -->，可以讓位置 1, 2 的 <span>$G$</span><!-- Has MathJax --> 可以同時被檢查，同理位置 3, 4 的 <span>$G$</span><!-- Has MathJax --> 可以同時被檢查。當 <span>$C = 3$</span><!-- Has MathJax --> 時，位置 1, 2, 3 的 <span>$G$</span><!-- Has MathJax --> 可以同時被檢查。根據觀察，至少要 <span>$\textit{ceil}(K/C)$</span><!-- Has MathJax --> 個學生就能滿足需求。</p>
<p>第 <span>$i$</span><!-- Has MathJax --> 個學生要檢查的位置為 <span>$1 + \sum_{0 \le j &lt; C} (C(i-1)+(C-1-j))K^j$</span><!-- Has MathJax -->。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h4 id="A"><a href="#A" class="headerlink" title="A"></a>A</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> n;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld"</span>, &amp;n);</div><div class="line">        <span class="keyword">if</span> (n == <span class="number">0</span>) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case #%d: INSOMNIA\n"</span>, ++cases);</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> has[<span class="number">128</span>] = &#123;&#125;, ten = <span class="number">10</span>;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> on = n;</div><div class="line">        <span class="keyword">while</span> (<span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">char</span> buf[<span class="number">32</span>];</div><div class="line">            <span class="built_in">sprintf</span>(buf, <span class="string">"%lld"</span>, n);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; buf[i]; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (has[buf[i]] == <span class="number">0</span>) &#123;</div><div class="line">                    ten--, has[buf[i]] = <span class="number">1</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (ten == <span class="number">0</span>)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            n += on;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, n);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="B"><a href="#B" class="headerlink" title="B"></a>B</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span> s[<span class="number">1024</span>];</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s);</div><div class="line">        <span class="keyword">int</span> n = <span class="built_in">strlen</span>(s), ret = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (s[i] == <span class="string">'+'</span>)	<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">int</span> has = <span class="number">0</span>, j = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= i; j++) &#123;</div><div class="line">                <span class="keyword">if</span> (s[j] == <span class="string">'-'</span>)	<span class="keyword">break</span>;</div><div class="line">                has = <span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (has) &#123;</div><div class="line">                reverse(s, s+j);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; j; k++) &#123;</div><div class="line">                    <span class="keyword">if</span> (s[k] == <span class="string">'-'</span>)</div><div class="line">                        s[k] = <span class="string">'+'</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        s[k] = <span class="string">'-'</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            ret += has;</div><div class="line">            <span class="keyword">if</span> (s[i] == <span class="string">'+'</span>)	<span class="keyword">continue</span>;</div><div class="line">            reverse(s, s+i+<span class="number">1</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; i+<span class="number">1</span>; k++) &#123;</div><div class="line">                <span class="keyword">if</span> (s[k] == <span class="string">'-'</span>)</div><div class="line">                    s[k] = <span class="string">'+'</span>;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    s[k] = <span class="string">'-'</span>;</div><div class="line">            &#125;</div><div class="line">            ret++;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="C"><a href="#C" class="headerlink" title="C"></a>C</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, J;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;N, &amp;J);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:\n"</span>, ++cases);</div><div class="line">        <span class="built_in">set</span>&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; R;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N &amp;&amp; J; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (N%i)	<span class="keyword">continue</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; (<span class="number">1</span>&lt;&lt;(i<span class="number">-2</span>)) &amp;&amp; J; j++) &#123;</div><div class="line">                <span class="keyword">int</span> mask = (j&lt;&lt;<span class="number">1</span>)|<span class="number">1</span>|(<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>));</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> v = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; N/i; k++)</div><div class="line">                    v = (v&lt;&lt;i) | mask;</div><div class="line">                <span class="keyword">if</span> (R.count(v))	<span class="keyword">continue</span>;</div><div class="line">                R.insert(v);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = N<span class="number">-1</span>; k &gt;= <span class="number">0</span>; k--)</div><div class="line">                    <span class="built_in">printf</span>(<span class="string">"%d"</span>, (v&gt;&gt;k)&amp;<span class="number">1</span>);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> B = <span class="number">2</span>; B &lt;= <span class="number">10</span>; B++) &#123;</div><div class="line">                    <span class="keyword">long</span> <span class="keyword">long</span> div = <span class="number">0</span>, nn = <span class="number">0</span>;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = i<span class="number">-1</span>; k &gt;= <span class="number">0</span>; k--)</div><div class="line">                        div = div * B + ((mask&gt;&gt;k)&amp;<span class="number">1</span>);</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = N<span class="number">-1</span>; k &gt;= <span class="number">0</span>; k--)</div><div class="line">                        nn = nn * B + ((v&gt;&gt;k)&amp;<span class="number">1</span>);</div><div class="line"><span class="comment">//					assert(nn % div == 0 &amp;&amp; nn != div);</span></div><div class="line">                    <span class="built_in">printf</span>(<span class="string">" %lld"</span>, div);</div><div class="line">                &#125;</div><div class="line">                <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">                J--;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        assert(J == <span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">1</span></div><div class="line"><span class="comment">16 3</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
<h4 id="D"><a href="#D" class="headerlink" title="D"></a>D</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">mpow</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> x, <span class="keyword">long</span> <span class="keyword">long</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (y) &#123;</div><div class="line">        <span class="keyword">if</span> (y&amp;<span class="number">1</span>)</div><div class="line">            ret = ret * x;</div><div class="line">        y &gt;&gt;= <span class="number">1</span>, x = x*x;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> K, C, S;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lld %lld %lld"</span>, &amp;K, &amp;C, &amp;S);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d:"</span>, ++cases);</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> pos = <span class="number">0</span>;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span>&gt; A;</div><div class="line"><span class="comment">//		puts("");</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">ceil</span>(<span class="number">1.f</span>*K/C); i++) &#123;</div><div class="line">            <span class="keyword">int</span> item = min(C, K - pos);</div><div class="line">            <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> x = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = C<span class="number">-1</span>, k = <span class="number">0</span>; j &gt;= <span class="number">0</span> &amp;&amp; k &lt; item; j--, k++) &#123;</div><div class="line"><span class="comment">//				printf("%d K^%d + ", pos + k, j);</span></div><div class="line">                x += (pos + k) * mpow(K, j);</div><div class="line">            &#125;</div><div class="line">            A.push_back(x);</div><div class="line"><span class="comment">//			puts("");</span></div><div class="line">            pos += C;</div><div class="line">            <span class="keyword">if</span> (pos &gt; K)	pos = K;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (A.size() &gt; S)</div><div class="line">            <span class="built_in">puts</span>(<span class="string">" IMPOSSIBLE"</span>);</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; A.size(); i++)</div><div class="line">                <span class="built_in">printf</span>(<span class="string">" %llu"</span>, A[i]+<span class="number">1</span>);</div><div class="line">            <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">5</span></div><div class="line"><span class="comment">4 4 5</span></div><div class="line"><span class="comment">*/</span></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-2016-facebook-hacker-cup-round-2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/01/27/2016-facebook-hacker-cup-round-2/" class="article-date">
  <time datetime="2016-01-27T12:07:59.000Z" itemprop="datePublished">2016-01-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/01/27/2016-facebook-hacker-cup-round-2/">2016 Facebook Hacker Cup Round 2</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2016/01/27/2016-facebook-hacker-cup-round-2/" data-id="cktgvu5kj000gmwvnuians6kp" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2016/01/27/2016-facebook-hacker-cup-round-2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數學/">數學</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/最少費用流/">最少費用流</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>這一場是凌晨的比賽，因此沒有興趣參與，還是來翻譯一下吧！</p>
<h2 id="A-Boomerang-Decoration"><a href="#A-Boomerang-Decoration" class="headerlink" title="A. Boomerang Decoration"></a>A. Boomerang Decoration</h2><p>要製作回力鏢的雙翼，需要兩個對稱形狀的翼構成，簡單來說是兩個相同字串。給予左翼 <span>$L$</span><!-- Has MathJax --> 和右翼 <span>$R$</span><!-- Has MathJax -->，現在 A 和另一名小夥伴 B 同時更改左翼 <span>$L$</span><!-- Has MathJax -->，使得 <span>$L = R$</span><!-- Has MathJax -->，請問最少時間為何。</p>
<p>每一時刻，<span>$A$</span><!-- Has MathJax --> 可以選擇 <span>$[0, x]$</span><!-- Has MathJax --> 都改變成顏色 <span>$c_1$</span><!-- Has MathJax -->，而 <span>$B$</span><!-- Has MathJax --> 則可以選擇 <span>$[y, n-1]$</span><!-- Has MathJax --> 全部變成顏色 <span>$c_2$</span><!-- Has MathJax -->，要求 <span>$A$</span><!-- Has MathJax --> 和 <span>$B$</span><!-- Has MathJax --> 的塗色區間不可重疊，意即 <span>$y &gt; x$</span><!-- Has MathJax -->。</p>
<p>由於每一次塗色是前綴或者後綴，那對於 A 而言，一定是選擇 <span>$x$</span><!-- Has MathJax --> 嚴格遞減，反之對於 <span>$y$</span><!-- Has MathJax --> 是嚴格遞增，否則之前的操作會白工。藉由上述推測得知，A 和 B 塗色的區間不會重疊，得到最後一定要求左區段和右區段工作時間最大值。</p>
<p>目標找到 A 完成左區段 <code>dpL[0...x]</code> 的最少時間，以及 B 完成 <code>dpR[y...n-1]</code> 的最少時間，最後答案為 <code>min(max(dpL[0...x], dpR[x+1...n-1]))</code>。計算 <code>dpL[]</code> 和 <code>dpR[]</code> 的方法是一樣的，左右相反即可，</p>
<p>由於只能更改左翼，右翼不能更改，那麼一旦改了左翼位置 <span>$x$</span><!-- Has MathJax -->，事實上要全部變動成右翼，變數個數 <span>$d$</span><!-- Has MathJax --> 即是右翼不同的連續相同字符片段。根據貪心策略，若左翼位置 <span>$x$</span><!-- Has MathJax --> 和右翼位置 <span>$x$</span><!-- Has MathJax --> 相同，則變動費用為 <code>dpL[x] = dpL[x-1]</code>，否則就是 <code>dpL[x] = d</code>。時間複雜度 <span>$\mathcal{O}(n)$</span><!-- Has MathJax -->。</p>
<h2 id="B-Carnival-Coins"><a href="#B-Carnival-Coins" class="headerlink" title="B. Carnival Coins"></a>B. Carnival Coins</h2><p>參與一場遊戲，獎品無限多個，遊戲規則要求一次投擲 <span>$n$</span><!-- Has MathJax --> 硬幣，硬幣出現正面的機率 <span>$P$</span><!-- Has MathJax -->，只要出現 <span>$K$</span><!-- Has MathJax --> 個以上正面即可獲得一份獎品，現在手裡握有 <span>$N$</span><!-- Has MathJax --> 個硬幣，你可以邀請很多個小夥伴幫忙參與遊戲，將這 <span>$N$</span><!-- Has MathJax --> 枚硬幣分給小夥伴玩。在最佳策略下，請問獲得獎品個數的期望值為何？</p>
<p>現在的目標要找到怎麼分，小夥伴個數不是問題，每一個小夥伴要拿多少枚硬幣是主要問題。定義 <code>dp[i][j]</code> 為投擲 <span>$i$</span><!-- Has MathJax --> 枚硬幣恰好 <span>$j$</span><!-- Has MathJax --> 枚正面的機率，遞推得到 <code>dp[i][j] = dp[i-1][j-1]*P + dp[i-1][j]*(1-P)</code>。由於大於等於 <span>$K$</span><!-- Has MathJax --> 枚只能獲得一份獎品，定義 <code>dpw[i]</code> 為投擲 <span>$i$</span><!-- Has MathJax --> 枚硬幣獲得一份獎品的期望值，遞推得到 <code>dpw[i] = sum(dp[i][j]), j &gt;= K</code>。</p>
<p>最後，定義 <code>dpw[i]</code> 為分配 <span>$i$</span><!-- Has MathJax --> 枚硬幣給小夥伴的最大期望值個數，得到 <code>dpw[i] = max(dpw[i-j]+dpv[j])</code>。每一步都是 <span>$\mathcal{O}(N^2)$</span><!-- Has MathJax -->，時間複雜度 <span>$\mathcal{O}(N^2)$</span><!-- Has MathJax -->。</p>
<h2 id="C-Snakes-and-Ladders"><a href="#C-Snakes-and-Ladders" class="headerlink" title="C. Snakes and Ladders"></a>C. Snakes and Ladders</h2><p>有一個奇怪的收藏家，收集很多梯子，每一個梯子位於水平位置 <span>$x_i$</span><!-- Has MathJax --> 高度為 <span>$H_i$</span><!-- Has MathJax -->，然而當地特有蛇種喜歡懸掛在兩個等高 <span>$H_p$</span><!-- Has MathJax --> 的梯子之間，並且兩個梯子中間的其餘梯子都滿足 <span>$H_r \le H_p$</span><!-- Has MathJax -->。若蛇懸掛在兩個距離 <span>$L$</span><!-- Has MathJax --> 的梯子之間，則需要餵養 <span>$L^2$</span><!-- Has MathJax --> 單位的飼料，請問飼主一天要餵多少單位的飼料。</p>
<p>搭配組合的數學計算，由於懸掛的組合保證中間不會有高於兩側，則可以用單調堆完成紀錄，由左而右依序加入梯子，在單調堆中維護梯子高度遞減的位置。由於等高的梯子個數需要合併，否則沒辦法計算 <span>$L$</span><!-- Has MathJax -->，為了計算 <span>$L^2$</span><!-- Has MathJax -->。當從左而右加入梯子時，往左找到合法的等高梯子，由於得知 <span>$\sum (X - x_i)^2$</span><!-- Has MathJax -->，把式子展開得到 <span>$nX^2 - 2X \sum x_i + \sum x_i^2$</span><!-- Has MathJax -->，因此需要對於每一個高度，要合併 <span>$\sum x_i$</span><!-- Has MathJax --> 和 <span>$\sum x_i^2$</span><!-- Has MathJax -->。</p>
<p>由於每一個元素至多 push 和 pop 一次，時間複雜度 <span>$\mathcal{O}(N)$</span><!-- Has MathJax -->。</p>
<h2 id="D-Costly-Labels"><a href="#D-Costly-Labels" class="headerlink" title="D. Costly Labels"></a>D. Costly Labels</h2><p>在一棵 <span>$N$</span><!-- Has MathJax --> 個節點的無根樹，每一個節點可填入 <span>$K$</span><!-- Has MathJax --> 種顏色，對於每一個節點填不同顏色都有不同花費，若一個節點 <span>$u$</span><!-- Has MathJax --> 的鄰居中有兩個以上節點顏色相同，則 <span>$u$</span><!-- Has MathJax --> 需要額外花費 <span>$P$</span><!-- Has MathJax --> 來維持平衡。請問著色的最少花費為何。</p>
<p>若不考慮額外花費 <span>$P$</span><!-- Has MathJax --> 這一點，這題就是再簡單不過的貪心。從鴿籠原理知道，若一個點的鄰居大於 <span>$K$</span><!-- Has MathJax --> 個，則他必然存在兩個相同顏色的鄰居，一定需要花費 <span>$P$</span><!-- Has MathJax --> 維持平衡。由於圖給定一棵樹，自然而然地就設想到樹形 dp，維護子樹的最少花費進行合併。</p>
<p>由於子樹的根著色不用考慮，但方案合併要考慮父節點要著色的方案，因此得到狀態 <code>dp[u][c1][c2]</code> 節點 <span>$u$</span><!-- Has MathJax --> 著色 <span>$c_1$</span><!-- Has MathJax -->，<span>$u$</span><!-- Has MathJax --> 的父節點著色 <span>$c_2$</span><!-- Has MathJax -->。分成兩種狀態轉移，是否要花費 <span>$P$</span><!-- Has MathJax -->，若 <span>$u$</span><!-- Has MathJax --> 花費 <span>$P$</span><!-- Has MathJax -->，直接合併子樹 <span>$v$</span><!-- Has MathJax --> 的最小值 <code>dp[v][?][c1]</code>。若不花費 <span>$P$</span><!-- Has MathJax -->，勢必要讓子樹都填入不同顏色，由於每一個節點配對顏色花費都不同，最小化著色方案是標準的二分圖帶權匹配，可以用 KM 算法或者是最少費用流完成，只要排除預設 <span>$u$</span><!-- Has MathJax --> 的父節點顏色建圖即可，幸好不花費的數值都小於等於 <span>$K$</span><!-- Has MathJax -->，KM 算法提供 <span>$\mathcal{O}(K^3)$</span><!-- Has MathJax -->。整體的時間複雜度最慘 <span>$\mathcal{O}(N \times K^2 \times K^3)$</span><!-- Has MathJax -->。</p>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><h3 id="A-Boomerang-Decoration-1"><a href="#A-Boomerang-Decoration-1" class="headerlink" title="A. Boomerang Decoration"></a>A. Boomerang Decoration</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXS = <span class="number">131072</span>;</div><div class="line"><span class="keyword">char</span> sa[MAXS], sb[MAXS];</div><div class="line"><span class="keyword">int</span> Ldp[MAXS], Rdp[MAXS];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s %s"</span>, sa+<span class="number">1</span>, sb+<span class="number">1</span>);</div><div class="line">        </div><div class="line">        <span class="built_in">memset</span>(Ldp, <span class="number">0</span>, <span class="keyword">sizeof</span>(Ldp));</div><div class="line">        <span class="built_in">memset</span>(Rdp, <span class="number">0</span>, <span class="keyword">sizeof</span>(Rdp));</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> c;</div><div class="line">        c = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (sb[i] != sb[i<span class="number">-1</span>])</div><div class="line">                c++;</div><div class="line">            <span class="keyword">if</span> (sa[i] != sb[i])</div><div class="line">                Ldp[i] = c;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                Ldp[i] = Ldp[i<span class="number">-1</span>];</div><div class="line">        &#125;</div><div class="line">        c = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n, j = <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--, j++) &#123;</div><div class="line">            <span class="keyword">if</span> (sb[i] != sb[i+<span class="number">1</span>])</div><div class="line">                c++;</div><div class="line">            <span class="keyword">if</span> (sa[i] != sb[i])</div><div class="line">                Rdp[j] = c;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                Rdp[j] = Rdp[j<span class="number">-1</span>];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> ret = n;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            ret = min(ret, max(Ldp[i], Rdp[n-i]));</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="B-Carnival-Coins-1"><a href="#B-Carnival-Coins-1" class="headerlink" title="B. Carnival Coins"></a>B. Carnival Coins</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4096</span>;</div><div class="line"><span class="keyword">double</span> dp[MAXN][MAXN], dpw[MAXN], dpv[MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> N, K;</div><div class="line">        <span class="keyword">double</span> P;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %lf"</span>, &amp;N, &amp;K, &amp;P);</div><div class="line">        <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= i; j++) &#123;</div><div class="line">                dp[i+<span class="number">1</span>][j] += dp[i][j] * (<span class="number">1</span>-P);</div><div class="line">                dp[i+<span class="number">1</span>][j+<span class="number">1</span>] += dp[i][j] * P;</div><div class="line">            &#125;</div><div class="line">            dpw[i] = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = K; j &lt;= i; j++)</div><div class="line">                dpw[i] += dp[i][j];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="built_in">memset</span>(dpv, <span class="number">0</span>, <span class="keyword">sizeof</span>(dpv));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= i; j++) &#123;</div><div class="line">                dpv[i] = max(dpv[i], dpw[j] + dpv[i-j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">double</span> ret = dpv[N];</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %.9lf\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="C-Snakes-and-Ladders-1"><a href="#C-Snakes-and-Ladders-1" class="headerlink" title="C. Snakes and Ladders"></a>C. Snakes and Ladders</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> MOD = <span class="number">1000000007</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">State</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> H;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> sum, sqsum, n;</div><div class="line">    State(<span class="keyword">int</span> H, <span class="keyword">long</span> <span class="keyword">long</span> sum = <span class="number">0</span>, </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> sqsum = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">long</span> n = <span class="number">0</span>):</div><div class="line">        H(H), sum(sum), sqsum(sqsum), n(n) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="keyword">int</span> n, x, h;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">std</span>::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; A;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;h);</div><div class="line">            A.push_back(make_pair(x, h));</div><div class="line">        &#125;</div><div class="line">        sort(A.begin(), A.end());</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</div><div class="line">        <span class="built_in">stack</span>&lt;State&gt; stk;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</div><div class="line">            <span class="keyword">while</span> (!stk.empty() &amp;&amp; stk.top().H &lt; A[i].second)</div><div class="line">                stk.pop();</div><div class="line">            <span class="keyword">if</span> (!stk.empty() &amp;&amp; stk.top().H == A[i].second) &#123;</div><div class="line">                State e = stk.top();</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> X = A[i].first;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> N = e.n;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> S = N*X%MOD * X%MOD;</div><div class="line">                S = (S - X*<span class="number">2</span>%MOD*e.sum%MOD + e.sqsum)%MOD;</div><div class="line">                e.sum = (e.sum + X)%MOD;</div><div class="line">                e.sqsum = (e.sqsum + X*X%MOD)%MOD;</div><div class="line">                e.n++;</div><div class="line">                ret = (ret + S)%MOD;</div><div class="line">                stk.pop(), stk.push(e);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">long</span> <span class="keyword">long</span> X = A[i].first;</div><div class="line">                stk.push(State(A[i].second, X, X*X%MOD, <span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        ret = (ret + MOD)%MOD;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="D-Costly-Labels-1"><a href="#D-Costly-Labels-1" class="headerlink" title="D. Costly Labels"></a>D. Costly Labels</h3><h4 id="版本-1"><a href="#版本-1" class="headerlink" title="版本 1"></a>版本 1</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">128</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1048576</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> x, y, cap;</div><div class="line">    <span class="keyword">int</span> cost;<span class="comment">// x-&gt;y, v</span></div><div class="line">    <span class="keyword">int</span> next;</div><div class="line">&#125; edge[MAXM];</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinCost</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> e, head[MAXN], pre[MAXN], record[MAXN], inq[MAXN];</div><div class="line">    <span class="keyword">int</span> dis[MAXN];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span> </span>&#123;</div><div class="line">        edge[e].x = x, edge[e].y = y, edge[e].cap = cap, edge[e].cost = cost;</div><div class="line">        edge[e].next = head[x], head[x] = e++;</div><div class="line">        edge[e].x = y, edge[e].y = x, edge[e].cap = <span class="number">0</span>, edge[e].cost = -cost;</div><div class="line">        edge[e].next = head[y], head[y] = e++;</div><div class="line">    &#125;</div><div class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mincost(<span class="keyword">int</span> s, <span class="keyword">int</span> t) &#123;</div><div class="line">        <span class="keyword">int</span> mncost = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> flow, totflow = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i, x, y;</div><div class="line">        <span class="keyword">while</span>(<span class="number">1</span>) &#123;</div><div class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">        		dis[i] = INF;</div><div class="line">            <span class="keyword">int</span> oo = dis[<span class="number">0</span>];</div><div class="line">            dis[s] = <span class="number">0</span>;</div><div class="line">            <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">            Q.push_front(s);</div><div class="line">            <span class="keyword">while</span>(!Q.empty()) &#123;</div><div class="line">                x = Q.front(), Q.pop_front();</div><div class="line">                inq[x] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span>(i = head[x]; i != <span class="number">-1</span>; i = edge[i].next) &#123;</div><div class="line">                    y = edge[i].y;</div><div class="line">                    <span class="keyword">if</span>(edge[i].cap &gt; <span class="number">0</span> &amp;&amp; dis[y] &gt; dis[x] + edge[i].cost) &#123;</div><div class="line">                        dis[y] = dis[x] + edge[i].cost;</div><div class="line">                        pre[y] = x, record[y] = i;</div><div class="line">                        <span class="keyword">if</span>(inq[y] == <span class="number">0</span>) &#123;</div><div class="line">                            inq[y] = <span class="number">1</span>;</div><div class="line">                            <span class="keyword">if</span>(Q.size() &amp;&amp; dis[Q.front()] &gt; dis[y])</div><div class="line">                                Q.push_front(y);</div><div class="line">                            <span class="keyword">else</span></div><div class="line">                                Q.push_back(y);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(dis[t] == oo)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            flow = <span class="number">0x3f3f3f3f</span>;</div><div class="line">            <span class="keyword">for</span>(x = t; x != s; x = pre[x]) &#123;</div><div class="line">                <span class="keyword">int</span> ri = record[x];</div><div class="line">                flow = min(flow, edge[ri].cap);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span>(x = t; x != s; x = pre[x]) &#123;</div><div class="line">                <span class="keyword">int</span> ri = record[x];</div><div class="line">                edge[ri].cap -= flow;</div><div class="line">                edge[ri^<span class="number">1</span>].cap += flow;</div><div class="line">                edge[ri^<span class="number">1</span>].cost = -edge[ri].cost;</div><div class="line">            &#125;</div><div class="line">            totflow += flow;</div><div class="line">            mncost += dis[t] * flow;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> make_pair(mncost, totflow);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    	<span class="keyword">this</span>-&gt;n = n;</div><div class="line">        e = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            head[i] = <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">&#125; g;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> N, K, P;</div><div class="line"><span class="keyword">int</span> costG[<span class="number">1024</span>][<span class="number">32</span>];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; treeG[<span class="number">1024</span>];</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">1024</span>][<span class="number">32</span>];	<span class="comment">// dp[subtree: u][color of u: c] = mincost, don't care penalty P</span></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dpv[<span class="number">1024</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">        dp[u][i] = costG[u][i];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : treeG[u]) &#123;</div><div class="line">        <span class="keyword">if</span> (v == p)	<span class="keyword">continue</span>;</div><div class="line">        dfs(v, u);</div><div class="line">        </div><div class="line">        <span class="keyword">int</span> cost = P;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;adj_v : treeG[v]) &#123;</div><div class="line">            <span class="keyword">if</span> (adj_v == u)	<span class="keyword">continue</span>;</div><div class="line">            cost += dpv[adj_v];</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (treeG[v].size() &gt; K) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">                dp[u][i] += cost;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="comment">// find disjoint-color by maximum weighted matching</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;	<span class="comment">// u-color</span></div><div class="line">                <span class="keyword">int</span> source = <span class="number">0</span>, sink = treeG[v].size()+K+<span class="number">1</span>;</div><div class="line">                g.init(treeG[v].size()+K+<span class="number">2</span>);</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">                    <span class="keyword">if</span> (j == i)	<span class="keyword">continue</span>;</div><div class="line">                    g.Addedge(treeG[v].size()+j+<span class="number">1</span>, sink, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; treeG[v].size(); j++) &#123;</div><div class="line">                    <span class="keyword">int</span> adj_v = treeG[v][j];</div><div class="line">                    <span class="keyword">if</span> (adj_v == u)	<span class="keyword">continue</span>;</div><div class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; K; k++) &#123;</div><div class="line">                        <span class="keyword">if</span> (k == i)	<span class="keyword">continue</span>;</div><div class="line">                        g.Addedge(j+<span class="number">1</span>, treeG[v].size()+k+<span class="number">1</span>, <span class="number">1</span>, dp[adj_v][k]);</div><div class="line">                    &#125;</div><div class="line">                    g.Addedge(source, j+<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">                &#125;</div><div class="line">                pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mm = g.mincost(source, sink);</div><div class="line">                dp[u][i] += min(cost, mm.first);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    dpv[u] = INT_MAX;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">        dpv[u] = min(dpv[u], dp[u][i]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">final</span><span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> cost = P;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;adj_v : treeG[v])</div><div class="line">        cost += dpv[adj_v];</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (treeG[v].size() &gt; K)</div><div class="line">        <span class="keyword">return</span> cost;</div><div class="line">    <span class="comment">// find disjoint-color by maximum weighted matching</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;	<span class="comment">// u-color</span></div><div class="line">        <span class="keyword">int</span> source = <span class="number">0</span>, sink = treeG[v].size() + K + <span class="number">1</span>;</div><div class="line">        g.init(treeG[v].size()+K+<span class="number">2</span>);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">            g.Addedge(j+treeG[v].size()+<span class="number">1</span>, sink, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; treeG[v].size(); j++) &#123;</div><div class="line">            <span class="keyword">int</span> adj_v = treeG[v][j];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; K; k++)</div><div class="line">                g.Addedge(j+<span class="number">1</span>, treeG[v].size()+k+<span class="number">1</span>, <span class="number">1</span>, dp[adj_v][k]);</div><div class="line">            g.Addedge(source, j+<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mm = g.mincost(source, sink);</div><div class="line">        cost = min(cost, mm.first);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> cost;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;	</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;K, &amp;P);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;costG[i][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</div><div class="line">            treeG[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            treeG[x].push_back(y);</div><div class="line">            treeG[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        dfs(<span class="number">1</span>, <span class="number">-1</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = INT_MAX;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">            ret = min(ret, dp[<span class="number">1</span>][i]);</div><div class="line">        ret += final(<span class="number">1</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="版本-2"><a href="#版本-2" class="headerlink" title="版本 2"></a>版本 2</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">128</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXM = <span class="number">1048576</span>;</div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></div><div class="line">    <span class="keyword">int</span> x, y, cap;</div><div class="line">    <span class="keyword">int</span> cost;<span class="comment">// x-&gt;y, v</span></div><div class="line">    <span class="keyword">int</span> next;</div><div class="line">&#125; edge[MAXM];</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinCost</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">int</span> e, head[MAXN], pre[MAXN], record[MAXN], inq[MAXN];</div><div class="line">    <span class="keyword">int</span> dis[MAXN];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Addedge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> cap, <span class="keyword">int</span> cost)</span> </span>&#123;</div><div class="line">        edge[e].x = x, edge[e].y = y, edge[e].cap = cap, edge[e].cost = cost;</div><div class="line">        edge[e].next = head[x], head[x] = e++;</div><div class="line">        edge[e].x = y, edge[e].y = x, edge[e].cap = <span class="number">0</span>, edge[e].cost = -cost;</div><div class="line">        edge[e].next = head[y], head[y] = e++;</div><div class="line">    &#125;</div><div class="line">    pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mincost(<span class="keyword">int</span> s, <span class="keyword">int</span> t) &#123;</div><div class="line">        <span class="keyword">int</span> mncost = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> flow, totflow = <span class="number">0</span>;</div><div class="line">        <span class="keyword">int</span> i, x, y;</div><div class="line">        <span class="keyword">while</span>(<span class="number">1</span>) &#123;</div><div class="line">        	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">        		dis[i] = INF;</div><div class="line">            <span class="keyword">int</span> oo = dis[<span class="number">0</span>];</div><div class="line">            dis[s] = <span class="number">0</span>;</div><div class="line">            <span class="built_in">deque</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">            Q.push_front(s);</div><div class="line">            <span class="keyword">while</span>(!Q.empty()) &#123;</div><div class="line">                x = Q.front(), Q.pop_front();</div><div class="line">                inq[x] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span>(i = head[x]; i != <span class="number">-1</span>; i = edge[i].next) &#123;</div><div class="line">                    y = edge[i].y;</div><div class="line">                    <span class="keyword">if</span>(edge[i].cap &gt; <span class="number">0</span> &amp;&amp; dis[y] &gt; dis[x] + edge[i].cost) &#123;</div><div class="line">                        dis[y] = dis[x] + edge[i].cost;</div><div class="line">                        pre[y] = x, record[y] = i;</div><div class="line">                        <span class="keyword">if</span>(inq[y] == <span class="number">0</span>) &#123;</div><div class="line">                            inq[y] = <span class="number">1</span>;</div><div class="line">                            <span class="keyword">if</span>(Q.size() &amp;&amp; dis[Q.front()] &gt; dis[y])</div><div class="line">                                Q.push_front(y);</div><div class="line">                            <span class="keyword">else</span></div><div class="line">                                Q.push_back(y);</div><div class="line">                        &#125;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span>(dis[t] == oo)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            flow = <span class="number">0x3f3f3f3f</span>;</div><div class="line">            <span class="keyword">for</span>(x = t; x != s; x = pre[x]) &#123;</div><div class="line">                <span class="keyword">int</span> ri = record[x];</div><div class="line">                flow = min(flow, edge[ri].cap);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">for</span>(x = t; x != s; x = pre[x]) &#123;</div><div class="line">                <span class="keyword">int</span> ri = record[x];</div><div class="line">                edge[ri].cap -= flow;</div><div class="line">                edge[ri^<span class="number">1</span>].cap += flow;</div><div class="line">                edge[ri^<span class="number">1</span>].cost = -edge[ri].cost;</div><div class="line">            &#125;</div><div class="line">            totflow += flow;</div><div class="line">            mncost += dis[t] * flow;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> make_pair(mncost, totflow);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</div><div class="line">    	<span class="keyword">this</span>-&gt;n = n;</div><div class="line">        e = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            head[i] = <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">&#125; g;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">int</span> N, K, P;</div><div class="line"><span class="keyword">int</span> costG[<span class="number">1024</span>][<span class="number">32</span>];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; treeG[<span class="number">1024</span>];</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dp[<span class="number">1024</span>][<span class="number">32</span>][<span class="number">32</span>];	<span class="comment">// dp[subtree: u][color of u: c][color of u'parent: c]</span></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> dpv[<span class="number">1024</span>][<span class="number">32</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u, <span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : treeG[u]) &#123;</div><div class="line">        <span class="keyword">if</span> (v == p)	<span class="keyword">continue</span>;</div><div class="line">        dfs(v, u);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">            <span class="keyword">int</span> cost = costG[u][i] + P;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> &amp;v : treeG[u]) &#123;</div><div class="line">                <span class="keyword">if</span> (v == p)	<span class="keyword">continue</span>;</div><div class="line">                cost += dpv[v][i];</div><div class="line">            &#125;</div><div class="line">            dp[u][i][j] = cost;</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> (treeG[u].size() &gt; K)</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">                </div><div class="line">            <span class="keyword">int</span> source = <span class="number">0</span>, sink = treeG[u].size()+K+<span class="number">1</span>;</div><div class="line">            g.init(treeG[u].size()+K+<span class="number">2</span>);</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; K; k++) &#123;</div><div class="line">                <span class="keyword">if</span> (k == j &amp;&amp; p != <span class="number">-1</span>)	<span class="keyword">continue</span>;	<span class="comment">// parent color</span></div><div class="line">                g.Addedge(treeG[u].size()+k+<span class="number">1</span>, sink, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">int</span> branch = <span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> it = <span class="number">0</span>; it &lt; treeG[u].size(); it++) &#123;</div><div class="line">                <span class="keyword">int</span> v = treeG[u][it];</div><div class="line">                <span class="keyword">if</span> (v == p)	<span class="keyword">continue</span>;</div><div class="line">                branch++;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; K; k++) &#123;</div><div class="line">                    <span class="keyword">if</span> (k == j &amp;&amp; p != <span class="number">-1</span>)	<span class="keyword">continue</span>;</div><div class="line">                    g.Addedge(it+<span class="number">1</span>, treeG[u].size()+k+<span class="number">1</span>, <span class="number">1</span>, dp[v][k][i]);</div><div class="line">                &#125;</div><div class="line">                g.Addedge(source, it+<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>);</div><div class="line">            &#125;</div><div class="line">            </div><div class="line">            pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mm = g.mincost(source, sink);</div><div class="line">            <span class="keyword">if</span> (mm.second != branch)</div><div class="line">                <span class="keyword">continue</span>;</div><div class="line">            dp[u][i][j] = min(dp[u][i][j], (<span class="keyword">long</span> <span class="keyword">long</span>) mm.first + costG[u][i]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++) &#123;</div><div class="line">        dpv[u][i] = INT_MAX;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++)</div><div class="line">            dpv[u][i] = min(dpv[u][i], dp[u][j][i]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> testcase, cases = <span class="number">0</span>;	</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;testcase);</div><div class="line">    <span class="keyword">while</span> (testcase--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d %d %d"</span>, &amp;N, &amp;K, &amp;P);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++) &#123;</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;costG[i][j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</div><div class="line">            treeG[i].clear();</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; i++) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%d %d"</span>, &amp;x, &amp;y);</div><div class="line">            treeG[x].push_back(y);</div><div class="line">            treeG[y].push_back(x);</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        dfs(<span class="number">1</span>, <span class="number">-1</span>);</div><div class="line">        </div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> ret = INT_MAX;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; K; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; K; j++)</div><div class="line">                ret = min(ret, dp[<span class="number">1</span>][i][j]);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case #%d: %lld\n"</span>, ++cases, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/categories/解題區/解題區-其他題目/page/2/">2</a><a class="page-number" href="/categories/解題區/解題區-其他題目/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/解題區-其他題目/page/5/">5</a><a class="extend next" rel="next" href="/categories/解題區/解題區-其他題目/page/2/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">37</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/其他/">其他</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">13</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">47</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/09/12/work/appreciation-letter/">
              
                <i class="icon-file-o"></i> 
              
            Shiny People 感謝</a>
          </li>
        
          <li>
            <a class="text" href="/2021/09/12/work/company-ghost-story-13/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 13</a>
          </li>
        
          <li>
            <a class="text" href="/2021/08/15/diary-202108/">
              
                <i class="icon-file-o"></i> 
              
            被預告要開始管人的我，今天開始學管理？</a>
          </li>
        
          <li>
            <a class="text" href="/2021/08/14/work/company-ghost-story-12/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 12</a>
          </li>
        
          <li>
            <a class="text" href="/2021/07/29/java/java-jni-tls-error-2/">
              
                <i class="icon-file-o"></i> 
              
            Java JNI GC Thread Error (EINVAL)</a>
          </li>
        
          <li>
            <a class="text" href="/2021/07/29/work/company-ghost-story-11/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 11</a>
          </li>
        
          <li>
            <a class="text" href="/2021/06/21/diary-202106/">
              
                <i class="icon-file-o"></i> 
              
            疫情下的工作變化</a>
          </li>
        
          <li>
            <a class="text" href="/2021/06/21/work/company-ghost-story-10/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 10</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/diary-202105/">
              
                <i class="icon-file-o"></i> 
              
            前思後想 新居落成</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-2/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 組合篇</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
        <ul>
          <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
        </ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>