<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 解題區 | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/解題區/page/11/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-zj-b434" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b434/" class="article-date">
  <time datetime="2015-07-07T00:00:31.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b434/">b434. 圖片的梯度</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b434/" data-id="ckpaivca500b5n8vnehpg7lbn" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b434/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>可以參考 <a href="http://ip.csie.ncu.edu.tw/course/course.htm">中央大學影像處理實驗室 課程 講義第八章 邊擷取</a></p>
<p>邊緣擷取可以靠相鄰像素的差異來判斷是否是邊緣，若顏色差異很大則表示是邊。然而圖片像素是不連續的離散點，因此沒有辦法利用微積分學到的微分來得精準，而是要採用差分 (減法)，至於遮罩要取多大是個問題，一般而言還會搭配降噪的矩陣來完成。</p>
<p>如 Prewitt operator、Sobel operator、Kirsch operator … 等，矩陣都有搭配降噪處理。之所以用矩陣表示，是為了讓 GPU 快速地計算數值。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">0 0 0 255 255 255</span><br><span class="line">255 255 255 255 255 255</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">255 255 255 0 0 0</span><br><span class="line">0 0 0 0 0 0</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>按照公式模擬即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IMAGE</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Pixel</span> &#123;</span></span><br><span class="line">        <span class="keyword">double</span> r, g, b, a;</span><br><span class="line">        <span class="built_in">Pixel</span>(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>, <span class="keyword">double</span> z = <span class="number">0</span>, <span class="keyword">double</span> w = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">r</span>(x), <span class="built_in">g</span>(y), <span class="built_in">b</span>(z), <span class="built_in">a</span>(w) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;r, &amp;g, &amp;b);</span><br><span class="line">        &#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>-(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r-x.r, g-x.g, b-x.b, a-x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>+(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r+x.r, g+x.g, b+x.b, a+x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r*x, g*x, b*x, a*x);</span><br><span class="line">    	&#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r/x, g/x, b/x, a/x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%d %d %d&quot;</span>, (<span class="keyword">int</span>)<span class="built_in">round</span>(r), (<span class="keyword">int</span>)<span class="built_in">round</span>(g), (<span class="keyword">int</span>)<span class="built_in">round</span>(b));</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> W, H;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">256</span>;</span><br><span class="line">    Pixel data[MAXN][MAXN];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;W, &amp;H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">Pixel <span class="title">pabs</span><span class="params">(Pixel x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Pixel</span>(<span class="built_in">fabs</span>(x.r), <span class="built_in">fabs</span>(x.g), <span class="built_in">fabs</span>(x.b));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">border</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++) &#123;</span><br><span class="line">                <span class="function">Pixel <span class="title">dx</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span>, <span class="title">dy</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                <span class="keyword">if</span> (i+<span class="number">1</span> &lt; H)</span><br><span class="line">                    dx = data[i+<span class="number">1</span>][j] - data[i][j];</span><br><span class="line">                <span class="keyword">if</span> (j+<span class="number">1</span> &lt; W)</span><br><span class="line">                    dy = data[i][j+<span class="number">1</span>] - data[i][j];</span><br><span class="line">                dx = <span class="built_in">pabs</span>(dx), dy = <span class="built_in">pabs</span>(dy);</span><br><span class="line">                data[i][j] = (dx + dy)/<span class="number">2.0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, W, H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">print</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j == W<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; test;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    test.<span class="built_in">read</span>();</span><br><span class="line">    test.<span class="built_in">border</span>();</span><br><span class="line">    test.<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b427" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b427/" class="article-date">
  <time datetime="2015-07-07T00:00:25.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b427/">b427. 漸層色彩</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b427/" data-id="ckpaivca400ayn8vn9ykkfnz6" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b427/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>給予兩個顏色的像素，在一張空白影像中使用漸層效果。</p>
<ul>
<li>水平由左到右的漸層</li>
<li>從中心點擴散的漸層</li>
</ul>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3 3 0 0 0 0 255 255 255 255 255</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3 3</span><br><span class="line">0 0 0 255 128 128 128 255 255 255 255 255</span><br><span class="line">0 0 0 255 128 128 128 255 255 255 255 255</span><br><span class="line">0 0 0 255 128 128 128 255 255 255 255 255</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>線性內插，特別小心中心點 (x, y) 會是一個浮點數情況。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IMAGE</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Pixel</span> &#123;</span></span><br><span class="line">        <span class="keyword">double</span> r, g, b, a;</span><br><span class="line">        <span class="built_in">Pixel</span>(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>, <span class="keyword">double</span> z = <span class="number">0</span>, <span class="keyword">double</span> w = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">r</span>(x), <span class="built_in">g</span>(y), <span class="built_in">b</span>(z), <span class="built_in">a</span>(w) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf %lf&quot;</span>, &amp;r, &amp;g, &amp;b, &amp;a);</span><br><span class="line">        &#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>-(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r-x.r, g-x.g, b-x.b, a-x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>+(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r+x.r, g+x.g, b+x.b, a+x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r*x, g*x, b*x, a*x);</span><br><span class="line">    	&#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r/x, g/x, b/x, a/x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, (<span class="keyword">int</span>)<span class="built_in">round</span>(r), (<span class="keyword">int</span>)<span class="built_in">round</span>(g), (<span class="keyword">int</span>)<span class="built_in">round</span>(b), (<span class="keyword">int</span>)<span class="built_in">round</span>(a));</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> W, H;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">300</span>;</span><br><span class="line">    Pixel data[MAXN][MAXN];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;W, &amp;H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">alloc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> TYPE;</span><br><span class="line">        Pixel st, ed;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;W, &amp;H, &amp;TYPE);</span><br><span class="line">        st.<span class="built_in">read</span>(), ed.<span class="built_in">read</span>();</span><br><span class="line">        <span class="built_in">gradient</span>(st, ed, TYPE);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">gradient</span><span class="params">(Pixel st, Pixel ed, <span class="keyword">int</span> TYPE)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (TYPE != <span class="number">0</span> &amp;&amp; TYPE != <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (TYPE == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++) </span><br><span class="line">                    data[i][j] = W<span class="number">-1</span> ? st + (ed - st) * j / (W<span class="number">-1</span>) : st;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">double</span> cx = (H<span class="number">-1</span>)/<span class="number">2.0</span>, cy = (W<span class="number">-1</span>)/<span class="number">2.0</span>;</span><br><span class="line">            <span class="keyword">double</span> cr = <span class="built_in">hypot</span>(cx, cy);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                    data[i][j] = cr ? st + (ed - st) * <span class="built_in">hypot</span>(i-cx, j-cy) / cr : st;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, W, H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">print</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j == W<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; test;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    test.<span class="built_in">alloc</span>();</span><br><span class="line">    test.<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b426" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b426/" class="article-date">
  <time datetime="2015-07-06T23:55:27.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b426/">b426. 宇宙光明體</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b426/" data-id="ckpaivca300axn8vn2fzwbyyv" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b426/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>模擬兩張圖片的合成。</p>
<p>將前景圖片疊在背景圖片之上，按照權重比例來融合重疊部分得像素。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0 0 0.5</span><br><span class="line">1 1</span><br><span class="line">255 255 255</span><br><span class="line">1 1</span><br><span class="line">0 0 0</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 1</span><br><span class="line">128 128 128</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><blockquote>
<p>原來是宇宙光明體，還以為是宇宙大覺者呢。</p>
</blockquote>
<p>按照公式純模擬即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">0</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IMAGE</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Pixel</span> &#123;</span></span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> r, g, b, a;</span><br><span class="line">        <span class="built_in">Pixel</span>(<span class="keyword">long</span> <span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> y = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> z = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> w = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">r</span>(x), <span class="built_in">g</span>(y), <span class="built_in">b</span>(z), <span class="built_in">a</span>(w) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> p1, p2, p3;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;p1, &amp;p2, &amp;p3);</span><br><span class="line">            r = p1, g = p2, b = p3;</span><br><span class="line">        &#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>-(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r-x.r, g-x.g, b-x.b, a-x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>+(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r+x.r, g+x.g, b+x.b, a+x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r*x, g*x, b*x, a*x);</span><br><span class="line">    	&#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r/x, g/x, b/x, a/x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    		<span class="keyword">double</span> p1 = r, p2 = g, p3 = b, p4 = a;</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%.0lf %.0lf %.0lf&quot;</span>, p1 + eps, p2 + eps, p3 + eps);</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> W, H;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">256</span>;</span><br><span class="line">    Pixel data[MAXN][MAXN];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;W, &amp;H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">read</span>();</span><br><span class="line">    &#125;	</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(IMAGE &amp;other, <span class="keyword">int</span> X, <span class="keyword">int</span> Y, <span class="keyword">double</span> OPACITY)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; other.H &amp;&amp; i+X &lt; H; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; other.W &amp;&amp; j+Y &lt; W; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (i+X &gt;= <span class="number">0</span> &amp;&amp; j+Y &gt;= <span class="number">0</span>)</span><br><span class="line">                    data[i+X][j+Y] = other.data[i][j] * OPACITY + data[i+X][j+Y] * (<span class="number">1</span> - OPACITY);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, W, H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">print</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j == W<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; back, fore;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> OPACITY;</span><br><span class="line">    <span class="keyword">int</span> X, Y;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %lf&quot;</span>, &amp;X, &amp;Y, &amp;OPACITY);</span><br><span class="line">    fore.<span class="built_in">read</span>();</span><br><span class="line">    back.<span class="built_in">read</span>();</span><br><span class="line">    back.<span class="built_in">add</span>(fore, Y, X, OPACITY);</span><br><span class="line">    back.<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b425" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b425/" class="article-date">
  <time datetime="2015-07-06T23:48:11.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b425/">b425. 抽菸動作 請勿模仿</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b425/" data-id="ckpaivca300awn8vnc4c60o9y" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b425/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>替影像打上馬賽克效果，馬賽克效果是把區域內部的每一個像素改變，改變的方法為從舊的圖像中，搜索以其為中心的 11 x 11 方形內部所有像素的平均。</p>
<p>這一題要馬賽克區域為圓形，接著找到方形內部的像素平均即可。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0 1 2</span><br><span class="line">1 2</span><br><span class="line">1 2 3</span><br><span class="line">4 5 6</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1 2</span><br><span class="line">3 4 5</span><br><span class="line">3 4 5</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>馬賽克的方案也許還有其他，從這裡可以知道平均造就出新的像素顏色。那麼可以列出方程式，所謂的解馬賽克估計也是去找線性聯立方程組，利用高斯消去法就能求解，可惜的是會有多組解的情況吧。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IMAGE</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Pixel</span> &#123;</span></span><br><span class="line">        <span class="keyword">double</span> r, g, b, a;</span><br><span class="line">        <span class="built_in">Pixel</span>(<span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">double</span> y = <span class="number">0</span>, <span class="keyword">double</span> z = <span class="number">0</span>, <span class="keyword">double</span> w = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">r</span>(x), <span class="built_in">g</span>(y), <span class="built_in">b</span>(z), <span class="built_in">a</span>(w) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %lf&quot;</span>, &amp;r, &amp;g, &amp;b);</span><br><span class="line">        &#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>-(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r-x.r, g-x.g, b-x.b, a-x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>+(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r+x.r, g+x.g, b+x.b, a+x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r*x, g*x, b*x, a*x);</span><br><span class="line">    	&#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r/x, g/x, b/x, a/x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%d %d %d&quot;</span>, (<span class="keyword">int</span>)<span class="built_in">round</span>(r), (<span class="keyword">int</span>)<span class="built_in">round</span>(g), (<span class="keyword">int</span>)<span class="built_in">round</span>(b));</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> W, H;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">300</span>;</span><br><span class="line">    Pixel data[MAXN][MAXN], tmp[MAXN][MAXN];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;W, &amp;H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">blur</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> X, <span class="keyword">long</span> <span class="keyword">long</span> Y, <span class="keyword">long</span> <span class="keyword">long</span> R)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (R &lt; <span class="number">0</span>)	<span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((i-X)*(i-X) + (j-Y)*(j-Y) &lt;= R*R) &#123;</span><br><span class="line">                    <span class="function">Pixel <span class="title">B</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">                    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> a = <span class="number">-5</span>; a &lt;= <span class="number">5</span>; a++) &#123;</span><br><span class="line">                        <span class="keyword">for</span> (<span class="keyword">int</span> b = <span class="number">-5</span>; b &lt;= <span class="number">5</span>; b++) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (i+a &lt; H &amp;&amp; j+b &lt; W &amp;&amp; i+a &gt;= <span class="number">0</span> &amp;&amp; j+b &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                                B = B + data[i+a][j+b];</span><br><span class="line">                                cnt++;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    tmp[i][j] = B / cnt;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    tmp[i][j] = data[i][j];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j] = tmp[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, W, H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">print</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j == W<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; test;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> X, Y, R;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld %lld %lld&quot;</span>, &amp;X, &amp;Y, &amp;R);</span><br><span class="line">    test.<span class="built_in">read</span>();</span><br><span class="line">    test.<span class="built_in">blur</span>(Y, X, R);</span><br><span class="line">    test.<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b424" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b424/" class="article-date">
  <time datetime="2015-07-06T23:18:48.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b424/">b424. 圖片縮放</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b424/" data-id="ckpaivca300avn8vnhrzpav05" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b424/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>此題有精準度誤差，未能提交成功。</p>
<p>進行圖片縮放，有兩種方案來補足缺失或者是簡化的像素計算。不管縮放如何，在新的坐標系的點可以對應到舊坐標系中，並且會有四個像素點 (正方形) 包含這個對應點，有可能會有所缺失，但至少包含一個點。</p>
<ul>
<li>最近鄰點法 (nearest-neighbor approach)<br>找正方形中哪個點最靠近新的對應點，就令其像素顏色等於最靠近的點。</li>
<li>雙線性內插 (bi-linear interpolation)<br>顏色由相鄰四個點決定，使用雙性內插來得到新的像素顏色。</li>
</ul>
<p>特別注意，雖然邊長根據縮放四捨五入，但在計算時先不考慮最終結果的長寬，否則縮放倍率也會跟著四捨五入。</p>
<p>可以參考 <a href="http://ip.csie.ncu.edu.tw/course/course.htm">中央大學影像處理實驗室 課程 講義第二章</a></p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2 2 0</span><br><span class="line">2 1 </span><br><span class="line">1 2 3 255 4 5 6 255 </span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">4 2</span><br><span class="line">1 2 3 255 3 4 5 255 4 5 6 255 4 5 6 255</span><br><span class="line">1 2 3 255 3 4 5 255 4 5 6 255 4 5 6 255</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>除了陷阱的邊長四捨五入外，精準度根據雙性內插影響。</p>
<p>雙線性內插可以由下列兩種方案，或者還有其他的</p>
<ul>
<li>兩次 lerp 插值，先水平後垂直或者先垂直後水平</li>
<li>特別的 <span>$f(x, y) = (1-a)(1-b) g(j, k) + a(1-b) g(j+1, k) + (1-a) b g(j, k+1) + a b g(j+1, k+1)$</span><!-- Has MathJax --></li>
</ul>
<p>特別發現到，第二種方案沒有用到除法運算，但乘法運算的優先順序會影響到誤差。然而我的代碼是混用造成難以評估的誤差。關於第二種方案的坐標系，可以參考講義中的圖示。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-18</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IMAGE</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Pixel</span> &#123;</span></span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">double</span> r, g, b, a;</span><br><span class="line">        <span class="built_in">Pixel</span>(<span class="keyword">long</span> <span class="keyword">double</span> x = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> y = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> z = <span class="number">0</span>, <span class="keyword">long</span> <span class="keyword">double</span> w = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">r</span>(x), <span class="built_in">g</span>(y), <span class="built_in">b</span>(z), <span class="built_in">a</span>(w) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">int</span> p1, p2, p3, p4;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;p1, &amp;p2, &amp;p3, &amp;p4);</span><br><span class="line">            r = p1, g = p2, b = p3, a = p4;</span><br><span class="line">        &#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>-(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r-x.r, g-x.g, b-x.b, a-x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>+(<span class="keyword">const</span> Pixel &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r+x.r, g+x.g, b+x.b, a+x.a);</span><br><span class="line">    	&#125;</span><br><span class="line">    	Pixel <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r*x, g*x, b*x, a*x);</span><br><span class="line">    	&#125;</span><br><span class="line">        Pixel <span class="keyword">operator</span>/(<span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> x) <span class="keyword">const</span> &#123;</span><br><span class="line">        	<span class="keyword">return</span> <span class="built_in">Pixel</span>(r/x, g/x, b/x, a/x);</span><br><span class="line">    	&#125;</span><br><span class="line">    	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    		<span class="keyword">double</span> p1 = r, p2 = g, p3 = b, p4 = a;</span><br><span class="line">    		<span class="built_in">printf</span>(<span class="string">&quot;%.0lf %.0lf %.0lf %.0lf&quot;</span>, p1 + eps, p2 + eps, p3 + eps, p4 + eps);</span><br><span class="line">    	&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">int</span> W, H;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">512</span>;</span><br><span class="line">    Pixel data[MAXN][MAXN], tmp[MAXN][MAXN];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;W, &amp;H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">read</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">isValid</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &gt;= <span class="number">0</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; x &lt; H &amp;&amp; y &lt; W;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">resize</span><span class="params">(<span class="keyword">long</span> <span class="keyword">double</span> SX, <span class="keyword">long</span> <span class="keyword">double</span> SY, <span class="keyword">int</span> trans = <span class="number">0</span>)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (trans != <span class="number">0</span> &amp;&amp; trans != <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> ;			</span><br><span class="line">        <span class="keyword">int</span> rW = (<span class="keyword">int</span>) <span class="built_in">round</span>(SX * W);</span><br><span class="line">        <span class="keyword">int</span> rH = (<span class="keyword">int</span>) <span class="built_in">round</span>(SY * H);</span><br><span class="line">        <span class="keyword">if</span> (rW &gt; <span class="number">256</span> || rH &gt; <span class="number">256</span> || rW &lt;= <span class="number">0</span> || rH &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rH; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; rW; j++) &#123;</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">double</span> x = i / SY;</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">double</span> y = j / SX;</span><br><span class="line">                <span class="keyword">int</span> lx, rx, ly, ry;</span><br><span class="line">                lx = <span class="built_in">floor</span>(x), rx = <span class="built_in">ceil</span>(x);</span><br><span class="line">                ly = <span class="built_in">floor</span>(y), ry = <span class="built_in">ceil</span>(y);</span><br><span class="line">                </span><br><span class="line">                Pixel v[] = &#123;data[lx][ly], data[lx][ry], data[rx][ly], data[rx][ry]&#125;;</span><br><span class="line">                <span class="keyword">int</span> px[] = &#123;lx, lx, rx, rx&#125;;</span><br><span class="line">                <span class="keyword">int</span> py[] = &#123;ly, ry, ly, ry&#125;;</span><br><span class="line">                <span class="keyword">if</span> (trans == <span class="number">0</span>) &#123;</span><br><span class="line">                    Pixel t1, t2;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">isValid</span>(px[<span class="number">0</span>], py[<span class="number">0</span>]) &amp;&amp; <span class="built_in">isValid</span>(px[<span class="number">1</span>], py[<span class="number">1</span>]) &amp;&amp; <span class="built_in">isValid</span>(px[<span class="number">2</span>], py[<span class="number">2</span>]) &amp;&amp; <span class="built_in">isValid</span>(px[<span class="number">3</span>], py[<span class="number">3</span>])) &#123;</span><br><span class="line">                        <span class="keyword">long</span> <span class="keyword">double</span> a = x - lx, b = y - ly;</span><br><span class="line">                        tmp[i][j] = v[<span class="number">0</span>] * (<span class="number">1</span> - a) * (<span class="number">1</span> - b) + v[<span class="number">2</span>] * a * (<span class="number">1</span> - b)</span><br><span class="line">                                    + v[<span class="number">1</span>] * (<span class="number">1</span> - a) * b + v[<span class="number">3</span>] * a * b;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isValid</span>(px[<span class="number">0</span>], py[<span class="number">0</span>]) &amp;&amp; <span class="built_in">isValid</span>(px[<span class="number">2</span>], py[<span class="number">2</span>])) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (rx != lx)</span><br><span class="line">                            tmp[i][j] = v[<span class="number">0</span>] + (v[<span class="number">2</span>] - v[<span class="number">0</span>]) * ((x - lx) / (rx - lx));</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            tmp[i][j] = v[<span class="number">0</span>];</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isValid</span>(px[<span class="number">0</span>], py[<span class="number">0</span>]) &amp;&amp; <span class="built_in">isValid</span>(px[<span class="number">1</span>], py[<span class="number">1</span>])) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (ry != ly)</span><br><span class="line">                            tmp[i][j] = v[<span class="number">0</span>] + (v[<span class="number">1</span>] - v[<span class="number">0</span>]) * ((y - ly) / (ry - ly));</span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            tmp[i][j] = v[<span class="number">0</span>];</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isValid</span>(px[<span class="number">0</span>], py[<span class="number">0</span>])) &#123;</span><br><span class="line">                        tmp[i][j] = v[<span class="number">0</span>];</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="built_in">puts</span>(<span class="string">&quot;WTF&quot;</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">int</span> c = <span class="number">-1</span>;</span><br><span class="line">                    <span class="keyword">double</span> mndist;</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) &#123;</span><br><span class="line">                        <span class="keyword">if</span> (!<span class="built_in">isValid</span>(px[k], py[k]))</span><br><span class="line">                            <span class="keyword">continue</span>;</span><br><span class="line">                        <span class="keyword">double</span> d = (x-px[k])*(x-px[k])+(y-py[k])*(y-py[k]);</span><br><span class="line">                        <span class="keyword">if</span> (c == <span class="number">-1</span> || mndist &gt; d)</span><br><span class="line">                            c = k, mndist = d;</span><br><span class="line">                    &#125;</span><br><span class="line">                    tmp[i][j] = data[px[c]][py[c]];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        W = rW, H = rH;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j] = tmp[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, W, H);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; H; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; W; j++)</span><br><span class="line">                data[i][j].<span class="built_in">print</span>(), <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, j == W<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; test;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> X, Y;</span><br><span class="line">    <span class="keyword">int</span> TYPE;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lf %lf %d&quot;</span>, &amp;X, &amp;Y, &amp;TYPE);</span><br><span class="line">    test.<span class="built_in">read</span>();</span><br><span class="line">    test.<span class="built_in">resize</span>(X, Y, TYPE);</span><br><span class="line">    test.<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b423" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b423/" class="article-date">
  <time datetime="2015-07-06T23:18:35.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b423/">b423. 魔術橡皮擦</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b423/" data-id="ckpaivca300aun8vn7m5j8xfg" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b423/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>提供影像去背、相鄰去色兩種方案。</p>
<ul>
<li>去背對整張影像找像素差小於某一個範圍內，就將其 alpha 值設成 0。</li>
<li>相鄰去色對鄰近四個方向上下左右進行搜索，將像素差低於某個閥值的都加入到集合中進行 alpha 值設成 0。</li>
</ul>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0 0 0 0</span><br><span class="line">3 2</span><br><span class="line">1 2 3 255 4 5 6 255 7 8 9 255</span><br><span class="line">10 11 12 255 13 14 15 255 16 17 18 255</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3 2</span><br><span class="line">1 2 3 0 4 5 6 255 7 8 9 255</span><br><span class="line">10 11 12 255 13 14 15 255 16 17 18 255</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">int</span> X, Y, TYPE, DIFF;</span><br><span class="line"><span class="keyword">namespace</span> Image &#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">256</span>;</span><br><span class="line">    <span class="keyword">int</span> n, m, rgba[MAXN][MAXN][<span class="number">4</span>], used[MAXN][MAXN] = &#123;&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">RGB_diff</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (rgba[x][y][<span class="number">0</span>]-rgba[a][b][<span class="number">0</span>])*(rgba[x][y][<span class="number">0</span>]-rgba[a][b][<span class="number">0</span>])+</span><br><span class="line">                (rgba[x][y][<span class="number">1</span>]-rgba[a][b][<span class="number">1</span>])*(rgba[x][y][<span class="number">1</span>]-rgba[a][b][<span class="number">1</span>])+</span><br><span class="line">                (rgba[x][y][<span class="number">2</span>]-rgba[a][b][<span class="number">2</span>])*(rgba[x][y][<span class="number">2</span>]-rgba[a][b][<span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">gTransparent</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">long</span> <span class="keyword">long</span> diff)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt;= m || y &gt;= n || diff &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        diff = diff * diff;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">RGB_diff</span>(x, y, i, j) &lt;= diff)</span><br><span class="line">                    rgba[i][j][<span class="number">3</span>] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">lTransparent</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> ox, <span class="keyword">int</span> oy, <span class="keyword">long</span> <span class="keyword">long</span> diff)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (ox &lt; <span class="number">0</span> || oy &lt; <span class="number">0</span> || ox &gt;= m || oy &gt;= n || diff &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> dx[] = &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">-1</span>&#125;;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> dy[] = &#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">if</span> (x &lt; <span class="number">0</span> || y &lt; <span class="number">0</span> || x &gt;= m || y &gt;= n)</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">RGB_diff</span>(x, y, ox, oy) &gt; diff * diff || used[x][y])</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        rgba[x][y][<span class="number">3</span>] = <span class="number">0</span>, used[x][y] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">            <span class="built_in">lTransparent</span>(x+dx[i], y+dy[i], ox, oy, diff);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++)</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d%c&quot;</span>, rgba[i][j][<span class="number">0</span>], rgba[i][j][<span class="number">1</span>], rgba[i][j][<span class="number">2</span>], rgba[i][j][<span class="number">3</span>], j == n<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d %d&quot;</span>, &amp;X, &amp;Y, &amp;TYPE, &amp;DIFF);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;Image::n, &amp;Image::m);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Image::m; i++)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; Image::n; j++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;Image::rgba[i][j][k]);</span><br><span class="line">    <span class="built_in">swap</span>(X, Y);</span><br><span class="line">    <span class="keyword">if</span> (TYPE == <span class="number">0</span>)</span><br><span class="line">        Image::<span class="built_in">gTransparent</span>(X, Y, DIFF);</span><br><span class="line">    <span class="keyword">if</span> (TYPE == <span class="number">1</span>)</span><br><span class="line">        Image::<span class="built_in">lTransparent</span>(X, Y, X, Y, DIFF);</span><br><span class="line">    Image::<span class="built_in">print</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b422" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b422/" class="article-date">
  <time datetime="2015-07-06T23:18:31.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b422/">b422. Colorful Life and Monochromatic Life</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b422/" data-id="ckpaivca200atn8vnddzo7h3v" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b422/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/影像處理/">影像處理</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>將一張 rgb 表示的彩色影像變成灰階影像。</p>
<p>套用公式 <code>round((r + g + b)/3)</code> 得到新的像素色彩。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3 2</span><br><span class="line">1 2 3 4 5 6 7 8 9</span><br><span class="line">10 11 12 13 14 15 16 17 18</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">3 2</span><br><span class="line">2 2 2 5 5 5 8 8 8</span><br><span class="line">11 11 11 14 14 14 17 17 17</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, n, m);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> r, g, b, w;</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;r, &amp;g, &amp;b);</span><br><span class="line">                w = (<span class="keyword">int</span>) <span class="built_in">round</span>((r + g + b)/<span class="number">3.0</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d%c&quot;</span>, w, w, w, j == n<span class="number">-1</span> ? <span class="string">&#x27;\n&#x27;</span> : <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b419" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/07/zj-b419/" class="article-date">
  <time datetime="2015-07-06T22:24:18.000Z" itemprop="datePublished">2015-07-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/07/zj-b419/">b419. 公平的硬幣</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/07/zj-b419/" data-id="ckpaivca200asn8vn53exegyz" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/07/zj-b419/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/數值積分/">數值積分</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/機率/">機率</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/自然分布/">自然分布</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/辛普森積分/">辛普森積分</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/近似公式/">近似公式</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>一天，liouzhou_101 去打印店裏打印了幾張複習資料，花了 4 毛錢，他給了店主1張塊錢的鈔票，結果店主補了他兩枚硬幣，一個5毛錢，一個 1 毛錢。</p>
<p>在走回宿舍的途中，liouzhou_101 一直在想一個問題，5 毛錢的硬幣和 1 毛錢的硬幣哪個更公平？所謂公平，就是指將一枚硬幣拋擲 1 次，他正面朝上的概率是 12，反面朝上的概率也是 12。</p>
<p>結果他一會去就把1毛錢的硬幣拋了 1000 次， 記下來有 531 次正面朝上。然後他突然說道：“這硬幣不公平！！！”</p>
<p>真的不公平嗎？他希望你計算一下出現這種情況的概率。 </p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">10 5 5</span><br><span class="line">20 6 8</span><br><span class="line">100 40 60</span><br><span class="line">1000 531 531</span><br><span class="line">5000 2345 2456</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0.2461</span><br><span class="line">0.2310</span><br><span class="line">0.9648</span><br><span class="line">0.0037</span><br><span class="line">0.1093</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>跟柳柳州互相出題目，已經來到了第 n 天，儘管我出的都是垃圾跟搬運題目，一出題被電得好愉悅，出在多的垃圾題都電不到柳柳州。</p>
<p>在擲硬幣找區間次數 <span>$[a, b]$</span><!-- Has MathJax --> 的機率，由於是離散的統計上就只能推組合數學，但又不是曲棍棒的模型 (Hockey Stick Pattern)，算了先手動窮舉，用 Stirling’s formula 計算組合，後來發現有幾組數據有問題。</p>
<p>當 n 太大的時候，機率分布就相當稀疏，直接套用數值積分，直接去積分自然分布得到公式稍微困難，利用 simpson 或者是 romberg 去解決，但這樣還會有一個問題，只有在平均值的部分機率非常高 (類似離散的 00000100000)，導致自適應辛普森積分會判斷錯誤，提醒剖半積分後測資就正確了不少。似乎合作出了一個可怕的題目，儘管如此，還是得用 mathlab 或者是 wolframalpha 來協助測資的檢驗，剩下的部分就交給柳柳州了。</p>
<p>關於自然分布 (normal distribution)：</p>
<ul>
<li>骰子擲 <span>$n$</span><!-- Has MathJax --> 次，命中的機率 <span>$p = 1/2$</span><!-- Has MathJax --></li>
<li>期望值 <span>$\mu = np = n/2$</span><!-- Has MathJax --></li>
<li>標準差為 <span>$\sigma = \sqrt{np(1-p)} = \sqrt{n/4}$</span><!-- Has MathJax -->。</li>
</ul>
<p>期望值 <span>$E[x] = \sum_{k=1}^{n} k \binom{n}{k} p^k (1-p)^{n-k}$</span><!-- Has MathJax -->，消階層之後提出，計算後得到 <span>$E[x] = np$</span><!-- Has MathJax -->。</p>
<p>而標準差 <span>$\sigma$</span><!-- Has MathJax --> 先從變異數下手</p>
<ul>
<li>定義： <span>$Var[x] = E[(x - \mu)^2] = \sum (x - \mu)^2 P[X = x]$</span><!-- Has MathJax --></li>
<li>拆解步驟 1： <span>$Var[x] = \sum (x^2 - 2 \mu x + \mu^{2}) P[X = x]$</span><!-- Has MathJax --></li>
<li>拆解步驟 2： <span>$Var[x] = E[x^2] - 2 E[x] E[x] + E[x] E[x] = E[x^2] - E[x]^2$</span><!-- Has MathJax --></li>
<li>拆解步驟 3： <span>$E[x^2] = E[x(x-1)] + E[x] = n(n-1)p^2 + np$</span><!-- Has MathJax --></li>
<li>拆解步驟 4： <span>$Var[x] = np(1-p)$</span><!-- Has MathJax --></li>
</ul>
<p>接下來直接帶入自然分布的公式，參數 <span>$(\mu, \sigma)$</span><!-- Has MathJax -->，特別小心使用辛普森積分 <span>$[a, b]$</span><!-- Has MathJax --> 時，由於問題是離散的，要改變成 <span>$[a - 0.5, b + 0.5]$</span><!-- Has MathJax -->，防止 <span>$a = b$</span><!-- Has MathJax --> 時造成積分錯誤。</p>
<p>特別感謝學弟 firejox 的數學指導。</p>
<p>不久之後，firejox 說道內建函數 <code>erf()</code> 可以解決積分問題，詳見 <a href="https://en.wikipedia.org/wiki/Error_function">wiki Gauss error function</a>，因此這一題也可以不寫辛普森積分，套用內建函數在不到 10 行內解決此題。</p>
<h3 id="暴力檢測"><a href="#暴力檢測" class="headerlink" title="暴力檢測"></a>暴力檢測</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>), e = <span class="built_in">exp</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100001</span>;</span><br><span class="line"><span class="keyword">double</span> f[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">stirling</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; MAXN)</span><br><span class="line">        <span class="keyword">return</span> f[n];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">log2</span>(<span class="built_in">sqrt</span>(<span class="number">2</span>*PI*n)) + n*<span class="built_in">log2</span>(n/e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">logC</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">stirling</span>(n) - <span class="built_in">stirling</span>(n - m) - <span class="built_in">stirling</span>(m);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">        f[i] = <span class="built_in">log2</span>(i) + f[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">int</span> n, a, b;</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;a, &amp;b) == <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">double</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = a; i &lt;= b; i++)</span><br><span class="line">            ret += <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">logC</span>(n, i) - <span class="built_in">log2</span>(<span class="number">2</span>) * n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>, ret);</span><br><span class="line">        <span class="keyword">if</span> (++cases &gt; <span class="number">100</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="數值積分"><a href="#數值積分" class="headerlink" title="數值積分"></a>數值積分</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1</span>), e = <span class="built_in">exp</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1001</span>;</span><br><span class="line"><span class="keyword">double</span> f[MAXN];</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">stirling</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; MAXN)</span><br><span class="line">        <span class="keyword">return</span> f[n];</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">log2</span>(<span class="built_in">sqrt</span>(<span class="number">2</span>*PI*n)) + n*<span class="built_in">log2</span>(n/e);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">logC</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">stirling</span>(n) - <span class="built_in">stirling</span>(n - m) - <span class="built_in">stirling</span>(m);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SimpsonIntegral</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-6</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">double</span> sqr2pi = <span class="built_in">sqrt</span>(<span class="number">2</span> * pi);</span><br><span class="line">    <span class="keyword">double</span> mu, sigma; <span class="comment">// function coefficient</span></span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">f</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123; <span class="comment">// usually replace</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">exp</span>(-(<span class="built_in">pow</span>(x - mu, <span class="number">2</span>)/<span class="number">2.0</span>/sigma/sigma))/ sigma / sqr2pi;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setCoefficient</span><span class="params">(<span class="keyword">double</span> m, <span class="keyword">double</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;mu = m, <span class="keyword">this</span>-&gt;sigma = s;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">simpson</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> fa, <span class="keyword">double</span> fb, <span class="keyword">double</span> fab)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (fa + <span class="number">4</span> * fab + fb) * (b - a) / <span class="number">6.0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">integral</span><span class="params">(<span class="keyword">double</span> l, <span class="keyword">double</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">integral</span>(l, r, eps);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">integral</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c, <span class="keyword">double</span> eps, <span class="keyword">double</span> A, <span class="keyword">double</span> fa, <span class="keyword">double</span> fb, <span class="keyword">double</span> fc)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ab = (a + b)/<span class="number">2</span>, bc = (b + c)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> fab = <span class="built_in">f</span>(ab), fbc = <span class="built_in">f</span>(bc);</span><br><span class="line">        <span class="keyword">double</span> L = <span class="built_in">simpson</span>(a, b, fa, fb, fab), R = <span class="built_in">simpson</span>(b, c, fb, fc, fbc);</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(L + R - A) &lt;= <span class="number">15</span> * eps)</span><br><span class="line">            <span class="keyword">return</span> L + R + (L + R - A) / <span class="number">15.0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">integral</span>(a, ab, b, eps/<span class="number">2</span>, L, fa, fab, fb) + <span class="built_in">integral</span>(b, bc, c, eps/<span class="number">2</span>, R, fb, fbc, fc);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">integral</span><span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> eps)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> ab = (a + b) /<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">double</span> fa = <span class="built_in">f</span>(a), fb = <span class="built_in">f</span>(b), fab = <span class="built_in">f</span>(ab);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">integral</span>(a, ab, b, eps, <span class="built_in">simpson</span>(a, b, fa, fb, fab), fa, fab, fb);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; tool;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">binom</span><span class="params">(<span class="keyword">double</span> n, <span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> a1, b1;</span><br><span class="line">    <span class="keyword">double</span> d = <span class="built_in">sqrt</span>(n/<span class="number">2.0</span>);</span><br><span class="line">    a1 = <span class="number">0.5</span> * (<span class="number">1.0</span> + <span class="built_in">erf</span>((a - n/<span class="number">2.0</span> - <span class="number">0.5</span>) / d));</span><br><span class="line">    b1 = <span class="number">0.5</span> * (<span class="number">1.0</span> + <span class="built_in">erf</span>((b - n/<span class="number">2.0</span> + <span class="number">0.5</span>) / d));</span><br><span class="line">    <span class="keyword">return</span> b1 - a1;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; MAXN; i++)</span><br><span class="line">        f[i] = <span class="built_in">log2</span>(i) + f[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">int</span> n, a, b;</span><br><span class="line">    <span class="keyword">int</span> cases = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;n, &amp;a, &amp;b) == <span class="number">3</span>) &#123;</span><br><span class="line">        cases++;</span><br><span class="line">        <span class="keyword">if</span> (n &lt; MAXN) &#123;</span><br><span class="line">            <span class="keyword">double</span> ret = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = a; i &lt;= b; i++)</span><br><span class="line">                ret += <span class="built_in">pow</span>(<span class="number">2</span>, <span class="built_in">logC</span>(n, i) - <span class="built_in">log2</span>(<span class="number">2</span>) * n);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>, ret);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">//			tool.setCoefficient(n/2.0, sqrt(n/4.0));</span></span><br><span class="line"><span class="comment">//			double ret = 0, l = a - 0.5, r = b + 0.5;</span></span><br><span class="line"><span class="comment">//			if (r &lt; n/2.0 || l &gt; n/2.0)</span></span><br><span class="line"><span class="comment">//				ret = tool.integral(l, r);</span></span><br><span class="line"><span class="comment">//			else</span></span><br><span class="line"><span class="comment">//				ret = tool.integral(l, n/2.0) + tool.integral(n/2.0, r);</span></span><br><span class="line"><span class="comment">//			printf(&quot;%.4lf\n&quot;, ret);</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%.4lf\n&quot;</span>, <span class="built_in">binom</span>(n, a, b));</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b417" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/05/zj-b417/" class="article-date">
  <time datetime="2015-07-05T00:28:10.000Z" itemprop="datePublished">2015-07-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/05/zj-b417/">b417. 區間眾數</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/05/zj-b417/" data-id="ckpaivca200aqn8vnesdn4hf1" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/05/zj-b417/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分塊/">分塊</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/莫隊算法/">莫隊算法</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>大學上課是怎麼回事的呢？談論到學期成績計算，很多奇聞軼事可以說的，例如教授任選三題批改、同學任選三題作答、滿分三百、沒有考試、 … 等。筆試類型的考試只是最常見的一種，還有所謂的多才華加分，例如上台報告、舉手發問、參與展覽、參加競賽、 … 等。</p>
<p>不幸地，某 M 修了一堂怪課，教授每一堂課結束後總是會大聲宣揚「葛萊分多加 5 分」對於需要不斷複習演練的某 M 而言，這門課的即時評分方式讓其非常挫敗。神奇的是，有一次教授這麼問同學「給一序列，請計算眾數、平均數、中位數，答對加分。」某 M 剎那間傻住，大學的學期成績可以用這種問題獲得，當他在懷疑這個問題時，問題早已被同學回答走。</p>
<p>某 M 非常不甘心，計算眾數、平均數、中位數就能夠加分，要求只是 n = 10 的序列。既然加分有理，出題吧！</p>
<h3 id="題目描述"><a href="#題目描述" class="headerlink" title="題目描述"></a>題目描述</h3><p>平均數、中位數可以藉由區間總和、區間 K 小問題來完成，現在來解決眾數。</p>
<p>給定一個長度為 <span>$n$</span><!-- Has MathJax --> ( <span>$1 \le n \le 100000$</span><!-- Has MathJax --> ) 的正整數序列 <span>$s$</span><!-- Has MathJax --> (<span>$1 \le s_i \le n$</span><!-- Has MathJax -->)，對於 <span>$m$</span><!-- Has MathJax --> ( <span>$1 \le m \le 1000000$</span><!-- Has MathJax -->) 次詢問 <span>$l, r$</span><!-- Has MathJax -->，每次輸出 <span>$[s_l, \text{... },s_r]$</span><!-- Has MathJax --> 中，出現最多次的次數以及有多少種數字出現最多次。 </p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">10 10</span><br><span class="line">2 3 1 1 1 2 1 2 1 1</span><br><span class="line">5 8</span><br><span class="line">1 10</span><br><span class="line">6 9</span><br><span class="line">5 9</span><br><span class="line">1 5</span><br><span class="line">3 10</span><br><span class="line">1 9</span><br><span class="line">1 1</span><br><span class="line">6 9</span><br><span class="line">2 3</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2 2</span><br><span class="line">6 1</span><br><span class="line">2 2</span><br><span class="line">3 1</span><br><span class="line">3 1</span><br><span class="line">6 1</span><br><span class="line">5 1</span><br><span class="line">1 1</span><br><span class="line">2 2</span><br><span class="line">1 2</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>眾數區間查找 <a href="https://en.wikipedia.org/wiki/Range_mode_query">Range mode query</a> 性質可以參考維基百科。</p>
<p>在這一題中，這裡提供三種解法，但我的寫法中只有莫隊算法可以通過，其餘算法受到時間跟空間上的限制，需要額外的優化，細節就不多做說明：</p>
<ul>
<li>莫隊算法<br>只能離線處理，無法強制在線詢問，維護眾數最高頻率指針，來統計眾數的對應次數和等價眾數的個數，由於指針移動都是 <span>$O(1)$</span><!-- Has MathJax -->，整體上時間效能為 <span>$O(N^{1.5})$</span><!-- Has MathJax -->。</li>
<li>分塊在線 1<br>離線預處理 <span>$O(N^{0.5} \times N^{0.5} \times \log{N})$</span><!-- Has MathJax --><br>提供在線詢問 <span>$O(\text{ans} \times \log{N})$</span><!-- Has MathJax -->，由於知道每一個塊中的代表眾數都可能是答案，因此預處理每一個塊的眾數，其餘的非眾數捨棄掉，最慘情況是每個數字都出現一次，在線詢問時複雜度會掉到 <span>$O(N \log N)$</span><!-- Has MathJax -->。</li>
<li>分塊在線 2<ul>
<li>離線預處理時間 <span>$O(N \times L^2)$</span><!-- Has MathJax -->，提供在線詢問 <span>$O(N/L)$</span><!-- Has MathJax -->，其中 <span>$L$</span><!-- Has MathJax --> 表示有多少個分塊。</li>
<li>預處理分塊編號 <span>$PILE[i, j]$</span><!-- Has MathJax --> 的眾數情況 (類似莫隊維護指針)，因此記憶體消耗 <span>$O(N \times L^2)$</span><!-- Has MathJax -->。</li>
<li>對於每一處詢問，會對應預處理中的區域塊的紀錄 <span>$PILE[L, R]$</span><!-- Has MathJax -->，接著頭尾兩端的殘存數字再依序加入，意即 <span>$A[a, L-1]$</span><!-- Has MathJax --> 和 <span>$A[R+1, b]$</span><!-- Has MathJax --> 的數字加入的複雜度 <span>$O(1)$</span><!-- Has MathJax -->，隨後再進行撤銷 <span>$O(1)$</span><!-- Has MathJax -->。</li>
<li>假設詢問次數 <span>$Q$</span><!-- Has MathJax --> 與 <span>$N$</span><!-- Has MathJax --> 呈現性關係，整體需要 <span>$O(N \times L^2 + N^2 / L)$</span><!-- Has MathJax -->，則 <span>$L = N^{1/3}$</span><!-- Has MathJax --> 是最好的情況，意即每一個塊具有 <span>$O(N^{2/3})$</span><!-- Has MathJax --> 個數字，最後得到整體時間效能為 <span>$O(N^{1.66})$</span><!-- Has MathJax -->。</li>
</ul>
</li>
</ul>
<p>由於這一題目標不是找到眾數為何 (這牽涉到最小字典順序)，而是找眾數的出現個數和有幾種眾數可能，莫隊算法會快於其他算法。若是要求最小眾數莫隊算法需要 <span>$O(N^{1.5} \log{N})$</span><!-- Has MathJax -->，分塊在線 1 也是 <span>$O(N^{1.5} \log{N})$</span><!-- Has MathJax -->。</p>
<p>分塊在線 2 在此題不僅僅遇到記憶體過大，只好鬆弛 <span>$L$</span><!-- Has MathJax --> 來壓低記憶體用量，但增加時間需求，時間上慢個 10 倍以上。</p>
<h3 id="莫隊算法"><a href="#莫隊算法" class="headerlink" title="莫隊算法"></a>莫隊算法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXV = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXQ = <span class="number">1000005</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Offline</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Event</span> &#123;</span></span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> PILE, belong[MAXV];</span><br><span class="line">        <span class="keyword">int</span> l, r, qid;</span><br><span class="line">        <span class="built_in">Event</span>(<span class="keyword">int</span> a = <span class="number">0</span>, <span class="keyword">int</span> b = <span class="number">0</span>, <span class="keyword">int</span> e = <span class="number">0</span>):</span><br><span class="line">            <span class="built_in">l</span>(a), <span class="built_in">r</span>(b), <span class="built_in">qid</span>(e) &#123;&#125;</span><br><span class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> Event &amp;x) <span class="keyword">const</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (belong[l] != belong[x.l])</span><br><span class="line">                <span class="keyword">return</span> l &lt; x.l;</span><br><span class="line">            <span class="keyword">return</span> r &lt; x.r; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; event[MAXQ];</span><br><span class="line">    <span class="keyword">int</span> A[MAXN], N, qsize;</span><br><span class="line">    <span class="keyword">int</span> ret[MAXQ][<span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;N = N, qsize = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(val_count, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(val_count));</span><br><span class="line">        <span class="built_in">memset</span>(mode_freq, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(mode_freq));</span><br><span class="line">        mode_idx = <span class="number">0</span>;</span><br><span class="line">        Event::PILE = <span class="built_in">sqrt</span>(N);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = N; i &gt;= <span class="number">1</span>; i--)</span><br><span class="line">            Event::belong[i] = i / Event::PILE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">q_add</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        event[qsize] = <span class="built_in">Event</span>(l, r, qsize);</span><br><span class="line">        qsize++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(event, event+qsize);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">1</span>, r = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; qsize; i++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (r &lt; event[i].r)	r++, <span class="built_in">update</span>(A[r], <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (r &gt; event[i].r)	<span class="built_in">update</span>(A[r], <span class="number">-1</span>), r--;</span><br><span class="line">            <span class="keyword">while</span> (l &gt; event[i].l)	l--, <span class="built_in">update</span>(A[l], <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">while</span> (l &lt; event[i].l)	<span class="built_in">update</span>(A[l], <span class="number">-1</span>), l++;</span><br><span class="line">            ret[event[i].qid][<span class="number">0</span>] = mode_idx;</span><br><span class="line">            ret[event[i].qid][<span class="number">1</span>] = mode_freq[mode_idx];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// unrolled</span></span><br><span class="line">    <span class="keyword">int</span> val_count[MAXV], mode_freq[MAXN], mode_idx;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (val == <span class="number">1</span>) &#123;</span><br><span class="line">            mode_freq[val_count[x]]--;</span><br><span class="line">            val_count[x]++;</span><br><span class="line">            mode_freq[val_count[x]]++;</span><br><span class="line">            <span class="keyword">if</span> (mode_freq[mode_idx+<span class="number">1</span>] != <span class="number">0</span>)</span><br><span class="line">                mode_idx++;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (val == <span class="number">-1</span>) &#123;</span><br><span class="line">            mode_freq[val_count[x]]--;</span><br><span class="line">            val_count[x]--;</span><br><span class="line">            mode_freq[val_count[x]]++;</span><br><span class="line">            <span class="keyword">if</span> (mode_freq[mode_idx] == <span class="number">0</span>)</span><br><span class="line">                mode_idx--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; off;</span><br><span class="line"><span class="keyword">int</span> Offline::Event::PILE = <span class="number">16</span>, Offline::Event::belong[MAXV];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> mLocalStream &#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">M</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1048576</span>;</span><br><span class="line">        <span class="keyword">char</span> buf[N], *p, *end;</span><br><span class="line">        <span class="built_in">M</span>() &#123;</span><br><span class="line">            p = buf, end = buf + N - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">printInt</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> stk[<span class="number">16</span>];</span><br><span class="line">            <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">            stk[idx++] = <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span> (!x)	</span><br><span class="line">                stk[idx++] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            <span class="keyword">while</span> (x)</span><br><span class="line">                stk[idx++] = x%<span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>, x /= <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">while</span> (idx) &#123;</span><br><span class="line">                <span class="keyword">if</span> (p == end) &#123;</span><br><span class="line">                    *p = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, buf), p = buf;</span><br><span class="line">                &#125;</span><br><span class="line">                *p = stk[--idx], p++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;	</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">readchar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> buf[N];</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> *p = buf, *end = buf;</span><br><span class="line">            <span class="keyword">if</span>(p == end) &#123;</span><br><span class="line">                <span class="keyword">if</span>((end = buf + <span class="built_in">fread</span>(buf, <span class="number">1</span>, N, stdin)) == buf) <span class="keyword">return</span> EOF;</span><br><span class="line">                p = buf;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> *p++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ReadInt</span><span class="params">(<span class="keyword">int</span> *x)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">static</span> <span class="keyword">char</span> c, neg;</span><br><span class="line">            <span class="keyword">while</span>((c = <span class="built_in">readchar</span>()) &lt; <span class="string">&#x27;-&#x27;</span>)    &#123;<span class="keyword">if</span>(c == EOF) <span class="keyword">return</span> <span class="number">0</span>;&#125;</span><br><span class="line">            neg = (c == <span class="string">&#x27;-&#x27;</span>) ? <span class="number">-1</span> : <span class="number">1</span>;</span><br><span class="line">            *x = (neg == <span class="number">1</span>) ? c-<span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>((c = <span class="built_in">readchar</span>()) &gt;= <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                *x = (*x &lt;&lt; <span class="number">3</span>) + (*x &lt;&lt; <span class="number">1</span>) + c-<span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">            *x *= neg;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ~<span class="built_in">M</span>() &#123;</span><br><span class="line">            *p = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>, buf);</span><br><span class="line">        &#125;		</span><br><span class="line">    &#125; bprint;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, l, r, a, b;</span><br><span class="line">    <span class="keyword">while</span> (mLocalStream::M::<span class="built_in">ReadInt</span>(&amp;n)) &#123;</span><br><span class="line">        mLocalStream::M::<span class="built_in">ReadInt</span>(&amp;m);</span><br><span class="line">        off.<span class="built_in">init</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            mLocalStream::M::<span class="built_in">ReadInt</span>(&amp;off.A[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            mLocalStream::M::<span class="built_in">ReadInt</span>(&amp;l);</span><br><span class="line">            mLocalStream::M::<span class="built_in">ReadInt</span>(&amp;r);</span><br><span class="line">            off.<span class="built_in">q_add</span>(l, r);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        off.<span class="built_in">run</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, off.ret[i][<span class="number">0</span>], off.ret[i][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h3 id="分塊在線-1"><a href="#分塊在線-1" class="headerlink" title="分塊在線 1"></a>分塊在線 1</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModeQuery</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> A[MAXN], N, PILE, belong[MAXN];</span><br><span class="line">    vector&lt; vector&lt;<span class="keyword">int</span>&gt; &gt; V, Vmode;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; POS[MAXN];</span><br><span class="line">    <span class="keyword">int</span> q_dup[MAXN], q_cases;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        N = n, q_cases = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (PILE = <span class="number">1</span>; PILE * PILE &lt; N; PILE &lt;&lt;= <span class="number">1</span>);</span><br><span class="line">        </span><br><span class="line">        V.<span class="built_in">clear</span>(), Vmode.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, r; l &lt; N; l = r+<span class="number">1</span>) &#123;</span><br><span class="line">            r = <span class="built_in">min</span>(l + PILE - <span class="number">1</span>, N<span class="number">-1</span>);</span><br><span class="line">            V.<span class="built_in">push_back</span>(vector&lt;<span class="keyword">int</span>&gt;(A+l, A+r+<span class="number">1</span>));</span><br><span class="line">            Vmode.<span class="built_in">push_back</span>(vector&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="built_in">sort</span>(V[i].<span class="built_in">begin</span>(), V[i].<span class="built_in">end</span>());</span><br><span class="line">            <span class="keyword">int</span> mx_cnt = <span class="number">1</span>, cnt = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= V[i].<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (j == V[i].<span class="built_in">size</span>() || V[i][j] != V[i][j<span class="number">-1</span>]) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (cnt &gt; mx_cnt)	</span><br><span class="line">                        mx_cnt = cnt, Vmode[i].<span class="built_in">clear</span>();</span><br><span class="line">                    <span class="keyword">if</span> (cnt == mx_cnt)</span><br><span class="line">                        Vmode[i].<span class="built_in">push_back</span>(V[i][j<span class="number">-1</span>]);</span><br><span class="line">                    cnt = <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    cnt++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) <span class="comment">// value range</span></span><br><span class="line">            POS[i].<span class="built_in">clear</span>(), q_dup[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</span><br><span class="line">            POS[A[i]].<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = N<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            belong[i] = i / PILE;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">compute_cnt</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (q_dup[x] == q_cases)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        q_dup[x] = q_cases;</span><br><span class="line">        <span class="keyword">int</span> va = (<span class="keyword">int</span>) (<span class="built_in">lower_bound</span>(POS[x].<span class="built_in">begin</span>(), POS[x].<span class="built_in">end</span>(), l) - POS[x].<span class="built_in">begin</span>()) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> vb = (<span class="keyword">int</span>) (<span class="built_in">upper_bound</span>(POS[x].<span class="built_in">begin</span>(), POS[x].<span class="built_in">end</span>(), r) - POS[x].<span class="built_in">begin</span>()) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> vb - va;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">static</span> <span class="keyword">int</span> t;</span><br><span class="line">        q_cases++;</span><br><span class="line">        a = b = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (belong[l] == belong[r]) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++) &#123;</span><br><span class="line">                t = <span class="built_in">compute_cnt</span>(A[i], l, r);</span><br><span class="line">                <span class="keyword">if</span> (t &gt; a)	a = t, b = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (t == a)	b++;</span><br><span class="line">            &#125;	</span><br><span class="line">            <span class="keyword">return</span> ;		</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = belong[l]+<span class="number">1</span>; i &lt; belong[r]; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; Vmode[i].<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                t = <span class="built_in">compute_cnt</span>(Vmode[i][j], l, r);</span><br><span class="line">                <span class="keyword">if</span> (t &gt; a)	a = t, b = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> (t == a)	b++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = (belong[a]+<span class="number">1</span>)*PILE<span class="number">-1</span>; i &gt;= l; i--) &#123;</span><br><span class="line">            t = <span class="built_in">compute_cnt</span>(A[i], l, r);</span><br><span class="line">            <span class="keyword">if</span> (t &gt; a)	a = t, b = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (t == a)	b++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = (belong[b])*PILE; i &lt;= r; i++) &#123;</span><br><span class="line">            t = <span class="built_in">compute_cnt</span>(A[i], l, r);</span><br><span class="line">            <span class="keyword">if</span> (t &gt; a)	a = t, b = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">if</span> (t == a)	b++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; dream;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, l, r, a, b;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;dream.A[i]);</span><br><span class="line">        dream.<span class="built_in">make</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            l--, r--;</span><br><span class="line">            dream.<span class="built_in">query</span>(l, r, a, b);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, a, b);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="分塊在線-2"><a href="#分塊在線-2" class="headerlink" title="分塊在線 2"></a>分塊在線 2</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100005</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXS = <span class="number">35</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ModeQuery</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Kit</span> &#123;</span></span><br><span class="line">        <span class="keyword">unsigned</span> <span class="keyword">short</span> cnt[MAXN], freq[MAXN];</span><br><span class="line">        <span class="keyword">int</span> mode_idx;</span><br><span class="line">        <span class="built_in">Kit</span>() &#123;</span><br><span class="line">            <span class="built_in">init</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            mode_idx = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">            freq[cnt[x]]--;</span><br><span class="line">            cnt[x] += val;</span><br><span class="line">            freq[cnt[x]]++;</span><br><span class="line">            <span class="keyword">if</span> (cnt[x] &gt; mode_idx)</span><br><span class="line">                mode_idx = cnt[x];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">resume</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">            freq[cnt[x]]--;</span><br><span class="line">            cnt[x] -= val;</span><br><span class="line">            freq[cnt[x]]++;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125; f[MAXS * MAXS/<span class="number">2</span>], kit;</span><br><span class="line">    <span class="keyword">int</span> fr[MAXS][MAXS];</span><br><span class="line">    <span class="keyword">int</span> A[MAXN], N, PILE, belong[MAXN];</span><br><span class="line">    vector&lt; pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; &gt; V;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">heavy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> ff = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.<span class="built_in">size</span>(); i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; V.<span class="built_in">size</span>(); j++)</span><br><span class="line">                fr[i][j] = ff++;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.<span class="built_in">size</span>(); i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)</span><br><span class="line">                fr[i][j] = ff;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            f[fr[i][i]].<span class="built_in">init</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = V[i].first; j &lt;= V[i].second; j++)</span><br><span class="line">                f[fr[i][i]].<span class="built_in">add</span>(A[j], <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; V.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; V.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                f[fr[i][j]] = f[fr[i][j<span class="number">-1</span>]];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> k = V[j].first; k &lt;= V[j].second; k++)</span><br><span class="line">                    f[fr[i][j]].<span class="built_in">add</span>(A[k], <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        N = n;</span><br><span class="line">        PILE = (<span class="keyword">int</span>) <span class="built_in">pow</span>(n, <span class="number">0.70</span>) + <span class="number">1</span>;</span><br><span class="line">                </span><br><span class="line">        V.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> l = <span class="number">0</span>, r; l &lt; N; l = r+<span class="number">1</span>) &#123;</span><br><span class="line">            r = <span class="built_in">min</span>(l + PILE - <span class="number">1</span>, N<span class="number">-1</span>);</span><br><span class="line">            V.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(l, r));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = N<span class="number">-1</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">            belong[i] = i / PILE;</span><br><span class="line">        <span class="built_in">heavy</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> &amp;a, <span class="keyword">int</span> &amp;b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> bl = belong[l], br = belong[r];</span><br><span class="line">        <span class="keyword">if</span> (bl == br || r - l &lt;= PILE + <span class="number">10</span>) &#123;</span><br><span class="line">            kit.<span class="built_in">init</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">                kit.<span class="built_in">add</span>(A[i], <span class="number">1</span>);</span><br><span class="line">            a = kit.freq[kit.mode_idx], b = kit.mode_idx;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; i++)</span><br><span class="line">                kit.<span class="built_in">resume</span>(A[i], <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= <span class="number">0</span> &amp;&amp; belong[l<span class="number">-1</span>] == bl)	</span><br><span class="line">            bl++;</span><br><span class="line">        <span class="keyword">if</span> (r &lt; N &amp;&amp; belong[r+<span class="number">1</span>] == br)</span><br><span class="line">            br--;</span><br><span class="line">        Kit &amp;tmp = f[fr[bl][br]];</span><br><span class="line">        <span class="keyword">int</span> tmp_mode_idx = tmp.mode_idx;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bl*PILE - <span class="number">1</span>; i &gt;= l; i--)</span><br><span class="line">            tmp.<span class="built_in">add</span>(A[i], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = (br+<span class="number">1</span>)*PILE; i &lt;= r; i++)</span><br><span class="line">            tmp.<span class="built_in">add</span>(A[i], <span class="number">1</span>);</span><br><span class="line">        a = tmp.freq[tmp.mode_idx], b = tmp.mode_idx;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = bl*PILE - <span class="number">1</span>; i &gt;= l; i--)</span><br><span class="line">            tmp.<span class="built_in">resume</span>(A[i], <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = (br+<span class="number">1</span>)*PILE; i &lt;= r; i++)</span><br><span class="line">            tmp.<span class="built_in">resume</span>(A[i], <span class="number">1</span>);</span><br><span class="line">        tmp.mode_idx = tmp_mode_idx;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; dream;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m, l, r, a, b;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;dream.A[i]);</span><br><span class="line">        dream.<span class="built_in">make</span>(n);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;l, &amp;r);</span><br><span class="line">            l--, r--;</span><br><span class="line">            dream.<span class="built_in">query</span>(l, r, a, b);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, b, a);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-zj-b418" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/07/02/zj-b418/" class="article-date">
  <time datetime="2015-07-01T22:15:41.000Z" itemprop="datePublished">2015-07-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/07/02/zj-b418/">b418. 八成真物</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/07/02/zj-b418/" data-id="ckpaivca200arn8vn9aji66rn" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/07/02/zj-b418/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/bitset/">bitset</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/窮舉/">窮舉</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><blockquote>
<p>「偽物比真物更有價值」—貝木泥舟<br>「真物和偽物一樣有價值」—忍野咩咩<br>「偽娘比真娘更有價值」—精英島民</p>
</blockquote>
<p>任兩個物品的相似度<span>$sim(A, B) = \frac{|A \cap B|}{|A \cup B|}$</span><!-- Has MathJax -->，換句話說把 <span>$A$</span><!-- Has MathJax --> 具有的特徵和 <span>$B$</span><!-- Has MathJax --> 具有的特徵類型取交集、聯集個數，相除就能得到其相似度。例如有 5 個特徵，若 A 表示成 11001、B 表示成 01100<span>$sim(A, B) = \frac{|{2}|}{|{1, 2, 3, 5}|} = 0.25$</span><!-- Has MathJax -->。</p>
<p>現在盤面上有 N 個物品、M 種特徵，請問相似度大於等於 0.8 的相似對數 <span>$S$</span><!-- Has MathJax --> 有多少種。為了讓這一題更有趣味，算法允許偽物，輸出<span>$\frac{S}{N(N-1)/2} \times 100$</span><!-- Has MathJax -->。</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">8 10</span><br><span class="line">0111101101</span><br><span class="line">0111101100</span><br><span class="line">0111101100</span><br><span class="line">0111101101</span><br><span class="line">1100101010</span><br><span class="line">0111101100</span><br><span class="line">0111101100</span><br><span class="line">0011101111</span><br><span class="line">  </span><br><span class="line">8 10</span><br><span class="line">1111101100</span><br><span class="line">1011101100</span><br><span class="line">1010101100</span><br><span class="line">1010111010</span><br><span class="line">0100110100</span><br><span class="line">1011101100</span><br><span class="line">1110110000</span><br><span class="line">1011111100</span><br></pre></td></tr></table></figure>

<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">53.57</span><br><span class="line">25.00</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>利用 <code>std::bitset</code> 加速交集和聯集運算，將數個屬性壓縮到一個 32-bits 單位，然後藉 bitcount 盡可能在 <span>$O(1)$</span><!-- Has MathJax --> 的時間內完成，就有機會通過這一題。一般的 <span>$O(N^2 M)$</span><!-- Has MathJax --> 比 <span>$O(N^2 M/32)$</span><!-- Has MathJax --> 慢個五六倍。</p>
<p>此外，特別小心浮點數計算誤差，<code>5.0/4.0 &gt;= 0.8 == false</code>，用乘法判定大於閥值的操作。</p>
<p>關於 LSH 的部分，還在進行測試，若 signature 計算太慢，還不如直接暴力法，若能分散找到 signature 或者是預先有辦法處理好，那分桶計算就會好一點。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="keyword">char</span> s[<span class="number">1024</span>];</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;m) == <span class="number">2</span>) &#123;</span><br><span class="line">        bitset&lt;512&gt; attr[n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s);</span><br><span class="line">            attr[i] = bitset&lt;<span class="number">512</span>&gt;(s);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">double</span> ret = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i+<span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="keyword">int</span> a = (attr[i]&amp;attr[j]).<span class="built_in">count</span>();</span><br><span class="line">                <span class="keyword">int</span> b = (attr[i]|attr[j]).<span class="built_in">count</span>();</span><br><span class="line">                <span class="keyword">if</span> (<span class="number">5</span> * a &gt;= <span class="number">4</span> * b)</span><br><span class="line">                    ret++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.2lf\n&quot;</span>, ret * <span class="number">100</span> / (n * (n<span class="number">-1</span>)/<span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/categories/解題區/page/10/">&laquo; Prev</a><a class="page-number" href="/categories/解題區/">1</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/page/9/">9</a><a class="page-number" href="/categories/解題區/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/categories/解題區/page/12/">12</a><a class="page-number" href="/categories/解題區/page/13/">13</a><span class="space">&hellip;</span><a class="page-number" href="/categories/解題區/page/64/">64</a><a class="extend next" rel="next" href="/categories/解題區/page/12/">Next &raquo;</a>
    </nav>
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">30</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">9</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">44</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-handover/">
              
                <i class="icon-file-o"></i> 
              
            Handover</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-interview-recursion/">
              
                <i class="icon-file-o"></i> 
              
            Interview &amp; Recursion</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-job-build/">
              
                <i class="icon-file-o"></i> 
              
            Job Build</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-lang/">
              
                <i class="icon-file-o"></i> 
              
            Programming Language Impostors</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-machine-learning-newbie/">
              
                <i class="icon-file-o"></i> 
              
            Machine Learning for Newbie</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-parallel-gc/">
              
                <i class="icon-file-o"></i> 
              
            Parallel &amp; Garbage Collection</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
<script type="text/javascript">
  $('#ukagaka_panel').ukagaka();
</script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>