<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>Category: 資訊安全 | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Morris&#39; Blog">
<meta property="og:url" content="http://morris821028.github.io/categories/學校課程/資訊安全/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Morris&#39; Blog">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <!-- <link rel="import" href="/bower_components/app-layout/app-layout.html"> --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main">
  
    <article id="post-security-notes7" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/06/23/security-notes7/" class="article-date">
  <time datetime="2015-06-23T00:06:29.000Z" itemprop="datePublished">2015-06-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/23/security-notes7/">近代加密 小額付費</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/06/23/security-notes7/" data-id="ckq5yoy4y00f4o4vnlyqfbhse" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/06/23/security-notes7/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="關於小額付費"><a href="#關於小額付費" class="headerlink" title="關於小額付費"></a>關於小額付費</h2><p>另一個名稱為 <strong> 微支付 </strong> (Micropayment)，簡單來說提供顧客 (Consumer) - 銀行 (Broker) - 商家 (Vendor) 三方的交易。小額付費標明在交易金額小，因此交易成本也應該小，否則交易手續的計算能量就超過交易金額，更別說要扣除交易物品的成本。通常要在以下三點最小化</p>
<ul>
<li>計算資源：<br>在先前提到的加密算法中，key 的 bit-length 相當長，導致計算的能量消耗大。倘若只消費 1 元，耗電成本就佔了 1% 以上，甚至更多，那麼是划不來的。</li>
<li>儲存空間花費：<br>計算每一組交易明細所需要的空間要最小，例如記錄金額需要 32-bit，那麼 n 次交易就需要 n 個 32-bit 的空間，在其他細節中還需要紀錄額外的購買來源、 … 等。</li>
<li>管理成本：<br>第三方 (通常是銀行) 要管理顧客的金額花費、商家是否能取用顧客的錢。銀行要怎麼紀錄顧客的狀態、如何驗證商家真的有跟顧客交易 … 等。</li>
</ul>
<p>由於交易金額小，即使被破解對雙方的損失也不大。但通常破解手段需要的時間、資源往往超過交易金額，因此不太會有人去破解這個。</p>
<h2 id="應用層面"><a href="#應用層面" class="headerlink" title="應用層面"></a>應用層面</h2><h3 id="網路電子報："><a href="#網路電子報：" class="headerlink" title="網路電子報："></a>網路電子報：</h3><p>一份電子報可能有一些特別的標題內容，若要深入查閱內文，需要讀者付費觀看。這一部分更具有彈性，對於一份具有相當多面向的電子報而言，有些人只看幾個專欄就必須花費購買一整本的金額，有些時候是浪費的。</p>
<h3 id="網路期刊購買、資料庫詢問"><a href="#網路期刊購買、資料庫詢問" class="headerlink" title="網路期刊購買、資料庫詢問"></a>網路期刊購買、資料庫詢問</h3><p>網路學術期刊就跟電子報的情況一樣。資料庫詢問比較特別，花費小金額來交換資料庫服務的次數。</p>
<h3 id="廣告"><a href="#廣告" class="headerlink" title="廣告"></a>廣告</h3><p>互動式影片、廣告商為了誘拐大眾仔細觀看廣告，由廣告商付錢給觀看者。例如回答問卷回饋、機率性地抽獎回饋 … 等。</p>
<h3 id="網頁閱讀"><a href="#網頁閱讀" class="headerlink" title="網頁閱讀"></a>網頁閱讀</h3><p>類似向大眾徵文，鼓勵分享知識。徵求到的文章，由平台供應者支付。</p>
<h2 id="何時用"><a href="#何時用" class="headerlink" title="何時用"></a>何時用</h2><p>使用者付費，而非訂閱長時間的垃圾訊息或服務。在大多數的服務商中，會提供時間內無限使用或按照次數計費兩種方案，在大多數的情況下，時間內無限使用是對商家有利，可以預先得到使用者的投資，但使用者在後續時間內可能沒有去使用、或者沒時間去用。</p>
<p>不是 <strong> 按照次數計費全然好 </strong>，就如 <strong> 電話費 </strong>，打了多少通電話、講了多久，只有電信商知道，即便告訴花費相當多金額，通話明細也是由他們提供，很難證明到底花了多少，這是對使用者的不利。相較起來，小額付費比較接近投幣式的公共電話，投了多少就打多少，等到快沒有餘額時，再進行補充。</p>
<p>先付款給商家會對使用者不利，有可能取得不好的服務，後付款給商家會對商家不利，因為使用者可能沒有足夠的金額。正因為小額交易，適時地刷新狀態 (再投幣) 就能在之間達到平衡。</p>
<h2 id="數學"><a href="#數學" class="headerlink" title="數學"></a>數學</h2><p>由制定 RSA 那伙人 Rivest, Shamir 提供 Payword scheme 的方法。</p>
<p>首先，概念建立在假設不用數字儲存金額 (減少儲存空間、管理花費)，而是用運算次數來知道花費金額 (用簡單運算來完成，防止能源消耗過大)。金額花費是整數，由最小單位 1 元構成，如果是在通貨膨脹的國家，最小單位可能不一樣？</p>
<p>那麼可以建立一個儲值金額 n 元的串列如下。</p>
<span>$x_0 \leftarrow x_1 \leftarrow x_2 \leftarrow \text{ ... } \leftarrow x_{n-1} \leftarrow x_n$</span><!-- Has MathJax -->
<p>由使用者拿一個<span>$x_n$</span><!-- Has MathJax --> 初始化，接著利用 hash<span>$x_i = h(x_{i+1})$</span><!-- Has MathJax --> 得到每一個硬幣<span>$x_i$</span><!-- Has MathJax -->。用數學表示遞迴公式<span>$x_i = h^{n-i}(x_n)$</span><!-- Has MathJax -->。</p>
<p>當顧客跟商家交易時，簽一份簽章 (例如用 RSA 或者是 DSA 等方式) 給商家。簽章內容為</p>
<span>$\text{Sign}_C(\text{Merchant-ID} || x_0 || \text{Cert})$</span><!-- Has MathJax -->
<p>其中 <span>$\text{Cert}$</span><!-- Has MathJax --> 是由第三方信任銀行簽署給用戶的內容 (類似銀行帳戶的確認)。最後發送給商家資訊為</p>
<span>$\text{Sign}_C(\text{Merchant-ID} || x_0 || \text{Cert}), \text{Merchant-ID}, x_0, \text{Cert}$</span><!-- Has MathJax -->
<p>由商人去驗證 (檢查簽證內容、拿對方的 public key 打開，再去拿銀行的 public key 驗證 <span>$\text{Cert}$</span><!-- Has MathJax -->  是否正確) 是否是可信任的顧客或者是顧客是否存在。</p>
<p>接下來交易採用最笨的方案，每一次交易 1 元，交付 i 元時，顧客就告知<span>$x_i$</span><!-- Has MathJax --> 值給商家，這裡顧客得到硬幣方法為重新計算<span>$x_i = h^{n-i}(x_n)$</span><!-- Has MathJax -->，可以不事先用記憶體儲存<span>$[x_0, x_n]$</span><!-- Has MathJax -->，保留 <span>$n$</span><!-- Has MathJax --> 和<span>$x_n$</span><!-- Has MathJax --> 即可。</p>
<p>之後商家拿著 i 元<span>$x_i$</span><!-- Has MathJax --> 和<span>$\text{Sign}_C(\text{Merchant-ID} || x_0 || \text{Cert})$</span><!-- Has MathJax --> 的資訊給銀行，銀行計算 <span>$i$</span><!-- Has MathJax --> 次 hash<span>$x_0 = h^i(x_i)$</span><!-- Has MathJax --> 查看是否正確，若檢驗沒問題，則銀行從客戶存簿撥款給商家。</p>
<h3 id="為什麼可行"><a href="#為什麼可行" class="headerlink" title="為什麼可行"></a>為什麼可行</h3><p>運算過程中使用 hash，hash 提供不可逆的操作，因此商家無法有更多金額的索取，假設從顧客手中得到<span>$x_i$</span><!-- Has MathJax -->，無法計算出<span>$x_{i+1}$</span><!-- Has MathJax --> 究竟是什麼，具有一定安全性。而顧客必須由銀行索取簽證，來表示當前的狀態是合法的，顧客沒辦法竄改自己的狀態，使得自己有更多的金錢，銀行那裏會有最新一組的簽章在？應該是吧，銀行會在商家發送驗證資訊時發生異狀檢查顧客是否竄改。</p>
<p>數學之美。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes6" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/06/19/security-notes6/" class="article-date">
  <time datetime="2015-06-19T07:20:52.000Z" itemprop="datePublished">2015-06-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/19/security-notes6/">近代加密 複習 續</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/06/19/security-notes6/" data-id="ckq5yoy4x00f2o4vnhso9nvdl" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/06/19/security-notes6/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>幾乎是密碼學基礎數論，看來也走到這了。</p>
<h2 id="亂來"><a href="#亂來" class="headerlink" title="亂來"></a>亂來</h2><p>隨便寫寫，上課不專心真是抱歉。</p>
<ol>
<li><p>Given an integer <span>$x$</span><!-- Has MathJax -->, what is the requirement to let the multiplcative inverse <span>$x^{-1}$</span><!-- Has MathJax --> exist when modulo <span>$p$</span><!-- Has MathJax -->?  if <span>$x^{-1} \mod p$</span><!-- Has MathJax --> exists, please write down the equation (based on Fermat’s theorem) used to compute <span>$x^{-1} \mod p$</span><!-- Has MathJax -->. (5%)</p>
<ol>
<li>condition: <span>$gcd(x, p) = 1$</span><!-- Has MathJax --> for multiplcative inverse <span>$x^{-1}$</span><!-- Has MathJax --> exist when modulo <span>$p$</span><!-- Has MathJax --></li>
<li>Fermat’s theorem :   <span>$x^{p-1} = 1 \mod p \Rightarrow x^{p-2} \times x = 1 \mod p$</span><!-- Has MathJax -->
<span>$x^{-1} = x^{p-2} \mod p$</span><!-- Has MathJax -->
</li>
</ol>
</li>
<li><p>What is the Euler totient function <span>$\phi(n)$</span><!-- Has MathJax -->? Please answer <span>$\phi(77) = ?$</span><!-- Has MathJax --></p>
 <span>$\phi(n)$</span><!-- Has MathJax --> 表示 1 到 n 之內的整數，有多少與 n 互質的個數。<br> <span>$\phi(77) = 77 \times (1 - 1 / 7) \times (1 - 1 / 11) = 60$</span><!-- Has MathJax -->
</li>
<li><p>Whais the discrete logarithm problem?   (5%)<br> 對於等式 <span>$y = x^a \mod p$</span><!-- Has MathJax -->，已知三整數 y, x, p，解出 a 的問題。詳見小步大步算法 baby-step-giant-step，複雜度 <span>$O(\sqrt p)$</span><!-- Has MathJax --></p>
</li>
<li><p>What is a hybrid cryptography?   (5%)<br>$<span>$\text{hybrid cryptosystem } = \text{ public-key cryptosystem } + \text{ symmetric-key cryptosystem}$</span><!-- Has MathJax -->$  </p>
<ul>
<li>public-key cryptosystem<br>提供 key encapsulation，就是 key 的安全性和簽章認證，保護 key 傳輸、保管上的問題。</li>
<li>symmetric-key cryptosystem<br>提供 data encapsulation，提供高效率的加解密效能。</li>
</ul>
</li>
<li><p>What are the two primary reasons of using a cryptographic hash before signing a signature?   (5%)<br>cryptographic hash 密碼雜湊函數，通常會計算 <span>$hash(M)$</span><!-- Has MathJax --></p>
<ul>
<li>單向不可逆<br>難以給定一個雜湊值，並且逆推得到當初輸入的數值。<ul>
<li>提供訊息修改檢查，相同的訊息進行雜湊，高機率會是不同。<br><span>$hash(M1) \neq hash(M2)$</span><!-- Has MathJax -->，如果 M1 和 M2 差異只有數個 bits 不同。</li>
<li>防止在傳輸過程中被竄改。對於簽章則更難竄改成相同雜湊值且具有 <strong> 意義 </strong> 的訊息 <span>$M&apos;$</span><!-- Has MathJax -->。</li>
</ul>
</li>
<li>容易計算<br>將一個長度很大的訊息，壓縮一個固定長度的數值，這數值方便後續算法計算用加密算法的部分。</li>
</ul>
</li>
<li><p>Please write down the RSA public key encryption and decryption process (including public key and private key generation process).   (10%)</p>
<ol>
<li><span>$N = p \times q$</span><!-- Has MathJax --></li>
<li><span>$\phi(N) = (p-1)(q-1)$</span><!-- Has MathJax --></li>
<li><span>$gcd(\phi(N), e) = 1, \phi(N) &gt; e &gt; 1$</span><!-- Has MathJax --></li>
<li><span>$d = e^{-1}, e \times d = 1 \mod &oslash;(N)$</span><!-- Has MathJax --></li>
<li>public <span>$e, N$</span><!-- Has MathJax --></li>
<li>private <span>$p, q, d$</span><!-- Has MathJax --></li>
</ol>
</li>
<li><p>Please develop a left-to-right binary exponentiation algorithm without “conditional jump” which is usually dangerous to some engineering attack. (10%)<br>Montgomery Ladder  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">R[0] = 1, R[1] = p</div><div class="line">for i = n-1 to 0, step = -1</div><div class="line">    R[1-a[i]] = R[0] * R[1]</div><div class="line">    R[a[i]] = R[a[i]] * R[a[i]]</div><div class="line">return R[0]</div></pre></td></tr></table></figure>
</li>
<li><p>Below is the DSA signature scheme in which <span>$p$</span><!-- Has MathJax --> is a large prime, <span>$q$</span><!-- Has MathJax --> is a 160-bit prime factor of (p - 1), <span>$g$</span><!-- Has MathJax --> is an integer of order <span>$q$</span><!-- Has MathJax --> modulo <span>$p$</span><!-- Has MathJax -->. Let <span>$x$</span><!-- Has MathJax --> be the signer’s private key and <span>$y = g^x \mod p$</span><!-- Has MathJax --> be the public key.  </p>
<ol>
<li>How to generate an integer <span>$g$</span><!-- Has MathJax --> ?   (5%)</li>
<li><p>Please complete the following nissing steps of the scheme.   (10%)</p>
</li>
<li><p>Please describe a trick for speeding up DSA’s on-line signing process. (5%)</p>
<pre><code>_______________________________________________________________________
Signing algorithm                 Verification algorithm
_______________________________________________________________________
r = (g^k mod p) mod q             w = s^-1 mod q
k is a random integer             u1 = (SHA(m) * w) mod q
s = ________________              u2 = (r * w) mod q
m is the messgae                  v = _________________
the signature is (s,r)            if v = r then the signature is correct
</code></pre></li>
</ol>
<ul>
<li><p><span>$g = h^{(p-1)/q} \mod p$</span><!-- Has MathJax --> ，其中隨機亂數 <span>$h$</span><!-- Has MathJax -->，滿足 <span>$g &gt; 1$</span><!-- Has MathJax --> 即可。<br>從費馬小定理中，有一個比較特別的計算來得到 order <span>$q$</span><!-- Has MathJax -->，所謂的 order <span>$q$</span><!-- Has MathJax --> 就是在前 <span>$q$</span><!-- Has MathJax --> 個 <span>$g^i \mod p$</span><!-- Has MathJax --> 下不會出現重複 (循環長度至少為 <span>$q$</span><!-- Has MathJax -->)，從觀察中得知循環長度 <span>$L$</span><!-- Has MathJax --> 滿足 <span>$L | p-1$</span><!-- Has MathJax -->，也就是說 <span>$L$</span><!-- Has MathJax --> 是 <span>$p-1$</span><!-- Has MathJax --> 的因數，<span>$q$</span><!-- Has MathJax --> 則是要找到一個大循環，讓攻擊者更難找到 <span>$x$</span><!-- Has MathJax -->，又因為 <span>$L$</span><!-- Has MathJax --> 是其因數，由於 <span>$q$</span><!-- Has MathJax --> 是 <span>$p-1$</span><!-- Has MathJax --> 的其中一個質因數，則保證是一個最小循環節的要求。</p>
</li>
<li><span>$s = k(SHA(m) + x \times r)$</span><!-- Has MathJax -->  
<span>$v = g^{u1} y^{u2}$</span><!-- Has MathJax -->  
</li>
<li><p>可以 offline 去預處理隨機亂數 <span>$k$</span><!-- Has MathJax -->，事先計算一堆的 <span>$r$</span><!-- Has MathJax -->、<span>$z = k^{-1}x \times r$</span><!-- Has MathJax -->，那麼計算 <span>$s$</span><!-- Has MathJax --> 可以非常的快速，<span>$s = k^{-1} SHA(M) + z \mod p$</span><!-- Has MathJax -->，假設 hash 計算快速，只動用到一次乘法和加法，相較於 RSA 的簽章方法，少了指數次方運算。</p>
</li>
</ul>
</li>
<li><p>Under the following certificate hierarchy, please provide all the details of how end user A checking the correctness of end user C’s public key by verifying a sequence of certificates. Note: User A only knows X’s public key, but does NOT have the root Z’s public key directly.   (10%)<br> 若 A 要確認 C 給的 public key 是否正確，則依循以下步驟來確認</p>
<ol>
<li>C 拿出 <code>Y&lt;&lt;C&gt;&gt;</code>，拿 Y 的 public key 進行確認 C 的 public key。</li>
<li>再檢查 Y 的 public key，Y 拿出 <code>Z&lt;&lt;Y&gt;&gt;</code>，拿 Z 的 public key 進行確認 Y 的 public key。</li>
<li>再檢查 Z 的 public key，Z 拿出 <code>X&lt;&lt;Z&gt;&gt;</code>，拿 X 的 public key 進行確認 Z 的 public key。</li>
<li>由於我們知道 X 的 public key (藉由實地臨櫃面對面確認 X 的 public key)，最後驗證 C 給的是正確的 public key。<pre><code>      Z
    ／ ＼          Notation used
   X     Y         X&lt;&lt;A&gt;&gt;:
 ／ ＼    ＼       A&apos;s certificate issued by X
A     B     C
</code></pre></li>
</ol>
</li>
<li><p>Pleasewrite down the Diffie-Hellman key exchange protocol (including the public key and private key generation process). (10%)  What is the man-in-middle (or the middle person) attack?   (5%)  </p>
<ul>
<li>共同決定一個大質數 <span>$p$</span><!-- Has MathJax --> 和一個基底 <span>$g$</span><!-- Has MathJax --> (全部人都知道)</li>
<li>每個人 A 擁有自己的 private key <span>$x_A$</span><!-- Has MathJax --> (<span>$x_A &lt; p - 1$</span><!-- Has MathJax -->)</li>
<li>每個人 A 計算自己的 public key <span>$y_A$</span><!-- Has MathJax --> (<span>$y_A = g^{x_A} \mod p$</span><!-- Has MathJax -->)</li>
</ul>
<p>假設有兩個人 A, B 要通訊，則把自己的 public key 交給對方，共同產生出一把暫時的 key <span>$K_{AB}$</span><!-- Has MathJax --> 進行通訊加密。</p>
<ul>
<li>對於 A 來說會接收到 <span>$y_B$</span><!-- Has MathJax -->，計算<span>$K_{AB} = (y_B)^{x_A} = g^{x_B \times x_A} \mod p$</span><!-- Has MathJax --></li>
<li>對於 B 來說會接收到 <span>$y_A$</span><!-- Has MathJax -->，計算<span>$K_{AB} = (y_A)^{x_B} = g^{x_A \times x_B} \mod p$</span><!-- Has MathJax --></li>
<li>由於離散對數是一個困難問題，很難藉由攔截紀錄來得到對方的 private key <span>$x_A$</span><!-- Has MathJax -->，因此有一定的安全性。</li>
</ul>
<p>假若現在要進行中間人 C 的攻擊，則會在一開始交換 <span>$K_{AB}$</span><!-- Has MathJax --> 的時候插入到其中通訊。</p>
<ul>
<li>A 發送 <span>$y_A$</span><!-- Has MathJax --> 給 B 時，受到 C 的攔截。</li>
<li>C 知道 A 想要跟 B 通訊，則把自己的 <span>$y_C$</span><!-- Has MathJax --> 發送給 B，並且也傳一份給 A。</li>
<li>B 以為是 A 要進行通訊，實質拿到 <span>$y_C$</span><!-- Has MathJax --> 而非 <span>$y_A$</span><!-- Has MathJax -->。</li>
<li>產生兩把 key<span>$K_{AC}, K_{CB}$</span><!-- Has MathJax -->，C 就偷偷在中間偷聽，並且作為中繼傳送訊息，需要解密 (拿<span>$K_{AC} \text{ or } K_{CB}$</span><!-- Has MathJax -->) 之後再進行加密<span>$K_{CB} \text{ or } K_{AC}$</span><!-- Has MathJax --> 送給另一方。</li>
</ul>
<p>如何防止中間人攻擊，大約有幾種方法，但牽涉到可信任第三方、計算速度。</p>
<ul>
<li>發送訊息上，計算時間的延遲不得超過一定限制，否則可能存在中間人攻擊。</li>
<li>藉由可信任第三方 CA (Certificate Authority) 來驗證彼此的 public key 歸屬於誰<br>由 CA 簽認<span>$Sign_{CA}(\text{public key || owner_id || expiration date || ...})$</span><!-- Has MathJax -->，如此一來如果存在 C 中間人，則轉交 <span>$y_C$</span><!-- Has MathJax --> 給 B 時，B 就會藉由 CA 驗證得到 <code>owner_id</code> 不是通訊對象 A。如果 CA 不可信任，則可以讓 C 簽一個<span>$Sign_{CA}(\text{public key C || owner_A || expiration date || ...})$</span><!-- Has MathJax --> 來欺騙 A 和 B，也就是說 CA 和 C 偷偷在私底下做了黑心勾當，那麼中間人攻擊仍是存在的。</li>
</ul>
</li>
<li><p>Both message authentication code (MAC) and digital signature can be used to provide the functionality of message origin and integrity check. Please briefly describe these two techniwues and compare percisely the difference between these two techniques.   (10%)<br>message authentication code (文件訊息鑑別) 顧名思義就是針對 message 進行驗證，確認發送者身分和資料完整性，相較於 digital signature (數位簽章) 也是做相同的事情，訊息量不同且產生出來的結果也大不相同。通常文件訊息鑑別會破壞儲存資訊，藉由雙方共享的 key 來進行身分認證，可用暫時性的 key，若採用非對稱式則需要額外的數位簽章來輔助驗證發送者。而數位簽章則是提供有效期限內的使用，這把驗證的 public key 必須存在比較長的時間。<br>數位簽章簽定時不知道對方怎麼簽，但能驗證是他簽的並且只有他簽得出來，文件訊息鑑別通常知道對方用什麼流程輸出一樣的數值。</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>類型\性質</th>
<th>加密類型</th>
<th>輸出訊息</th>
<th>碰撞情況</th>
<th>重複使用</th>
</tr>
</thead>
<tbody>
<tr>
<td>文件訊息鑑別</td>
<td>普遍上對稱式</td>
<td>不管多長都固定長度</td>
<td>存在</td>
<td>相同輸入 - 相同輸出</td>
</tr>
<tr>
<td>數位簽章</td>
<td>非對稱式</td>
<td>視情況而定</td>
<td>視情況而定</td>
<td>相同輸入 - 可能不同輸出</td>
</tr>
</tbody>
</table>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes5" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/06/12/security-notes5/" class="article-date">
  <time datetime="2015-06-11T23:20:54.000Z" itemprop="datePublished">2015-06-12</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/12/security-notes5/">近代加密 數位簽章 DSA 筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/06/12/security-notes5/" data-id="ckq5yoy4w00eyo4vnyseiroqd" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/06/12/security-notes5/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="DSA"><a href="#DSA" class="headerlink" title="DSA"></a>DSA</h2><p>Digital Signature Standard (DSS) 數位憑證標準，而有一個 DSA 演算法來完成憑證。</p>
<p>每一次憑證傳送三個參數 <span>$(r, s, M)$</span><!-- Has MathJax -->，利用私用金鑰進行加密。讓對方使用公鑰進行驗證。</p>
<ul>
<li><span>$r = (g^k \mod p) \mod q$</span><!-- Has MathJax --></li>
<li><span>$s = k^{-1}(SHA(M) + x \times r) \mod q$</span><!-- Has MathJax -->
</li>
</ul>
<p>give receiver <span>$(r, s, M)$</span><!-- Has MathJax -->, we have random (one-time) <span>$k$</span><!-- Has MathJax --> &amp; private key <span>$x$</span><!-- Has MathJax --></p>
<p>每一次簽名時，最好使用隨機亂數 <span>$k$</span><!-- Has MathJax --> 作為簽章用途，隨用即棄，若發生重複使用，將會發生被攻擊，被攻擊者拿到私鑰後，攻擊者就能進行偽裝。</p>
<h3 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h3><p>if reused <span>$k$</span><!-- Has MathJax --></p>
<p>如果重複使用隨機變數 <span>$k$</span><!-- Has MathJax -->，可以藉由夾擊的方式得到，雖然不知道加密的隨機亂數 <span>$k$</span><!-- Has MathJax --> 究竟是什麼，藉由夾擊可以把 <span>$k$</span><!-- Has MathJax --> 消除，利用乘法反元素反求 <span>$x$</span><!-- Has MathJax --> 是多少，公式如下所述。</p>
<ul>
<li><span>$k = s1^{-1} (SHA(M1) + x \times r) \mod q$</span><!-- Has MathJax --> - (1)</li>
<li><span>$k = s2^{-1} (SHA(M2) + x \times r) \mod q$</span><!-- Has MathJax --> - (2)</li>
</ul>
<p>subtract (1) - (2)</p>
<ul>
<li><span>$0 = s1^{-1} SHA(M1) - s2^{-1} SHA(M2) + (s1^{-1} - s2^{-1}) x \times r \mod q$</span><!-- Has MathJax --></li>
<li><span>$s1^{-1} SHA(M1) - s2^{-1} SHA(M2) = (s2^{-1} - s1^{-1}) x \times r \mod q$</span><!-- Has MathJax --></li>
<li><span>$x = (s1^{-1} SHA(M1) - s2^{-1} SHA(M2)) \times (s2^{-1} - s1^{-1})^{-1} \times r^{-1} \mod q$</span><!-- Has MathJax -->
</li>
</ul>
<p>get private key. Dangerous !</p>
<h3 id="Verify"><a href="#Verify" class="headerlink" title="Verify"></a>Verify</h3><p>驗證的正確性與否，接收者需要計算以下四個步驟來完成驗證。</p>
<ul>
<li><span>$w = s^{-1} \mod q$</span><!-- Has MathJax --></li>
<li><span>$u1 = (SHA(M) \times w) \mod q$</span><!-- Has MathJax --></li>
<li><span>$u2 = r \times w \mod q$</span><!-- Has MathJax --></li>
<li><span>$v = g^{u1} y^{u2} \mod q$</span><!-- Has MathJax -->
</li>
</ul>
<p>test <span>$v = r$</span><!-- Has MathJax -->, why correct ?</p>
<p>理論的正確性可以參考以下證明，把公開的 <span>$y = g^x \mod p$</span><!-- Has MathJax --> 拿出來，這個安全性取決於離散對數的算法難度。</p>
<ul>
<li>known <span>$y = g^x \mod p$</span><!-- Has MathJax -->, <span>$x$</span><!-- Has MathJax --> is a private key</li>
<li>because <span>$s = k^{-1}(SHA(M) + x \times r) \mod q$</span><!-- Has MathJax --></li>
<li>then <span>$k = s^{-1}(SHA(M) + x \times r) \mod q$</span><!-- Has MathJax --></li>
</ul>
<p>want <span>$r = (g^k \mod p) \mod q$</span><!-- Has MathJax --></p>
<ul>
<li><span>$r = (g^k \mod p) \mod q = g^{s^{-1}(SHA(M) + x \times r)} \mod q$</span><!-- Has MathJax --></li>
<li><span>$r = g^{s^{-1} SHA(M)} \times g^{x (s^{-1} \times r)} \mod q$</span><!-- Has MathJax --></li>
<li><span>$r = g^{s^{-1} SHA(M)} \times g^{x^{(s^{-1} \times r)}} \mod q$</span><!-- Has MathJax --></li>
<li><span>$r = g^{s^{-1} SHA(M)} \times y^{(s^{-1} \times r)} \mod q$</span><!-- Has MathJax -->
</li>
</ul>
<p>而我們事實上就是在處理指數部分，</p>
<h2 id="離散對數"><a href="#離散對數" class="headerlink" title="離散對數"></a>離散對數</h2><p>解決問題 <span>$y = g^x \mod p$</span><!-- Has MathJax -->，當已知 <span>$y, g, p$</span><!-- Has MathJax -->，要解出 <span>$x$</span><!-- Has MathJax --> 的難度大為提升，不像國高中學的指數計算，可以藉由 <code>log()</code> 運算來完成，離散對數可以的複雜度相當高，當 <span>$p$</span><!-- Has MathJax --> 是一個相當大的整數時，通常會取用到 256 bits 以上，複雜度則會在 <span>$O(2^{100})$</span><!-- Has MathJax --> 以上。</p>
<p>實際上有一個有趣的算法 body-step, giant-step algorithm，中文翻譯為 <strong> 小步大步算法 </strong>，在 ACM-ICPC 競賽中也可以找到一些題目來玩玩，算法的時間複雜度為 <span>$O(\sqrt{p})$</span><!-- Has MathJax -->，空間複雜度也是 <span>$O(\sqrt{p})$</span><!-- Has MathJax -->。相信除了這個外，還有更好的算法可以完成。</p>
<p>小步大步算法其實很類似塊狀表的算法，分塊處理，每一塊的大小為 <span>$\sqrt{p}$</span><!-- Has MathJax -->，為了找尋答案計算其中一塊的所有資訊，每一塊就是一小步，接著就是利用數學運算，拉動數線，把這一塊往前推動 (或者反過來把目標搜尋結果相對往塊的地方推動)。因此需要走 <span>$\sqrt{p}$</span><!-- Has MathJax --> 大步完成。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes4" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/29/security-notes4/" class="article-date">
  <time datetime="2015-05-28T22:51:10.000Z" itemprop="datePublished">2015-05-29</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/29/security-notes4/">資訊安全 小考 2 筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/05/29/security-notes4/" data-id="ckq5yoy4v00ewo4vnobw02sjc" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/05/29/security-notes4/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>筆記錯誤多多，請以僅供參考的角度去質疑</p>
</blockquote>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><ol>
<li><p>Below is a key distribution protocol.<br>(a) Please describe the details of “replay attack” when <span>$N_1$</span><!-- Has MathJax --> is removed from the protocol.<br>(b) Please modify the protocol to enable party A to confirm that party B already received <span>$K_s$</span><!-- Has MathJax -->? </p>
</li>
<li><p>Please explain link encryption and end-to-end encryption.</p>
</li>
<li><p>(a) Please describe details of the Fermat’s theorem (or called Fermat’s little theorem).<br>(b) How to compute the multiplicative inverse of an integer <span>$a$</span><!-- Has MathJax --> modulo <span>$p$</span><!-- Has MathJax --> based on the Fermat’s theorem?<br>(c) What is the requirement for <span>$a^{-1}$</span><!-- Has MathJax --> to exist?</p>
</li>
<li><p>(a) Please describe details of the Euler’s theorem.<br>(b) Based on this theorem, please describe the <strong> basic idea </strong> of the RSA encryption and decryption process.</p>
</li>
<li><p>The Miller-Rabin algorithm is used to test whether an odd integer n is a<br>prime. Please complete the following missing steps of teh algorithm.   (15%)<br>(1) Find integers <span>$k, q$</span><!-- Has MathJax --> (<span>$k$</span><!-- Has MathJax --> &gt; 0, <span>$q$</span><!-- Has MathJax --> odd), so that <span>$(n - 1)$</span><!-- Has MathJax --> = <code>__________</code><br>(2) Select a random integer <span>$a$</span><!-- Has MathJax -->, <span>$1 &lt; a &lt; n - 1$</span><!-- Has MathJax --><br>(3) if (<code>_______</code>) then return (“maybe prime”)<br>(4) for <span>$j = 0$</span><!-- Has MathJax --> to <span>$k - 1$</span><!-- Has MathJax --> do<br>(5)     if (<code>_________</code>) then return (“maybe prime”)<br>(6) return (“composite”)</p>
</li>
<li><p>Please describe details of the Chinese remainder theorem for the case of <span>$n = p \times q$</span><!-- Has MathJax --> where both <span>$p$</span><!-- Has MathJax --> and <span>$q$</span><!-- Has MathJax --> are primes. (Your anseer should include how to transform an ordinary domain integer <span>$A$</span><!-- Has MathJax --> to the CRT domain, and the CRT formula used to inverse-transform the CRT domain representation back to the ordinary domain integer).</p>
</li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><p>基礎步驟如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(1) A -&gt; KDC : IDA || IDB || N1</div><div class="line">(2) KDC -&gt; A : E(Ka, [Ks || IDA || IDB || N1]) || E(Kb, [Ks || IDA])</div><div class="line">(3) A -&gt; B   : E(Kb, [Ks || IDA])</div><div class="line">(4) B -&gt; A   : E(Ks, N2)</div><div class="line">(5) A -&gt; B   : E(Ks, f(N2))</div></pre></td></tr></table></figure>
<p>如果沒有 <span>$N_1$</span><!-- Has MathJax -->，紀錄 <code>IDA || IDB、E(Ka, [Ks || IDA || IDB]) || E(Kb, [Ks || IDA])</code>，就能假冒 KDC 讓 A 用固定的 <span>$K_s$</span><!-- Has MathJax --> 去跟 B 連線。再藉由已知明文，就能知道雙方的溝通內容，進行竊聽。</p>
<p>為了讓 A 知道 B 擁有 <span>$K_s$</span><!-- Has MathJax --> 修改其中兩個步驟</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">modify  (3) E(Kb, [Ks || IDA]) || Nx</div><div class="line">        (4) E(Ks, N2 || Nx)</div></pre></td></tr></table></figure>
<h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><ul>
<li>link encryption 屬於 router 之間的通訊，屬於低階網路層協定，在每一條連輸線路各自獨立的加解密，會修改訊息 header，可以增加 padding，保護流量偵測。</li>
<li>end-to-end encryption 屬於原點、目的地之間的加密，它們共同享有一把 shared key，屬於高階網路層協定，用來保護資料安全，訊息 header 保留給傳輸用。</li>
</ul>
<h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><p>Fermat’s theorem : </p>
<p>$<span>$a^{p-1} \equiv 1 (\text{mod } p)$</span><!-- Has MathJax -->$</p>
<p>為了要求 <span>$x^{-1}$</span><!-- Has MathJax -->，則利用費馬小定理 <span>$x^{p-2} \times x \equiv 1 (\text{mod } p)$</span><!-- Has MathJax -->，因此 <span>$x^{-1} \equiv x^{p-2} (\text{mod }p)$</span><!-- Has MathJax -->，特別小心 <span>$p$</span><!-- Has MathJax --> 一定要是質數，且滿足 <span>$gcd(x, p) = 1$</span><!-- Has MathJax -->。</p>
<h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><p>Euler’s theorem</p>
<p>$<span>$a^{\phi(n)} \equiv 1 (\text{mod } n) \text{ , }gcd(a, n) = 1$</span><!-- Has MathJax -->$</p>
<p>先來複習一下 RSA 算法的產生與加解密</p>
<ol>
<li>select two large primes <span>$p$</span><!-- Has MathJax --> and <span>$q$</span><!-- Has MathJax --> at random.</li>
<li>Let <span>$N = p \times q$</span><!-- Has MathJax -->, <span>$\phi(N) = (p-1)(q-1)$</span><!-- Has MathJax --></li>
<li>select (at random or fixed) the encryption key <span>$e$</span><!-- Has MathJax --><br> where <span>$1 &lt; e &lt; \phi(N)$</span><!-- Has MathJax -->, <span>$gcd(e,\phi(N))=1$</span><!-- Has MathJax --><br> so, <span>$e^{-1} \mod \phi(N)$</span><!-- Has MathJax --> exists</li>
<li>solve following equation to find decryption key <span>$d = e^{-1}$</span><!-- Has MathJax -->, <span>$e \times d \mod \phi(N)=1$</span><!-- Has MathJax --></li>
<li>publish public/encryption key:<span>$KP = \left \{ e,N \right \}$</span><!-- Has MathJax --></li>
<li>keep secret private/decryption key:<span>$KS = \left \{ d, p, q \right \}$</span><!-- Has MathJax --></li>
</ol>
<p>encrypt a message <span>$M$</span><!-- Has MathJax --> the sender:</p>
<ul>
<li>obtains public key of <strong> recipient </strong><span>$KP = \left \{ e,N \right \}$</span><!-- Has MathJax --></li>
<li>computes: <span>$C = M^e \mod N$</span><!-- Has MathJax --></li>
</ul>
<p>decryption a ciphertext <span>$C$</span><!-- Has MathJax --></p>
<ul>
<li>uses his private key<span>$KS = \left \{ d, p, q \right \}$</span><!-- Has MathJax --></li>
<li>computes: <span>$M = C^d \mod N$</span><!-- Has MathJax --></li>
</ul>
<p>用來加解密，為什麼會是正確的呢？</p>
<span>$$\begin{align}
&amp; M \equiv (M^e)^d \mod N \\
&amp; M \equiv M^{ed} \mod N  \\
&amp; \because ed \equiv 1 \mod \phi(N) \text{ and Euler&apos;s theorem} \\
&amp; \therefore M \equiv M^{ed \mod \phi(N)} \mod N \\
&amp; M \equiv M^{1} \mod N
\end{align}$$</span><!-- Has MathJax -->
<p>這裡很神祕，假設 <span>$n = 21$</span><!-- Has MathJax -->，則 <span>$phi(n) = 12$</span><!-- Has MathJax -->，根據歐拉公式 <span>$3^{12} \equiv 15 \mod 21$</span><!-- Has MathJax --> 違反歐拉定理，但是在 ACM-ICPC 競賽中，有一點明白到，<span>$a^i$</span><!-- Has MathJax --> 在 <span>$\mod n$</span><!-- Has MathJax --> 下的餘數循環節長度 L，則滿足 <span>$L | phi(n)$</span><!-- Has MathJax -->，藉由這一點來正確解密，至於到底算不算利用歐拉定理仍是個有趣問題。</p>
<h3 id="Part-5"><a href="#Part-5" class="headerlink" title="Part 5"></a>Part 5</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(1) 2^k q</div><div class="line">(3) a^q == 1 mod n</div><div class="line">(5) a^(2^j q) == n-1 mod n</div></pre></td></tr></table></figure>
<h3 id="Part-6"><a href="#Part-6" class="headerlink" title="Part 6"></a>Part 6</h3><p>雖然題目要求得不多，這裡直接拿 RSA 作範例</p>
<ol>
<li><span>$N = p \times q$</span><!-- Has MathJax -->
</li>
<li><p>目標計算 <span>$M = C^d \mod N$</span><!-- Has MathJax --><br>分開計算得到兩個部分，這裡可以利用歐拉定理加快，因此 <span>$d$</span><!-- Has MathJax --> 可以先 <span>$\mod \phi(p)$</span><!-- Has MathJax --></p>
<span>$Mp = C^d \mod p$</span><!-- Has MathJax -->
<span>$Mq = C^d \mod q$</span><!-- Has MathJax -->
</li>
<li><p>套用中國餘式定理 CRT，簡單的模型如下： </p>
<span>$a_i = M \mod m_i$</span><!-- Has MathJax -->
<span>$M = a_1 c_1 + a_2 c_2 + \text{ ... }$</span><!-- Has MathJax -->
<span>$Mi = m_1 \times m_2 ... \times m_n / m_i$</span><!-- Has MathJax -->
<span>$c_i = M_i \times (M_i^{-1}) \mod m_i$</span><!-- Has MathJax -->
</li>
<li><p>因此 RSA 可以預先處理 <span>$c_p = q \times (q^{-1} \mod p)$</span><!-- Has MathJax --> 和 <span>$c_q = p \times (p^{-1} \mod q)$</span><!-- Has MathJax -->，還原的算法則是 <span>$M = Mp \times c_p + Mq \times c_q \mod N$</span><!-- Has MathJax --></p>
</li>
</ol>
<p>結論，由於拆分後的 bit length 少一半，乘法速度快 4 倍，快速冪次方快 2 倍 (次方的 bit length 少一半)，但是要算 2 次，最後共計快 4 倍。CPU 的乘法想必不會用快速傅立葉 FFT 來達到乘法速度為 <span>$O(n \log n)$</span><!-- Has MathJax --></p>
<p>但是利用 CRT 計算容易受到硬體上攻擊，因為會造成 <span>$p, q$</span><!-- Has MathJax --> 在分解過程中獨立出現，當初利用 <span>$N$</span><!-- Has MathJax --> 很難被分解的特性來達到資訊安全，但是卻因為加速把 <span>$p, q$</span><!-- Has MathJax --> 存放道不同時刻的暫存器中。</p>
<p>其中一種攻擊，計算得到 <span>$M = Mp \times q \times (q^{-1} \mod p) + Mq \times p \times (p^{-1} \mod q) \mod N$</span><!-- Has MathJax --> 當擾亂後面的式子 (提供不穩定的計算結果)。得到 <span>$M&apos; = Mp \times q \times (q^{-1} \mod p) + (Mq + \Delta) \times p \times (p^{-1} \mod q) \mod N$</span><!-- Has MathJax --></p>
<p>接著 <span>$(M&apos; - M) = (\Delta&apos; \times p) \mod N$</span><!-- Has MathJax -->，若要求 <span>$p$</span><!-- Has MathJax --> 的方法為 <span>$gcd(M&apos; - M, N) = gcd(\Delta&apos; \times p, N) = p$</span><!-- Has MathJax -->，輾轉相除的概念呼之欲出，原來 <span>$p$</span><!-- Has MathJax --> 會被這麼夾出，當得到兩個 <span>$p, q$</span><!-- Has MathJax -->，RSA 算法就會被破解。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/16/security-notes3/" class="article-date">
  <time datetime="2015-05-16T00:52:18.000Z" itemprop="datePublished">2015-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/16/security-notes3/">近代加密 快速冪次計算</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/05/16/security-notes3/" data-id="ckq5yoy4t00ero4vnxvjqr8is" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/05/16/security-notes3/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/分治算法/">分治算法</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/模乘法/">模乘法</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <p>先來上競賽中最常見到的快速冪次寫法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">long long mul(long long a, long long b, long long mod) &#123; </div><div class="line">    long long ret = 0; </div><div class="line">    for( ; b != 0; b&gt;&gt;=1, (a&lt;&lt;=1)%=mod) </div><div class="line">        if(b&amp;1) (ret += a) %= mod; </div><div class="line">    return ret; </div><div class="line">&#125;</div><div class="line">long long mpow(long long x, long long y, long long mod) &#123;</div><div class="line">    long long ret = 1;</div><div class="line">    while (y) &#123;</div><div class="line">        if (y&amp;1)</div><div class="line">            ret = mul(ret, x, mod);</div><div class="line">        y &gt;&gt;= 1, x = mul(x, x, mod);</div><div class="line">    &#125;</div><div class="line">    return ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>這樣的寫法，只運算 64-bits 內的結果相當不錯，與接下來講的算法速度差異並不大。但對於近代加密所需要的離散對數過程，則會有放大速度差異，因為 x, y, mod 三個參數的 bit-length 都相當長。</p>
<h2 id="Right-To-Left"><a href="#Right-To-Left" class="headerlink" title="Right-To-Left"></a>Right-To-Left</h2><p>做法就是最普遍見到的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">void pow(x, a) &#123;</div><div class="line">    R = 1, g = x</div><div class="line"></div><div class="line">    for i = 0 to n, step 1</div><div class="line">        if (a[i] == 1) // a[i] mean i-bit in a</div><div class="line">            R = R * g</div><div class="line">        g = g * g</div><div class="line">    return R</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">example: a = 26 = (11010)</div><div class="line">---</div><div class="line">#iterator  0   1    2    3     4 </div><div class="line">#g         x, x^2, x^4, x^8, x^16, ...</div><div class="line">binary     0   1    0    1     1</div><div class="line">x^a =         x^2       x^8 x^16 = x^26</div></pre></td></tr></table></figure>
<h2 id="Left-To-Right"><a href="#Left-To-Right" class="headerlink" title="Left-To-Right"></a>Left-To-Right</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">void pow(x, a) &#123;</div><div class="line">    R = 1</div><div class="line">    for i = n-1 to 0, step -1</div><div class="line">        R = R ^ 2</div><div class="line">        if (a[i] == 1)</div><div class="line">            R = R * x</div><div class="line">    return R;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">example: a = 26 = (11010)</div><div class="line">---</div><div class="line">#iterator  0   1    2      3     4 </div><div class="line">binary     1   1    0      1     0</div><div class="line">R         x^1 x^11 x^110 x^1101 x^11010</div></pre></td></tr></table></figure>
<p>也就是說，每一次迭代，將會將指數左移 (<code>R = R ^ 2</code> 就是要移動 <code>R^xxxx</code> 變成 <code>R^xxxx0</code>，切著看是否要乘上 x 來變成 <code>R^xxxx1</code>)，這方法雖然不錯，但是計算高位元空迴圈可是不能忽略！當然對於設計電路的人，固定變量的迴圈展開後就不存在這問題。</p>
<p>效能上，期望的乘法次數與 Right-To-Left 是差不多的！長度為 n bits 的數字，期望值會有 <span>$n/2$</span><!-- Has MathJax --> 個 1，因此大約需要 <span>$n/2$</span><!-- Has MathJax --> 次乘法。</p>
<h2 id="Left-To-Right-2-bits"><a href="#Left-To-Right-2-bits" class="headerlink" title="Left-To-Right(2-bits)"></a>Left-To-Right(2-bits)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">void pow(x, a) &#123;</div><div class="line">    pre-computation: x^2, x^3</div><div class="line"></div><div class="line">    R = 1</div><div class="line">    for i = n/2 to 0, step -2</div><div class="line">        R = R ^ 4</div><div class="line">        if (a[i+1]a[i] != 0)</div><div class="line">            R = R * x^(a[i+1]a[i])</div><div class="line">    return R</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">example: a = 1737 = (01 10 11 00 10 01)</div><div class="line">---</div><div class="line">#iterator   0   1    2     3     4     5</div><div class="line">R          x^1 x^4  x^24  x^108 x^432 x^1736</div><div class="line">               x^6  x^27        x^434 x^1737</div><div class="line">a[i+1]a[i] 01  10   11    00    10    01</div></pre></td></tr></table></figure>
<p>長度為 n bits 的數字，倆倆一起期望值會有 <span>$3n/8$</span><!-- Has MathJax --> 個非 0 (00, 01, 10, 11 中 4 個有 3 個 <span>$!= 0$</span><!-- Has MathJax -->，計算組數只有 <span>$n/2$</span><!-- Has MathJax -->)，因此大約需要 <span>$3n/8$</span><!-- Has MathJax --> 次乘法。比剛剛快上一點呢 ( <span>$3n/8 &lt; n/2$</span><!-- Has MathJax --> )！</p>
<h2 id="Left-To-Right-sliding"><a href="#Left-To-Right-sliding" class="headerlink" title="Left-To-Right(sliding)"></a>Left-To-Right(sliding)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">void pow(x, a) &#123;</div><div class="line">    pre-computation: x^3</div><div class="line"></div><div class="line">    R = 1</div><div class="line">    for i = n-1 to 0</div><div class="line">        if a[i]a[i-1] = (11)</div><div class="line">            R = R ^ 4</div><div class="line">            R = R * x^3</div><div class="line">            i -= 2</div><div class="line">        else if a[i]a[i-1] = (00)</div><div class="line">            R = R ^ 4</div><div class="line">            i -= 2</div><div class="line">        else if a[i] = (0)</div><div class="line">            R = R ^ 2</div><div class="line">            i -= 1</div><div class="line">        else if a[i] = (1)</div><div class="line">            R = R ^ 2</div><div class="line">            R = R * x</div><div class="line">            i -= 1</div><div class="line">    return R</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">example: a = (1 10 11 00 10 01)</div><div class="line">---</div><div class="line">#iterator   0   1    2       3     4      5          6</div><div class="line">R          x^11    x^11011     x^11011001      x^11011001001</div><div class="line">              x^110     x^1101100    x^1101100100</div></pre></td></tr></table></figure>
<p>期望的乘法次數 <span>$n/3$</span><!-- Has MathJax -->，這很可怕，別問我！</p>
<h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><table>
<thead>
<tr>
<th>Algorithm Name</th>
<th>Table Size</th>
<th>#squaring</th>
<th>Average #Multiplication</th>
</tr>
</thead>
<tbody>
<tr>
<td>Right-To-Left</td>
<td>1: <span>$x^{2^i}$</span><!-- Has MathJax --></td>
<td><span>$n$</span><!-- Has MathJax --></td>
<td><span>$n/2$</span><!-- Has MathJax --></td>
</tr>
<tr>
<td>Left-To-Right</td>
<td>1: <span>$x$</span><!-- Has MathJax --></td>
<td><span>$n$</span><!-- Has MathJax --></td>
<td><span>$n/2$</span><!-- Has MathJax --></td>
</tr>
<tr>
<td>Left-To-Right(2-bits)</td>
<td>3: <span>$x$</span><!-- Has MathJax -->, <span>$x^2$</span><!-- Has MathJax -->, <span>$x^3$</span><!-- Has MathJax --></td>
<td><span>$n$</span><!-- Has MathJax --></td>
<td><span>$3n/8$</span><!-- Has MathJax --></td>
</tr>
<tr>
<td>Left-To-Right(sliding)</td>
<td>2: <span>$x$</span><!-- Has MathJax -->, <span>$x^3$</span><!-- Has MathJax --></td>
<td><span>$n$</span><!-- Has MathJax --></td>
<td><span>$n/3$</span><!-- Has MathJax --></td>
</tr>
</tbody>
</table>
<h2 id="Attack"><a href="#Attack" class="headerlink" title="Attack"></a>Attack</h2><p>上述四種方法中，不外乎都存在 <strong><em> Conditional Jump </em></strong> 出現，會導致執行速度跟程式計數器 (Program Counter) 移動上會有所差別。可以進行實作攻擊，從分析時間、電源不穩攻擊，來找到 <span>$a$</span><!-- Has MathJax --> 究竟是何物 (通常要偷的都是 <span>$x^a$</span><!-- Has MathJax --> 上面的 <span>$a$</span><!-- Has MathJax -->)！電源雜訊干擾於當指令執行到 <strong> Conditional Jump </strong> 時，干擾 <span>$R$</span><!-- Has MathJax --> 的計算發生錯誤，如果沒有發生錯誤，表示 <span>$a \left [ i \right ] = 0$</span><!-- Has MathJax -->，反之就能知道 <span>$a \left [ i \right ] = 1$</span><!-- Has MathJax -->。</p>
<p>很趣味地是提供一個不需要 Conditional Jump 的寫法 (實作上)，一樣會有這種問題！</p>
<h3 id="error-example"><a href="#error-example" class="headerlink" title="error example"></a>error example</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">R[1] = 1</div><div class="line">for i = n-1 to 0, step -1</div><div class="line">    R[1] = R[1] ^ 2</div><div class="line">    R[a[i]] = R[1] × g</div><div class="line">return R[1]</div></pre></td></tr></table></figure>
<p>提供一個不相干的垃圾暫存器 (redundancy register) 來減少 Jump 的問題，很明顯地 電源雜訊干擾 的攻擊仍然存在！這作法很有趣的啊！只是會被攻擊。</p>
<h3 id="Montgomery-Ladder"><a href="#Montgomery-Ladder" class="headerlink" title="Montgomery Ladder"></a>Montgomery Ladder</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">R[0] = 1, R[1] = g</div><div class="line">for i = n-1 to 0, step -1</div><div class="line">    R[1-a[i]] = R[0] × R[1]</div><div class="line">    R[a[i] = R[a[i]] × R[a[i]]</div><div class="line">return R[0]</div></pre></td></tr></table></figure>
<p>這作法避開之前的問題，解決其中一種被攻擊的方案。</p>
<p>過程中都滿足 <span>$R \left [ 0 \right ] = R \left [ 1 \right ] \times g$</span><!-- Has MathJax -->，同時 <span>$R \left [ 0 \right ]$</span><!-- Has MathJax --> 會是最後的答案。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">example: a = 26 = (11010)</div><div class="line">---</div><div class="line">#iterator  0   1    2      3      4     5</div><div class="line">binary     0   1    1      0      1     0</div><div class="line">R[0]       1   x    x^3   x^6   x^13  x^26</div><div class="line">R[1]       x   x^2  x^4   x^7   x^14</div></pre></td></tr></table></figure>
<p>明顯地，<span>$R \left [ 1 \right ]$</span><!-- Has MathJax --> 的計算是為了下一次為 <span>$a \left [ i+1 \right ] = 1$</span><!-- Has MathJax --> 而存在的！</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/05/16/security-notes2/" class="article-date">
  <time datetime="2015-05-15T23:22:05.000Z" itemprop="datePublished">2015-05-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/05/16/security-notes2/">資訊安全 期中考筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/05/16/security-notes2/" data-id="ckq5yoy4s00eoo4vn67x7insa" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/05/16/security-notes2/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>筆記錯誤多多，請以僅供參考的角度去質疑</p>
</blockquote>
<h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><ol>
<li><p>Please compare the <em>CFB</em> mode the <em>OFB</em> mode by providing a table indicating at least 5 of their advantage and corresponding disadvantage.</p>
</li>
<li><p>This question is about issues of random access of encryption and decryption. Define notations or symbols you need before providing your answer. Please describe how to use <em>CFB</em> mode and <em>CTR</em> mode to randomly encrypt and decrypt a file Why <em>OFB</em> mode is inappropriate to randomly encrypt and decrypt a file?</p>
</li>
<li><p>What is the one-time pad (please provide a figure to explain it) and what is the main security requirement ?</p>
</li>
<li><p>Follow</p>
<ol>
<li>What is the main weakness (disadvantage) of <em>ECB</em> mode ?</li>
<li>How <em>CBC</em> resolves this security problem (explained in mathematical approach) ?</li>
</ol>
</li>
<li><p>Follow </p>
<ol>
<li>Block ciphers process messages in blocks like an extremely large substitution, but this is very difficult to implement for a very big block size. What is Shannon’s idea to realize a block cipher with big block size ?</li>
<li>Feistel cipher structure provides a real implementation of Shannon’s idea. Please explain the main features of Feistel cipher structure.</li>
</ol>
</li>
<li><p>What is the <strong> avalanche effect </strong> of a block cipher ?</p>
</li>
<li><p>What is the <strong> Triple </strong> -DES with two keys ? Please explain the process the derive the complexity of <strong> meet-in-the-middle attack </strong> on Triple-DES with two keys.</p>
</li>
<li><p>For all <em>AES</em> round operations, which operation(s) provides <strong> substitution </strong> and which operations(s) provides <strong> diffusion </strong> ?</p>
</li>
<li><p>Please describe the details of <em>BBS</em> pseudorandom number generator.</p>
</li>
<li><p>Below is the pseduo code of <em>RC4</em>. Please design a modified <em>RC4</em> version with <strong> message dependent </strong> property of key stream.</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">init(master_key) // shuffle S-array with master_key</div><div class="line"></div><div class="line">i = j = 0</div><div class="line">for each message byte M</div><div class="line">    i = (i + 1) mod 256</div><div class="line">    j = (j + S[i]) mod 256</div><div class="line">    swap(S[i], S[j])</div><div class="line">    t = (S[i] + S[j]) mod 256</div><div class="line">    C = M xor S[t]</div></pre></td></tr></table></figure>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><p>請參照 《資訊安全 小考筆記》</p>
<h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><p>請參照 《資訊安全 小考筆記》</p>
<h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><p>one-time pad 概念圖如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">                +------------+               +------------+               </div><div class="line">                | random key |               | random key |               </div><div class="line">                | generator  |               | generator  |               </div><div class="line">                +------------+               +------------+               </div><div class="line">                      |                             |                     </div><div class="line">                      |                             |                     </div><div class="line">                      | Ki                          | Ki                  </div><div class="line">                      |                             |                     </div><div class="line">                      |                             |                     </div><div class="line">       Pi          +--v--+           Ci          +--v--+       Pi         </div><div class="line">------------------&gt;+ XOR +----------------------&gt;+ XOR +----------------&gt; </div><div class="line">                   +-----+                       +-----+                  </div><div class="line">                                                                          </div><div class="line">                   From Alice                    To Blob</div></pre></td></tr></table></figure>
<p>one-time pad 主要是靠 key 不重複使用來維護資料安全，但是雙方同時產生出相同的 random key 是很困難。由於不重複使用，靠一個 random key 的產生提供 random mask 消除明文和祕聞之間的關係。但是雙方都要相同 random key 是相當困難的，通常 generator 是由某個偽隨機數產生器，由演算法產生的到底是不是隨機數呢？</p>
<p>一定要 random key，不能有任何的 dependent、 <strong> 不能重複 (reuse) </strong>，否則會有 <strong> 已知明文攻擊 </strong>。</p>
<h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><p>ECB mode 在相同明文對應相同的密文，這容易受到大多數的攻擊，如收集已知明文或密文所進行的攻擊。由於明文和密文的關係明確，也因此在 <strong> 圖片資料 </strong> 加密傳送，會出現 <strong> 大量重複 </strong> 的密文。</p>
<p>CBC mode 提供 random mask 的效果</p>
<span>$$C_{-1} = IV \\
C_{i} = E_{k}(C_{i-1} \text{ XOR } P_{i}) \\$$</span><!-- Has MathJax -->
<p>從<span>$C_{i-1} \text{ XOR } P_{i}$</span><!-- Has MathJax --> 操作中可以發現到，讓相同的明文對應到不同的密文 (在前一個密文不同時)，解決 ECB 在相同明文加密只會對應種密文。</p>
<h3 id="Part-5"><a href="#Part-5" class="headerlink" title="Part 5"></a>Part 5</h3><p>Shannon’s idea 請參照 《資訊安全 小考筆記》</p>
<p>Feistel cipher structure 藉由三個規則實作</p>
<ul>
<li>多個回合 (round)</li>
<li>藉由一半的訊息加密另一半的訊息</li>
<li>兩個半段訊息位置交換</li>
</ul>
<h3 id="Part-6"><a href="#Part-6" class="headerlink" title="Part 6"></a>Part 6</h3><p>Avalanche effect 讓相似的明文 Pi, Pj (漢明距離 <span>$H(Pi, Pj) = 1$</span><!-- Has MathJax --> … 之類的) 對應的密文 Ci, Cj 能有相當大的差異 (漢明距離 <span>$H(Ci, Cj) = \text{half-bit}$</span><!-- Has MathJax --> 的期望值)，將只有一點不同的差異，擴散到密文的每個地方，放大差異的效果。</p>
<h3 id="Part-7"><a href="#Part-7" class="headerlink" title="Part 7"></a>Part 7</h3><p>Triple-DES</p>
<span>$E_{k_{1}}\left [ D_{k_{2}} \left [ E_{k_{1}} \left [ P_{i} \right ] \right ] \right ] = C_{i}$</span><!-- Has MathJax -->
<p>當指使用兩次的 DES，受到中間相遇法的攻擊，理論上的複雜度與 1 個 DES 一樣，複雜度大約都在 <span>$O(2^{56})$</span><!-- Has MathJax -->，因此效果並沒有變得更好。然而在 Triple-DES 複雜度就提升到 <span>$O(2^{112})$</span><!-- Has MathJax -->。</p>
<h4 id="中間相遇法攻擊"><a href="#中間相遇法攻擊" class="headerlink" title="中間相遇法攻擊"></a>中間相遇法攻擊</h4><span>$$X = D_{k_{2}} \left [ E_{k_{1}} \left [ P_{i} \right ] \right ] \\
C_{i} = E_{k_{1}} \left [ Y \right ]$$</span><!-- Has MathJax -->
<p>從已知的明文、密文，目標是讓 <span>$X = Y$</span><!-- Has MathJax -->，窮舉 key，如果發生 <span>$X = Y$</span><!-- Has MathJax --> 則表示找到一組可行的解。窮舉得到 <span>$X$</span><!-- Has MathJax --> 的複雜度為 <span>$O(2^{56} \times 2^{56}) = O(2^{112})$</span><!-- Has MathJax -->，而 <span>$Y$</span><!-- Has MathJax --> 則需要 <span>$O(2^{56})$</span><!-- Has MathJax -->，當 <span>$X = Y$</span><!-- Has MathJax --> 符合時，則表示 key 找到！</p>
<p>當然也可以抽換相遇的地點，如下是另外一種</p>
<span>$$X = E_{k_{1}} \left [ P_{i} \right ] \\
C_{i} = E_{k_{1}} \left [ D_{k_{2}} \left [ Y \right ] \right ]$$</span><!-- Has MathJax -->
<p>不管怎麼切割，都至少要窮舉兩把 key 來得到其中一個相遇結果，複雜度都落在 <span>$O(2^{112})$</span><!-- Has MathJax -->。如果說對應兩個表的結果需要 <span>$O(log \text{ n})$</span><!-- Has MathJax --> 的時間，則複雜度為 <span>$O(112 \times 2^{112})$</span><!-- Has MathJax -->。</p>
<h3 id="Part-8"><a href="#Part-8" class="headerlink" title="Part 8"></a>Part 8</h3><table>
<thead>
<tr>
<th>Step</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>Substition Bytes</td>
<td>substitution</td>
</tr>
<tr>
<td>Shift Rows</td>
<td>diffusion</td>
</tr>
<tr>
<td>Mix Column</td>
<td>diffusion, substitution</td>
</tr>
<tr>
<td>Add Round Key</td>
<td>substitution</td>
</tr>
</tbody>
</table>
<p>比較討厭的是 Shift Rows 為什麼提供是 diffusion，明明對於兩個相似明文加密上，漢明距離沒有增加！但是 diffusion 不只是讓差異數量增加，還要考量差異位置的變動，相鄰差異的位置被轉移到兩個遠處，就能提供 diffusion！這會讓攻擊者無從判定差異的對應。</p>
<h3 id="Part-9"><a href="#Part-9" class="headerlink" title="Part 9"></a>Part 9</h3><p><a href="http://en.wikipedia.org/wiki/Blum_Blum_Shub" target="_blank" rel="external">Blum Blum Shub</a></p>
<span>$$X_{i} = X_{i-1}^2 \text{mod } N \\
N = p \times q \\
p, q \text{ is prime nubmer, } \\
p \equiv 3 (\text{mod } 4) \\
q \equiv 3 (\text{mod } 4)$$</span><!-- Has MathJax -->
<h3 id="Part-10"><a href="#Part-10" class="headerlink" title="Part 10"></a>Part 10</h3><p><strong> message dependent </strong> RC4</p>
<p>第一版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">i = j = 0, Cprev = 0</div><div class="line">for each message byte M</div><div class="line">    i = (i + 1) mod 256</div><div class="line">    j = (j + S[i]) mod 256</div><div class="line">    swap(S[i], S[j])</div><div class="line">    t = (S[i] + S[j] + Cprev) mod 256</div><div class="line">    C = M xor S[t]</div><div class="line">    if sender</div><div class="line">        Cprev = C</div><div class="line">    if receiver</div><div class="line">        Cprev = M</div></pre></td></tr></table></figure>
<p>好像不管怎麼寫兩邊似乎都很難相同。</p>
<p>第二版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">i = j = 0, C = 0</div><div class="line">for each message byte M</div><div class="line">    i = (i + C) mod 256</div><div class="line">    j = (j + S[i]) mod 256</div><div class="line">    swap(S[i], S[j])</div><div class="line">    t = (S[i] + S[j]) mod 256</div><div class="line">    C = M xor S[t]</div></pre></td></tr></table></figure>
<p>感覺上述的寫法，萬一 C 被竄改，會導致錯誤擴散，而且是全部失效，這讓我非常納悶。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-galois-field" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/25/security-galois-field/" class="article-date">
  <time datetime="2015-04-25T11:16:42.000Z" itemprop="datePublished">2015-04-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/25/security-galois-field/">資訊安全 Galois Fields C++ 軟體實作體驗</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/25/security-galois-field/" data-id="ckq5yoy4r00ejo4vnj93qyu8u" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/25/security-galois-field/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>在 AES 中，利用 Galois fields<span>$GF(2^{8})$</span><!-- Has MathJax --> 為運算單位，有效地在 8-bits CPU 上高效地實作。</p>
<p>Galois Fields<span>$GF(p^{n})$</span><!-- Has MathJax --> 限定在質數 p 的 n 次方，便可存在有限的元素集合，支持加減乘除，同時可以利用 <strong> 擴充歐幾里算法 </strong> 得得到乘法反元素。從最簡單的 p = 2 開始看起，將 f(x) 視為一個元素。則</p>
<span>$$f(x) = a_{n-1}x^{n-1} + a_{n-2}x^{n-2} + ... + a_{1}x + a_{0} \\
a_{i} \in [0, p)$$</span><!-- Has MathJax -->
<p>當 p = 2 時，f(x) 就跟一般的二進制數字儲存相同。當選定在 p 的 n 次方時，必須找一個 degree = n 的多項式，不被集合內的任何元素整除，來約束所有的運算保持在一個大小內。特別的是當 p = 2 時，加法和減法是等價運算 (在 p = 2 下，1 乘法反元素是自己本身)。</p>
<p>AES 取 8-bits 作為運算單位的用意很多，其一反元素可以在極小空間內儲存，可以用查表的方式得到。之所以選定 p = 2 的好處在於計算機的儲存架構，若在某些特殊硬體可以支持三進位的情況下，p = 3 則會比較有效率的使用，不然取用 p = 3 在二進制的電腦架構，需要轉換的儲存單位是很沒效率，並且覆蓋的集合大小也沒辦法全部使用。</p>
<p>GF 有什麼好處呢？其一的道理在於加解密設計要 <strong> 防止線性關係 </strong> (線性代數太邪惡，很多種攻擊可以繞過線性關係的運算，拋開未知數也能求解)，對於 AES 的設計概念來說 GF 恰好符合這個條件。</p>
<h3 id="AES"><a href="#AES" class="headerlink" title="AES"></a>AES</h3><p>AES 選用<span>$GF(2^{8})$</span><!-- Has MathJax -->，並且取<span>$m(x) = x^8 + x^4 + x^3 + x + 1$</span><!-- Has MathJax --> 作為模數，然後再設計一個以 GF 作為常數類型的多項式 Polynominal</p>
<span>$f(x) = s_{3}x^{3} + s_{2}x^{2} + s_{1}x + s_{0}$</span><!-- Has MathJax -->
<p>每一個<span>$s_{i}$</span><!-- Has MathJax --> 都是一個 8-bits 的儲存單位，也就是說這個多項式是 32-bits 儲存。並且取用<span>$m(x) = x^4 + 1$</span><!-- Has MathJax --> 作為多項式的模數。AES 藉由 <strong> 多項式相乘 </strong>，將 4 個 8-bits 的資料交互影響產生出新的 4 個 8-bits，這在密碼學裡面造成 <strong> 雪崩效應 </strong>。</p>
<p>跟之前講的一樣，GF 一定存在反操作，也就是乘法反元素，因此取用<span>$03 x^{3} + 01 x^{2} + 01 x^{1} + 02$</span><!-- Has MathJax --> 其乘法反元素為<span>$0B x^{3} + 0D x^{2} + 09 x^{1} + 0E$</span><!-- Has MathJax -->。</p>
<p>接著，寫一個程式驗證反元素的計算吧！</p>
<blockquote>
<p>備註：GF 裡面套用 GF 相當有趣，感覺可以無限擴充大小，當然任意質數也可以找反元素，但也只有 <strong> 梅森質數 </strong> 比較適合在電腦二進制系統中吧？</p>
</blockquote>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">no input</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">00 01 8D F6 CB 52 7B D1 E8 4F 29 C0 B0 E1 E5 C7</div><div class="line">74 B4 AA 4B 99 2B 60 5F 58 3F FD CC FF 40 EE B2</div><div class="line">3A 6E 5A F1 55 4D A8 C9 C1 0A 98 15 30 44 A2 C2</div><div class="line">2C 45 92 6C F3 39 66 42 F2 35 20 6F 77 BB 59 19</div><div class="line">1D FE 37 67 2D 31 F5 69 A7 64 AB 13 54 25 E9 09</div><div class="line">ED 5C 05 CA 4C 24 87 BF 18 3E 22 F0 51 EC 61 17</div><div class="line">16 5E AF D3 49 A6 36 43 F4 47 91 DF 33 93 21 3B</div><div class="line">79 B7 97 85 10 B5 BA 3C B6 70 D0 06 A1 FA 81 82</div><div class="line">83 7E 7F 80 96 73 BE 56 9B 9E 95 D9 F7 02 B9 A4</div><div class="line">DE 6A 32 6D D8 8A 84 72 2A 14 9F 88 F9 DC 89 9A</div><div class="line">FB 7C 2E C3 8F B8 65 48 26 C8 12 4A CE E7 D2 62</div><div class="line">0C E0 1F EF 11 75 78 71 A5 8E 76 3D BD BC 86 57</div><div class="line">0B 28 2F A3 DA D4 E4 0F A9 27 53 04 1B FC AC E6</div><div class="line">7A 07 AE 63 C5 DB E2 EA 94 8B C4 D5 9D F8 90 6B</div><div class="line">B1 0D D6 EB C6 0E CF AD 08 4E D7 E3 5D 50 1E B3</div><div class="line">5B 23 38 34 68 46 03 8C DD 9C 7D A0 CD 1A 41 1C</div><div class="line">03 x^3 + 01 x^2 + 01 x^1 + 02 x^0</div><div class="line">0B x^3 + 0D x^2 + 09 x^1 + 0E x^0</div><div class="line">00 x^3 + 00 x^2 + 00 x^1 + 01 x^0</div><div class="line">0B x^3 + 0D x^2 + 09 x^1 + 0E x^0</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>暴力實作，模擬運算，不考慮電路架構，用最樸素的方式儲存每一個欄位。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">// in AES, GF(2^8), m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GaloisField</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> v[<span class="number">32</span>];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    GaloisField() &#123;</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">    &#125;</div><div class="line">    GaloisField(<span class="keyword">int</span> val) &#123;</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">8</span>; i++)</div><div class="line">            v[i] = (val&gt;&gt;i)&amp;<span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    GaloisField(<span class="keyword">const</span> <span class="keyword">int</span> a[], <span class="keyword">int</span> an) &#123;</div><div class="line">        <span class="built_in">memset</span>(v, <span class="number">0</span>, <span class="keyword">sizeof</span>(v));</div><div class="line">        n = <span class="number">8</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= an; i++)</div><div class="line">            v[i] = a[i];</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>+(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r.n; i++)</div><div class="line">            r.v[i] = v[i] xor a.v[i];</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>-(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> (*<span class="keyword">this</span>) + a;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>*(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a.n; j++) </div><div class="line">                r.v[i+j] = r.v[i+j] xor (v[i] <span class="keyword">and</span> a.v[j]);</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GaloisField <span class="title">shift</span><span class="params">(<span class="keyword">int</span> sn)</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        GaloisField r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            r.v[i + sn] = v[i];</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span> &amp;&amp; a.v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span> &amp;&amp; a.v[i] == <span class="number">0</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">0</span> &amp;&amp; a.v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>/(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (a.v[i] == <span class="number">1</span> &amp;&amp; v[i] == <span class="number">0</span>)</div><div class="line">                <span class="keyword">return</span> GaloisField();</div><div class="line">            <span class="keyword">if</span> (a.v[i] == <span class="number">0</span> &amp;&amp; v[i] == <span class="number">1</span>)</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        GaloisField r, b = (*<span class="keyword">this</span>), c;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            c = a.shift(i);</div><div class="line">            <span class="keyword">if</span> (c &lt; b) &#123;</div><div class="line">                r.v[i] = <span class="number">1</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">16</span>; j &gt;= <span class="number">0</span>; j--)</div><div class="line">                    b.v[j] = b.v[j] xor c.v[j];</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GaloisField <span class="keyword">operator</span>%(<span class="keyword">const</span> GaloisField &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GaloisField ret = (*<span class="keyword">this</span>) - (*<span class="keyword">this</span>) / a * a;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isZero</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">            <span class="keyword">if</span> (v[i])	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GaloisField <span class="title">inverse</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> m[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, mn = <span class="number">8</span>; <span class="comment">// m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line">        <span class="function">GaloisField <span class="title">y</span><span class="params">(m, mn)</span></span>;</div><div class="line">        GaloisField g, a, b;</div><div class="line">        </div><div class="line">        exgcd((*<span class="keyword">this</span>), y, g, a, b); <span class="comment">// a x + b y = g</span></div><div class="line">        <span class="keyword">return</span> a;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(GaloisField x, GaloisField y, GaloisField &amp;g, GaloisField &amp;a, GaloisField &amp;b)</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (y.isZero()) &#123;</div><div class="line">            g = x, a = GaloisField(<span class="number">1</span>), b = GaloisField(<span class="number">0</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            exgcd(y, x%y, g, b, a), b = b - (x / y) * a;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">normal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> m[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, mn = <span class="number">8</span>; <span class="comment">// m(x) = x^8 + x^4 + x^3 + x + 1</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i - mn &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (v[i] == <span class="number">1</span>) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = mn, k = i; j &gt;= <span class="number">0</span>; j--, k--)</div><div class="line">                    v[k] = v[k] xor (m[j]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">7</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d"</span>, v[i]);</div><div class="line">            <span class="keyword">if</span> (i%<span class="number">4</span> == <span class="number">0</span>)	<span class="built_in">printf</span>(<span class="string">" "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getHbits</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v[<span class="number">7</span>]&lt;&lt;<span class="number">3</span> | v[<span class="number">6</span>]&lt;&lt;<span class="number">2</span> | v[<span class="number">5</span>]&lt;&lt;<span class="number">1</span> | v[<span class="number">4</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLbits</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> v[<span class="number">3</span>]&lt;&lt;<span class="number">3</span> | v[<span class="number">2</span>]&lt;&lt;<span class="number">2</span> | v[<span class="number">1</span>]&lt;&lt;<span class="number">1</span> | v[<span class="number">0</span>];</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">testGF</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> va[] = &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">int</span> vb[] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">256</span>; i++) &#123;</div><div class="line">        <span class="function">GaloisField <span class="title">a</span><span class="params">(i)</span></span>;</div><div class="line">        GaloisField b = a.inverse();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%X%X "</span>, b.getHbits(), b.getLbits());</div><div class="line">        <span class="keyword">if</span> (i%<span class="number">16</span> == <span class="number">15</span>) <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">GF_Polynominal</span> &#123;</span></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    GaloisField v[<span class="number">32</span>];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line">    GF_Polynominal() &#123;</div><div class="line">        n = <span class="number">4</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</div><div class="line">            v[i] = GaloisField();</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal(<span class="keyword">const</span> GaloisField a[], <span class="keyword">int</span> an) &#123;</div><div class="line">        n = <span class="number">4</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= an; i++)</div><div class="line">            v[i] = a[i];</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>+(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= r.n; i++)</div><div class="line">            r.v[i] = v[i] + a.v[i];</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>-(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">return</span> (*<span class="keyword">this</span>) + a;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>*(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= n; i++)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= a.n; j++) </div><div class="line">                r.v[i+j] = r.v[i+j] + (v[i] * a.v[j]);</div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GF_Polynominal <span class="title">shift</span><span class="params">(<span class="keyword">int</span> sn)</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        GF_Polynominal r;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++)</div><div class="line">            r.v[i + sn] = v[i];</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero() &amp;&amp; !a.v[i].isZero())</div><div class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (v[i].isZero() != a.v[i].isZero())</div><div class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>/(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!a.v[i].isZero() &amp;&amp; v[i].isZero())</div><div class="line">                <span class="keyword">return</span> GF_Polynominal();</div><div class="line">            <span class="keyword">if</span> (a.v[i].isZero() &amp;&amp; !v[i].isZero())</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">        GF_Polynominal r, b = (*<span class="keyword">this</span>), c;</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = n; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            c = a.shift(i);</div><div class="line">            <span class="keyword">if</span> (c &lt; b) &#123;</div><div class="line">                GaloisField t, x, y;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">16</span>; j &gt;= <span class="number">0</span>; j--) &#123;</div><div class="line">                    <span class="keyword">if</span> (!c.v[j].isZero()) &#123;</div><div class="line">                        y = c.v[j], x = b.v[j];</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">                t = y.inverse() * x;</div><div class="line"><span class="comment">//				b.print();</span></div><div class="line"><span class="comment">//				c.print();</span></div><div class="line"><span class="comment">//				printf("gg %d\n", i);</span></div><div class="line"><span class="comment">//				y.print();</span></div><div class="line"><span class="comment">//				x.print();</span></div><div class="line"><span class="comment">//				y.inverse().print();</span></div><div class="line"><span class="comment">//				t.print();</span></div><div class="line">                r.v[i] = t;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">8</span>; j &gt;= <span class="number">0</span>; j--)</div><div class="line">                    b.v[j] = b.v[j] - c.v[j] * t;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"><span class="comment">//		printf("---&gt; mod "); b.print();</span></div><div class="line"><span class="comment">//		puts("");</span></div><div class="line"><span class="comment">//		puts("div begin");</span></div><div class="line"><span class="comment">//		print();</span></div><div class="line"><span class="comment">//		a.print();</span></div><div class="line"><span class="comment">//		r.print();</span></div><div class="line"><span class="comment">//		(r * a).print();</span></div><div class="line"><span class="comment">//		(r * a + b).print();</span></div><div class="line"><span class="comment">//		puts("div end\n");</span></div><div class="line">        r.normal();</div><div class="line">        <span class="keyword">return</span> r;</div><div class="line">    &#125;</div><div class="line">    GF_Polynominal <span class="keyword">operator</span>%(<span class="keyword">const</span> GF_Polynominal &amp;a) <span class="keyword">const</span> &#123;</div><div class="line">        GF_Polynominal ret = (*<span class="keyword">this</span>) - (*<span class="keyword">this</span>) / a * a;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isZero</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">8</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero())	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function">GF_Polynominal <span class="title">inverse</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">1</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">4</span>; <span class="comment">// m(x) = x^4 + 1</span></div><div class="line">        <span class="function">GF_Polynominal <span class="title">y</span><span class="params">(m, mn)</span></span>;</div><div class="line">        GF_Polynominal g, a, b;</div><div class="line">        </div><div class="line">        exgcd((*<span class="keyword">this</span>), y, g, a, b); <span class="comment">// a x + b y = g</span></div><div class="line">        </div><div class="line">        <span class="keyword">return</span> a / g;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(GF_Polynominal x, GF_Polynominal y, GF_Polynominal &amp;g, GF_Polynominal &amp;a, GF_Polynominal &amp;b)</span> </span>&#123;</div><div class="line"><span class="comment">//		puts("exgcd -----------------");</span></div><div class="line"><span class="comment">//		x.print();</span></div><div class="line"><span class="comment">//		y.print();</span></div><div class="line"><span class="comment">//		getchar();</span></div><div class="line">        <span class="keyword">if</span> (y.isZero()) &#123;</div><div class="line">            <span class="keyword">const</span> GaloisField m1[] = &#123;GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">            <span class="keyword">const</span> GaloisField m0[] = &#123;GaloisField(<span class="number">0</span>)&#125;;</div><div class="line">            g = x, a = GF_Polynominal(m1, <span class="number">1</span>), b = GF_Polynominal(m0, <span class="number">1</span>);</div><div class="line">            <span class="comment">// a = g.inverse();</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            exgcd(y, x%y, g, b, a), b = b - (x / y) * a;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">normal</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">1</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">0</span>), GaloisField(<span class="number">1</span>)&#125;;</div><div class="line">        <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">4</span>; <span class="comment">// m(x) = x^4 + 1</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">16</span>; i - mn &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="keyword">if</span> (!v[i].isZero()) &#123;</div><div class="line">                GaloisField t = v[i];</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = mn, k = i; j &gt;= <span class="number">0</span>; j--, k--)</div><div class="line">                    v[k] = v[k] - (m[j] * t);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &gt;= <span class="number">0</span>; i--) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%X%X "</span>, v[i].getHbits(), v[i].getLbits());</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"x^%d"</span>, i);</div><div class="line">            <span class="keyword">if</span> (i)	<span class="built_in">printf</span>(<span class="string">" + "</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">puts</span>(<span class="string">""</span>);</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">testPoly</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">const</span> GaloisField m[] = &#123;GaloisField(<span class="number">2</span>), GaloisField(<span class="number">1</span>), GaloisField(<span class="number">1</span>), GaloisField(<span class="number">3</span>)&#125;;</div><div class="line">    <span class="keyword">const</span> GaloisField m2[] = &#123;GaloisField(<span class="number">14</span>), GaloisField(<span class="number">9</span>), GaloisField(<span class="number">13</span>), GaloisField(<span class="number">11</span>)&#125;;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">int</span> mn = <span class="number">3</span>, mn2 = <span class="number">3</span>;</div><div class="line">    GF_Polynominal a(m, mn), b(m2, mn2);</div><div class="line">    </div><div class="line">    a.print();</div><div class="line">    b.print();</div><div class="line">    </div><div class="line">    GF_Polynominal c = a * b;</div><div class="line">    c.print();</div><div class="line">    </div><div class="line">    GF_Polynominal d = a.inverse();</div><div class="line">    d.print();</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    testGF();</div><div class="line">    testPoly();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/24/security-notes/" class="article-date">
  <time datetime="2015-04-24T02:37:28.000Z" itemprop="datePublished">2015-04-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/04/24/security-notes/">資訊安全 小考筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/24/security-notes/" data-id="ckq5yoy4q00ego4vn1zuwdj4o" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/24/security-notes/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><ol>
<li><p>Follow</p>
<ol>
<li>What is a monoalphabetic cipher ?</li>
<li>How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ?</li>
<li>What is the main security weakness of a monoalphabetic cipher ?</li>
<li>Please provide at least 4 approaches to prevent the above weakness.</li>
</ol>
</li>
<li><p>Block ciphers process messages in blocks like an extremely large substitution, but this is very difficult to implement for a very big block size. What is Shannon’s idea to realize a block cipher with big block size ?</p>
</li>
<li><p>The S-box of DES round operation is not invertable, but why DES can decrypt ?</p>
</li>
<li><p>Follow</p>
<ol>
<li>Please explain the OFB mode.</li>
<li>In the OFB mode, we never reuse the same sequence (key+IV). If we reuse the key, then the attacker can recover message. Please describe very precisely (mathematiclly with symbols) how the attack works.</li>
</ol>
</li>
<li><p>Please compare the CFB mode the OFB mode by providing a table indicating at least 5 of their advantage and corresponding disadvantage.</p>
</li>
<li><p>This question is about issues of random access of encryption and decryption. Define notations or symbols you need before providing your answer. Please describe how to use CFB mode and CTR mode to randomly encrypt and decrypt a file Why OFB mode is inappropriate to randomly encrypt and decrypt a file?</p>
</li>
<li><p>Describe the details (as much as you remember) of AES operation and describe how efficiently implement AES on an 8-bit CPU ?</p>
</li>
<li><p>How avalanche happens in AES within the first tow rounds ?</p>
</li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><p>monoalphabetic cipher 簡單來說比凱薩加密難一點，從每個字母都 shift 固定的數量來說，變成變動式的。換句話說就是單純的英文字母替換 (substitute)。由於要維持可逆的解密，替換必須符合一對一，所以方法數為 <code>26! = 403291461126605635584000000</code>。</p>
<p>但這種替換方式容易受到語言統計的攻擊，也就是說在英文的特性中，不是每個字母都出現相同的頻率，因為很多冗詞的使用，導致有些字母會特別多。也因此在找對應時，可以藉由這一個觀點，反向查找可能的替換，大幅度地降低搜索可能，讓解密變得相當容易。</p>
<p>為了解決這一語言統計的攻擊，可以藉由</p>
<ul>
<li>壓縮明文，破壞語言特性，但是壓縮算法有儲存的字典部分，仍可能發生字典結構被攻擊，進而進行解壓縮。</li>
<li>增加垃圾字，撥點冗詞穿插在其中，把頻率不均的問題消彌。</li>
<li>多個字符一起加密，相對於單一字母的替換，可以同時替換兩個以上，如 <code>AA -&gt; WT</code> 之類的。</li>
<li>使用多種替換，在不同時刻使用不同的替換表，同樣地可以把頻率問題解決。</li>
<li>參照後續區段加密的一些技巧，如 CFB、OFB … 等，讓替換表進行變動。</li>
</ul>
<h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><p>區段加密具有相當大的強度，當一次加密 64 bits 時，可以達到的對應種類高達 <code>(2^64)!</code>，沒有辦法將這種表格存放在記憶體，因為也要消耗 <code>2^64</code> bits。</p>
<p>因此有 Shannon’s idea，利用 substitution (S-box)、permutation (P-box) 來完成對應，藉由 S-P 的組合，提供 混淆(confusion) 和 差異 (diffusion)。組合的效應遠比想像中的還大，儘管組合的方法數遠小於 <code>(2^64)!</code>，連兆分之一都不到，但簡單的概念可以在 <code>64KB</code> 記憶體大小內完成，效應上算相當划算。</p>
<h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><p>DES 的 S-box 屬於不可逆的操作 (8-bits to 6-bits)，然而 DES 在解密時，不需要將 S-box 往回推導，也就是不需要逆向操作，因為加密的 key 來自於 master key 和另一段的訊息 L(i) ，最後用 key 加密 R(i) 得到 L(i+1)。解密時，只需要將 R(i+1) (L(i) 會變成 S(i+1))帶入 S-box，就能重新產生出 key。</p>
<p>至於 DES 為什麼可以正確加解密，定義對於所有的任意明文 A, B，產生的密文 E(A) != E(B)。若明文差異在 L(i)，則在 R(i+1) 一定會不同。若明文差異在 R(i)，則在 key 相同，做 L(i+1) = R(i) XOR key 時，L(i+1) 也必定會不同。</p>
<h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><span>$$O_{i} = E_{k}(O_{i-1}); O_{-1} = IV \\
C_{i} = P_{i} \text{ XOR } O_{i}$$</span><!-- Has MathJax -->
<p>為什麼 OFB 不能重新使用 key + IV 呢？原因是因為 <strong> 已知明文攻擊 (Known plaintext attack) </strong> 。假設每一天都重新啟動，那麼攻擊者可以在事後得到密文對應的明文 (可能隔天才知道，儘管對應仍然是很難的)，那麼可以藉由數學概念來完成解密，無須考慮 key 是什麼內容。</p>
<span>$$C_{i} = P_{i} \text{ XOR } O_{i} \\
C_{j} = P_{j} \text{ XOR } O_{i} \\
C_{i} \text{ XOR } C_{j} = P_{i} \text{ XOR } P_{j}$$</span><!-- Has MathJax -->
<p>假設 i 和 j 重複使用 key，那麼會發生已知密文<span>$C_{i}, C_{j}$</span><!-- Has MathJax --> (傳輸上一定會被發現) 和已知明文<span>$P_{i}$</span><!-- Has MathJax -->，只要夾擊做 XOR，就可以直接得到<span>$P_{j}$</span><!-- Has MathJax -->，當已知明文相當長時，竊取的效果就越好。</p>
<h3 id="Part-5"><a href="#Part-5" class="headerlink" title="Part 5"></a>Part 5</h3><p>比較 CFB 和 OFB。</p>
<table>
<thead>
<tr>
<th>特性\模式</th>
<th>CFB</th>
<th>OFB</th>
</tr>
</thead>
<tbody>
<tr>
<td>自同步 (self-synchronization)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>錯誤擴散 (error propagation)</td>
<td>有</td>
<td>無</td>
</tr>
<tr>
<td>預先計算 (preprocess key)</td>
<td>不可</td>
<td>可</td>
</tr>
<tr>
<td>隨機存取 (random access)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>資訊安全性 (message security)</td>
<td>高</td>
<td>低</td>
</tr>
</tbody>
</table>
<ul>
<li><strong> 自同步 (self-synchronization) </strong>，不用告知對方加密狀態，可以藉由數次的傳輸訊息，自動地將兩邊的狀態一致，在此之前會造成一段雜訊。斷線時，不必重複使用 IV 讓兩邊同步 (狀態相同時，才能正確解密)。</li>
<li><strong> 錯誤擴散 (error propagation) </strong> ，也因為自同步的設計，導致在同步前都會有雜訊，或者在訊息被攻擊者竄改時，會影響該週期的狀態 (<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --> )。</li>
<li><strong> 預先計算 (preprocess key) </strong> ，預先計算 key 可以加快加解密速度，同時便可支持平行運算，這原因是因為 message-independent/dependent 之間的差異，狀態不依靠正在傳遞的訊息時，就可以預先處理。</li>
<li><strong> 隨機存取 (random access) </strong> ，當要解析某個密文時，CFB 可以往前查找密文<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax -->，得到當前的解密器所需要的狀態，放上 master key 就能進行解密。OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</li>
<li><strong> 資訊安全性 (message security) </strong> ，由於狀態與訊息獨立，會導致被攻擊者竄改內容時不易發現。在 CFB 中，由於依賴傳遞的訊息，當攻擊者竄改某個密文時會造成錯誤擴散，影響的解密時的明文不只一個，這也讓安全性提高。可以說是一體兩面的特性。</li>
</ul>
<h3 id="Part-6"><a href="#Part-6" class="headerlink" title="Part 6"></a>Part 6</h3><ul>
<li>CFB 狀態為 master key +<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --></li>
<li>CTR 狀態為 master key + counter</li>
</ul>
<p>CFB 解密某個密文時，往前查找密文即可解密。CTR 知道密文 offset 便可得到 counter。在獲得資訊上都是 O(k) 常數，因此支持隨機存取。</p>
<blockquote>
<p>OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</p>
</blockquote>
<p>CFB 和 CTR 到底誰的隨機存取能力好呢？若檔案儲存會切割成數個，那 CFB 的隨機存取能力就更高一點。CTR 必須計算 offset，相較於 CFB 的紀錄架構會稍微地麻煩。</p>
<h3 id="Part-7"><a href="#Part-7" class="headerlink" title="Part 7"></a>Part 7</h3><p>AES 的計算結構都落在 GF(2^8)，一個 cell 的內容都是 GF(2^8)</p>
<ul>
<li>substitue 需要 8-bits to 8-bits</li>
<li>shift rows 對於 8-bit 關聯不大 (移動記憶體的位置)</li>
<li>mixColume 上是 8-bits x 8-bits</li>
<li>add round key 對於每一個 cell XOR 8-bit keys</li>
</ul>
<p>因此 AES 可以在 8-bits CPU 上有更好的實作效能，所需要的 clock cycle 會比較短。</p>
<h3 id="Part-8"><a href="#Part-8" class="headerlink" title="Part 8"></a>Part 8</h3><p>假設有兩個明文的 <strong> 漢明距離 (Hamming distance) </strong> 為 1，在 128 bits 中有一個 1 bits 不同，意即<span>$H(P, Q) = 1$</span><!-- Has MathJax -->。</p>
<table>
<thead>
<tr>
<th>Step\Round</th>
<th>Round 1</th>
<th>Round 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Substitue bytes</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Shift rows</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Mix Columes</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
<tr>
<td>Add Round key</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
</tbody>
</table>
<ul>
<li>在 Substitue bytes 步驟時，S-box 會設計成期望當有一個 1-bits 不同，則替換出來的結果會有 4-bits 不同 (一個 cell 具有 8-bits。替換 8-bits 時，差異最少 0 bits、最多 8-bits，期望值是 4-bits)。</li>
<li>在 Shift rows 步驟時，單純移動 cell 不影響差異。</li>
<li>在 Mix Columes 步驟時，每一個 colume 會根據上一個 colume 的 4 個元素相互影響，因此會增加 4 倍。</li>
<li>在 Add Round key 步驟時，由於 XOR 相同的 key，因此差異並不會改變。</li>
</ul>
<p>最後，在 Round 2 時，能得到平均 64 bits 的差異。加密的明文一次 128 bits，差異期望值也就是一半的情況 64 bits，因此很快地就能達到期望的差異性。在隨後的 Round X 中，差異會在 64-bits 上下浮動都是有可能的。</p>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
    <article id="post-security-block-ciphers" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/03/21/security-block-ciphers/" class="article-date">
  <time datetime="2015-03-21T01:42:36.000Z" itemprop="datePublished">2015-03-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/21/security-block-ciphers/">區段加密筆記</a>
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/03/21/security-block-ciphers/" data-id="ckq5yoy4o00ebo4vn11rcntct" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/03/21/security-block-ciphers/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry article-index" itemprop="articleBody">
      
          
        
          <div class="toggle-content">
            <blockquote>
<p>本篇筆記，僅為個人淺見</p>
</blockquote>
<h2 id="什麼是區段加密"><a href="#什麼是區段加密" class="headerlink" title="什麼是區段加密"></a>什麼是區段加密</h2><p>先了解 stream ciphers 和 block ciphers 的差異</p>
<ul>
<li><p>stream ciphers 特別在於加密用的 key 不斷地變更，並且以極少數的情況下重複使用，每一次加密針對一個 byte 或者是 bit 進行加密。加解密的兩方，可以同時產生出相同 random key。</p>
</li>
<li><p>block ciphers 只用同一份 key，把加密文件一次用一個 block 文字進行加密，利用換位 (位置交換)、替換 (文字替換) … 等方式，讓相似內容的明文，可以產出差異極大的密文 (訊息獨立)。</p>
</li>
</ul>
<p>從概念上，串流加密是絕對安全，如果雙方有辦法在不通訊下，可以產生出 random key，而且不重複使用 key，攻擊者會無從下手。但是現今很多 random 的產生方法仍然是演算法的數學模型，因此一定有規則。</p>
<p>而區段加密的好處，在於換位、替換、 … 等方式，將密文的相似度降低，即使明文長得很相似，攻擊者無法誘導相似明文的傳遞，導致 key 快速被發現，因為密文的差異性導致規則難以被破解。</p>
<h3 id="加密設計基礎原則"><a href="#加密設計基礎原則" class="headerlink" title="加密設計基礎原則"></a>加密設計基礎原則</h3><ul>
<li><p>confusion 困惑<br>密文跟 key 的關係盡可能混亂，根據加密的方式，有可能某些 key 會造成特殊的密文規則，這種弱 key 要不不存在、要不不使用。減少攻擊者對密文的觀察，就可以找到 key。</p>
</li>
<li><p>diffusion 散播<br>當明文相當相似時，也許只有幾個 bit 不同，產生出來的密文的差異性也要相當高，否則攻擊者可以推導加密原理，藉由 bitwise 將密文修改，讓解密者受到誤導。</p>
</li>
</ul>
<h2 id="Data-Encryption-Standard-DES"><a href="#Data-Encryption-Standard-DES" class="headerlink" title="Data Encryption Standard (DES)"></a>Data Encryption Standard (DES)</h2><ul>
<li>每一次加密 <strong> 64 </strong>-bit 的資料，用 <strong> 56 </strong>-bit 的 key。<br>這是一個很詭異的現象，通常 key 的長度會比 data 的長度來得大。</li>
<li>經過 16 回合的加密，並且每一個回合用 <strong> 56 </strong>-bit 的 key 產生出 <strong> 48 </strong>-bit 的 subkey 針對 <strong> 64 </strong>-bit 的資料加密。</li>
<li>加密過程會有擴充 subkey 和選擇一部分的 subkey，並且拿一部分的明文對 subkey 加密。</li>
</ul>
<p>將明文對切成兩個部分，一部分加密 subkey，另一部分根據加密過的 subkey 進行加密。在下一個回合，交換部分明文和部分密文的位置，讓所有的明文都進入到混亂狀態。</p>
<p>在解密時，知道 subkey 的產生規則，然後拿部分明文，加密 subkey 後，得到部分密文的加密要件，逆推回去。這一個繁複的過程，主要是製造 confusion，而 diffusion 的部分，則是在擴充 key 和拿部分明文加密 subkey 時，發生雪崩效應，因為拿部分明文進行加密 subkey，會造成 key 差異性放大。</p>
<p>儘管明文相似程度很高，卻會因為處理過程將差異轉移到 subkey 很多的位置的不同，經過輪替加密。無法利用頻率的方式，找到明文差異會造成密文的哪一個部分的差異。</p>
<h3 id="正確性"><a href="#正確性" class="headerlink" title="正確性"></a>正確性</h3><p>為什麼 DES 可以被正確解密？概念上，一個密文只能對應一個明文，這樣才符合正確解密的定義。因此不同的明文，也要產生出來不同的密文。</p>
<p>證明從輪替下手，部分明文 A 會保留到下一個輪替，而部分明文 A 會加密部分明文 B，假設兩個明文在 A 部分不同，則在密文部分就會不同 (因為保留)，假設是 B 部分不同，加密 (XOR 加密) 後也會不同。數學歸納法得證。</p>
<h3 id="加密強度分析"><a href="#加密強度分析" class="headerlink" title="加密強度分析"></a>加密強度分析</h3><p>因為 subkey 產生方式和換位、替換的規格是明定，與 key 無關。因此 key 長短將影響加密的強度，從現在分析 <strong> 56 </strong>-bit 在數個小時內就會被解出來。</p>
<blockquote>
<p>為什麼 subkey 產生方式和換位、替換的規格是明定？<br>因為雪崩效應的造成需要某些放大效果，因此表格要符合某些設計規則。</p>
</blockquote>
<h3 id="攻擊方法"><a href="#攻擊方法" class="headerlink" title="攻擊方法"></a>攻擊方法</h3><ul>
<li><p>Timing Attacks 加密時間攻擊，因為電腦運算的速度受輸入要件影響，如果 bit 變換數大，會導致加密時間拉長，藉以分析明文。</p>
</li>
<li><p>Power Attacks 偵測能源消耗，因為運算所需要的能量不同，隨著時間能到得到能源使用圖，就能分析加密過程的情況。也有為了防止這種偵測，考慮將所有運算做得一樣耗電，這有可能本末倒置。</p>
</li>
<li><p>Analytic Attacks 分析攻擊，從統計學的角度進行攻擊，從密文差異下手、從已知密文、明文解方程式、key 與加密結果的關聯性 … 等。</p>
</li>
</ul>
<h2 id="Block-mode"><a href="#Block-mode" class="headerlink" title="Block mode"></a>Block mode</h2><h3 id="ECB"><a href="#ECB" class="headerlink" title="ECB"></a>ECB</h3><p>Electronic CodeBook (ECB)，不變的 key，需要加密器和解密器，加解密的複雜度可能不同。</p>
<ul>
<li>優點：<br>構造簡單、容易實做</li>
<li>缺點：<br>長時間下，容易被偵測。影像資料的差異性不大，很容易被辨識到重複性，相較於文字很容易受前後文的影響。</li>
</ul>
<h3 id="CBC"><a href="#CBC" class="headerlink" title="CBC"></a>CBC</h3><p>Cipher Block Chaining (CBC)，不變的 key，以及前一個密文會先針對明文加密。</p>
<ul>
<li>優點：<br>相同明文，會因為前一個的密文不同造就出不同的密文，也就是加密器多一個新的狀態。</li>
<li>缺點：  <ul>
<li>一個密文 Ci 的錯誤，會導致兩個明文解析錯誤 (Pi &amp; Pi+1)。</li>
<li>第一次加密很容易被抽換 bitwise，因為每次驅動的 Initial Vector 都相同。</li>
</ul>
</li>
</ul>
<h3 id="CFB"><a href="#CFB" class="headerlink" title="CFB"></a>CFB</h3><p>Cipher FeedBack (CFB)，類似 CBC，但前一個密文的結果只影響一部分的加密關係，然後將前一段密文狀態加密 key，再對明文加密。</p>
<ul>
<li>優點：  <ul>
<li>支持即時 (real-time) 通訊</li>
<li>只需要加密器，加密做兩次相當於解密。</li>
<li>支持自同步 (self-synchronization)，即使中斷連線、訊息錯誤，可以在數個週期後再次同步運作。</li>
<li>藉由自同步的概念，可以捨棄掉 Initial Vector。</li>
<li>後半部的明文，可以透過週期性的部分密文建立解密狀態，支持 random access。</li>
</ul>
</li>
<li>缺點：<ul>
<li>error propagation 錯誤增長，當一個訊息錯誤時，需要好幾個週期後才能修正回來，這導致中間的解密訊息都不能用。</li>
<li>雜訊過多的情況下，不宜使用。</li>
</ul>
</li>
</ul>
<h3 id="OFB"><a href="#OFB" class="headerlink" title="OFB"></a>OFB</h3><p>Output FeedBack (OFB)，類似於 CFB，將前一段的加密 key 拿回來加密，不依賴接收的密文狀態。</p>
<ul>
<li>優點：  <ul>
<li>支持即時 (real-time) 通訊</li>
<li>只需要加密器，加密做兩次相當於解密。</li>
<li>相較於 CFB，沒有錯誤增長的情況。</li>
<li>依序使用的 key，可以事先算出來，然後依次使用。</li>
<li>雜訊下支持的能力好。</li>
</ul>
</li>
<li>缺點：<ul>
<li>必須一直保持同步</li>
<li>訊息被修改時，不易被發現，只單純影響單一明文 (沒有錯誤增長)。</li>
<li>起始狀態的 Initial Vector，不能重複使用，否則很容易被攻擊者抓到。</li>
<li>加設沒有預先算 key，沒辦法解密出後半部的明文。</li>
</ul>
</li>
</ul>
<h3 id="CTR"><a href="#CTR" class="headerlink" title="CTR"></a>CTR</h3><p>Counter (CTR)，類似於 OFB，直接利用計數器作為加密 key。</p>
<ul>
<li>優點：<ul>
<li>加解密可以平行化處理，如果加解密速度耗時，可以選擇這一種。</li>
<li>支持 random access。</li>
</ul>
</li>
<li>缺點：<ul>
<li>必須一直保持同步</li>
<li>訊息被修改時，不易被發現，只單純影響單一明文 (沒有錯誤增長)。</li>
<li>起始狀態的 Initial Vector，不能重複使用，否則很容易被攻擊者抓到。</li>
</ul>
</li>
</ul>

          </div>
          <div class="toggle-input article-more-link"><a>Read More +</a></div>
        
      
    </div>

  </div>
  
</article>


  
  
</section>
          
          
            <aside id="sidebar">
  <!-- <div id="ukagaka_panel"></div> -->
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/">學校課程</a><span class="category-list-count">115</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/介面設計/">介面設計</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/作業系統/">作業系統</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/即時系統/">即時系統</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/大學專題/">大學專題</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/巨量資料/">巨量資料</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/平行程式/">平行程式</a><span class="category-list-count">43</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/敏捷方法/">敏捷方法</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/數位影像生成/">數位影像生成</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/編譯器/">編譯器</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/自然語言/">自然語言</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/虛擬實境/">虛擬實境</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算型智慧/">計算型智慧</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算幾何/">計算幾何</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/計算機圖學/">計算機圖學</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資料庫系統/">資料庫系統</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/資訊安全/">資訊安全</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/學校課程/通識課程/">通識課程</a><span class="category-list-count">14</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/">工作應用</a><span class="category-list-count">32</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Java/">Java</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/Meme/">Meme</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/可持久化/">可持久化</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/工作應用/鬼故事/">鬼故事</a><span class="category-list-count">10</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/手札日記/">手札日記</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/">網頁設計</a><span class="category-list-count">15</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/About-This-Blog/">About This Blog</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/HTML5/">HTML5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/JQuery/">JQuery</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/網頁設計/NodeJs/">NodeJs</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/">解題區</a><span class="category-list-count">633</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/Latex/">Latex</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/出題解題/">出題解題</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-POJ/">解題區 - POJ</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a><span class="category-list-count">483</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-Zerojudge/">解題區 - Zerojudge</a><span class="category-list-count">77</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-其他題目/">解題區 - 其他題目</a><span class="category-list-count">45</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/解題區/解題區-未解題目/">解題區 - 未解題目</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/雜言筆記/">雜言筆記</a><span class="category-list-count">4</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a class="text" href="/2021/06/21/work/company-ghost-story-10/">
              
                <i class="icon-file-o"></i> 
              
            Company Ghost Story 公司鬼故事 10</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/diary-202105/">
              
                <i class="icon-file-o"></i> 
              
            前思後想 新居落成</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-2/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 組合篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/05/30/java/java-memory-optimization-1/">
              
                <i class="icon-file-o"></i> 
              
            Java 優化內存使用 結構篇</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/diary-202101/">
              
                <i class="icon-file-o"></i> 
              
            二八進展</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-file-extension/">
              
                <i class="icon-file-o"></i> 
              
            File Extension</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-globl-var/">
              
                <i class="icon-file-o"></i> 
              
            Global Variable</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-handover/">
              
                <i class="icon-file-o"></i> 
              
            Handover</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-interview-recursion/">
              
                <i class="icon-file-o"></i> 
              
            Interview &amp; Recursion</a>
          </li>
        
          <li>
            <a class="text" href="/2021/01/31/work/meme-job-build/">
              
                <i class="icon-file-o"></i> 
              
            Job Build</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    <div class="widget-wrap">
    <h3 class="widget-title">Links</h3>
    <div class="widget">   
      	<ul>
	      <li><a href="http://mypaper.pchome.com.tw/zerojudge" target="_blank" title="Old Blog"><i class="icon-star"></i> Morris' Blog (pchome)</a></li>
	      <li><a href="http://flere114.blogspot.tw/" target="_blank" title="蘿莉勿觸"><i class="icon-googles"></i> flere's Blog</a></li>
	      <li><a href="http://dreamoon4.blogspot.tw/" target="_blank" title="夢月"><i class="icon-googles"></i> dreamoon's Blog</a></li>
	      <li><a href="http://m80126colin.github.io" target="_blank" title="許胖們"><i class="icon-github-alt"></i> m80126colin's Blog</a></li>
	      <li><a href="http://sd12582000.blogspot.tw/" target="_blank" title="妮可妮可"><i class="icon-github-alt"></i> Nico's Blog</a></li>
	      <li><a href="http://kuoe0.logdown.com/" target="_blank" title="郭至軒大神"><i class="icon-github-alt"></i> KuoE0's Dots</a></li>
	      <li><a href="http://tyan.io/" title=""><i class="icon-github-alt"></i> Tyan Blog</a></li>
    	</ul>
    </div>
</div>

  
    
<script src="/js/jquery-ui.js"></script>
<script src="/js/ukagaka/jquery.morris.ukagaka.resource.js"></script>
<script src="/js/ukagaka/typed.js"></script>
  
  
</aside>
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>