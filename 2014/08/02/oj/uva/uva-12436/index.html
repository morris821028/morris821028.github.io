<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>UVa 12436 - Rip Van Winkle&#39;s Code | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="12345678910111213141516long long data[250001];void A( int st, int nd ) &amp;#123;    for( int i = st; i &amp;lt;= nd; i++ ) data[i] = data[i] + (i - st + 1);&amp;#125;void B( int st, int nd ) &amp;#123;    for( int i">
<meta name="keywords" content="ST,線段樹">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa 12436 - Rip Van Winkle&#39;s Code">
<meta property="og:url" content="http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:description" content="12345678910111213141516long long data[250001];void A( int st, int nd ) &amp;#123;    for( int i = st; i &amp;lt;= nd; i++ ) data[i] = data[i] + (i - st + 1);&amp;#125;void B( int st, int nd ) &amp;#123;    for( int i">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2016-04-20T11:50:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UVa 12436 - Rip Van Winkle&#39;s Code">
<meta name="twitter:description" content="12345678910111213141516long long data[250001];void A( int st, int nd ) &amp;#123;    for( int i = st; i &amp;lt;= nd; i++ ) data[i] = data[i] + (i - st + 1);&amp;#125;void B( int st, int nd ) &amp;#123;    for( int i">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main" style="width: 95%"><article id="post-oj/uva/uva-12436" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/08/02/oj/uva/uva-12436/" class="article-date">
  <time datetime="2014-08-02T06:20:17.000Z" itemprop="datePublished">2014-08-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UVa 12436 - Rip Van Winkle&#39;s Code
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/" data-id="ckpaivcc700j7n8vndxegdok8" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ST/">ST</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/線段樹/">線段樹</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
              <div id="toc" class="toc-article">
              <h2 class="toc-title"><span>contents</span></h2>
              
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Input"><span class="toc-number">1.</span> <span class="toc-text">Input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output"><span class="toc-number">2.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sample-Input"><span class="toc-number">3.</span> <span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">4.</span> <span class="toc-text">Solution</span></a></li></ol>
              
              </div>
          
        
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">long long data[250001];</span><br><span class="line"></span><br><span class="line">void A( int st, int nd ) &#123;</span><br><span class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = data[i] + (i - st + 1);</span><br><span class="line">&#125;</span><br><span class="line">void B( int st, int nd ) &#123;</span><br><span class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = data[i] + (nd - i + 1);</span><br><span class="line">&#125;</span><br><span class="line">void C( int st, int nd, int x ) &#123;</span><br><span class="line">    for( int i = st; i &lt;= nd; i++ ) data[i] = x;</span><br><span class="line">&#125;</span><br><span class="line">long long S( int st, int nd ) &#123;</span><br><span class="line">    long long res = 0;</span><br><span class="line">    for( int i = st; i &lt;= nd; i++ ) res += data[i];</span><br><span class="line">    return res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>The first line of input will contain T (≤ 4*105) denoting the number of operations. Each of the next T lines starts with a character (‘A’, ‘B’, ‘C’ or ‘S’), which indicates the type of operation. Character ‘A’, ‘B’ or ‘S’ will be followed by two integers, st and nd in the same line. Character ‘C’ is followed by three integers, st, nd and x. It’s assumed that, 1 ≤ st ≤ nd ≤ 250000 and -105 ≤ x ≤ 105. The meanings of these integers are explained by the code of Rip Van Winkle.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>For each line starting with the character ‘S’, print S( st, nd ) as defined in the code. Dataset is huge, so use faster I/O methods.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">7</span><br><span class="line">A 1 4</span><br><span class="line">B 2 3</span><br><span class="line">S 1 3</span><br><span class="line">C 3 4 -2</span><br><span class="line">S 2 4</span><br><span class="line">B 1 3</span><br><span class="line">S 2 4</span><br></pre></td></tr></table></figure>

<p>Output for Sample Input</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9</span><br><span class="line">0</span><br><span class="line">3</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>紀錄該區間的首項和公差即可，保證公差可以疊加。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 262144</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 1048576 + 10 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line">LL sum[MAXM];</span><br><span class="line">LL preB[MAXM], preD[MAXM]; <span class="comment">// base, diff</span></span><br><span class="line">LL sufB[MAXM], sufD[MAXM];</span><br><span class="line">LL setB[MAXM], setD[MAXM];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushUp</span><span class="params">(<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    sum[k] = sum[k&lt;&lt;<span class="number">1</span>] + sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushDown</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = (l + r) /<span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(setB[k]) &#123;</span><br><span class="line">        setB[k&lt;&lt;<span class="number">1</span>] = <span class="number">1</span>, setD[k&lt;&lt;<span class="number">1</span>] = setD[k];</span><br><span class="line">        setB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = <span class="number">1</span>, setD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = setD[k];</span><br><span class="line">        preB[k&lt;&lt;<span class="number">1</span>] = preD[k&lt;&lt;<span class="number">1</span>] = sufB[k&lt;&lt;<span class="number">1</span>] = sufD[k&lt;&lt;<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        preB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = preD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = sufB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = sufD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>] = (m - l + <span class="number">1</span>) * setD[k];</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] = (r - m) * setD[k];</span><br><span class="line">        setB[k] = setD[k] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preB[k]) &#123;</span><br><span class="line">        preB[k&lt;&lt;<span class="number">1</span>] += preB[k], preD[k&lt;&lt;<span class="number">1</span>] += preD[k];</span><br><span class="line">        preB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += preB[k] + preD[k] * (m - l + <span class="number">1</span>), preD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += preD[k];</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>] += (<span class="number">2</span> * preB[k] + (m - l) * preD[k]) * (m - l + <span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += (<span class="number">2</span> * preB[k] + (r - l + m + <span class="number">1</span> - l) * preD[k]) * (r - m)/<span class="number">2</span>;</span><br><span class="line">        preB[k] = preD[k] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(sufB[k]) &#123;</span><br><span class="line">        sufB[k&lt;&lt;<span class="number">1</span>] += sufB[k] + (r - m) * sufD[k], sufD[k&lt;&lt;<span class="number">1</span>] += sufD[k];</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>] += (<span class="number">2</span> * sufB[k] + (r - m + r - l) * sufD[k]) * (m - l + <span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">        sufB[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += sufB[k], sufD[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += sufD[k];</span><br><span class="line">        sum[k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>] += (<span class="number">2</span> * sufB[k] + (r - m - <span class="number">1</span>) * sufD[k]) * (r - m)/<span class="number">2</span>;</span><br><span class="line"><span class="comment">//		printf(&quot;[%d %d] suffix %lld %lld , = %lld %lld\n&quot;, l, r, sufB[k], sufD[k], sum[k&lt;&lt;1], sum[k&lt;&lt;1|1]);</span></span><br><span class="line">        sufB[k] = sufD[k] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyA</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</span><br><span class="line">        preB[k] += l - x + <span class="number">1</span>, preD[k]++;</span><br><span class="line">        sum[k] += (LL)(<span class="number">2</span> * (l - x + <span class="number">1</span>) + r - l) * (r - l + <span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushDown</span>(k, l, r);</span><br><span class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(y &lt;= m)</span><br><span class="line">        <span class="built_in">modifyA</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</span><br><span class="line">        <span class="built_in">modifyA</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">modifyA</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</span><br><span class="line">        <span class="built_in">modifyA</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushUp</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyB</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">pushDown</span>(k, l, r);</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</span><br><span class="line">        sufB[k] += y - r + <span class="number">1</span>, sufD[k]++;</span><br><span class="line">        sum[k] += (LL)(<span class="number">2</span> * (y - r + <span class="number">1</span>) + r - l) * (r - l + <span class="number">1</span>)/<span class="number">2</span>;</span><br><span class="line"><span class="comment">//		printf(&quot;BB [%d %d] %d\n&quot;, l, r, base);</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(y &lt;= m)</span><br><span class="line">        <span class="built_in">modifyB</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</span><br><span class="line">        <span class="built_in">modifyB</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">modifyB</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</span><br><span class="line">        <span class="built_in">modifyB</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushUp</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modifyC</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> mm)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y)  &#123;</span><br><span class="line">        setB[k] = <span class="number">1</span>, setD[k] = mm;</span><br><span class="line">        preB[k] = preD[k] = sufB[k] = sufD[k] = <span class="number">0</span>;</span><br><span class="line">        sum[k] = (LL)mm * (r - l + <span class="number">1</span>);</span><br><span class="line"><span class="comment">//		printf(&quot;CCCC [%d %d] %lld\n&quot;, l, r, sum[k]);</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushDown</span>(k, l, r);</span><br><span class="line">    <span class="keyword">int</span> m = (l+r) /<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(y &lt;= m)</span><br><span class="line">        <span class="built_in">modifyC</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y, mm);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(x &gt; m)</span><br><span class="line">        <span class="built_in">modifyC</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y, mm);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">modifyC</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y, mm);</span><br><span class="line">        <span class="built_in">modifyC</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y, mm);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">pushUp</span>(k);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> k, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r)	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushDown</span>(k, l, r);</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= l &amp;&amp; r &lt;= y) &#123;</span><br><span class="line"><span class="comment">//		printf(&quot;qq[%d %d] %lld\n&quot;, l, r, sum[k]);</span></span><br><span class="line">        <span class="keyword">return</span> sum[k];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (l + r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt;= m)</span><br><span class="line">        ret += <span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>, l, m, x, y);</span><br><span class="line">    <span class="keyword">if</span>(y &gt; m)</span><br><span class="line">        ret += <span class="built_in">query</span>(k&lt;&lt;<span class="number">1</span>|<span class="number">1</span>, m+<span class="number">1</span>, r, x, y);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">//	freopen(&quot;in.txt&quot;, &quot;r+t&quot;, stdin);</span></span><br><span class="line"><span class="comment">//	freopen(&quot;out2.txt&quot;, &quot;w+t&quot;, stdout); </span></span><br><span class="line">    <span class="keyword">int</span> T, st, nd, x;</span><br><span class="line">    <span class="keyword">char</span> cmd[<span class="number">128</span>];</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T) == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">memset</span>(sum, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(sum));</span><br><span class="line">        <span class="built_in">memset</span>(preB, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(preB));</span><br><span class="line">        <span class="built_in">memset</span>(preD, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(preD));</span><br><span class="line">        <span class="built_in">memset</span>(sufB, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(sufB));</span><br><span class="line">        <span class="built_in">memset</span>(sufD, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(sufD));</span><br><span class="line">        <span class="built_in">memset</span>(setB, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(setB));</span><br><span class="line">        <span class="built_in">memset</span>(setD, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(setD));</span><br><span class="line">        <span class="keyword">while</span>(T--) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, cmd);</span><br><span class="line">            <span class="keyword">if</span>(cmd[<span class="number">0</span>] == <span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d %d %d&quot;</span>, &amp;st, &amp;nd, &amp;x);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;st, &amp;nd);</span><br><span class="line">            <span class="built_in"><span class="keyword">switch</span></span>(cmd[<span class="number">0</span>]) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;A&#x27;</span>:</span><br><span class="line">                    <span class="built_in">modifyA</span>(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;B&#x27;</span>:</span><br><span class="line">                    <span class="built_in">modifyB</span>(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">                    <span class="built_in">modifyC</span>(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd, x);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">                    <span class="keyword">long</span> <span class="keyword">long</span> ret = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, MAXN, st, nd);</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>, ret);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1000</span></span><br><span class="line"><span class="comment">S 2 3</span></span><br><span class="line"><span class="comment">A 7 15</span></span><br><span class="line"><span class="comment">B 4 5</span></span><br><span class="line"><span class="comment">B 15 16</span></span><br><span class="line"><span class="comment">C 2 10 3</span></span><br><span class="line"><span class="comment">B 14 15</span></span><br><span class="line"><span class="comment">A 10 18</span></span><br><span class="line"><span class="comment">S 4 4</span></span><br><span class="line"><span class="comment">A 3 16</span></span><br><span class="line"><span class="comment">B 6 14</span></span><br><span class="line"><span class="comment">B 4 7</span></span><br><span class="line"><span class="comment">S 8 11</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/08/02/oj/uva/uva-12446/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          UVa 12446 - How Many... in 3D!
        
      </div>
    </a>
  
  
    <a href="/2014/08/02/oj/uva/uva-12396/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">UVa 12396 - Remoteland</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2014/08/02/oj/uva/uva-12436/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>