<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>UVa 10118 - Free Candies | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The ProblemLittle Bob is playing a game. He wants to win some candies in it - as many as possible. There are 4 piles, each pile contains N candies. Bob is given a basket which can hold at most 5 candi">
<meta name="keywords" content="dp,搜索">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa 10118 - Free Candies">
<meta property="og:url" content="http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:description" content="The ProblemLittle Bob is playing a game. He wants to win some candies in it - as many as possible. There are 4 piles, each pile contains N candies. Bob is given a basket which can hold at most 5 candi">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2016-04-20T11:50:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UVa 10118 - Free Candies">
<meta name="twitter:description" content="The ProblemLittle Bob is playing a game. He wants to win some candies in it - as many as possible. There are 4 piles, each pile contains N candies. Bob is given a basket which can hold at most 5 candi">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <!-- <link rel="import" href="/bower_components/app-layout/app-layout.html"> --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main" style="width: 95%"><article id="post-oj/uva/uva-10118" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/16/oj/uva/uva-10118/" class="article-date">
  <time datetime="2014-06-15T23:06:43.000Z" itemprop="datePublished">2014-06-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UVa 10118 - Free Candies
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/" data-id="ckq5wy4x902lhnsvnbu3yzbme" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dp/">dp</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/搜索/">搜索</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
              <div id="toc" class="toc-article">
              <h2 class="toc-title"><span>contents</span></h2>
              
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Problem"><span class="toc-number">1.</span> <span class="toc-text">The Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Input"><span class="toc-number">2.</span> <span class="toc-text">The Input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Output"><span class="toc-number">3.</span> <span class="toc-text">The Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sample-Input"><span class="toc-number">4.</span> <span class="toc-text">Sample Input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sample-Output"><span class="toc-number">5.</span> <span class="toc-text">Sample Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">6.</span> <span class="toc-text">Solution</span></a></li></ol>
              
              </div>
          
        
          <h2 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h2><p>Little Bob is playing a game. He wants to win some candies in it - as many as possible.</p>
<p>There are 4 piles, each pile contains N candies. Bob is given a basket which can hold at most 5 candies. Each time, he puts a candy at the top of one pile into the basket, and if there’re two candies of the same color in it ,he can take both of them outside the basket and put them into his own pocket. When the basket is full and there are no two candies of the same color, the game ends. If the game is played perfectly, the game will end with no candies left in the piles.</p>
<p>For example, Bob may play this game like this (N=5):</p>
<p>Step1     Initial Piles     Step2     Take one from pile #2<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1 2 3 4<br>1 5 6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>nothing     nothing     
</code></pre><p>1   3 4<br>1 5 6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2     nothing
</code></pre><p>Step3     Take one from pile #2     Step4     Take one from pile #3<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1   3 4<br>1   6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 5     nothing     
</code></pre><p>1     4<br>1   6 7<br>2 3 3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 3 5     nothing
</code></pre><p>Step5     Take one from pile #2     Step6     put two candies into his pocket<br>Piles     Basket     Pocket     Piles     Basket     Pocket</p>
<p>1     4<br>1   6 7<br>2   3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 3 3 5     nothing     
</code></pre><p>1     4<br>1   6 7<br>2   3 3<br>4 9 8 6<br>8 7 2 1</p>
<pre><code>2 5     a pair of 3
</code></pre><p>Note that different numbers indicate different colors, there are 20 kinds of colors numbered 1..20.</p>
<p>‘Seems so hard…’Bob got very much puzzled. How many pairs of candies could he take home at most?</p>
<h2 id="The-Input"><a href="#The-Input" class="headerlink" title="The Input"></a>The Input</h2><p>The input will contain no more than 10 test cases. Each test case begins with a line containing a single integer n(1&lt;=n&lt;=40) representing the height of the piles. In the following n lines, each line contains four integers xi1,xi2,xi3,xi4 (in the range 1..20). Each integer indicates the color of the corresponding candy. The test case containing n=0 will terminate the input, you should not give an answer to this case.</p>
<h2 id="The-Output"><a href="#The-Output" class="headerlink" title="The Output"></a>The Output</h2><p>Output the number of pairs of candies that the cleverest little child can take home. Print your answer in a single line for each test case.</p>
<h2 id="Sample-Input"><a href="#Sample-Input" class="headerlink" title="Sample Input"></a>Sample Input</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">5</div><div class="line">1 2 3 4</div><div class="line">1 5 6 7</div><div class="line">2 3 3 3</div><div class="line">4 9 8 6</div><div class="line">8 7 2 1</div><div class="line">1</div><div class="line">1 2 3 4</div><div class="line">3</div><div class="line">1 2 3 4</div><div class="line">5 6 7 8</div><div class="line">1 2 3 4</div><div class="line">0</div></pre></td></tr></table></figure>
<h2 id="Sample-Output"><a href="#Sample-Output" class="headerlink" title="Sample Output"></a>Sample Output</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">8</div><div class="line">0</div><div class="line">3</div></pre></td></tr></table></figure>
<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p><strong> 題目描述： </strong></p>
<p>現在盤面上共有 4 堆，每一堆呈現 stack 的方式，並且每一堆都會有 n 個糖果，接下來每一步將會把每一堆的 top 糖果放入籃子中，假使籃子中有相同編號的糖果，則會將這兩個相同編號的糖果收入口袋。請問到籃子滿 5 個糖果之前，最多有多少對的糖果可以帶回家。</p>
<p><strong> 題目解法： </strong></p>
<p>將搜索狀態進行標記，之後走訪遇到相同狀態直接退回。這個問題在相同狀態下的結果必然相同。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 45</span></div><div class="line"><span class="keyword">int</span> N, pile[<span class="number">4</span>][MAXN];</div><div class="line"><span class="keyword">int</span> used[MAXN][MAXN][MAXN][MAXN] = &#123;&#125;, testcase = <span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> dp[MAXN][MAXN][MAXN][MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> p1, <span class="keyword">int</span> p2, <span class="keyword">int</span> p3, <span class="keyword">int</span> p4, <span class="keyword">int</span> state)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(__builtin_popcount(state) == <span class="number">5</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(used[p1][p2][p3][p4] == testcase)</div><div class="line">        <span class="keyword">return</span> dp[p1][p2][p3][p4];</div><div class="line">    used[p1][p2][p3][p4] = testcase;</div><div class="line">    <span class="keyword">int</span> &amp;ret = dp[p1][p2][p3][p4];</div><div class="line">    <span class="keyword">int</span> t, v;</div><div class="line">    ret = <span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(p1 &lt; N) &#123;</div><div class="line">        t = pile[<span class="number">0</span>][p1];</div><div class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</div><div class="line">        ret = max(ret, v + dfs(p1+<span class="number">1</span>, p2, p3, p4, state^(<span class="number">1</span>&lt;&lt;t)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(p2 &lt; N) &#123;</div><div class="line">        t = pile[<span class="number">1</span>][p2];</div><div class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</div><div class="line">        ret = max(ret, v + dfs(p1, p2+<span class="number">1</span>, p3, p4, state^(<span class="number">1</span>&lt;&lt;t)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(p3 &lt; N) &#123;</div><div class="line">        t = pile[<span class="number">2</span>][p3];</div><div class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</div><div class="line">        ret = max(ret, v + dfs(p1, p2, p3+<span class="number">1</span>, p4, state^(<span class="number">1</span>&lt;&lt;t)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(p4 &lt; N) &#123;</div><div class="line">        t = pile[<span class="number">3</span>][p4];</div><div class="line">        v = (state&gt;&gt;t)&amp;<span class="number">1</span>;</div><div class="line">        ret = max(ret, v + dfs(p1, p2, p3, p4+<span class="number">1</span>, state^(<span class="number">1</span>&lt;&lt;t)));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">while</span>(<span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;N) == <span class="number">1</span> &amp;&amp; N) &#123;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; i++)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; j++)</div><div class="line">                <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;pile[j][i]);</div><div class="line">        testcase++;</div><div class="line">        <span class="keyword">int</span> ret = dfs(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ret);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/06/17/oj/uva/uva-313/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          UVa 313 - Intervals
        
      </div>
    </a>
  
  
    <a href="/2014/06/15/lesson/operating-system-notes-2/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">作業系統 筆記 (2)</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2014/06/16/oj/uva/uva-10118/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>