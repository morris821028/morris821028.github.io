<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>UVa 174 - Strategy | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ProblemA well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<meta name="keywords" content="遞迴分析">
<meta property="og:type" content="article">
<meta property="og:title" content="UVa 174 - Strategy">
<meta property="og:url" content="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:description" content="ProblemA well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2016-04-20T11:50:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="UVa 174 - Strategy">
<meta name="twitter:description" content="ProblemA well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main" style="width: 95%"><article id="post-oj/uva/uva-174" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2014/06/24/oj/uva/uva-174/" class="article-date">
  <time datetime="2014-06-24T09:17:39.000Z" itemprop="datePublished">2014-06-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/解題區/">解題區</a>/<a class="article-category-link" href="/categories/解題區/解題區-UVa/">解題區 - UVa</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      UVa 174 - Strategy
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/" data-id="ckpaivccu00lyn8vn6nxc7lyo" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2014/06/24/oj/uva/uva-174/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/遞迴分析/">遞迴分析</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
              <div id="toc" class="toc-article">
              <h2 class="toc-title"><span>contents</span></h2>
              
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Input"><span class="toc-number">2.</span> <span class="toc-text">Input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Output"><span class="toc-number">3.</span> <span class="toc-text">Output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sample-input"><span class="toc-number">4.</span> <span class="toc-text">Sample input</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Sample-output"><span class="toc-number">5.</span> <span class="toc-text">Sample output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solution"><span class="toc-number">6.</span> <span class="toc-text">Solution</span></a></li></ol>
              
              </div>
          
        
          <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>A well known psychology experiment involves people playing a game in which they can either trade with each other or attempt to cheat the other player. If both players TRADE then each gains one point. If one TRADEs and the other CHEATs then the TRADEr loses 2 points and the CHEATer wins 2. If both CHEAT then each loses 1 point.</p>
<p>There are a variety of different strategies for playing this game, although most people are either unable to find a winning strategy, or, having decided on a strategy, do not stick to it. Thus it is fairer to attempt to evaluate these strategies by simulation on a computer. Each strategy is simulated by an automaton. An automaton is characterised by a program incorporating the strategy, a memory for previous encounters and a count reflecting the score of that automaton. The count starts at zero and is altered according to the above rules after each encounter. The memory is able to determine what happened on up to the last two encounters with each other contender.</p>
<p>Write a program that will read in details of up to 10 different strategies, play each strategy against each other strategy 10 times and then print out the final scores. Strategies will be in the form of simple programs obeying the following grammar:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;program&gt; ::= &lt;statement&gt;.</span><br><span class="line">&lt;statement&gt; ::= &lt;command&gt; tex2html_wrap_inline45 &lt;ifstat&gt;</span><br><span class="line">&lt;ifstat&gt; ::= IF &lt;condition&gt; THEN &lt;statement&gt; ELSE &lt;statement&gt;</span><br><span class="line">&lt;condition&gt; ::= &lt;cond&gt; tex2html_wrap_inline45 &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</span><br><span class="line">&lt;op&gt; ::= AND tex2html_wrap_inline45 OR</span><br><span class="line">&lt;cond&gt; ::= &lt;memory&gt; &#123;= tex2html_wrap_inline45 #&#125; &#123;&lt;command&gt; tex2html_wrap_inline45 NULL&#125;</span><br><span class="line">&lt;memory&gt; ::= &#123;MY tex2html_wrap_inline45 YOUR&#125; LAST &#123;1 tex2html_wrap_inline45 2&#125;</span><br><span class="line">&lt;command&gt; ::= TRADE tex2html_wrap_inline45 CHEAT </span><br></pre></td></tr></table></figure>

<p>Note that LAST1 refers to the previous encounter between these two automata, LAST2 to the encounter before that and that <code>MY&#39; and </code>YOUR’ have the obvious meanings. Spaces and line breaks may appear anywhere in the program and are for legibility only. The symbol <code>#&#39; means </code>is not equal to’. NULL indicates that an encounter has not ocurred. The following are valid programs:</p>
<p>CHEAT.<br>IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.<br>IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE<br>ELSECHEAT.</p>
<h2 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h2><p>Input will consist of a series of programs. Each program will be no longer than 255 characters and may be split over several lines for convenience. There will be no more than 10 programs. The file will be terminated by a line containing only a single `#’.</p>
<h2 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h2><p>Output will consist of one line for each line of input. Each line will consist of the final score of the relevant program right justified in a field of width 3.</p>
<h2 id="Sample-input"><a href="#Sample-input" class="headerlink" title="Sample input"></a>Sample input</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CHEAT.</span><br><span class="line">IF MY LAST1 = CHEAT THEN TRADE ELSE CHEAT.</span><br><span class="line">IFYOURLAST2=NULLTHENTRADEELSEIFYOURLAST1=TRADETHENTRADE</span><br><span class="line">ELSECHEAT.</span><br><span class="line">#</span><br></pre></td></tr></table></figure>

<h2 id="Sample-output"><a href="#Sample-output" class="headerlink" title="Sample output"></a>Sample output</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  1</span><br><span class="line">-12</span><br><span class="line">-13</span><br></pre></td></tr></table></figure>

<h2 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h2><p>** 題目描述： **</p>
<p>現在這邊有兩台機器人，玩類似 “吹牛” 的紙牌遊戲，欺騙成功者將獲得點數。</p>
<p>而每一台機器的策略也有所不同，並且能根據對方前幾次和自己前幾次的策略進行判斷，給予每一台機器的策略模式，請兩兩互打 10 回合，最後輸出每一台機器的得分概況。</p>
<p>** 題目解法： **</p>
<p>這題不只有語法分析，還有語意分析。總之，遞迴分析是最主要的技巧。<br>對於 AND 和 OR 運算，測資中似乎沒有優先順序的情況，所以直接由左而右進行即可。</p>
<p>而在分析的時候，嘗試將指針一直往後移動，並且解析出第一個符合條件的 token。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;algorithm&gt;</span><br><span class="line">#include &lt;vector&gt;</span><br><span class="line">#include &lt;math.h&gt;</span><br><span class="line">#include &lt;iostream&gt;</span><br><span class="line">#include &lt;map&gt;</span><br><span class="line">#include &lt;assert.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">#include &lt;ctype.h&gt;</span><br><span class="line">using namespace std;</span><br><span class="line">enum ACTION &#123;TRADE, CHEAT, EMPTY&#125;;</span><br><span class="line">enum RECORD &#123;LAST1, LAST2&#125;;</span><br><span class="line">class Memory &#123;</span><br><span class="line">public:</span><br><span class="line">    map&lt;RECORD, ACTION&gt; R;</span><br><span class="line">    Memory() &#123;</span><br><span class="line">        R[LAST1] = EMPTY;</span><br><span class="line">        R[LAST2] = EMPTY;</span><br><span class="line">    &#125;</span><br><span class="line">    static ACTION getAction(string s) &#123;</span><br><span class="line">        if(s == &quot;TRADE&quot;)    return TRADE;</span><br><span class="line">        if(s == &quot;CHEAT&quot;)    return CHEAT;</span><br><span class="line">        if(s == &quot;EMPTY&quot;)    return EMPTY;</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION getMemory(string addr) &#123;</span><br><span class="line">        if (addr == &quot;LAST1&quot;)</span><br><span class="line">            return R[LAST1];</span><br><span class="line">        if (addr == &quot;LAST2&quot;)</span><br><span class="line">            return R[LAST2];</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    void record(ACTION a) &#123;</span><br><span class="line">        ACTION last1 = R[LAST1], last2 = R[LAST2];</span><br><span class="line">        R[LAST1] = a;</span><br><span class="line">        R[LAST2] = last1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">class Strategy &#123;</span><br><span class="line">public:</span><br><span class="line">    char prog[1024];</span><br><span class="line">    Strategy(string s) &#123;</span><br><span class="line">        for (int i = 0; i &lt; s.length(); i++) &#123;</span><br><span class="line">            prog[i] = s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        prog[s.length()] = &#x27;\0&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    char* match(char *str, const char *p) &#123;</span><br><span class="line">        if (str == NULL)</span><br><span class="line">            return  NULL;</span><br><span class="line">        if (memcmp(str, p, strlen(p)) == 0)</span><br><span class="line">            return str + strlen(p);</span><br><span class="line">        return NULL;</span><br><span class="line">    &#125;</span><br><span class="line">/*</span><br><span class="line"> &lt;condition&gt; ::= &lt;cond&gt; | &lt;cond&gt; &lt;op&gt; &lt;condition&gt;</span><br><span class="line"> &lt;op&gt; ::= AND | OR</span><br><span class="line"> &lt;cond&gt; ::= &lt;memory&gt; &#123;= | #&#125; &#123;&lt;command&gt; | NULL&#125;</span><br><span class="line"> &lt;memory&gt; ::= &#123;MY | YOUR&#125; LAST &#123;1 | 2&#125;</span><br><span class="line"> &lt;command&gt; ::= TRADE | CHEAT</span><br><span class="line"> */</span><br><span class="line">    bool cond(char* &amp;p, Memory MY, Memory YOUR) &#123;</span><br><span class="line">        // printf(&quot;condition %s\n&quot;, p);</span><br><span class="line">        char        *q;</span><br><span class="line">        Memory      *addr = NULL;</span><br><span class="line">        string      read, equal, kind;</span><br><span class="line">        /* &lt;memory&gt; */</span><br><span class="line">        q = match(p, &quot;MY&quot;);</span><br><span class="line">        if(q != NULL)   p = q, addr = &amp;MY;</span><br><span class="line">        q = match(p, &quot;YOUR&quot;);</span><br><span class="line">        if(q != NULL)   p = q, addr = &amp;YOUR;</span><br><span class="line">        q = match(p, &quot;LAST1&quot;);</span><br><span class="line">        if(q != NULL)   p = q, read = &quot;LAST1&quot;;</span><br><span class="line">        q = match(p, &quot;LAST2&quot;);</span><br><span class="line">        if(q != NULL)   p = q, read = &quot;LAST2&quot;;</span><br><span class="line">        /* &#123;= | #&#125; */</span><br><span class="line">        q = match(p, &quot;=&quot;);</span><br><span class="line">        if(q != NULL)   p = q, equal = &quot;=&quot;;</span><br><span class="line">        q = match(p, &quot;#&quot;);</span><br><span class="line">        if(q != NULL)   p = q, equal = &quot;#&quot;;</span><br><span class="line">        /* &#123;&lt;command&gt; | NULL&#125; */</span><br><span class="line">        q = match(p, &quot;TRADE&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;TRADE&quot;;</span><br><span class="line">        q = match(p, &quot;CHEAT&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;CHEAT&quot;;</span><br><span class="line">        q = match(p, &quot;NULL&quot;);</span><br><span class="line">        if(q != NULL)  p = q, kind = &quot;EMPTY&quot;;</span><br><span class="line">        bool ret = equal == &quot;=&quot; ? addr-&gt;getMemory(read) == Memory::getAction(kind) :</span><br><span class="line">                                    addr-&gt;getMemory(read) != Memory::getAction(kind);</span><br><span class="line">        // cout &lt;&lt; &quot;ADDR: &quot; &lt;&lt; addr-&gt;getMemory(read) &lt;&lt; &quot;, ACTION: &quot; &lt;&lt; Memory::getAction(kind) &lt;&lt; endl;</span><br><span class="line">        // cout &lt;&lt; read &lt;&lt; &quot;, &quot; &lt;&lt; kind &lt;&lt; endl; </span><br><span class="line">        /* &lt;op&gt; &lt;condition&gt; */</span><br><span class="line">        q = match(p, &quot;AND&quot;);</span><br><span class="line">        if(q != NULL)  p = q, ret = ret&amp;cond(p, MY, YOUR);</span><br><span class="line">        q = match(p, &quot;OR&quot;);</span><br><span class="line">        if(q != NULL)  p = q, ret = ret|cond(p, MY, YOUR);</span><br><span class="line">        // cout &lt;&lt; &quot;return &quot; &lt;&lt; ret &lt;&lt; endl;</span><br><span class="line">        return ret;</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION ifstat(char* &amp;p, Memory a, Memory b) &#123;</span><br><span class="line">        char *q;</span><br><span class="line">        q = match(p, &quot;IF&quot;);</span><br><span class="line">        if (q != NULL) &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            bool f = cond(p, a, b);</span><br><span class="line">            ACTION a1, a2;</span><br><span class="line">            q = match(p, &quot;THEN&quot;);</span><br><span class="line">            p = q;</span><br><span class="line">            a1 = statement(p, a, b);</span><br><span class="line">            q = match(p, &quot;ELSE&quot;);</span><br><span class="line">        	p = q;</span><br><span class="line">        	a2 = statement(p, a, b);</span><br><span class="line">        	return f ? a1 : a2;</span><br><span class="line">        &#125;</span><br><span class="line">        assert(false);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION statement(char* &amp;p, Memory a, Memory b) &#123;</span><br><span class="line">        // printf(&quot;%s\n&quot;, p);</span><br><span class="line">        char *q;</span><br><span class="line">        q = match(p, &quot;TRADE&quot;);</span><br><span class="line">        if (q != NULL)  &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            return TRADE;</span><br><span class="line">        &#125;</span><br><span class="line">        q = match(p, &quot;CHEAT&quot;);</span><br><span class="line">        if (q != NULL) &#123;</span><br><span class="line">            p = q;</span><br><span class="line">            return CHEAT;</span><br><span class="line">        &#125;</span><br><span class="line">        return ifstat(p, a, b);</span><br><span class="line">    &#125;</span><br><span class="line">    ACTION eval(char* &amp;p, Memory a, Memory b) &#123; // read only</span><br><span class="line">        // printf(&quot;eval %s\n&quot;, p);</span><br><span class="line">        return statement(p, a, b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">int main() &#123;</span><br><span class="line">    char c, s[1024];</span><br><span class="line">    vector&lt;Strategy&gt; machine;</span><br><span class="line">    while (true) &#123;</span><br><span class="line">        int n = 0;</span><br><span class="line">        while ((c = getchar()) != EOF) &#123;</span><br><span class="line">            if(c == &#x27;.&#x27; || (c == &#x27;#&#x27; &amp;&amp; n == 0) )</span><br><span class="line">                break;</span><br><span class="line">            if(isspace(c))</span><br><span class="line">                continue;</span><br><span class="line">            s[n++] = c;</span><br><span class="line">        &#125;</span><br><span class="line">        if (n == 0)</span><br><span class="line">            break;</span><br><span class="line">        s[n++] = &#x27;\0&#x27;;</span><br><span class="line">        machine.push_back(Strategy(s));</span><br><span class="line">    &#125;</span><br><span class="line">#define MAXN 20</span><br><span class="line">    int SCORE[MAXN] = &#123;&#125;;</span><br><span class="line">    for (int i = 0; i &lt; machine.size(); i++) &#123;</span><br><span class="line">        for (int j = i + 1; j &lt; machine.size(); j++) &#123;</span><br><span class="line">            Memory      ma, mb;</span><br><span class="line">            Strategy    &amp;A = machine[i];</span><br><span class="line">            Strategy    &amp;B = machine[j];</span><br><span class="line">            char        *p;</span><br><span class="line">            </span><br><span class="line">            for (int k = 0; k &lt; 10; k++) &#123;</span><br><span class="line">                ACTION ia = A.eval(p = A.prog, ma, mb);</span><br><span class="line">                ACTION ib = B.eval(p = B.prog, mb, ma);</span><br><span class="line">                if(ia == TRADE &amp;&amp; ib == TRADE)</span><br><span class="line">                	SCORE[i]++, SCORE[j]++;</span><br><span class="line">                else if(ia == TRADE &amp;&amp; ib == CHEAT)</span><br><span class="line">                	SCORE[i] -= 2, SCORE[j] += 2;</span><br><span class="line">                else if(ia == CHEAT &amp;&amp; ib == TRADE)</span><br><span class="line">                	SCORE[i] += 2, SCORE[j] -= 2;</span><br><span class="line">                else</span><br><span class="line">                	SCORE[i]--, SCORE[j]--;</span><br><span class="line">                ma.record(ia), mb.record(ib);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    for(int i = 0; i &lt; machine.size(); i++)</span><br><span class="line">    	printf(&quot;%3d\n&quot;, SCORE[i]);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2014/06/24/oj/uva/uva-427/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          UVa 427 - FlatLand Piano Movers
        
      </div>
    </a>
  
  
    <a href="/2014/06/24/oj/uva/uva-171/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">UVa 171 - Car Trialling</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2021 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2014/06/24/oj/uva/uva-174/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>