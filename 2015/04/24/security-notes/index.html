<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>資訊安全 小考筆記 | Morris&#39; Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Problem Follow  What is a monoalphabetic cipher ? How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ? What is the main security weakness of">
<meta name="keywords" content="密碼學">
<meta property="og:type" content="article">
<meta property="og:title" content="資訊安全 小考筆記">
<meta property="og:url" content="http://morris821028.github.io/2015/04/24/security-notes/index.html">
<meta property="og:site_name" content="Morris&#39; Blog">
<meta property="og:description" content="Problem Follow  What is a monoalphabetic cipher ? How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ? What is the main security weakness of">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2016-04-20T11:50:22.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="資訊安全 小考筆記">
<meta name="twitter:description" content="Problem Follow  What is a monoalphabetic cipher ? How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ? What is the main security weakness of">
<link rel="publisher" href="108158678174364350000">
  
    <link rel="alternative" href="/atom.xml" title="Morris&#39; Blog" type="application/atom+xml">
  
  
    <meta name="google-site-verification" content="5mRgj8NanEMpGZuNfHNJNmH90RgNlrnJXsFlTaKD6Gs" />
  
  
    <link rel="shortcut icon" href="/img/f.ico">
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <script src="/js/jquery-2.1.0.min.js"></script>
  <link rel="stylesheet" href="/css/style.css">
  
  <link rel="stylesheet" href="http://cdn.oesmith.co.uk/morris-0.5.1.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
<script src="http://cdn.oesmith.co.uk/morris-0.5.1.min.js"></script>
  <link rel="import" href="/bower_components/app-layout/app-layout.html"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>
<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"><div id="banner-right"></div></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Morris&#39; Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          
            <a class="main-nav-link" href="/"><i class=icon-home title='Home'></i></a>
          
        
          
            <a class="main-nav-link" href="/about"><i class=icon-user title='About'></i></a>
          
        
          
            <a class="main-nav-link" href="/archives"><i class=icon-archive title='Archives'></i></a>
          
        
          
            <a class="main-nav-link" href="/tags"><i class=icon-tags title='Tags'></i></a>
          
        
          
            <a class="main-nav-link" href="/picture"><i class=icon-camera title='Pictures'></i></a>
          
        
          
            <a class="main-nav-link" href="/works"><i class=icon-trophy title='Works'></i></a>
          
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://morris821028.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        
          
          <section id="main" style="width: 95%"><article id="post-security-notes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2015/04/24/security-notes/" class="article-date">
  <time datetime="2015-04-24T02:37:28.000Z" itemprop="datePublished">2015-04-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/學校課程/">學校課程</a>/<a class="article-category-link" href="/categories/學校課程/資訊安全/">資訊安全</a>
  </div>

  </div>
  <div class="article-inner ">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      資訊安全 小考筆記
    </h1>
  

      </header>
    
    <footer class="article-footer">
      <a data-url="http://morris821028.github.io/2015/04/24/security-notes/" data-id="ckgyukis700ec3svr2ey6mrym" class="article-share-link">Share</a>
      
        <a href="http://morris821028.github.io/2015/04/24/security-notes/#disqus_thread" class="article-comment-link">Comments</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/密碼學/">密碼學</a></li></ul>

    </footer>
    <div class="article-entry " itemprop="articleBody">
      
          
              <div id="toc" class="toc-article">
              <h2 class="toc-title"><span>contents</span></h2>
              
                  <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem"><span class="toc-number">1.</span> <span class="toc-text">Problem</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notes"><span class="toc-number">2.</span> <span class="toc-text">Notes</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-1"><span class="toc-number">2.1.</span> <span class="toc-text">Part 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-2"><span class="toc-number">2.2.</span> <span class="toc-text">Part 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-3"><span class="toc-number">2.3.</span> <span class="toc-text">Part 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-4"><span class="toc-number">2.4.</span> <span class="toc-text">Part 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-5"><span class="toc-number">2.5.</span> <span class="toc-text">Part 5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-6"><span class="toc-number">2.6.</span> <span class="toc-text">Part 6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-7"><span class="toc-number">2.7.</span> <span class="toc-text">Part 7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Part-8"><span class="toc-number">2.8.</span> <span class="toc-text">Part 8</span></a></li></ol></li></ol>
              
              </div>
          
        
          <h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><ol>
<li><p>Follow</p>
<ol>
<li>What is a monoalphabetic cipher ?</li>
<li>How large is the key space of the monoalphabetic cipher applied to English (just consider lower case letters) ?</li>
<li>What is the main security weakness of a monoalphabetic cipher ?</li>
<li>Please provide at least 4 approaches to prevent the above weakness.</li>
</ol>
</li>
<li><p>Block ciphers process messages in blocks like an extremely large substitution, but this is very difficult to implement for a very big block size. What is Shannon’s idea to realize a block cipher with big block size ?</p>
</li>
<li><p>The S-box of DES round operation is not invertable, but why DES can decrypt ?</p>
</li>
<li><p>Follow</p>
<ol>
<li>Please explain the OFB mode.</li>
<li>In the OFB mode, we never reuse the same sequence (key+IV). If we reuse the key, then the attacker can recover message. Please describe very precisely (mathematiclly with symbols) how the attack works.</li>
</ol>
</li>
<li><p>Please compare the CFB mode the OFB mode by providing a table indicating at least 5 of their advantage and corresponding disadvantage.</p>
</li>
<li><p>This question is about issues of random access of encryption and decryption. Define notations or symbols you need before providing your answer. Please describe how to use CFB mode and CTR mode to randomly encrypt and decrypt a file Why OFB mode is inappropriate to randomly encrypt and decrypt a file?</p>
</li>
<li><p>Describe the details (as much as you remember) of AES operation and describe how efficiently implement AES on an 8-bit CPU ?</p>
</li>
<li><p>How avalanche happens in AES within the first tow rounds ?</p>
</li>
</ol>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><h3 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h3><p>monoalphabetic cipher 簡單來說比凱薩加密難一點，從每個字母都 shift 固定的數量來說，變成變動式的。換句話說就是單純的英文字母替換 (substitute)。由於要維持可逆的解密，替換必須符合一對一，所以方法數為 <code>26! = 403291461126605635584000000</code>。</p>
<p>但這種替換方式容易受到語言統計的攻擊，也就是說在英文的特性中，不是每個字母都出現相同的頻率，因為很多冗詞的使用，導致有些字母會特別多。也因此在找對應時，可以藉由這一個觀點，反向查找可能的替換，大幅度地降低搜索可能，讓解密變得相當容易。</p>
<p>為了解決這一語言統計的攻擊，可以藉由</p>
<ul>
<li>壓縮明文，破壞語言特性，但是壓縮算法有儲存的字典部分，仍可能發生字典結構被攻擊，進而進行解壓縮。</li>
<li>增加垃圾字，撥點冗詞穿插在其中，把頻率不均的問題消彌。</li>
<li>多個字符一起加密，相對於單一字母的替換，可以同時替換兩個以上，如 <code>AA -&gt; WT</code> 之類的。</li>
<li>使用多種替換，在不同時刻使用不同的替換表，同樣地可以把頻率問題解決。</li>
<li>參照後續區段加密的一些技巧，如 CFB、OFB … 等，讓替換表進行變動。</li>
</ul>
<h3 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h3><p>區段加密具有相當大的強度，當一次加密 64 bits 時，可以達到的對應種類高達 <code>(2^64)!</code>，沒有辦法將這種表格存放在記憶體，因為也要消耗 <code>2^64</code> bits。</p>
<p>因此有 Shannon’s idea，利用 substitution (S-box)、permutation (P-box) 來完成對應，藉由 S-P 的組合，提供 混淆(confusion) 和 差異 (diffusion)。組合的效應遠比想像中的還大，儘管組合的方法數遠小於 <code>(2^64)!</code>，連兆分之一都不到，但簡單的概念可以在 <code>64KB</code> 記憶體大小內完成，效應上算相當划算。</p>
<h3 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h3><p>DES 的 S-box 屬於不可逆的操作 (8-bits to 6-bits)，然而 DES 在解密時，不需要將 S-box 往回推導，也就是不需要逆向操作，因為加密的 key 來自於 master key 和另一段的訊息 L(i) ，最後用 key 加密 R(i) 得到 L(i+1)。解密時，只需要將 R(i+1) (L(i) 會變成 S(i+1))帶入 S-box，就能重新產生出 key。</p>
<p>至於 DES 為什麼可以正確加解密，定義對於所有的任意明文 A, B，產生的密文 E(A) != E(B)。若明文差異在 L(i)，則在 R(i+1) 一定會不同。若明文差異在 R(i)，則在 key 相同，做 L(i+1) = R(i) XOR key 時，L(i+1) 也必定會不同。</p>
<h3 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h3><span>$$O_{i} = E_{k}(O_{i-1}); O_{-1} = IV \\
C_{i} = P_{i} \text{ XOR } O_{i}$$</span><!-- Has MathJax -->
<p>為什麼 OFB 不能重新使用 key + IV 呢？原因是因為 <strong> 已知明文攻擊 (Known plaintext attack) </strong> 。假設每一天都重新啟動，那麼攻擊者可以在事後得到密文對應的明文 (可能隔天才知道，儘管對應仍然是很難的)，那麼可以藉由數學概念來完成解密，無須考慮 key 是什麼內容。</p>
<span>$$C_{i} = P_{i} \text{ XOR } O_{i} \\
C_{j} = P_{j} \text{ XOR } O_{i} \\
C_{i} \text{ XOR } C_{j} = P_{i} \text{ XOR } P_{j}$$</span><!-- Has MathJax -->
<p>假設 i 和 j 重複使用 key，那麼會發生已知密文<span>$C_{i}, C_{j}$</span><!-- Has MathJax --> (傳輸上一定會被發現) 和已知明文<span>$P_{i}$</span><!-- Has MathJax -->，只要夾擊做 XOR，就可以直接得到<span>$P_{j}$</span><!-- Has MathJax -->，當已知明文相當長時，竊取的效果就越好。</p>
<h3 id="Part-5"><a href="#Part-5" class="headerlink" title="Part 5"></a>Part 5</h3><p>比較 CFB 和 OFB。</p>
<table>
<thead>
<tr>
<th>特性\模式</th>
<th>CFB</th>
<th>OFB</th>
</tr>
</thead>
<tbody>
<tr>
<td>自同步 (self-synchronization)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>錯誤擴散 (error propagation)</td>
<td>有</td>
<td>無</td>
</tr>
<tr>
<td>預先計算 (preprocess key)</td>
<td>不可</td>
<td>可</td>
</tr>
<tr>
<td>隨機存取 (random access)</td>
<td>可</td>
<td>不可</td>
</tr>
<tr>
<td>資訊安全性 (message security)</td>
<td>高</td>
<td>低</td>
</tr>
</tbody>
</table>
<ul>
<li><strong> 自同步 (self-synchronization) </strong>，不用告知對方加密狀態，可以藉由數次的傳輸訊息，自動地將兩邊的狀態一致，在此之前會造成一段雜訊。斷線時，不必重複使用 IV 讓兩邊同步 (狀態相同時，才能正確解密)。</li>
<li><strong> 錯誤擴散 (error propagation) </strong> ，也因為自同步的設計，導致在同步前都會有雜訊，或者在訊息被攻擊者竄改時，會影響該週期的狀態 (<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --> )。</li>
<li><strong> 預先計算 (preprocess key) </strong> ，預先計算 key 可以加快加解密速度，同時便可支持平行運算，這原因是因為 message-independent/dependent 之間的差異，狀態不依靠正在傳遞的訊息時，就可以預先處理。</li>
<li><strong> 隨機存取 (random access) </strong> ，當要解析某個密文時，CFB 可以往前查找密文<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax -->，得到當前的解密器所需要的狀態，放上 master key 就能進行解密。OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</li>
<li><strong> 資訊安全性 (message security) </strong> ，由於狀態與訊息獨立，會導致被攻擊者竄改內容時不易發現。在 CFB 中，由於依賴傳遞的訊息，當攻擊者竄改某個密文時會造成錯誤擴散，影響的解密時的明文不只一個，這也讓安全性提高。可以說是一體兩面的特性。</li>
</ul>
<h3 id="Part-6"><a href="#Part-6" class="headerlink" title="Part 6"></a>Part 6</h3><ul>
<li>CFB 狀態為 master key +<span>$C_{i-k}, C_{i-k+1}, ..., C_{i-1}$</span><!-- Has MathJax --></li>
<li>CTR 狀態為 master key + counter</li>
</ul>
<p>CFB 解密某個密文時，往前查找密文即可解密。CTR 知道密文 offset 便可得到 counter。在獲得資訊上都是 O(k) 常數，因此支持隨機存取。</p>
<blockquote>
<p>OFB 辦不到這一點，狀態不依賴訊息，那就要知道當前是哪個回合，從 IV 開始推導狀態，若密文在第 n 個位置，需要 O(n) 的時間來得到狀態，相對於 CFB 的 O(k) = O(1)來說相當耗時。</p>
</blockquote>
<p>CFB 和 CTR 到底誰的隨機存取能力好呢？若檔案儲存會切割成數個，那 CFB 的隨機存取能力就更高一點。CTR 必須計算 offset，相較於 CFB 的紀錄架構會稍微地麻煩。</p>
<h3 id="Part-7"><a href="#Part-7" class="headerlink" title="Part 7"></a>Part 7</h3><p>AES 的計算結構都落在 GF(2^8)，一個 cell 的內容都是 GF(2^8)</p>
<ul>
<li>substitue 需要 8-bits to 8-bits</li>
<li>shift rows 對於 8-bit 關聯不大 (移動記憶體的位置)</li>
<li>mixColume 上是 8-bits x 8-bits</li>
<li>add round key 對於每一個 cell XOR 8-bit keys</li>
</ul>
<p>因此 AES 可以在 8-bits CPU 上有更好的實作效能，所需要的 clock cycle 會比較短。</p>
<h3 id="Part-8"><a href="#Part-8" class="headerlink" title="Part 8"></a>Part 8</h3><p>假設有兩個明文的 <strong> 漢明距離 (Hamming distance) </strong> 為 1，在 128 bits 中有一個 1 bits 不同，意即<span>$H(P, Q) = 1$</span><!-- Has MathJax -->。</p>
<table>
<thead>
<tr>
<th>Step\Round</th>
<th>Round 1</th>
<th>Round 2</th>
</tr>
</thead>
<tbody>
<tr>
<td>Substitue bytes</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Shift rows</td>
<td>4 bits</td>
<td>16 bits</td>
</tr>
<tr>
<td>Mix Columes</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
<tr>
<td>Add Round key</td>
<td>16 bits</td>
<td>64 bits</td>
</tr>
</tbody>
</table>
<ul>
<li>在 Substitue bytes 步驟時，S-box 會設計成期望當有一個 1-bits 不同，則替換出來的結果會有 4-bits 不同 (一個 cell 具有 8-bits。替換 8-bits 時，差異最少 0 bits、最多 8-bits，期望值是 4-bits)。</li>
<li>在 Shift rows 步驟時，單純移動 cell 不影響差異。</li>
<li>在 Mix Columes 步驟時，每一個 colume 會根據上一個 colume 的 4 個元素相互影響，因此會增加 4 倍。</li>
<li>在 Add Round key 步驟時，由於 XOR 相同的 key，因此差異並不會改變。</li>
</ul>
<p>最後，在 Round 2 時，能得到平均 64 bits 的差異。加密的明文一次 128 bits，差異期望值也就是一半的情況 64 bits，因此很快地就能達到期望的差異性。在隨後的 Round X 中，差異會在 64-bits 上下浮動都是有可能的。</p>

        
      
    </div>

  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/04/25/security-galois-field/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          資訊安全 Galois Fields C++ 軟體實作體驗
        
      </div>
    </a>
  
  
    <a href="/2015/04/22/game-maker-design/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Game Maker 遊戲介面設計</div>
    </a>
  
</nav>

  
</article>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>
</section>
          
          
        
      </div>
      <footer id="footer">
  
  <div class="outer">    
    <div class="social-group">
      
      <a href="https://github.com/morris821028" target="_blank" title="github"><i class="icon-github"></i></a>
      
      
      <a href="https://www.facebook.com/Morris1028" target="_blank" title="facebook"><i class="icon-facebook-sign"></i></a>
      
      
      <a href="http://uhunt.felix-halim.net/id/46705" target="_blank" title="uhunt" ><span class="icon-uhunt">UVa<span></a>
      
    </div>
    <div id="footer-info" class="inner">
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/morris821028/hexo-theme-landscape" target="_blank" title="landscape">landscape</a> &copy; 2020 Shiang-Yun Yang 
    </div>
  </div>
</footer>


    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link"><i class=icon-home ></i>&nbsp&nbspHome</a>
  
    <a href="/about" class="mobile-nav-link"><i class=icon-user ></i>&nbsp&nbspAbout</a>
  
    <a href="/archives" class="mobile-nav-link"><i class=icon-archive ></i>&nbsp&nbspArchives</a>
  
    <a href="/tags" class="mobile-nav-link"><i class=icon-tags ></i>&nbsp&nbspTags</a>
  
    <a href="/picture" class="mobile-nav-link"><i class=icon-camera ></i>&nbsp&nbspPictures</a>
  
    <a href="/works" class="mobile-nav-link"><i class=icon-trophy ></i>&nbsp&nbspWorks</a>
  
</nav>
    
<script>
  var disqus_shortname = 'morris1028';
  
  var disqus_url = 'http://morris821028.github.io/2015/04/24/security-notes/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/jquery.lazyload.js"></script>
<script src="/js/jquery.als-1.6.js"></script>

<script src="/js/script.js"></script>

  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>